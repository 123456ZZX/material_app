{"remainingRequest":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\babel-loader\\lib\\index.js!D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\eslint-loader\\index.js??ref--14-0!D:\\Code\\Project\\WL\\xasw-mobile\\src\\utils\\sm4.js","dependencies":[{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\src\\utils\\sm4.js","mtime":1705912799992},{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\babel.config.js","mtime":1705912799600},{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:LyoNCiAqIEBEZXNjcmlwdGlvbjogU000IOWKoOWvhi/op6Plr4YNCiAqIEBBdXRob3I6IHllX3hmDQogKiBARGF0ZTogMjAyMS0wMi0wNCAxMDoxMzo1OA0KICogQExhc3RFZGl0VGltZTogMjAyMS0wNS0xNCAxMToyMToyNA0KICogQExhc3RFZGl0b3JzOiBQbGVhc2Ugc2V0IExhc3RFZGl0b3JzDQogKiBAUmVmZXJlbmNlOg0KICovCgppbXBvcnQgeyBzbTIgfSBmcm9tICdzbS1jcnlwdG8nOwovLyAjU00y5ZCO56uv5YWs6ZKlCmNvbnN0IFNNMl9CQUNLX1BVQkxJQ0tfS0VZID0gJzA0MjAzNWNmZmVhY2RhMTRmNGE3Njg0MjUwNzBkYjhmYmUxMzZjNzJiODM1ODE4YzU1NWRlYmUzMzBjMWQyMjBkYTUxNGNhNDY2YjZjMTcxY2MyNDQ1ODQ0YzcwY2IwMDMyZWU3ZGYwYjRhMTFmZDQwOTdhOTI5NzcwZmMzM2MwN2QnOwovLyAjU00y5YmN56uv56uv5YWs6ZKlCi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtbGVuCi8vIGNvbnN0IFNNMl9QVUJMSUNLX0tFWSA9ICcwNDVhYTAwMTVjYzFiNmJmZGVmYTVhZmQ0MDQ2Yzc4YjViMDkwY2Q2NThkOTJhMjYzMTViZmY2YzgwNWIxZmNmYjI3OWIzYjViYWQxNjhmZjFhMWZkYjdlZDkxZDQxMDFlZjM0YWU2MjkxNDNmZGI5MjFjNjQzZjczZGJiOWNkMTNlJzsKLy8gI1NNMuengemSpQpjb25zdCBTTTJfUFJJVkFURV9LRVkgPSAnM2VmOWVmZWFmMDU0YWRiZmFmZGYxMDZjOTUxMGZjYmRmYjRjZGZmMmJkNTJmMTZkZTliYmMwMDVhMzlmZTk3MCc7Ci8vICNTTTTlr4bpkqUKY29uc3QgU000X0tFWSA9ICc0Mzg2OTM5OUMxNDExQTNCRTcxQTk5QjM1MTIzQUVGQyc7Ci8vIOeUn+aIkFNNNOWvhumSpQovLyBmdW5jdGlvbiBnZXRLZXkobGVuZ3RoID0gMzIpIHsKLy8gICBjb25zdCByYW5kb20gPSAnMDEyMzQ1Njc4OUFCQ0RFRic7Ci8vICAgbGV0IHN0ciA9ICcnOwoKLy8gICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7Ci8vICAgICBzdHIgKz0gcmFuZG9tLmNoYXJBdChNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxNikpOwovLyAgIH0KCi8vICAgcmV0dXJuIHN0cjsKLy8gfQoKLy8g5Yqg5a+GCmZ1bmN0aW9uIGVuY3J5cHQocGxhaW50ZXh0LCBrZXkpIHsKICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW5kZWYKICBjb25zdCBzbTQgPSBuZXcgU200dXRpbHMoa2V5KTsKICBsZXQgdGV4dDsKICBpZiAocGxhaW50ZXh0IGluc3RhbmNlb2YgT2JqZWN0KSB7CiAgICB0ZXh0ID0gSlNPTi5zdHJpbmdpZnkocGxhaW50ZXh0KTsKICB9IGVsc2UgewogICAgdGV4dCA9IHBsYWludGV4dDsKICB9CiAgY29uc3QgZW5jcnlwdERhdGEgPSBzbTQuZW5jcnlwdERhdGFfRUNCKHRleHQpOwogIGlmICghZW5jcnlwdERhdGEpIHsKICAgIHJldHVybiBmYWxzZTsKICB9CiAgcmV0dXJuIGVuY3J5cHREYXRhOwp9CgovLyDop6Plr4YKZnVuY3Rpb24gZGVjcnlwdChjaXBoZXJ0ZXh0LCBrZXkpIHsKICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW5kZWYKICBjb25zdCBzbTQgPSBuZXcgU200dXRpbHMoa2V5KTsKICBsZXQgZGVjcnlwdERhdGEgPSBzbTQuZGVjcnlwdERhdGFfRUNCKGNpcGhlcnRleHQpOwogIGlmICghZGVjcnlwdERhdGEpIHsKICAgIHJldHVybiBmYWxzZTsKICB9CiAgaWYgKGRlY3J5cHREYXRhLmNoYXJBdCgwKSA9PT0gJ3snIHx8IGRlY3J5cHREYXRhLmNoYXJBdCgwKSA9PT0gJ1snKSB7CiAgICBkZWNyeXB0RGF0YSA9IEpTT04ucGFyc2UoZGVjcnlwdERhdGEpOwogIH0KICByZXR1cm4gZGVjcnlwdERhdGE7Cn0KCi8vIOaOpeWPo+aVsOaNruWKoOWvhgpleHBvcnQgZnVuY3Rpb24gZW5jcnlwdFNNNChkYXRhKSB7CiAgLy8gcmV0dXJuIG5ldyBQcm9taXNlKChyZXMsIHJlaikgPT4gewogIC8vIOS7jua1j+iniOWZqOe8k+WtmOS4reiOt+WPllNNNAogIC8vIGNvbnN0IFNNNF9LRVkgPSBzdG9yYWdlLmdldCgnc200X2tleScpCgogIC8vIGlmICghU000X0tFWSkgewogIC8vICAgICBTTTRfS0VZID0gZ2V0S2V5KCkgLy/ojrflj5ZTTTTlr4bpkqUKICAvLyAgICAgc3RvcmFnZS5zZXQoJ3NtNF9rZXknLCBTTTRfS0VZKSAvL+WwhlNNNOWvhumSpeWtmOWCqOWIsOa1j+iniOWZqOe8k+WtmOS4rQogIC8vIH0KCiAgY29uc3QgZW5jcnlwdERhdGEgPSBlbmNyeXB0KGRhdGEsIFNNNF9LRVkpOwogIGlmICghZW5jcnlwdERhdGEpIHsKICAgIC8vIGNvbnNvbGUubG9nKCfmlbDmja7liqDlr4blpLHotKUnKTsKICAgIC8vIHJlaihmYWxzZSk7CiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICAvLyBjb25zdCBlbmNyeXB0U000ID0gJzA0JyArIHNtMi5kb0VuY3J5cHQoU000X0tFWSwgU00yX1BVQkxJQ0tfS0VZLCAwKSAvL+WwhlNNNF9LRVnkvb/nlKhTTTLlhazpkqXov5vooYzliqDlr4YKCiAgcmV0dXJuIGVuY3J5cHREYXRhOwogIC8vIH0pCn0KCi8vIOaOpeWPo+aVsOaNruino+WvhgpleHBvcnQgZnVuY3Rpb24gZGVjcnlwdFNNNChkYXRhKSB7CiAgLy8gcmV0dXJuIG5ldyBQcm9taXNlKChyZXMsIHJlaikgPT4gewogIC8vIGNvbnN0IFNNNF9LRVkgPSBzbTIuZG9EZWNyeXB0KGRhdGEsIFNNMl9QUklWQVRFX0tFWSwgMCkgLy/kvb/nlKhTTTLnp4HpkqXop6Plr4bojrflj5ZTTTRfS0VZCgogIGlmICghU000X0tFWSkgewogICAgLy8gY29uc29sZS5sb2coJ1NNNOWvhumSpeino+WvhuWksei0pScpOwogICAgLy8gcmVqKGZhbHNlKTsKICAgIHJldHVybiBmYWxzZTsKICB9CiAgY29uc3QgZGVjcnlwdERhdGEgPSBkZWNyeXB0KGRhdGEsIFNNNF9LRVkpOyAvLyDkvb/nlKhTTTRfS0VZ6Kej5a+GCiAgLy8gICBjb25zb2xlLmxvZyhkZWNyeXB0RGF0YSk7CiAgaWYgKCFkZWNyeXB0RGF0YSkgewogICAgLy8gICBjb25zb2xlLmxvZygn5pWw5o2u6Kej5a+G5aSx6LSlJyk7CiAgICAvLyByZWooZmFsc2UpOwogICAgcmV0dXJuIGZhbHNlOwogIH0KICByZXR1cm4gZGVjcnlwdERhdGE7Cn0KZXhwb3J0IGZ1bmN0aW9uIGVuY3J5cHRTTTIoZGF0YSkgewogIHJldHVybiBgMDQke3NtMi5kb0VuY3J5cHQoZGF0YSwgU00yX0JBQ0tfUFVCTElDS19LRVksIDApfWA7Cn0KZXhwb3J0IGZ1bmN0aW9uIGRlY3J5cHRTTTIoZGF0YSkgewogIHJldHVybiBzbTIuZG9EZWNyeXB0KGRhdGEuc2xpY2UoMiksIFNNMl9QUklWQVRFX0tFWSwgMCk7Cn0="},{"version":3,"names":["sm2","SM2_BACK_PUBLICK_KEY","SM2_PRIVATE_KEY","SM4_KEY","encrypt","plaintext","key","sm4","Sm4utils","text","Object","JSON","stringify","encryptData","encryptData_ECB","decrypt","ciphertext","decryptData","decryptData_ECB","charAt","parse","encryptSM4","data","decryptSM4","encryptSM2","doEncrypt","decryptSM2","doDecrypt","slice"],"sources":["D:/Code/Project/WL/xasw-mobile/src/utils/sm4.js"],"sourcesContent":["/*\r\n * @Description: SM4 加密/解密\r\n * @Author: ye_xf\r\n * @Date: 2021-02-04 10:13:58\r\n * @LastEditTime: 2021-05-14 11:21:24\r\n * @LastEditors: Please set LastEditors\r\n * @Reference:\r\n */\r\n\r\nimport { sm2 } from 'sm-crypto';\r\n// #SM2后端公钥\r\nconst SM2_BACK_PUBLICK_KEY = '042035cffeacda14f4a768425070db8fbe136c72b835818c555debe330c1d220da514ca466b6c171cc2445844c70cb0032ee7df0b4a11fd4097a929770fc33c07d';\r\n// #SM2前端端公钥\r\n// eslint-disable-next-line max-len\r\n// const SM2_PUBLICK_KEY = '045aa0015cc1b6bfdefa5afd4046c78b5b090cd658d92a26315bff6c805b1fcfb279b3b5bad168ff1a1fdb7ed91d4101ef34ae629143fdb921c643f73dbb9cd13e';\r\n// #SM2私钥\r\nconst SM2_PRIVATE_KEY = '3ef9efeaf054adbfafdf106c9510fcbdfb4cdff2bd52f16de9bbc005a39fe970';\r\n// #SM4密钥\r\nconst SM4_KEY = '43869399C1411A3BE71A99B35123AEFC';\r\n// 生成SM4密钥\r\n// function getKey(length = 32) {\r\n//   const random = '0123456789ABCDEF';\r\n//   let str = '';\r\n\r\n//   for (let i = 0; i < length; i++) {\r\n//     str += random.charAt(Math.floor(Math.random() * 16));\r\n//   }\r\n\r\n//   return str;\r\n// }\r\n\r\n// 加密\r\nfunction encrypt(plaintext, key) {\r\n  // eslint-disable-next-line no-undef\r\n  const sm4 = new Sm4utils(key);\r\n\r\n  let text;\r\n\r\n  if (plaintext instanceof Object) {\r\n    text = JSON.stringify(plaintext);\r\n  } else {\r\n    text = plaintext;\r\n  }\r\n\r\n  const encryptData = sm4.encryptData_ECB(text);\r\n\r\n  if (!encryptData) {\r\n    return false;\r\n  }\r\n  return encryptData;\r\n}\r\n\r\n// 解密\r\nfunction decrypt(ciphertext, key) {\r\n  // eslint-disable-next-line no-undef\r\n  const sm4 = new Sm4utils(key);\r\n  let decryptData = sm4.decryptData_ECB(ciphertext);\r\n\r\n  if (!decryptData) {\r\n    return false;\r\n  }\r\n\r\n  if (decryptData.charAt(0) === '{' || decryptData.charAt(0) === '[') {\r\n    decryptData = JSON.parse(decryptData);\r\n  }\r\n\r\n  return decryptData;\r\n}\r\n\r\n// 接口数据加密\r\nexport function encryptSM4(data) {\r\n  // return new Promise((res, rej) => {\r\n  // 从浏览器缓存中获取SM4\r\n  // const SM4_KEY = storage.get('sm4_key')\r\n\r\n  // if (!SM4_KEY) {\r\n  //     SM4_KEY = getKey() //获取SM4密钥\r\n  //     storage.set('sm4_key', SM4_KEY) //将SM4密钥存储到浏览器缓存中\r\n  // }\r\n\r\n  const encryptData = encrypt(data, SM4_KEY);\r\n\r\n  if (!encryptData) {\r\n    // console.log('数据加密失败');\r\n    // rej(false);\r\n    return false;\r\n  }\r\n\r\n  // const encryptSM4 = '04' + sm2.doEncrypt(SM4_KEY, SM2_PUBLICK_KEY, 0) //将SM4_KEY使用SM2公钥进行加密\r\n\r\n  return encryptData;\r\n  // })\r\n}\r\n\r\n// 接口数据解密\r\nexport function decryptSM4(data) {\r\n  // return new Promise((res, rej) => {\r\n  // const SM4_KEY = sm2.doDecrypt(data, SM2_PRIVATE_KEY, 0) //使用SM2私钥解密获取SM4_KEY\r\n\r\n  if (!SM4_KEY) {\r\n    // console.log('SM4密钥解密失败');\r\n    // rej(false);\r\n    return false;\r\n  }\r\n\r\n  const decryptData = decrypt(data, SM4_KEY); // 使用SM4_KEY解密\r\n  //   console.log(decryptData);\r\n  if (!decryptData) {\r\n    //   console.log('数据解密失败');\r\n    // rej(false);\r\n    return false;\r\n  }\r\n\r\n  return decryptData;\r\n}\r\nexport function encryptSM2(data) {\r\n  return `04${sm2.doEncrypt(data, SM2_BACK_PUBLICK_KEY, 0)}`;\r\n}\r\nexport function decryptSM2(data) {\r\n  return sm2.doDecrypt(data.slice(2), SM2_PRIVATE_KEY, 0);\r\n}\r\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,SAASA,GAAG,QAAQ,WAAW;AAC/B;AACA,MAAMC,oBAAoB,GAAG,oIAAoI;AACjK;AACA;AACA;AACA;AACA,MAAMC,eAAe,GAAG,kEAAkE;AAC1F;AACA,MAAMC,OAAO,GAAG,kCAAkC;AAClD;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,SAASC,OAAOA,CAACC,SAAS,EAAEC,GAAG,EAAE;EAC/B;EACA,MAAMC,GAAG,GAAG,IAAIC,QAAQ,CAACF,GAAG,CAAC;EAE7B,IAAIG,IAAI;EAER,IAAIJ,SAAS,YAAYK,MAAM,EAAE;IAC/BD,IAAI,GAAGE,IAAI,CAACC,SAAS,CAACP,SAAS,CAAC;EAClC,CAAC,MAAM;IACLI,IAAI,GAAGJ,SAAS;EAClB;EAEA,MAAMQ,WAAW,GAAGN,GAAG,CAACO,eAAe,CAACL,IAAI,CAAC;EAE7C,IAAI,CAACI,WAAW,EAAE;IAChB,OAAO,KAAK;EACd;EACA,OAAOA,WAAW;AACpB;;AAEA;AACA,SAASE,OAAOA,CAACC,UAAU,EAAEV,GAAG,EAAE;EAChC;EACA,MAAMC,GAAG,GAAG,IAAIC,QAAQ,CAACF,GAAG,CAAC;EAC7B,IAAIW,WAAW,GAAGV,GAAG,CAACW,eAAe,CAACF,UAAU,CAAC;EAEjD,IAAI,CAACC,WAAW,EAAE;IAChB,OAAO,KAAK;EACd;EAEA,IAAIA,WAAW,CAACE,MAAM,CAAC,CAAC,CAAC,KAAK,GAAG,IAAIF,WAAW,CAACE,MAAM,CAAC,CAAC,CAAC,KAAK,GAAG,EAAE;IAClEF,WAAW,GAAGN,IAAI,CAACS,KAAK,CAACH,WAAW,CAAC;EACvC;EAEA,OAAOA,WAAW;AACpB;;AAEA;AACA,OAAO,SAASI,UAAUA,CAACC,IAAI,EAAE;EAC/B;EACA;EACA;;EAEA;EACA;EACA;EACA;;EAEA,MAAMT,WAAW,GAAGT,OAAO,CAACkB,IAAI,EAAEnB,OAAO,CAAC;EAE1C,IAAI,CAACU,WAAW,EAAE;IAChB;IACA;IACA,OAAO,KAAK;EACd;;EAEA;;EAEA,OAAOA,WAAW;EAClB;AACF;;AAEA;AACA,OAAO,SAASU,UAAUA,CAACD,IAAI,EAAE;EAC/B;EACA;;EAEA,IAAI,CAACnB,OAAO,EAAE;IACZ;IACA;IACA,OAAO,KAAK;EACd;EAEA,MAAMc,WAAW,GAAGF,OAAO,CAACO,IAAI,EAAEnB,OAAO,CAAC,CAAC,CAAC;EAC5C;EACA,IAAI,CAACc,WAAW,EAAE;IAChB;IACA;IACA,OAAO,KAAK;EACd;EAEA,OAAOA,WAAW;AACpB;AACA,OAAO,SAASO,UAAUA,CAACF,IAAI,EAAE;EAC/B,OAAQ,KAAItB,GAAG,CAACyB,SAAS,CAACH,IAAI,EAAErB,oBAAoB,EAAE,CAAC,CAAE,EAAC;AAC5D;AACA,OAAO,SAASyB,UAAUA,CAACJ,IAAI,EAAE;EAC/B,OAAOtB,GAAG,CAAC2B,SAAS,CAACL,IAAI,CAACM,KAAK,CAAC,CAAC,CAAC,EAAE1B,eAAe,EAAE,CAAC,CAAC;AACzD"}]}