{"remainingRequest":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\babel-loader\\lib\\index.js!E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\eslint-loader\\index.js??ref--14-0!E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\src\\utils\\sign.js","dependencies":[{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\src\\utils\\sign.js","mtime":1705912799992},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\babel.config.js","mtime":1705912799600},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7Ci8qDQogKiBAQXV0aG9yOiB4aWVfc20NCiAqIEBEYXRlOiAyMDIyLTAzLTE2IDA4OjU3OjQwDQogKiBATGFzdEVkaXRvcnM6IHhpZV9zbQ0KICogQExhc3RFZGl0VGltZTogMjAyMi0wMy0xNiAxMTozMTozMw0KICogQEZpbGVQYXRoOiBcbW9iaWxlLXRlbXBsYXRlXHNyY1x1dGlsc1xzaWduLmpzDQogKiBARGVzY3JpcHRpb246DQogKg0KICovCmltcG9ydCBIbWFjU0hBMSBmcm9tICJjcnlwdG8tanMvaG1hYy1zaGExIjsKaW1wb3J0IEJhc2U2NCBmcm9tICJjcnlwdG8tanMvZW5jLWJhc2U2NCI7CmltcG9ydCBkYXlqcyBmcm9tICJkYXlqcyI7CmltcG9ydCB7IGlzRW1wdHkgfSBmcm9tICIuL3V0aWwiOwppbXBvcnQgeyBDTElFTlQsIENMSUVOVF9TRUNSRVQsIFRUTCB9IGZyb20gIkAvc2V0dGluZ3MiOwppbXBvcnQgc3RvcmFnZSBmcm9tICIuL3N0b3JhZ2UiOwpjb25zdCBEdmFsdWUgPSAoKSA9PiBgJHtzdG9yYWdlLmdldCgidHMtRC12YWx1ZSIpfWAgPT09ICJudWxsIiA/IDAgOiBOdW1iZXIoYCR7c3RvcmFnZS5nZXQoInRzLUQtdmFsdWUiKX1gKTsKY29uc3Qgb2JqVHJhbnNVcmxQYXJhbXMgPSBvYmogPT4gewogIGNvbnN0IHBhcmFtcyA9IFtdOwogIE9iamVjdC5rZXlzKG9iaikuZm9yRWFjaChrZXkgPT4gewogICAgbGV0IHZhbHVlID0gb2JqW2tleV07CiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAidW5kZWZpbmVkIikgewogICAgICB2YWx1ZSA9ICIiOwogICAgfQogICAgcGFyYW1zLnB1c2goW2tleSwgdmFsdWVdLmpvaW4oIj0iKSk7CiAgfSk7CiAgcmV0dXJuIHBhcmFtcy5qb2luKCImIik7Cn07CmNvbnN0IHNvcnRVcmxQYXJhbXMgPSBzdHIgPT4gewogIGlmICh0eXBlb2Ygc3RyICE9PSAic3RyaW5nIikgewogICAgcmV0dXJuIHt9OwogIH0KICBjb25zdCBwYXJhbU9iaiA9IHt9OwogIGNvbnN0IHBhcmFtQXJyID0gZGVjb2RlVVJJKHN0cikuc3BsaXQoIiYiKTsKICAvLyBsZXQgcGFyYW1BcnIgPSBzdHIuc3BsaXQoJyYnKTsKICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcGx1c3BsdXMKICBmb3IgKGxldCBpID0gMDsgaSA8IHBhcmFtQXJyLmxlbmd0aDsgaSsrKSB7CiAgICBjb25zdCB0bXAgPSBwYXJhbUFycltpXS5zcGxpdCgiPSIpOwogICAgY29uc3Qga2V5ID0gdG1wWzBdOwogICAgY29uc3QgdmFsdWUgPSB0bXBbMV0gfHwgIiI7CiAgICAvLyBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyAmJiBpc05hTihOdW1iZXIodmFsdWUpKSA9PT0gZmFsc2UgJiYgdmFsdWUgIT09ICIiKSB7CiAgICAvLyAgdmFsdWUgPSBOdW1iZXIodmFsdWUpOwogICAgLy8gfQogICAgaWYgKHR5cGVvZiBwYXJhbU9ialtrZXldID09PSAidW5kZWZpbmVkIikgewogICAgICBwYXJhbU9ialtrZXldID0gdmFsdWU7CiAgICB9IGVsc2UgewogICAgICBjb25zdCBuZXdWYWx1ZSA9IEFycmF5LmlzQXJyYXkocGFyYW1PYmpba2V5XSkgPyBwYXJhbU9ialtrZXldIDogW3BhcmFtT2JqW2tleV1dOwogICAgICBuZXdWYWx1ZS5wdXNoKHZhbHVlKTsKICAgICAgcGFyYW1PYmpba2V5XSA9IG5ld1ZhbHVlOwogICAgfQogIH0KICByZXR1cm4gcGFyYW1PYmo7Cn07CmNvbnN0IG9iaktleVNvcnQgPSBvYmogPT4gewogIGNvbnN0IG5ld2tleSA9IE9iamVjdC5rZXlzKG9iaikuc29ydCgpOwogIGNvbnN0IG5ld09iaiA9IHt9OwogIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1wbHVzcGx1cwogIGZvciAobGV0IGkgPSAwOyBpIDwgbmV3a2V5Lmxlbmd0aDsgaSsrKSB7CiAgICBuZXdPYmpbbmV3a2V5W2ldXSA9IG9ialtuZXdrZXlbaV1dOwogIH0KICByZXR1cm4gbmV3T2JqOwp9OwoKLy8g6I635Y+W5Yqg5a+G5ZCO55qE5Y+C5pWw5a+56LGhCi8qKg0KICogQHBhcmFtIHtvYmplY3R9IOWvueixoeS4reeahOWxnuaAp+S4uumcgOimgeWKoOWvhueahOWxnuaApw0KICogQGV4YW1wbGUgZ2V0U2lnbih7IGY4czogZmlsZVRva2VuIH0pDQogKiBAcmV0dXJuDQogKiB7DQogICAgZjhzOiAiYzE1Y2YyZTk5YzliNDZjZmM0Y2VkNGQyMzAxYjZhZWYiDQogICAgc2lnbjogIkF1QlJVRHo2cXpCWFc0QitzZzFHaXB0dUl5cz0iDQogICAgdHM6ICIxNjAyNDk5NDQxNjIyIg0KICAgIHR0bDogIjMwIg0KICAgIHVpZDogImZhd2tlcyJ9DQogKi8KZXhwb3J0IGNvbnN0IGdldFNpZ24gPSByZXN0ID0+IHsKICBsZXQgcGFyYW0gPSAiIjsKICBjb25zdCB0cyA9IGRheWpzKCkudW5peCgpICsgRHZhbHVlKCk7CiAgY29uc3QgdHRsID0gVFRMOwogIGNvbnN0IG9iaiA9IHJlc3Q7CiAgcGFyYW0gKz0gYHRzPSR7dHN9JnR0bD0ke3R0bH0mdWlkPSR7Q0xJRU5UfSR7aXNFbXB0eShvYmopID8gIiIgOiBgJiR7b2JqVHJhbnNVcmxQYXJhbXMob2JqKX1gfWA7CiAgbGV0IHBhcmFtQXJyID0gc29ydFVybFBhcmFtcyhwYXJhbSk7CiAgcGFyYW1BcnIgPSBvYmpLZXlTb3J0KHBhcmFtQXJyKTsKICBsZXQgcGFyYW1TdHIgPSBbXTsKICBPYmplY3Qua2V5cyhwYXJhbUFycikuZm9yRWFjaChrZXkgPT4gcGFyYW1TdHIucHVzaChgJHtrZXl9PSR7cGFyYW1BcnJba2V5XX1gKSk7CiAgcGFyYW1TdHIgPSBwYXJhbVN0ci5qb2luKCImIik7CiAgY29uc3Qgc2lnbldvcmRBcnJheSA9IEhtYWNTSEExKHBhcmFtU3RyLCBDTElFTlRfU0VDUkVUKTsKICBjb25zdCBzaWduID0gQmFzZTY0LnN0cmluZ2lmeShzaWduV29yZEFycmF5KTsKICByZXR1cm4gewogICAgc2lnbiwKICAgIHRzLAogICAgdHRsLAogICAgdWlkOiBDTElFTlQsCiAgICAuLi5wYXJhbUFycgogIH07Cn07CmV4cG9ydCBkZWZhdWx0IHsKICBnZXRTaWduCn07"},{"version":3,"names":["HmacSHA1","Base64","dayjs","isEmpty","CLIENT","CLIENT_SECRET","TTL","storage","Dvalue","get","Number","objTransUrlParams","obj","params","Object","keys","forEach","key","value","push","join","sortUrlParams","str","paramObj","paramArr","decodeURI","split","i","length","tmp","newValue","Array","isArray","objKeySort","newkey","sort","newObj","getSign","rest","param","ts","unix","ttl","paramStr","signWordArray","sign","stringify","uid"],"sources":["E:/ty_project/xasw-yy/revenue/xasw-mobile/src/utils/sign.js"],"sourcesContent":["/*\r\n * @Author: xie_sm\r\n * @Date: 2022-03-16 08:57:40\r\n * @LastEditors: xie_sm\r\n * @LastEditTime: 2022-03-16 11:31:33\r\n * @FilePath: \\mobile-template\\src\\utils\\sign.js\r\n * @Description:\r\n *\r\n */\r\nimport HmacSHA1 from \"crypto-js/hmac-sha1\";\r\nimport Base64 from \"crypto-js/enc-base64\";\r\nimport dayjs from \"dayjs\";\r\nimport { isEmpty } from \"./util\";\r\nimport { CLIENT, CLIENT_SECRET, TTL } from \"@/settings\";\r\nimport storage from \"./storage\";\r\n\r\nconst Dvalue = () =>\r\n  `${storage.get(\"ts-D-value\")}` === \"null\" ? 0 : Number(`${storage.get(\"ts-D-value\")}`);\r\n\r\nconst objTransUrlParams = (obj) => {\r\n  const params = [];\r\n  Object.keys(obj).forEach((key) => {\r\n    let value = obj[key];\r\n    if (typeof value === \"undefined\") {\r\n      value = \"\";\r\n    }\r\n    params.push([key, value].join(\"=\"));\r\n  });\r\n  return params.join(\"&\");\r\n};\r\n\r\nconst sortUrlParams = (str) => {\r\n  if (typeof str !== \"string\") {\r\n    return {};\r\n  }\r\n  const paramObj = {};\r\n  const paramArr = decodeURI(str).split(\"&\");\r\n  // let paramArr = str.split('&');\r\n  // eslint-disable-next-line no-plusplus\r\n  for (let i = 0; i < paramArr.length; i++) {\r\n    const tmp = paramArr[i].split(\"=\");\r\n    const key = tmp[0];\r\n    const value = tmp[1] || \"\";\r\n    // if (typeof value === 'string' && isNaN(Number(value)) === false && value !== \"\") {\r\n    //  value = Number(value);\r\n    // }\r\n    if (typeof paramObj[key] === \"undefined\") {\r\n      paramObj[key] = value;\r\n    } else {\r\n      const newValue = Array.isArray(paramObj[key]) ? paramObj[key] : [paramObj[key]];\r\n      newValue.push(value);\r\n      paramObj[key] = newValue;\r\n    }\r\n  }\r\n  return paramObj;\r\n};\r\n\r\nconst objKeySort = (obj) => {\r\n  const newkey = Object.keys(obj).sort();\r\n  const newObj = {};\r\n  // eslint-disable-next-line no-plusplus\r\n  for (let i = 0; i < newkey.length; i++) {\r\n    newObj[newkey[i]] = obj[newkey[i]];\r\n  }\r\n  return newObj;\r\n};\r\n\r\n// 获取加密后的参数对象\r\n/**\r\n * @param {object} 对象中的属性为需要加密的属性\r\n * @example getSign({ f8s: fileToken })\r\n * @return\r\n * {\r\n    f8s: \"c15cf2e99c9b46cfc4ced4d2301b6aef\"\r\n    sign: \"AuBRUDz6qzBXW4B+sg1GiptuIys=\"\r\n    ts: \"1602499441622\"\r\n    ttl: \"30\"\r\n    uid: \"fawkes\"}\r\n */\r\nexport const getSign = (rest) => {\r\n  let param = \"\";\r\n  const ts = dayjs().unix() + Dvalue();\r\n  const ttl = TTL;\r\n  const obj = rest;\r\n  param += `ts=${ts}&ttl=${ttl}&uid=${CLIENT}${isEmpty(obj) ? \"\" : `&${objTransUrlParams(obj)}`}`;\r\n  let paramArr = sortUrlParams(param);\r\n  paramArr = objKeySort(paramArr);\r\n  let paramStr = [];\r\n  Object.keys(paramArr).forEach((key) => paramStr.push(`${key}=${paramArr[key]}`));\r\n  paramStr = paramStr.join(\"&\");\r\n  const signWordArray = HmacSHA1(paramStr, CLIENT_SECRET);\r\n  const sign = Base64.stringify(signWordArray);\r\n  return {\r\n    sign,\r\n    ts,\r\n    ttl,\r\n    uid: CLIENT,\r\n    ...paramArr,\r\n  };\r\n};\r\n\r\nexport default {\r\n  getSign,\r\n};\r\n"],"mappings":"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"}]}