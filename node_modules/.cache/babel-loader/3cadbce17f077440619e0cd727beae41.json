{"remainingRequest":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\babel-loader\\lib\\index.js!D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\eslint-loader\\index.js??ref--14-0!D:\\Code\\Project\\WL\\xasw-mobile\\src\\components\\map\\utils\\area\\area.js","dependencies":[{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\src\\components\\map\\utils\\area\\area.js","mtime":1708928163326},{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\babel.config.js","mtime":1705912799600},{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9kZWZpbmVQcm9wZXJ0eSBmcm9tICJEOi9Db2RlL1Byb2plY3QvV0wveGFzdy1tb2JpbGUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2RlZmluZVByb3BlcnR5LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCAqIGFzIHR1cmYgZnJvbSAnQHR1cmYvdHVyZic7CmltcG9ydCBtYXBib3hnbCBmcm9tICdtYXBib3gtZ2wnOwppbXBvcnQgJ21hcGJveC1nbC9kaXN0L21hcGJveC1nbC5jc3MnOwppbXBvcnQgVnVlIGZyb20gInZ1ZSI7CmltcG9ydCBjbG9zZUJ1dHRvbiBmcm9tICIuLi9jb21tb24vcG9wdXAvY2xvc2VCdXR0b24iOwppbXBvcnQgcG9wdXAgZnJvbSAiLi4vY29tbW9uL3BvcHVwL3B1cG9wLnZ1ZSI7CmltcG9ydCBzd2FuVG9vbCBmcm9tICIuLi9zd2FuVG9vbCI7CgovKioNCiAqIOmdouenr+a1i+mHjw0KICovCmV4cG9ydCBkZWZhdWx0IGNsYXNzIHN3YW5BcmVhIGV4dGVuZHMgc3dhblRvb2wgewogIGNvbnN0cnVjdG9yKG1hcCkgewogICAgc3VwZXIobWFwKTsKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiYWRkUG9seWdvbiIsIGUgPT4gewogICAgICB0aGlzLnN0YXJ0RHJhdyA9IHRydWU7CiAgICAgIHRoaXMucG9seWdvbkRhdGFbMF0uZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF0ucHVzaChbZS5sbmdMYXQubG5nLCBlLmxuZ0xhdC5sYXRdKTsKICAgICAgbGV0IGdlb2pzb24gPSB7CiAgICAgICAgInR5cGUiOiAiRmVhdHVyZUNvbGxlY3Rpb24iLAogICAgICAgICJmZWF0dXJlcyI6IHRoaXMucG9seWdvbkRhdGEKICAgICAgfTsKICAgICAgdGhpcy5tYXAuZ2V0U291cmNlKCJwb2x5Z29uIikuc2V0RGF0YShnZW9qc29uKTsKICAgIH0pOwogICAgX2RlZmluZVByb3BlcnR5KHRoaXMsICJhZGRNb3ZlUG9seWdvbiIsIGUgPT4gewogICAgICBpZiAoIXRoaXMuc3RhcnREcmF3KSByZXR1cm47CiAgICAgIHRoaXMubW92ZURhdGEgPSBbewogICAgICAgICJ0eXBlIjogIkZlYXR1cmUiLAogICAgICAgICJnZW9tZXRyeSI6IHsKICAgICAgICAgICJ0eXBlIjogIlBvbHlnb24iLAogICAgICAgICAgImNvb3JkaW5hdGVzIjogW1tdXQogICAgICAgIH0KICAgICAgfV07CiAgICAgIHRoaXMubW92ZURhdGFbMF0uZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF0gPSBbLi4udGhpcy5wb2x5Z29uRGF0YVswXS5nZW9tZXRyeS5jb29yZGluYXRlc1swXSwgW2UubG5nTGF0LmxuZywgZS5sbmdMYXQubGF0XV07CiAgICAgIGxldCBnZW9qc29uID0gewogICAgICAgICJ0eXBlIjogIkZlYXR1cmVDb2xsZWN0aW9uIiwKICAgICAgICAiZmVhdHVyZXMiOiB0aGlzLm1vdmVEYXRhCiAgICAgIH07CiAgICAgIHRoaXMubWFwLmdldFNvdXJjZSgicG9seWdvbiIpLnNldERhdGEoZ2VvanNvbik7CiAgICAgIHRoaXMubGFzdFBvcHVwICYmIHRoaXMubGFzdFBvcHVwLnJlbW92ZSgpOwogICAgICBpZiAodGhpcy5tb3ZlRGF0YVswXS5nZW9tZXRyeS5jb29yZGluYXRlc1swXS5sZW5ndGggPCA0KSByZXR1cm47CiAgICAgIGxldCBhcmVhID0gdGhpcy5nZXRBcmVhKHRoaXMubW92ZURhdGFbMF0uZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF0pOwogICAgICBsZXQgZGlzcGxheVRleHQgPSBbewogICAgICAgIGtleTogIumdouenrzoiLAogICAgICAgIHZhbHVlOiBhcmVhCiAgICAgIH1dOwogICAgICBsZXQgcG9wdXBWID0gVnVlLmV4dGVuZChwb3B1cCk7CiAgICAgIGxldCBwb3B1cERvbSA9IG5ldyBwb3B1cFYoewogICAgICAgIHByb3BzRGF0YTogewogICAgICAgICAgZGlzcGxheVRleHQKICAgICAgICB9CiAgICAgIH0pLiRtb3VudCgpOwogICAgICB0aGlzLnZtTGlzdC5wdXNoKHBvcHVwRG9tKTsKICAgICAgdGhpcy5sYXN0UG9wdXAgPSBuZXcgbWFwYm94Z2wuUG9wdXAoewogICAgICAgIG9mZnNldDogewogICAgICAgICAgJ3RvcCc6IFswLCAyMl0KICAgICAgICB9LAogICAgICAgIGNsb3NlQnV0dG9uOiBmYWxzZSwKICAgICAgICAvL+WmguaenOS4uiB0cnVlIO+8jOW8ueeql+WPs+S4iuinkuWwhuWHuueOsOWFs+mXreaMiemSruOAggogICAgICAgIGNsb3NlT25DbGljazogZmFsc2UsCiAgICAgICAgLy/lpoLmnpzkuLogdHJ1ZSDvvIzngrnlh7vlnLDlm77ml7blvLnnqpflsIblhbPpl63jgIIKICAgICAgICBjbGFzc05hbWU6ICdzd2FuLXBvcHVwJwogICAgICB9KS5zZXRMbmdMYXQoZS5sbmdMYXQpLnNldERPTUNvbnRlbnQocG9wdXBEb20uJGVsKS5hZGRUbyh0aGlzLm1hcCk7CiAgICB9KTsKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAic3RvcEFkZCIsICgpID0+IHsKICAgICAgaWYgKCF0aGlzLnN0YXJ0RHJhdykgcmV0dXJuOwogICAgICB0aGlzLmNsZWFyTGlzdGVuZXIoKTsKICAgICAgaWYgKHRoaXMubW92ZURhdGFbMF0uZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF0ubGVuZ3RoIC0gMSA9PSB0aGlzLnBvcHVwTGlzdC5sZW5ndGgpIHsKICAgICAgICB0aGlzLnBvcHVwTGlzdFt0aGlzLnBvcHVwTGlzdC5sZW5ndGggLSAxXS5yZW1vdmUoKTsKICAgICAgfQogICAgICAvLyBjbG9zZUJ1dHRvbgogICAgICAvL+a3u+WKoOWFs+mXreaMiemSrgogICAgICBsZXQgcG9wdXBDbG9zZSA9IFZ1ZS5leHRlbmQoY2xvc2VCdXR0b24pOwogICAgICBsZXQgcG9wdXBDbG9zZURvbSA9IG5ldyBwb3B1cENsb3NlKHt9KS4kbW91bnQoKTsKICAgICAgcG9wdXBDbG9zZURvbS4kb24oImNsb3NlIiwgKCkgPT4gewogICAgICAgIHRoaXMub25DYW5jZWwoKTsKICAgICAgfSk7CiAgICAgIHRoaXMudm1MaXN0LnB1c2gocG9wdXBDbG9zZURvbSk7CiAgICAgIGxldCBnZW9tID0gdGhpcy5tb3ZlRGF0YVswXS5nZW9tZXRyeS5jb29yZGluYXRlc1swXTsKICAgICAgdGhpcy5wb3B1cExpc3QucHVzaChuZXcgbWFwYm94Z2wuUG9wdXAoewogICAgICAgIG9mZnNldDogewogICAgICAgICAgJ2JvdHRvbSc6IFswLCA0MF0KICAgICAgICB9LAogICAgICAgIGNsb3NlQnV0dG9uOiBmYWxzZSwKICAgICAgICAvL+WmguaenOS4uiB0cnVlIO+8jOW8ueeql+WPs+S4iuinkuWwhuWHuueOsOWFs+mXreaMiemSruOAggogICAgICAgIGNsb3NlT25DbGljazogZmFsc2UsCiAgICAgICAgLy/lpoLmnpzkuLogdHJ1ZSDvvIzngrnlh7vlnLDlm77ml7blvLnnqpflsIblhbPpl63jgIIKICAgICAgICBjbGFzc05hbWU6ICdzd2FuLXBvcHVwLWNsb3NlJwogICAgICB9KS5zZXRMbmdMYXQoZ2VvbVtnZW9tLmxlbmd0aCAtIDFdKS5zZXRET01Db250ZW50KHBvcHVwQ2xvc2VEb20uJGVsKS5hZGRUbyh0aGlzLm1hcCkpOwogICAgfSk7CiAgICB0aGlzLnBvbHlnb25EYXRhID0gW107CiAgICB0aGlzLm1vdmVEYXRhID0gW107CiAgICB0aGlzLnN0YXJ0RHJhdyA9IGZhbHNlOwogICAgdGhpcy5wb3B1cExpc3QgPSBbXTsKICAgIHRoaXMudm1MaXN0ID0gW107CiAgICB0aGlzLmxhc3RQb3B1cCA9IG51bGw7CiAgfQogIG9uQWRkKCkgewogICAgdGhpcy5pbml0TWVhc3VyZSgpOwogICAgdGhpcy5tYXAub24oImNsaWNrIiwgdGhpcy5hZGRQb2x5Z29uKTsKICAgIHRoaXMubWFwLm9uKCJtb3VzZW1vdmUiLCB0aGlzLmFkZE1vdmVQb2x5Z29uKTsKICAgIHRoaXMubWFwLm9uKCJkYmxjbGljayIsIHRoaXMuc3RvcEFkZCk7CiAgfQogIGluaXRNZWFzdXJlKCkgewogICAgdGhpcy5wb3B1cExpc3QuZm9yRWFjaChpdGVtID0+IHsKICAgICAgaXRlbS5yZW1vdmUoKTsKICAgIH0pOwogICAgdGhpcy5sYXN0UG9wdXAgJiYgdGhpcy5sYXN0UG9wdXAucmVtb3ZlKCk7CiAgICB0aGlzLnBvbHlnb25EYXRhID0gW3sKICAgICAgInR5cGUiOiAiRmVhdHVyZSIsCiAgICAgICJnZW9tZXRyeSI6IHsKICAgICAgICAidHlwZSI6ICJQb2x5Z29uIiwKICAgICAgICAiY29vcmRpbmF0ZXMiOiBbW11dCiAgICAgIH0KICAgIH1dOwogICAgdGhpcy5tYXAuZ2V0Q2FudmFzKCkuc3R5bGUuY3Vyc29yID0gImNyb3NzaGFpciI7CiAgICAhdGhpcy5tYXAuZ2V0U291cmNlKCJwb2x5Z29uIikgJiYgdGhpcy5tYXAuYWRkU291cmNlKCJwb2x5Z29uIiwgewogICAgICAidHlwZSI6ICJnZW9qc29uIiwKICAgICAgImRhdGEiOiB7CiAgICAgICAgInR5cGUiOiAiRmVhdHVyZUNvbGxlY3Rpb24iLAogICAgICAgICJmZWF0dXJlcyI6IFtdCiAgICAgIH0sCiAgICAgICJtYXh6b29tIjogMTIgLy/lvZPku6Xmm7Tpq5jnmoTnvKnmlL7nuqfliKvmmL7npLrlnLDlm77ml7bvvIzlsIbkvb/nlKjmnaXoh6rmnIDlpKfnvKnmlL7nmoTnk6bniYfnmoTmlbDmja4KICAgIH0pOwogICAgIXRoaXMubWFwLmdldExheWVyKCJwb2x5Z29uIikgJiYgdGhpcy5tYXAuYWRkTGF5ZXIoewogICAgICAiaWQiOiAicG9seWdvbiIsCiAgICAgICJzb3VyY2UiOiAicG9seWdvbiIsCiAgICAgICJ0eXBlIjogImZpbGwiLAogICAgICAicGFpbnQiOiB7CiAgICAgICAgLy8g57uY5Yi257G75bGe5oCnCiAgICAgICAgImZpbGwtYW50aWFsaWFzIjogdHJ1ZSwKICAgICAgICAvLyDloavlhYXml7bmmK/lkKblj43plK/pvb/vvIjlj6/pgInvvIzpu5jorqTlgLzkuLogdHJ1Ze+8iQogICAgICAgICJmaWxsLW9wYWNpdHkiOiAwLjEsCiAgICAgICAgLy8g5aGr5YWF55qE5LiN6YCP5piO5bqm77yI5Y+v6YCJ77yM5Y+W5YC86IyD5Zu05Li6IDAgfiAx77yM6buY6K6k5YC85Li6IDHvvIkKICAgICAgICAiZmlsbC1jb2xvciI6ICIjRkZGRjAwIiwKICAgICAgICAvLyDloavlhYXnmoTpopzoibLvvIjlj6/pgInvvIzpu5jorqTlgLzkuLogIzAwMDAwMOOAguWmguaenOiuvue9ruS6hiBmaWxsLXBhdHRlcm7vvIzliJkgZmlsbC1jb2xvciDlsIbml6DmlYjvvIkKICAgICAgICAiZmlsbC1vdXRsaW5lLWNvbG9yIjogIiMwNkNFQUUiCiAgICAgIH0KICAgIH0pOwogICAgIXRoaXMubWFwLmdldExheWVyKCJwb2x5Z29uX2NhcCIpICYmIHRoaXMubWFwLmFkZExheWVyKHsKICAgICAgImlkIjogInBvbHlnb25fY2FwIiwKICAgICAgInNvdXJjZSI6ICJwb2x5Z29uIiwKICAgICAgInR5cGUiOiAiY2lyY2xlIiwKICAgICAgInBhaW50IjogewogICAgICAgIC8vIOe7mOWItuexu+WxnuaApwogICAgICAgICJjaXJjbGUtb3BhY2l0eSI6IDEsCiAgICAgICAgLy8g5ZyG54K555qE5LiN6YCP5piO5bqm77yI5Y+v6YCJ77yM5Y+W5YC86IyD5Zu05Li6IDAgfiAx77yM6buY6K6k5YC85Li6IDHvvIkKICAgICAgICAiY2lyY2xlLXJhZGl1cyI6IDQsCiAgICAgICAgLy8g5ZyG54K555qE5Y2K5b6E77yI5Y+v6YCJ77yM5YC8ID49IDDvvIzpu5jorqTlgLzkuLogNe+8jOWNleS9je+8muWDj+e0oO+8iQogICAgICAgICJjaXJjbGUtY29sb3IiOiAiI0ZGRkYwMCIgLy8g5ZyG54K555qE6aKc6Imy77yI5Y+v6YCJ77yM6buY6K6k5YC85Li6ICMwMDAwMDDvvIkKICAgICAgfQogICAgfSk7CiAgfQogIGdldEFyZWEoYXJlYUxpc3QpIHsKICAgIGxldCBwb2x5Z29uID0gdHVyZi5wb2x5Z29uKFtbLi4uYXJlYUxpc3QsIGFyZWFMaXN0WzBdXV0pOwogICAgbGV0IGFyZWEgPSB0dXJmLmFyZWEocG9seWdvbik7CiAgICBpZiAoYXJlYSA8IDEwMDAwMDApIHsKICAgICAgcmV0dXJuIGAke2FyZWEudG9GaXhlZCgyKX3jjqFgOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIGAkeyhhcmVhIC8gMTAwMDAwMCkudG9GaXhlZCgyKX1r446hYDsKICAgIH0KICB9CiAgY2xlYXJMaXN0ZW5lcigpIHsKICAgIHRoaXMuc3RhcnREcmF3ID0gZmFsc2U7CiAgICB0aGlzLm1hcC5nZXRDYW52YXMoKS5zdHlsZS5jdXJzb3IgPSAiIjsKICAgIHRoaXMubWFwLm9mZigiY2xpY2siLCB0aGlzLmFkZFBvbHlnb24pOwogICAgdGhpcy5tYXAub2ZmKCJtb3VzZW1vdmUiLCB0aGlzLmFkZE1vdmVQb2x5Z29uKTsKICAgIHRoaXMubWFwLm9mZigiZGJsY2xpY2siLCB0aGlzLnN0b3BBZGQpOwogIH0KICBvbkNhbmNlbCgpIHsKICAgIHRoaXMuY2xlYXJMaXN0ZW5lcigpOwogICAgdGhpcy5wb3B1cExpc3QuZm9yRWFjaChpdGVtID0+IHsKICAgICAgaXRlbS5yZW1vdmUoKTsKICAgIH0pOwogICAgdGhpcy52bUxpc3QuZm9yRWFjaChpdGVtID0+IHsKICAgICAgaXRlbS4kZGVzdHJveSgpOwogICAgfSk7CiAgICB0aGlzLmxhc3RQb3B1cCAmJiB0aGlzLmxhc3RQb3B1cC5yZW1vdmUoKTsKICAgIHRoaXMubWFwLmdldExheWVyKCJwb2x5Z29uIikgJiYgdGhpcy5tYXAucmVtb3ZlTGF5ZXIoInBvbHlnb24iKTsKICAgIHRoaXMubWFwLmdldExheWVyKCJwb2x5Z29uX2NhcCIpICYmIHRoaXMubWFwLnJlbW92ZUxheWVyKCJwb2x5Z29uX2NhcCIpOwogICAgdGhpcy5tYXAuZ2V0U291cmNlKCJwb2x5Z29uIikgJiYgdGhpcy5tYXAucmVtb3ZlU291cmNlKCJwb2x5Z29uIik7CiAgfQp9"},{"version":3,"names":["turf","mapboxgl","Vue","closeButton","popup","swanTool","swanArea","constructor","map","_defineProperty","e","startDraw","polygonData","geometry","coordinates","push","lngLat","lng","lat","geojson","getSource","setData","moveData","lastPopup","remove","length","area","getArea","displayText","key","value","popupV","extend","popupDom","propsData","$mount","vmList","Popup","offset","closeOnClick","className","setLngLat","setDOMContent","$el","addTo","clearListener","popupList","popupClose","popupCloseDom","$on","onCancel","geom","onAdd","initMeasure","on","addPolygon","addMovePolygon","stopAdd","forEach","item","getCanvas","style","cursor","addSource","getLayer","addLayer","areaList","polygon","toFixed","off","$destroy","removeLayer","removeSource"],"sources":["D:/Code/Project/WL/xasw-mobile/src/components/map/utils/area/area.js"],"sourcesContent":["import * as turf from '@turf/turf';\r\nimport mapboxgl from 'mapbox-gl';\r\nimport 'mapbox-gl/dist/mapbox-gl.css';\r\nimport Vue from \"vue\";\r\nimport closeButton from \"../common/popup/closeButton\";\r\nimport popup from \"../common/popup/pupop.vue\";\r\nimport swanTool from \"../swanTool\";\r\n\r\n/**\r\n * 面积测量\r\n */\r\nexport default class swanArea extends swanTool {\r\n  constructor(map) {\r\n    super(map);\r\n    this.polygonData = [];\r\n    this.moveData = [];\r\n    this.startDraw = false;\r\n    this.popupList = [];\r\n    this.vmList = [];\r\n    this.lastPopup = null;\r\n  }\r\n\r\n  onAdd() {\r\n    this.initMeasure();\r\n    this.map.on(\"click\", this.addPolygon)\r\n    this.map.on(\"mousemove\", this.addMovePolygon)\r\n    this.map.on(\"dblclick\", this.stopAdd)\r\n  }\r\n\r\n  initMeasure() {\r\n    this.popupList.forEach(item => {\r\n      item.remove()\r\n    })\r\n    this.lastPopup && this.lastPopup.remove()\r\n    this.polygonData = [{\r\n      \"type\": \"Feature\",\r\n      \"geometry\": {\r\n        \"type\": \"Polygon\",\r\n        \"coordinates\": [[]]\r\n      }\r\n    }]\r\n    this.map.getCanvas().style.cursor = \"crosshair\";\r\n    !this.map.getSource(\"polygon\") && this.map.addSource(\"polygon\", {\r\n      \"type\": \"geojson\",\r\n      \"data\": {\r\n        \"type\": \"FeatureCollection\",\r\n        \"features\": []\r\n      },\r\n      \"maxzoom\": 12 //当以更高的缩放级别显示地图时，将使用来自最大缩放的瓦片的数据\r\n    })\r\n    !this.map.getLayer(\"polygon\") && this.map.addLayer({\r\n      \"id\": \"polygon\",\r\n      \"source\": \"polygon\",\r\n      \"type\": \"fill\",\r\n      \"paint\": { // 绘制类属性\r\n        \"fill-antialias\": true, // 填充时是否反锯齿（可选，默认值为 true）\r\n        \"fill-opacity\": 0.1, // 填充的不透明度（可选，取值范围为 0 ~ 1，默认值为 1）\r\n        \"fill-color\": \"#FFFF00\", // 填充的颜色（可选，默认值为 #000000。如果设置了 fill-pattern，则 fill-color 将无效）\r\n        \"fill-outline-color\": \"#06CEAE\",\r\n      }\r\n    })\r\n    !this.map.getLayer(\"polygon_cap\") && this.map.addLayer({\r\n      \"id\": \"polygon_cap\",\r\n      \"source\": \"polygon\",\r\n      \"type\": \"circle\",\r\n      \"paint\": { // 绘制类属性\r\n        \"circle-opacity\": 1, // 圆点的不透明度（可选，取值范围为 0 ~ 1，默认值为 1）\r\n        \"circle-radius\": 4, // 圆点的半径（可选，值 >= 0，默认值为 5，单位：像素）\r\n        \"circle-color\": \"#FFFF00\", // 圆点的颜色（可选，默认值为 #000000）\r\n      }\r\n    })\r\n  }\r\n\r\n  addPolygon = (e) => {\r\n    this.startDraw = true\r\n    this.polygonData[0].geometry.coordinates[0].push([e.lngLat.lng, e.lngLat.lat]);\r\n    let geojson = {\r\n      \"type\": \"FeatureCollection\",\r\n      \"features\": this.polygonData\r\n    };\r\n    this.map.getSource(\"polygon\").setData(geojson);\r\n  }\r\n\r\n  addMovePolygon = (e) => {\r\n    if (!this.startDraw) return\r\n    this.moveData = [{\r\n      \"type\": \"Feature\",\r\n      \"geometry\": {\r\n        \"type\": \"Polygon\",\r\n        \"coordinates\": [[]]\r\n      }\r\n    }]\r\n    this.moveData[0].geometry.coordinates[0] = [\r\n      ...this.polygonData[0].geometry.coordinates[0],\r\n      [e.lngLat.lng, e.lngLat.lat]\r\n    ]\r\n    let geojson = {\r\n      \"type\": \"FeatureCollection\",\r\n      \"features\": this.moveData\r\n    };\r\n    this.map.getSource(\"polygon\").setData(geojson);\r\n\r\n    this.lastPopup && this.lastPopup.remove()\r\n    if (this.moveData[0].geometry.coordinates[0].length < 4) return\r\n    let area = this.getArea(this.moveData[0].geometry.coordinates[0])\r\n    let displayText = [{\r\n      key: \"面积:\",\r\n      value: area\r\n    }]\r\n    let popupV = Vue.extend(popup);\r\n    let popupDom = new popupV({\r\n      propsData: { displayText }\r\n    }).$mount();\r\n    this.vmList.push(popupDom);\r\n    this.lastPopup = new mapboxgl.Popup({\r\n      offset: {\r\n        'top': [0, 22],\r\n      },\r\n      closeButton: false,//如果为 true ，弹窗右上角将出现关闭按钮。\r\n      closeOnClick: false, //如果为 true ，点击地图时弹窗将关闭。\r\n      className: 'swan-popup'\r\n    })\r\n      .setLngLat(e.lngLat)\r\n      .setDOMContent(popupDom.$el)\r\n      .addTo(this.map)\r\n  }\r\n\r\n  getArea(areaList) {\r\n    let polygon = turf.polygon([[...areaList, areaList[0]]]);\r\n    let area = turf.area(polygon);\r\n    if (area < 1000000) {\r\n      return `${area.toFixed(2)}㎡`\r\n    } else {\r\n      return `${(area / 1000000).toFixed(2)}k㎡`\r\n    }\r\n  }\r\n\r\n  stopAdd = () => {\r\n    if (!this.startDraw)\r\n      return\r\n    this.clearListener()\r\n    if (this.moveData[0].geometry.coordinates[0].length - 1 == this.popupList.length) {\r\n      this.popupList[this.popupList.length - 1].remove()\r\n    }\r\n    // closeButton\r\n    //添加关闭按钮\r\n    let popupClose = Vue.extend(closeButton);\r\n    let popupCloseDom = new popupClose({}).$mount();\r\n    popupCloseDom.$on(\"close\", () => {\r\n      this.onCancel();\r\n    })\r\n    this.vmList.push(popupCloseDom);\r\n    let geom = this.moveData[0].geometry.coordinates[0]\r\n    this.popupList.push(\r\n      new mapboxgl.Popup({\r\n        offset: {\r\n          'bottom': [0, 40],\r\n        },\r\n        closeButton: false,//如果为 true ，弹窗右上角将出现关闭按钮。\r\n        closeOnClick: false, //如果为 true ，点击地图时弹窗将关闭。\r\n        className: 'swan-popup-close'\r\n      })\r\n        .setLngLat(geom[geom.length - 1])\r\n        .setDOMContent(popupCloseDom.$el)\r\n        .addTo(this.map)\r\n    )\r\n  }\r\n\r\n  clearListener() {\r\n    this.startDraw = false\r\n    this.map.getCanvas().style.cursor = \"\";\r\n    this.map.off(\"click\", this.addPolygon)\r\n    this.map.off(\"mousemove\", this.addMovePolygon)\r\n    this.map.off(\"dblclick\", this.stopAdd)\r\n  }\r\n\r\n  onCancel() {\r\n    this.clearListener()\r\n    this.popupList.forEach(item => {\r\n      item.remove()\r\n    })\r\n    this.vmList.forEach(item => {\r\n      item.$destroy();\r\n    })\r\n    this.lastPopup && this.lastPopup.remove()\r\n    this.map.getLayer(\"polygon\") && this.map.removeLayer(\"polygon\");\r\n    this.map.getLayer(\"polygon_cap\") && this.map.removeLayer(\"polygon_cap\");\r\n    this.map.getSource(\"polygon\") && this.map.removeSource(\"polygon\");\r\n  }\r\n}"],"mappings":"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"}]}