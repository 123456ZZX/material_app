{"remainingRequest":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\babel-loader\\lib\\index.js!D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\eslint-loader\\index.js??ref--14-0!D:\\Code\\Project\\WL\\xasw-mobile\\src\\components\\map\\utils\\distance\\distance.js","dependencies":[{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\src\\components\\map\\utils\\distance\\distance.js","mtime":1708928163328},{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\babel.config.js","mtime":1705912799600},{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9kZWZpbmVQcm9wZXJ0eSBmcm9tICJEOi9Db2RlL1Byb2plY3QvV0wveGFzdy1tb2JpbGUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2RlZmluZVByb3BlcnR5LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCBzd2FuVG9vbCBmcm9tICIuLi9zd2FuVG9vbCI7CmltcG9ydCBtYXBib3hnbCBmcm9tICdtYXBib3gtZ2wnOwppbXBvcnQgJ21hcGJveC1nbC9kaXN0L21hcGJveC1nbC5jc3MnOwppbXBvcnQgKiBhcyB0dXJmIGZyb20gJ0B0dXJmL3R1cmYnOwppbXBvcnQgcG9wdXAgZnJvbSAiLi4vY29tbW9uL3BvcHVwL3B1cG9wLnZ1ZSI7CmltcG9ydCBjbG9zZUJ1dHRvbiBmcm9tICIuLi9jb21tb24vcG9wdXAvY2xvc2VCdXR0b24iOwppbXBvcnQgVnVlIGZyb20gInZ1ZSI7CgovKioNCiAqIOi3neemu+a1i+mHjw0KICovCmV4cG9ydCBkZWZhdWx0IGNsYXNzIHN3YW5EaXN0YW5jZSBleHRlbmRzIHN3YW5Ub29sIHsKICBjb25zdHJ1Y3RvcihtYXApIHsKICAgIHN1cGVyKG1hcCk7CiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgImFkZExpbmUiLCBlID0+IHsKICAgICAgdGhpcy5zdGFydERyYXcgPSB0cnVlOwogICAgICB0aGlzLmxpbmVEYXRhWzBdLmdlb21ldHJ5LmNvb3JkaW5hdGVzWzBdLnB1c2goW2UubG5nTGF0LmxuZywgZS5sbmdMYXQubGF0XSk7CiAgICAgIGxldCBhcnIgPSB0aGlzLmxpbmVEYXRhWzBdLmdlb21ldHJ5LmNvb3JkaW5hdGVzWzBdOwogICAgICBpZiAoYXJyLmxlbmd0aCA+IDEpIHsKICAgICAgICBsZXQgZGlzdGFuY2UgPSB0aGlzLmdldERpc3RhbmNlKFthcnJbYXJyLmxlbmd0aCAtIDFdLCBhcnJbYXJyLmxlbmd0aCAtIDJdXSk7CiAgICAgICAgbGV0IGRpc3BsYXlUZXh0ID0gW3sKICAgICAgICAgIGtleTogIumVv+W6pjoiLAogICAgICAgICAgdmFsdWU6IGRpc3RhbmNlCiAgICAgICAgfV07CiAgICAgICAgbGV0IHBvcHVwViA9IFZ1ZS5leHRlbmQocG9wdXApOwogICAgICAgIGxldCBwb3B1cERvbSA9IG5ldyBwb3B1cFYoewogICAgICAgICAgcHJvcHNEYXRhOiB7CiAgICAgICAgICAgIGRpc3BsYXlUZXh0CiAgICAgICAgICB9CiAgICAgICAgfSkuJG1vdW50KCk7CiAgICAgICAgdGhpcy52bUxpc3QucHVzaChwb3B1cERvbSk7CiAgICAgICAgdGhpcy5wb3B1cExpc3QucHVzaChuZXcgbWFwYm94Z2wuUG9wdXAoewogICAgICAgICAgb2Zmc2V0OiB7CiAgICAgICAgICAgICd0b3AnOiBbMCwgMjJdCiAgICAgICAgICB9LAogICAgICAgICAgY2xvc2VCdXR0b246IGZhbHNlLAogICAgICAgICAgLy/lpoLmnpzkuLogdHJ1ZSDvvIzlvLnnqpflj7PkuIrop5LlsIblh7rnjrDlhbPpl63mjInpkq7jgIIKICAgICAgICAgIGNsb3NlT25DbGljazogZmFsc2UsCiAgICAgICAgICAvL+WmguaenOS4uiB0cnVlIO+8jOeCueWHu+WcsOWbvuaXtuW8ueeql+WwhuWFs+mXreOAggogICAgICAgICAgY2xhc3NOYW1lOiAnc3dhbi1wb3B1cCcKICAgICAgICB9KS5zZXRMbmdMYXQoZS5sbmdMYXQpLnNldERPTUNvbnRlbnQocG9wdXBEb20uJGVsKS5hZGRUbyh0aGlzLm1hcCkpOwogICAgICB9CiAgICAgIGxldCBnZW9qc29uID0gewogICAgICAgICJ0eXBlIjogIkZlYXR1cmVDb2xsZWN0aW9uIiwKICAgICAgICAiZmVhdHVyZXMiOiB0aGlzLmxpbmVEYXRhCiAgICAgIH07CiAgICAgIHRoaXMubWFwLmdldFNvdXJjZSgiZGlzdGFuY2UiKS5zZXREYXRhKGdlb2pzb24pOwogICAgfSk7CiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgImFkZE1vdmVMaW5lIiwgZSA9PiB7CiAgICAgIGlmICghdGhpcy5zdGFydERyYXcpIHJldHVybjsKICAgICAgdGhpcy5tb3ZlRGF0YSA9IFt7CiAgICAgICAgInR5cGUiOiAiRmVhdHVyZSIsCiAgICAgICAgImdlb21ldHJ5IjogewogICAgICAgICAgInR5cGUiOiAiTXVsdGlMaW5lU3RyaW5nIiwKICAgICAgICAgICJjb29yZGluYXRlcyI6IFtbXV0KICAgICAgICB9CiAgICAgIH1dOwogICAgICB0aGlzLm1vdmVEYXRhWzBdLmdlb21ldHJ5LmNvb3JkaW5hdGVzWzBdID0gWy4uLnRoaXMubGluZURhdGFbMF0uZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF0sIFtlLmxuZ0xhdC5sbmcsIGUubG5nTGF0LmxhdF1dOwogICAgICBsZXQgZ2VvanNvbiA9IHsKICAgICAgICAidHlwZSI6ICJGZWF0dXJlQ29sbGVjdGlvbiIsCiAgICAgICAgImZlYXR1cmVzIjogdGhpcy5tb3ZlRGF0YQogICAgICB9OwogICAgICB0aGlzLm1hcC5nZXRTb3VyY2UoImRpc3RhbmNlIikuc2V0RGF0YShnZW9qc29uKTsKICAgICAgdGhpcy5sYXN0UG9wdXAgJiYgdGhpcy5sYXN0UG9wdXAucmVtb3ZlKCk7CiAgICAgIGxldCBkaXN0YW5jZSA9IHRoaXMuZ2V0RGlzdGFuY2UodGhpcy5tb3ZlRGF0YVswXS5nZW9tZXRyeS5jb29yZGluYXRlc1swXSk7CiAgICAgIGxldCBkaXNwbGF5VGV4dCA9IFt7CiAgICAgICAga2V5OiAi5oC76ZW/5bqmOiIsCiAgICAgICAgdmFsdWU6IGRpc3RhbmNlCiAgICAgIH1dOwogICAgICBsZXQgcG9wdXBWID0gVnVlLmV4dGVuZChwb3B1cCk7CiAgICAgIGxldCBwb3B1cERvbSA9IG5ldyBwb3B1cFYoewogICAgICAgIHByb3BzRGF0YTogewogICAgICAgICAgZGlzcGxheVRleHQKICAgICAgICB9CiAgICAgIH0pLiRtb3VudCgpOwogICAgICB0aGlzLnZtTGlzdC5wdXNoKHBvcHVwRG9tKTsKICAgICAgdGhpcy5sYXN0UG9wdXAgPSBuZXcgbWFwYm94Z2wuUG9wdXAoewogICAgICAgIG9mZnNldDogewogICAgICAgICAgJ3RvcCc6IFswLCAyMl0KICAgICAgICB9LAogICAgICAgIGNsb3NlQnV0dG9uOiBmYWxzZSwKICAgICAgICAvL+WmguaenOS4uiB0cnVlIO+8jOW8ueeql+WPs+S4iuinkuWwhuWHuueOsOWFs+mXreaMiemSruOAggogICAgICAgIGNsb3NlT25DbGljazogZmFsc2UsCiAgICAgICAgLy/lpoLmnpzkuLogdHJ1ZSDvvIzngrnlh7vlnLDlm77ml7blvLnnqpflsIblhbPpl63jgIIKICAgICAgICBjbGFzc05hbWU6ICdzd2FuLXBvcHVwJwogICAgICB9KS5zZXRMbmdMYXQoZS5sbmdMYXQpLnNldERPTUNvbnRlbnQocG9wdXBEb20uJGVsKS5hZGRUbyh0aGlzLm1hcCk7CiAgICB9KTsKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAic3RvcEFkZCIsICgpID0+IHsKICAgICAgaWYgKCF0aGlzLnN0YXJ0RHJhdykgcmV0dXJuOwogICAgICB0aGlzLmNsZWFyTGlzdGVuZXIoKTsKICAgICAgaWYgKHRoaXMubW92ZURhdGFbMF0uZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF0ubGVuZ3RoIC0gMSA9PSB0aGlzLnBvcHVwTGlzdC5sZW5ndGgpIHsKICAgICAgICB0aGlzLnBvcHVwTGlzdFt0aGlzLnBvcHVwTGlzdC5sZW5ndGggLSAxXS5yZW1vdmUoKTsKICAgICAgfQogICAgICAvLyBjbG9zZUJ1dHRvbgogICAgICAvL+a3u+WKoOWFs+mXreaMiemSrgogICAgICBsZXQgcG9wdXBDbG9zZSA9IFZ1ZS5leHRlbmQoY2xvc2VCdXR0b24pOwogICAgICBsZXQgcG9wdXBDbG9zZURvbSA9IG5ldyBwb3B1cENsb3NlKHt9KS4kbW91bnQoKTsKICAgICAgcG9wdXBDbG9zZURvbS4kb24oImNsb3NlIiwgKCkgPT4gewogICAgICAgIHRoaXMub25DYW5jZWwoKTsKICAgICAgfSk7CiAgICAgIHRoaXMudm1MaXN0LnB1c2gocG9wdXBDbG9zZURvbSk7CiAgICAgIGxldCBnZW9tID0gdGhpcy5tb3ZlRGF0YVswXS5nZW9tZXRyeS5jb29yZGluYXRlc1swXTsKICAgICAgdGhpcy5wb3B1cExpc3QucHVzaChuZXcgbWFwYm94Z2wuUG9wdXAoewogICAgICAgIG9mZnNldDogewogICAgICAgICAgJ2JvdHRvbSc6IFswLCA0MF0KICAgICAgICB9LAogICAgICAgIGNsb3NlQnV0dG9uOiBmYWxzZSwKICAgICAgICAvL+WmguaenOS4uiB0cnVlIO+8jOW8ueeql+WPs+S4iuinkuWwhuWHuueOsOWFs+mXreaMiemSruOAggogICAgICAgIGNsb3NlT25DbGljazogZmFsc2UsCiAgICAgICAgLy/lpoLmnpzkuLogdHJ1ZSDvvIzngrnlh7vlnLDlm77ml7blvLnnqpflsIblhbPpl63jgIIKICAgICAgICBjbGFzc05hbWU6ICdzd2FuLXBvcHVwLWNsb3NlJwogICAgICB9KS5zZXRMbmdMYXQoZ2VvbVtnZW9tLmxlbmd0aCAtIDFdKS5zZXRET01Db250ZW50KHBvcHVwQ2xvc2VEb20uJGVsKS5hZGRUbyh0aGlzLm1hcCkpOwogICAgfSk7CiAgICB0aGlzLmxpbmVEYXRhID0gW107CiAgICB0aGlzLm1vdmVEYXRhID0gW107CiAgICB0aGlzLnN0YXJ0RHJhdyA9IGZhbHNlOwogICAgdGhpcy5wb3B1cExpc3QgPSBbXTsKICAgIHRoaXMudm1MaXN0ID0gW107CiAgICB0aGlzLmxhc3RQb3B1cCA9IG51bGw7CiAgfQogIG9uQWRkKCkgewogICAgdGhpcy5pbml0TWVhc3VyZSgpOwogICAgdGhpcy5tYXAub24oImNsaWNrIiwgdGhpcy5hZGRMaW5lKTsKICAgIHRoaXMubWFwLm9uKCJtb3VzZW1vdmUiLCB0aGlzLmFkZE1vdmVMaW5lKTsKICAgIHRoaXMubWFwLm9uKCJkYmxjbGljayIsIHRoaXMuc3RvcEFkZCk7CiAgfQogIGluaXRNZWFzdXJlKCkgewogICAgdGhpcy5wb3B1cExpc3QuZm9yRWFjaChpdGVtID0+IHsKICAgICAgaXRlbS5yZW1vdmUoKTsKICAgIH0pOwogICAgdGhpcy5sYXN0UG9wdXAgJiYgdGhpcy5sYXN0UG9wdXAucmVtb3ZlKCk7CiAgICB0aGlzLmxpbmVEYXRhID0gW3sKICAgICAgInR5cGUiOiAiRmVhdHVyZSIsCiAgICAgICJnZW9tZXRyeSI6IHsKICAgICAgICAidHlwZSI6ICJNdWx0aUxpbmVTdHJpbmciLAogICAgICAgICJjb29yZGluYXRlcyI6IFtbXV0KICAgICAgfQogICAgfV07CiAgICB0aGlzLm1hcC5nZXRDYW52YXMoKS5zdHlsZS5jdXJzb3IgPSAiY3Jvc3NoYWlyIjsKICAgICF0aGlzLm1hcC5nZXRTb3VyY2UoImRpc3RhbmNlIikgJiYgdGhpcy5tYXAuYWRkU291cmNlKCJkaXN0YW5jZSIsIHsKICAgICAgInR5cGUiOiAiZ2VvanNvbiIsCiAgICAgICJkYXRhIjogewogICAgICAgICJ0eXBlIjogIkZlYXR1cmVDb2xsZWN0aW9uIiwKICAgICAgICAiZmVhdHVyZXMiOiBbXQogICAgICB9CiAgICB9KTsKICAgICF0aGlzLm1hcC5nZXRMYXllcigiZGlzdGFuY2UiKSAmJiB0aGlzLm1hcC5hZGRMYXllcih7CiAgICAgICJpZCI6ICJkaXN0YW5jZSIsCiAgICAgICJzb3VyY2UiOiAiZGlzdGFuY2UiLAogICAgICAidHlwZSI6ICJsaW5lIiwKICAgICAgInBhaW50IjogewogICAgICAgIC8vIOe7mOWItuexu+WxnuaApwogICAgICAgICJsaW5lLW9wYWNpdHkiOiAxLAogICAgICAgIC8vIOe6v+eahOS4jemAj+aYjuW6pu+8iOWPr+mAie+8jOWPluWAvOiMg+WbtOS4uiAwIH4gMe+8jOm7mOiupOWAvOS4uiAx77yJCiAgICAgICAgImxpbmUtY29sb3IiOiAiIzA2Q0VBRSIsCiAgICAgICAgLy8g57q/55qE6aKc6Imy77yI5Y+v6YCJ77yM6buY6K6k5YC85Li6ICMwMDAwMDDjgILlpoLmnpzorr7nva7kuoYgbGluZS1wYXR0ZXJu77yM5YiZIGxpbmUtY29sb3Ig5bCG5peg5pWI77yJCiAgICAgICAgImxpbmUtd2lkdGgiOiAyIC8vIOe6v+eahOWuveW6pu+8iOWPr+mAie+8jOWAvCA+PSAw77yM6buY6K6k5YC85Li6IDHvvIzljZXkvY3vvJrlg4/ntKDvvIkKICAgICAgfQogICAgfSk7CiAgICAhdGhpcy5tYXAuZ2V0TGF5ZXIoImRpc3RhbmNlX2NhcCIpICYmIHRoaXMubWFwLmFkZExheWVyKHsKICAgICAgImlkIjogImRpc3RhbmNlX2NhcCIsCiAgICAgICJzb3VyY2UiOiAiZGlzdGFuY2UiLAogICAgICAidHlwZSI6ICJjaXJjbGUiLAogICAgICAicGFpbnQiOiB7CiAgICAgICAgLy8g57uY5Yi257G75bGe5oCnCiAgICAgICAgImNpcmNsZS1vcGFjaXR5IjogMSwKICAgICAgICAvLyDlnIbngrnnmoTkuI3pgI/mmI7luqbvvIjlj6/pgInvvIzlj5blgLzojIPlm7TkuLogMCB+IDHvvIzpu5jorqTlgLzkuLogMe+8iQogICAgICAgICJjaXJjbGUtcmFkaXVzIjogNiwKICAgICAgICAvLyDlnIbngrnnmoTljYrlvoTvvIjlj6/pgInvvIzlgLwgPj0gMO+8jOm7mOiupOWAvOS4uiA177yM5Y2V5L2N77ya5YOP57Sg77yJCiAgICAgICAgImNpcmNsZS1jb2xvciI6ICIjRkZGRjAwIiAvLyDlnIbngrnnmoTpopzoibLvvIjlj6/pgInvvIzpu5jorqTlgLzkuLogIzAwMDAwMO+8iQogICAgICB9CiAgICB9KTsKICB9CiAgZ2V0RGlzdGFuY2UobGluZUxpc3QpIHsKICAgIGxldCBsaW5lID0gdHVyZi5saW5lU3RyaW5nKGxpbmVMaXN0KTsKICAgIGxldCBsZW5ndGggPSB0dXJmLmxlbmd0aChsaW5lLCB7CiAgICAgIHVuaXRzOiAna2lsb21ldGVycycKICAgIH0pOwogICAgaWYgKGxlbmd0aCA8IDEpIHsKICAgICAgcmV0dXJuIGAkeyhsZW5ndGggKiAxMDAwKS50b0ZpeGVkKDEpfU1gOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIGAke2xlbmd0aC50b0ZpeGVkKDIpfUtNYDsKICAgIH0KICB9CiAgY2xlYXJMaXN0ZW5lcigpIHsKICAgIHRoaXMuc3RhcnREcmF3ID0gZmFsc2U7CiAgICB0aGlzLm1hcC5nZXRDYW52YXMoKS5zdHlsZS5jdXJzb3IgPSAiIjsKICAgIHRoaXMubWFwLm9mZigiY2xpY2siLCB0aGlzLmFkZExpbmUpOwogICAgdGhpcy5tYXAub2ZmKCJtb3VzZW1vdmUiLCB0aGlzLmFkZExhc3RQb2ludCk7CiAgICB0aGlzLm1hcC5vZmYoImRibGNsaWNrIiwgdGhpcy5zdG9wQWRkKTsKICB9CiAgb25DYW5jZWwoKSB7CiAgICB0aGlzLmNsZWFyTGlzdGVuZXIoKTsKICAgIHRoaXMucG9wdXBMaXN0LmZvckVhY2goaXRlbSA9PiB7CiAgICAgIGl0ZW0ucmVtb3ZlKCk7CiAgICB9KTsKICAgIHRoaXMudm1MaXN0LmZvckVhY2goaXRlbSA9PiB7CiAgICAgIGl0ZW0uJGRlc3Ryb3koKTsKICAgIH0pOwogICAgdGhpcy5sYXN0UG9wdXAgJiYgdGhpcy5sYXN0UG9wdXAucmVtb3ZlKCk7CiAgICB0aGlzLm1hcC5nZXRMYXllcigiZGlzdGFuY2UiKSAmJiB0aGlzLm1hcC5yZW1vdmVMYXllcigiZGlzdGFuY2UiKTsKICAgIHRoaXMubWFwLmdldExheWVyKCJkaXN0YW5jZV9jYXAiKSAmJiB0aGlzLm1hcC5yZW1vdmVMYXllcigiZGlzdGFuY2VfY2FwIik7CiAgICB0aGlzLm1hcC5nZXRTb3VyY2UoImRpc3RhbmNlIikgJiYgdGhpcy5tYXAucmVtb3ZlU291cmNlKCJkaXN0YW5jZSIpOwogIH0KfQ=="},{"version":3,"names":["swanTool","mapboxgl","turf","popup","closeButton","Vue","swanDistance","constructor","map","_defineProperty","e","startDraw","lineData","geometry","coordinates","push","lngLat","lng","lat","arr","length","distance","getDistance","displayText","key","value","popupV","extend","popupDom","propsData","$mount","vmList","popupList","Popup","offset","closeOnClick","className","setLngLat","setDOMContent","$el","addTo","geojson","getSource","setData","moveData","lastPopup","remove","clearListener","popupClose","popupCloseDom","$on","onCancel","geom","onAdd","initMeasure","on","addLine","addMoveLine","stopAdd","forEach","item","getCanvas","style","cursor","addSource","getLayer","addLayer","lineList","line","lineString","units","toFixed","off","addLastPoint","$destroy","removeLayer","removeSource"],"sources":["D:/Code/Project/WL/xasw-mobile/src/components/map/utils/distance/distance.js"],"sourcesContent":["import swanTool from \"../swanTool\";\r\nimport mapboxgl from 'mapbox-gl';\r\nimport 'mapbox-gl/dist/mapbox-gl.css';\r\nimport * as turf from '@turf/turf';\r\nimport popup from \"../common/popup/pupop.vue\";\r\nimport closeButton from \"../common/popup/closeButton\";\r\nimport Vue from \"vue\";\r\n\r\n/**\r\n * 距离测量\r\n */\r\nexport default class swanDistance extends swanTool {\r\n  constructor(map) {\r\n    super(map);\r\n    this.lineData = [];\r\n    this.moveData = [];\r\n    this.startDraw = false;\r\n    this.popupList = [];\r\n    this.vmList = [];\r\n    this.lastPopup = null;\r\n  }\r\n\r\n  onAdd() {\r\n    this.initMeasure();\r\n    this.map.on(\"click\", this.addLine)\r\n    this.map.on(\"mousemove\", this.addMoveLine)\r\n    this.map.on(\"dblclick\", this.stopAdd)\r\n  }\r\n\r\n  initMeasure() {\r\n    this.popupList.forEach(item => {\r\n      item.remove()\r\n    })\r\n    this.lastPopup && this.lastPopup.remove()\r\n    this.lineData = [{\r\n      \"type\": \"Feature\",\r\n      \"geometry\": {\r\n        \"type\": \"MultiLineString\",\r\n        \"coordinates\": [[]]\r\n      }\r\n    }]\r\n    this.map.getCanvas().style.cursor = \"crosshair\";\r\n    !this.map.getSource(\"distance\") && this.map.addSource(\"distance\", {\r\n      \"type\": \"geojson\",\r\n      \"data\": {\r\n        \"type\": \"FeatureCollection\",\r\n        \"features\": []\r\n      },\r\n    })\r\n    !this.map.getLayer(\"distance\") && this.map.addLayer({\r\n      \"id\": \"distance\",\r\n      \"source\": \"distance\",\r\n      \"type\": \"line\",\r\n      \"paint\": { // 绘制类属性\r\n        \"line-opacity\": 1, // 线的不透明度（可选，取值范围为 0 ~ 1，默认值为 1）\r\n        \"line-color\": \"#06CEAE\", // 线的颜色（可选，默认值为 #000000。如果设置了 line-pattern，则 line-color 将无效）\r\n        \"line-width\": 2, // 线的宽度（可选，值 >= 0，默认值为 1，单位：像素）\r\n      }\r\n    })\r\n    !this.map.getLayer(\"distance_cap\") && this.map.addLayer({\r\n      \"id\": \"distance_cap\",\r\n      \"source\": \"distance\",\r\n      \"type\": \"circle\",\r\n      \"paint\": { // 绘制类属性\r\n        \"circle-opacity\": 1, // 圆点的不透明度（可选，取值范围为 0 ~ 1，默认值为 1）\r\n        \"circle-radius\": 6, // 圆点的半径（可选，值 >= 0，默认值为 5，单位：像素）\r\n        \"circle-color\": \"#FFFF00\", // 圆点的颜色（可选，默认值为 #000000）\r\n      }\r\n    })\r\n  }\r\n\r\n  addLine = (e) => {\r\n    this.startDraw = true\r\n    this.lineData[0].geometry.coordinates[0].push([e.lngLat.lng, e.lngLat.lat]);\r\n    let arr = this.lineData[0].geometry.coordinates[0]\r\n    if (arr.length > 1) {\r\n      let distance = this.getDistance([arr[arr.length - 1], arr[arr.length - 2]])\r\n      let displayText = [{\r\n        key: \"长度:\",\r\n        value: distance\r\n      }]\r\n      let popupV = Vue.extend(popup);\r\n      let popupDom = new popupV({\r\n        propsData: { displayText }\r\n      }).$mount();\r\n      this.vmList.push(popupDom);\r\n      this.popupList.push(\r\n        new mapboxgl.Popup({\r\n          offset: {\r\n            'top': [0, 22],\r\n          },\r\n          closeButton: false,//如果为 true ，弹窗右上角将出现关闭按钮。\r\n          closeOnClick: false, //如果为 true ，点击地图时弹窗将关闭。\r\n          className: 'swan-popup'\r\n        })\r\n          .setLngLat(e.lngLat)\r\n          .setDOMContent(popupDom.$el)\r\n          .addTo(this.map)\r\n      )\r\n    }\r\n    let geojson = {\r\n      \"type\": \"FeatureCollection\",\r\n      \"features\": this.lineData\r\n    };\r\n    this.map.getSource(\"distance\").setData(geojson);\r\n  }\r\n\r\n  addMoveLine = (e) => {\r\n    if (!this.startDraw)\r\n      return\r\n    this.moveData = [{\r\n      \"type\": \"Feature\",\r\n      \"geometry\": {\r\n        \"type\": \"MultiLineString\",\r\n        \"coordinates\": [[]]\r\n      }\r\n    }]\r\n    this.moveData[0].geometry.coordinates[0] = [\r\n      ...this.lineData[0].geometry.coordinates[0],\r\n      [e.lngLat.lng, e.lngLat.lat]\r\n    ]\r\n    let geojson = {\r\n      \"type\": \"FeatureCollection\",\r\n      \"features\": this.moveData\r\n    };\r\n    this.map.getSource(\"distance\").setData(geojson);\r\n\r\n    this.lastPopup && this.lastPopup.remove()\r\n    let distance = this.getDistance(this.moveData[0].geometry.coordinates[0])\r\n    let displayText = [{\r\n      key: \"总长度:\",\r\n      value: distance\r\n    }]\r\n    let popupV = Vue.extend(popup);\r\n    let popupDom = new popupV({\r\n      propsData: { displayText }\r\n    }).$mount();\r\n    this.vmList.push(popupDom);\r\n    this.lastPopup = new mapboxgl.Popup({\r\n      offset: {\r\n        'top': [0, 22],\r\n      },\r\n      closeButton: false,//如果为 true ，弹窗右上角将出现关闭按钮。\r\n      closeOnClick: false, //如果为 true ，点击地图时弹窗将关闭。\r\n      className: 'swan-popup'\r\n    })\r\n      .setLngLat(e.lngLat)\r\n      .setDOMContent(popupDom.$el)\r\n      .addTo(this.map)\r\n  }\r\n\r\n  getDistance(lineList) {\r\n    let line = turf.lineString(lineList);\r\n    let length = turf.length(line, { units: 'kilometers' });\r\n    if (length < 1) {\r\n      return `${(length * 1000).toFixed(1)}M`\r\n    } else {\r\n      return `${length.toFixed(2)}KM`\r\n    }\r\n  }\r\n\r\n  stopAdd = () => {\r\n    if (!this.startDraw)\r\n      return\r\n    this.clearListener()\r\n    if (this.moveData[0].geometry.coordinates[0].length - 1 == this.popupList.length) {\r\n      this.popupList[this.popupList.length - 1].remove()\r\n    }\r\n    // closeButton\r\n    //添加关闭按钮\r\n    let popupClose = Vue.extend(closeButton);\r\n    let popupCloseDom = new popupClose({}).$mount();\r\n    popupCloseDom.$on(\"close\", () => {\r\n      this.onCancel();\r\n    })\r\n    this.vmList.push(popupCloseDom);\r\n    let geom = this.moveData[0].geometry.coordinates[0]\r\n    this.popupList.push(\r\n      new mapboxgl.Popup({\r\n        offset: {\r\n          'bottom': [0, 40],\r\n        },\r\n        closeButton: false,//如果为 true ，弹窗右上角将出现关闭按钮。\r\n        closeOnClick: false, //如果为 true ，点击地图时弹窗将关闭。\r\n        className: 'swan-popup-close'\r\n      })\r\n        .setLngLat(geom[geom.length - 1])\r\n        .setDOMContent(popupCloseDom.$el)\r\n        .addTo(this.map)\r\n    )\r\n  }\r\n\r\n  clearListener() {\r\n    this.startDraw = false\r\n    this.map.getCanvas().style.cursor = \"\";\r\n    this.map.off(\"click\", this.addLine)\r\n    this.map.off(\"mousemove\", this.addLastPoint)\r\n    this.map.off(\"dblclick\", this.stopAdd)\r\n  }\r\n\r\n  onCancel() {\r\n    this.clearListener()\r\n    this.popupList.forEach(item => {\r\n      item.remove()\r\n    })\r\n    this.vmList.forEach(item => {\r\n      item.$destroy();\r\n    })\r\n    this.lastPopup && this.lastPopup.remove()\r\n    this.map.getLayer(\"distance\") && this.map.removeLayer(\"distance\");\r\n    this.map.getLayer(\"distance_cap\") && this.map.removeLayer(\"distance_cap\");\r\n    this.map.getSource(\"distance\") && this.map.removeSource(\"distance\");\r\n  }\r\n}"],"mappings":"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"}]}