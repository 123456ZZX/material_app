{"remainingRequest":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\babel-loader\\lib\\index.js!D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Code\\Project\\WL\\xasw-mobile\\src\\views\\PumpStationInspection\\components\\InspectionSubmit.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\src\\views\\PumpStationInspection\\components\\InspectionSubmit.vue","mtime":1708928163414},{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\babel.config.js","mtime":1705912799600},{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCBJbnNwZWN0aW9uU3VibWl0Q2FyZCBmcm9tICcuL0luc3BlY3Rpb25TdWJtaXRDYXJkLnZ1ZSc7CmltcG9ydCB7IHBhdHJvbEVkaXQsIHVwbG9hZFRyYWNrTGlzdCB9IGZyb20gJy4uL2FwaSc7CmV4cG9ydCBkZWZhdWx0IHsKICBjb21wb25lbnRzOiB7CiAgICBJbnNwZWN0aW9uU3VibWl0Q2FyZAogIH0sCiAgcHJvcHM6IHsKICAgIC8v5beh5qOA54q25oCBKDE65b6F5beh5qOA77yMMjrlt6Hmo4DkuK3vvIwzOuW3suWujOaIkCDvvIw0OuW3sue7iOatoiko5omL5py656uvKQogICAgUGF0cm9sRGF0YTogewogICAgICB0eXBlOiBPYmplY3QsCiAgICAgIGRlZmF1bHQ6ICgpID0+IHt9CiAgICB9LAogICAgbW9kZWxUeXBlOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXVsdDogJ2xpc3QnCiAgICB9CiAgfSwKICB3YXRjaDogewogICAgUGF0cm9sRGF0YTogewogICAgICBoYW5kbGVyOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgdGhpcy5pc0ZpbmlzaENvbmZpZygpOwogICAgICB9LAogICAgICBkZWVwOiB0cnVlLAogICAgICBpbW1lZGlhdGU6IHRydWUKICAgIH0KICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBzdWJtaXREYXRhOiBudWxsLAogICAgICBmaXJzdENvbmZpZzogdHJ1ZSwKICAgICAgLy/mmK/lkKbkuLrnrKzkuIDmrKHov5vlhaUKICAgICAgZmluaXNoQ29uZmlnOiBmYWxzZSwKICAgICAgLy/lt6Hmo4DngrnmmK/lkKblt6Hmo4Dlrozmr5UKICAgICAgc3VibWl0U2hvdzogZmFsc2UsCiAgICAgIC8v5o+Q5Lqk5by55qGGCiAgICAgIGRpc2FibGVkOiB0cnVlCiAgICB9OwogIH0sCiAgbW91bnRlZCgpIHsKICAgIHRoaXMuc2V0Rmlyc3RDb25maWcoKTsKICB9LAogIGJlZm9yZURlc3Ryb3koKSB7CiAgICB0aGlzLnN0b3BSZXF1ZXN0TG9jYXRpb25zKCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICAvL+WGheWuueWPmOWMlgogICAgLy9saXN05YiX6KGo77yMbWFw5Zyw5Zu+CiAgICBtb2RlbFR5cGVDaGFuZ2UodHlwZSkgewogICAgICBpZiAodGhpcy5maXJzdENvbmZpZyAmJiB0aGlzLlBhdHJvbERhdGEucGF0cm9sU3RhdHVzID09PSAyKSByZXR1cm47CiAgICAgIHRoaXMuJGVtaXQoJ21vZGVsVHlwZUNoYW5nZScsIHR5cGUpOwogICAgICB0aGlzLnN0b3BSZXF1ZXN0TG9jYXRpb25zKCk7CiAgICAgIGlmICh0eXBlID09PSAnbGlzdCcpIHRoaXMucmVxdWVzdFNpbmdsZUxvY2F0aW9uKGZhbHNlKTsKICAgIH0sCiAgICAvL+WIpOaWreaYr+WQpuS4uuesrOS4gOasoei/m+WFpQogICAgc2V0Rmlyc3RDb25maWcoKSB7CiAgICAgIGxldCB7CiAgICAgICAgZmlyc3RDb25maWcKICAgICAgfSA9IHRoaXMuJHN0b3JlLnN0YXRlLnB1bXAudXJsUXVlcnk7CiAgICAgIGlmIChmaXJzdENvbmZpZyA9PT0gZmFsc2UpIHsKICAgICAgICB0aGlzLmZpcnN0Q29uZmlnID0gZmFsc2U7CiAgICAgICAgdGhpcy4kZW1pdCgnaXNEaXNhYmxlZCcsIGZhbHNlKTsKICAgICAgICBjb25zb2xlLmxvZygnaXNEaXNhYmxlZCcsIGZhbHNlKTsKICAgICAgICB0aGlzLnJlcXVlc3RTaW5nbGVMb2NhdGlvbih0aGlzLmZpcnN0Q29uZmlnKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmZpcnN0Q29uZmlnID0gdHJ1ZTsKICAgICAgfQogICAgfSwKICAgIC8v5beh5qOA54K55piv5ZCm5beh5qOA5a6M5q+VCiAgICBpc0ZpbmlzaENvbmZpZygpIHsKICAgICAgdmFyIF90aGlzJFBhdHJvbERhdGE7CiAgICAgIGxldCBjb25maWcgPSAoX3RoaXMkUGF0cm9sRGF0YSA9IHRoaXMuUGF0cm9sRGF0YSkgPT09IG51bGwgfHwgX3RoaXMkUGF0cm9sRGF0YSA9PT0gdm9pZCAwIHx8IChfdGhpcyRQYXRyb2xEYXRhID0gX3RoaXMkUGF0cm9sRGF0YS5wYXRyb2xQb2ludFJlc3VsdExpc3QpID09PSBudWxsIHx8IF90aGlzJFBhdHJvbERhdGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJFBhdHJvbERhdGEuZXZlcnkoaXRlbSA9PiB7CiAgICAgICAgcmV0dXJuIGl0ZW0ucGF0cm9sU3RhdHVzID09PSAn5bey5behJzsKICAgICAgfSk7CiAgICAgIHRoaXMuZmluaXNoQ29uZmlnID0gY29uZmlnOwogICAgfSwKICAgIC8v57un57ut5beh5qOACiAgICBnb0luc3BlY3Rpb24oKSB7CiAgICAgIHRoaXMuZmlyc3RDb25maWcgPSBmYWxzZTsKICAgICAgdGhpcy4kZW1pdCgnaXNEaXNhYmxlZCcsIGZhbHNlKTsKICAgICAgdGhpcy5yZXF1ZXN0U2luZ2xlTG9jYXRpb24odHJ1ZSk7CiAgICB9LAogICAgLy/lvIDlp4vlt6Hmo4AKICAgIGFzeW5jIHN0YXJ0SW5zcGVjdGlvbih0eXBlKSB7CiAgICAgIGxldCBxdWVyeSA9IHsKICAgICAgICBpZDogdGhpcy4kc3RvcmUuc3RhdGUucHVtcC51cmxRdWVyeS50YXNrSWQsCiAgICAgICAgcGF0cm9sU3RhdHVzOiB0eXBlID8gdHlwZSA6IHRoaXMuUGF0cm9sRGF0YSAmJiB0aGlzLlBhdHJvbERhdGEucGF0cm9sU3RhdHVzLAogICAgICAgIHBhdHJvbFN0YXJ0VGltZTogdGhpcy4kZGF5anMoKS5mb3JtYXQoJ1lZWVktTU0tREQgSEg6bW06c3MnKSwKICAgICAgICBwYXRyb2xQb2ludFJlc3VsdExpc3Q6IHRoaXMuUGF0cm9sRGF0YSAmJiB0aGlzLlBhdHJvbERhdGEucGF0cm9sUG9pbnRSZXN1bHRMaXN0CiAgICAgIH07CiAgICAgIHRoaXMuJGVtaXQoJ2lzRGlzYWJsZWQnLCBmYWxzZSk7CiAgICAgIHRoaXMucmVxdWVzdFNpbmdsZUxvY2F0aW9uKHRydWUpOwogICAgICBjb25zdCByZXMgPSBhd2FpdCBwYXRyb2xFZGl0KHF1ZXJ5KTsKICAgICAgdGhpcy4kcGFyZW50LmdldFBhdHJvbCgpOwogICAgICB0aGlzLmZpcnN0Q29uZmlnID0gZmFsc2U7CiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICBwYXRoOiAnL3B1bXAvaW5zcGVjdGlvbicsCiAgICAgICAgcXVlcnk6IHsKICAgICAgICAgIHRhc2tJZDogdGhpcy4kc3RvcmUuc3RhdGUucHVtcC51cmxRdWVyeS50YXNrSWQsCiAgICAgICAgICBmaXJzdENvbmZpZzogJ2ZhbHNlJwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgLy/mmoLlgZzlt6Hmo4AKICAgIHN0b3BJbnNwZWN0aW9uKCkgewogICAgICB0aGlzLiRkaWFsb2cuY29uZmlybSh7CiAgICAgICAgdGl0bGU6ICfmmoLlgZzlt6Hmo4AnLAogICAgICAgIG1lc3NhZ2U6ICfmmoLlgZzlt6Hmo4DlsIbmj5DkuqTmnKrmj5DkuqTnmoTlt6Hmo4DngrnlkozpmpDmgqPmlbDmja7vvIEnCiAgICAgIH0pLnRoZW4oYXN5bmMgKCkgPT4gewogICAgICAgIGF3YWl0IHRoaXMuaXNVbnN1Ym1pdHRlZCgpOwogICAgICAgIHRoaXMuJHJvdXRlci5yZXBsYWNlKCcvcHVtcC9pbnNwZWN0aW9uTWFuYWdlJyk7CiAgICAgIH0pLmNhdGNoKGVycm9yID0+IHsKICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7CiAgICAgIH0pOwogICAgfSwKICAgIC8v57uI5q2i5beh5qOACiAgICBhc3luYyB0ZXJtaW5hdGVkSW5zcGVjdGlvbigpIHsKICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdzZXRVcmxRdWVyeScsIHsKICAgICAgICB0YXNrSWQ6IHRoaXMuJHN0b3JlLnN0YXRlLnB1bXAudXJsUXVlcnkudGFza0lkCiAgICAgIH0pOwogICAgICB0aGlzLiRyb3V0ZXIucHVzaChgL3B1bXAvdGVybWluYXRlZC10YXNrYCk7CiAgICB9LAogICAgLy/mo4Dmn6XmmK/lkKbmnInmnKrmj5DkuqTpobks5bm25o+Q5LqkCiAgICBhc3luYyBpc1Vuc3VibWl0dGVkKCkgewogICAgICB2YXIgX3RoaXMkc3VibWl0RGF0YSRwYXRyOwogICAgICB0aGlzLnN1Ym1pdERhdGEgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuUGF0cm9sRGF0YSkpOwogICAgICBsZXQgc3RvcmFnZUl0ZW1EYXRhTGlzdCA9IEpTT04ucGFyc2UodGhpcy4kc3RvcmFnZS5nZXQoJ3B1bXAtc3RvcmFnZUl0ZW1EYXRhTGlzdCcpKTsKICAgICAgKF90aGlzJHN1Ym1pdERhdGEkcGF0ciA9IHRoaXMuc3VibWl0RGF0YS5wYXRyb2xQb2ludFJlc3VsdExpc3QpID09PSBudWxsIHx8IF90aGlzJHN1Ym1pdERhdGEkcGF0ciA9PT0gdm9pZCAwIHx8IF90aGlzJHN1Ym1pdERhdGEkcGF0ci5mb3JFYWNoKChpdGVtLCBpbmRleCkgPT4gewogICAgICAgIHN0b3JhZ2VJdGVtRGF0YUxpc3QgPT09IG51bGwgfHwgc3RvcmFnZUl0ZW1EYXRhTGlzdCA9PT0gdm9pZCAwIHx8IHN0b3JhZ2VJdGVtRGF0YUxpc3QuZm9yRWFjaCgoZGF0YSwgaSkgPT4gewogICAgICAgICAgaXRlbS5pZCA9PT0gZGF0YS5pZCA/IHRoaXMuc3VibWl0RGF0YS5wYXRyb2xQb2ludFJlc3VsdExpc3RbaW5kZXhdID0gc3RvcmFnZUl0ZW1EYXRhTGlzdFtpXSA6IG51bGw7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgICB0aGlzLiRzdG9yYWdlLnJlbW92ZSgncHVtcC1zdG9yYWdlSXRlbURhdGFMaXN0Jyk7CiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBhdHJvbEVkaXQodGhpcy5zdWJtaXREYXRhKTsKICAgIH0sCiAgICAvL+W8gOWni+W3oeajgAogICAgcmVxdWVzdFNpbmdsZUxvY2F0aW9uKGlzRmlyc3QpIHsKICAgICAgY29uc29sZS5sb2coaXNGaXJzdCwgJ+iusOW9leW3oeajgCcpOwogICAgICBpZiAodHlwZW9mIHl1YW5jaHUgIT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICB5dWFuY2h1LmxvY2F0aW9uQU1hcC5yZXF1ZXN0U2luZ2xlTG9jYXRpb24oWycxJ10sIHJlcyA9PiB7CiAgICAgICAgICBsZXQgewogICAgICAgICAgICBsYXRpdHVkZSwKICAgICAgICAgICAgbG9uZ2l0dWRlCiAgICAgICAgICB9ID0gcmVzOwogICAgICAgICAgbGV0IHBhdGg7CiAgICAgICAgICBpZiAoaXNGaXJzdCkgewogICAgICAgICAgICBwYXRoID0gdGhpcy5QYXRyb2xEYXRhICYmIHRoaXMuUGF0cm9sRGF0YS5wYXRyb2xQb2ludFRyYWNrTGlzdCA/IHRoaXMuUGF0cm9sRGF0YS5wYXRyb2xQb2ludFRyYWNrTGlzdCA6IFtdOwogICAgICAgICAgICBjb25zb2xlLmxvZyhwYXRoKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHBhdGggPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuJHN0b3JlLnN0YXRlLnB1bXAucHVtcFBhdGgpKTsKICAgICAgICAgIH0KICAgICAgICAgIHBhdGgucHVzaCh7CiAgICAgICAgICAgIGxhdDogbGF0aXR1ZGUsCiAgICAgICAgICAgIGxvbjogbG9uZ2l0dWRlCiAgICAgICAgICB9KTsKICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0UHVtcFBhdGgnLCBwYXRoKTsKICAgICAgICAgIGNvbnNvbGUubG9nKHRoaXMuJHN0b3JlLnN0YXRlLnB1bXAucHVtcFBhdGgpOwogICAgICAgIH0sIGVyciA9PiB7CiAgICAgICAgICBjb25zb2xlLmxvZygnZXJyPScsIGVycik7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICAvL+e7k+adn+WumuS9jQogICAgc3RvcFJlcXVlc3RMb2NhdGlvbnMoKSB7CiAgICAgIGNvbnNvbGUubG9nKCfnu5PmnZ/lt6Hmo4AnKTsKICAgICAgaWYgKHR5cGVvZiB5dWFuY2h1ICE9ICd1bmRlZmluZWQnKSB7CiAgICAgICAgeXVhbmNodS5sb2NhdGlvbkFNYXAuc3RvcFJlcXVlc3RMb2NhdGlvbnMoKTsKICAgICAgfQogICAgfSwKICAgIC8v5a6M5oiQ5beh5qOA5o+Q5LqkCiAgICBhc3luYyBzdWJtaXQodHlwZSkgewogICAgICB0aGlzLnN1Ym1pdERhdGEgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuUGF0cm9sRGF0YSkpOwogICAgICB0aGlzLnN1Ym1pdERhdGEucGF0cm9sU3RhdHVzID0gdHlwZTsKICAgICAgdGhpcy5zdWJtaXREYXRhLnBhdHJvbEVuZFRpbWUgPSB0aGlzLiRkYXlqcygpLmZvcm1hdCgnWVlZWS1NTS1ERCBISDptbTpzcycpOwogICAgICB0aGlzLnN1Ym1pdERhdGEuc3VibWl0VGltZSA9IHRoaXMuJGRheWpzKCkuZm9ybWF0KCdZWVlZLU1NLUREIEhIOm1tOnNzJyk7CiAgICAgIHRoaXMuc3VibWl0U2hvdyA9IHRydWU7CiAgICB9LAogICAgLy/ojrflj5blrp7pmYXlt6Hmo4DkuroKICAgIGdldEFjdHVhbFBlcnNvbihhY3R1YWxQZXJzb24pIHsKICAgICAgdGhpcy4kc2V0KHRoaXMuc3VibWl0RGF0YSwgJ2FjdHVhbFBlcnNvbicsIGFjdHVhbFBlcnNvbik7CiAgICB9LAogICAgLy/ku7vliqHmj5DkuqTnoa7orqQKICAgIGFzeW5jIG9uQ29uZmlybSgpIHsKICAgICAgdHJ5IHsKICAgICAgICBsZXQgcXVlcnkgPSB7CiAgICAgICAgICBwYXRyb2xUYXNrSWQ6IHRoaXMuJHN0b3JlLnN0YXRlLnB1bXAudXJsUXVlcnkudGFza0lkLAogICAgICAgICAgdHJhY2tEVE9TOiB0aGlzLiRzdG9yZS5zdGF0ZS5wdW1wLnB1bXBQYXRoCiAgICAgICAgfTsKICAgICAgICBjb25zdCBwYXRoID0gYXdhaXQgdXBsb2FkVHJhY2tMaXN0KHF1ZXJ5KTsKICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldFB1bXBQYXRoJywgW10pOwogICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBhdHJvbEVkaXQodGhpcy5zdWJtaXREYXRhKTsKICAgICAgICB0aGlzLiRwYXJlbnQuZ2V0UGF0cm9sKCk7CiAgICAgICAgdGhpcy5maXJzdENvbmZpZyA9IGZhbHNlOwogICAgICAgIHRoaXMuJHJvdXRlci5yZXBsYWNlKCcvcHVtcC9pbnNwZWN0aW9uTWFuYWdlJyk7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5sb2coZXJyb3IpOwogICAgICB9CiAgICB9CiAgfQp9Ow=="},{"version":3,"names":["InspectionSubmitCard","patrolEdit","uploadTrackList","components","props","PatrolData","type","Object","default","modelType","String","watch","handler","isFinishConfig","deep","immediate","data","submitData","firstConfig","finishConfig","submitShow","disabled","mounted","setFirstConfig","beforeDestroy","stopRequestLocations","methods","modelTypeChange","patrolStatus","$emit","requestSingleLocation","$store","state","pump","urlQuery","console","log","_this$PatrolData","config","patrolPointResultList","every","item","goInspection","startInspection","query","id","taskId","patrolStartTime","$dayjs","format","res","$parent","getPatrol","$router","push","path","stopInspection","$dialog","confirm","title","message","then","isUnsubmitted","replace","catch","error","terminatedInspection","commit","_this$submitData$patr","JSON","parse","stringify","storageItemDataList","$storage","get","forEach","index","i","remove","isFirst","yuanchu","locationAMap","latitude","longitude","patrolPointTrackList","pumpPath","lat","lon","err","submit","patrolEndTime","submitTime","getActualPerson","actualPerson","$set","onConfirm","patrolTaskId","trackDTOS"],"sources":["src/views/PumpStationInspection/components/InspectionSubmit.vue"],"sourcesContent":["<template>\r\n  <div class=\"inspection-submit\">\r\n    <div class=\"inspection-map\">\r\n      <img\r\n        v-if=\"modelType === 'list'\"\r\n        @click=\"modelTypeChange('map')\"\r\n        src=\"@/assets/img/pump/inspection-map.png\"\r\n        alt=\"\"\r\n        class=\"inspection-icon\"\r\n      />\r\n      <img\r\n        v-if=\"modelType === 'map'\"\r\n        @click=\"modelTypeChange('list')\"\r\n        src=\"@/assets/img/pump/inspection-list.png\"\r\n        alt=\"\"\r\n        class=\"inspection-icon\"\r\n      />\r\n    </div>\r\n\r\n    <fm-button\r\n      type=\"success\"\r\n      class=\"inspection-btn inspection-btn-one\"\r\n      v-if=\"PatrolData && PatrolData.patrolStatus === 1\"\r\n      @click=\"startInspection(2)\"\r\n      >开始巡检</fm-button\r\n    >\r\n    <fm-button\r\n      type=\"success\"\r\n      class=\"inspection-btn\"\r\n      v-if=\"PatrolData && PatrolData.patrolStatus === 2 && !firstConfig && finishConfig\"\r\n      @click=\"submit(3)\"\r\n      >完成巡检</fm-button\r\n    >\r\n    <fm-button\r\n      type=\"warning\"\r\n      class=\"inspection-btn\"\r\n      v-if=\"PatrolData && PatrolData.patrolStatus === 2 && !firstConfig && !finishConfig\"\r\n      @click=\"terminatedInspection(4)\"\r\n      >终止巡检</fm-button\r\n    >\r\n    <fm-button\r\n      type=\"primary\"\r\n      class=\"inspection-btn\"\r\n      v-if=\"PatrolData && PatrolData.patrolStatus === 2 && !firstConfig && !finishConfig\"\r\n      @click=\"stopInspection()\"\r\n      >暂停巡检</fm-button\r\n    >\r\n    <fm-button\r\n      type=\"primary\"\r\n      class=\"inspection-btn inspection-btn-one\"\r\n      v-if=\"PatrolData && PatrolData.patrolStatus === 2 && firstConfig\"\r\n      @click=\"goInspection()\"\r\n      >继续巡检</fm-button\r\n    >\r\n\r\n    <fm-dialog\r\n      :visible.sync=\"submitShow\"\r\n      title=\"巡检任务提交\"\r\n      @confirm=\"onConfirm\"\r\n      show-cancel-button\r\n      width=\"331\"\r\n    >\r\n      <inspection-submit-card :PatrolData=\"submitData\"  @getActualPerson='getActualPerson' />\r\n    </fm-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport InspectionSubmitCard from './InspectionSubmitCard.vue'\r\nimport { patrolEdit, uploadTrackList } from '../api'\r\nexport default {\r\n  components: { InspectionSubmitCard },\r\n  props: {\r\n    //巡检状态(1:待巡检，2:巡检中，3:已完成 ，4:已终止)(手机端)\r\n    PatrolData: {\r\n      type: Object,\r\n      default: () => {},\r\n    },\r\n    modelType: {\r\n      type: String,\r\n      default: 'list',\r\n    },\r\n  },\r\n  watch: {\r\n    PatrolData: {\r\n      handler: function () {\r\n        this.isFinishConfig()\r\n      },\r\n      deep: true,\r\n      immediate: true,\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      submitData: null,\r\n      firstConfig: true, //是否为第一次进入\r\n      finishConfig: false, //巡检点是否巡检完毕\r\n      submitShow: false, //提交弹框\r\n      disabled: true,\r\n    }\r\n  },\r\n\r\n  mounted() {\r\n    this.setFirstConfig()\r\n  },\r\n  beforeDestroy() {\r\n    this.stopRequestLocations()\r\n  },\r\n\r\n  methods: {\r\n    //内容变化\r\n    //list列表，map地图\r\n    modelTypeChange(type) {\r\n      if (this.firstConfig && this.PatrolData.patrolStatus === 2) return\r\n      this.$emit('modelTypeChange', type)\r\n\r\n      this.stopRequestLocations()\r\n      if (type === 'list') this.requestSingleLocation(false)\r\n    },\r\n\r\n    //判断是否为第一次进入\r\n    setFirstConfig() {\r\n      let { firstConfig } = this.$store.state.pump.urlQuery\r\n\r\n      if (firstConfig === false) {\r\n        this.firstConfig = false\r\n        this.$emit('isDisabled', false)\r\n        console.log('isDisabled', false)\r\n\r\n        this.requestSingleLocation(this.firstConfig)\r\n      } else {\r\n        this.firstConfig = true\r\n      }\r\n    },\r\n\r\n    //巡检点是否巡检完毕\r\n    isFinishConfig() {\r\n      let config = this.PatrolData?.patrolPointResultList?.every((item) => {\r\n        return item.patrolStatus === '已巡'\r\n      })\r\n      this.finishConfig = config\r\n    },\r\n\r\n    //继续巡检\r\n    goInspection() {\r\n      this.firstConfig = false\r\n      this.$emit('isDisabled', false)\r\n\r\n      this.requestSingleLocation(true)\r\n    },\r\n\r\n    //开始巡检\r\n    async startInspection(type) {\r\n      let query = {\r\n        id: this.$store.state.pump.urlQuery.taskId,\r\n        patrolStatus: type ? type : this.PatrolData && this.PatrolData.patrolStatus,\r\n        patrolStartTime: this.$dayjs().format('YYYY-MM-DD HH:mm:ss'),\r\n        patrolPointResultList: this.PatrolData && this.PatrolData.patrolPointResultList,\r\n      }\r\n\r\n      this.$emit('isDisabled', false)\r\n\r\n      this.requestSingleLocation(true)\r\n\r\n      const res = await patrolEdit(query)\r\n      this.$parent.getPatrol()\r\n      this.firstConfig = false\r\n      this.$router.push({\r\n        path: '/pump/inspection',\r\n        query: {\r\n          taskId: this.$store.state.pump.urlQuery.taskId,\r\n          firstConfig: 'false',\r\n        },\r\n      })\r\n    },\r\n\r\n    //暂停巡检\r\n    stopInspection() {\r\n      this.$dialog\r\n        .confirm({\r\n          title: '暂停巡检',\r\n          message: '暂停巡检将提交未提交的巡检点和隐患数据！',\r\n        })\r\n        .then(async () => {\r\n          await this.isUnsubmitted()\r\n\r\n          this.$router.replace('/pump/inspectionManage')\r\n        })\r\n        .catch((error) => {\r\n          console.log(error)\r\n        })\r\n    },\r\n\r\n    //终止巡检\r\n    async terminatedInspection() {\r\n      this.$store.commit('setUrlQuery', {\r\n        taskId: this.$store.state.pump.urlQuery.taskId,\r\n      })\r\n      this.$router.push(`/pump/terminated-task`)\r\n    },\r\n\r\n    //检查是否有未提交项,并提交\r\n    async isUnsubmitted() {\r\n      this.submitData = JSON.parse(JSON.stringify(this.PatrolData))\r\n\r\n      let storageItemDataList = JSON.parse(this.$storage.get('pump-storageItemDataList'))\r\n      this.submitData.patrolPointResultList?.forEach((item, index) => {\r\n        storageItemDataList?.forEach((data, i) => {\r\n          item.id === data.id\r\n            ? (this.submitData.patrolPointResultList[index] = storageItemDataList[i])\r\n            : null\r\n        })\r\n      })\r\n\r\n      this.$storage.remove('pump-storageItemDataList')\r\n      const res = await patrolEdit(this.submitData)\r\n    },\r\n\r\n    //开始巡检\r\n    requestSingleLocation(isFirst) {\r\n      console.log(isFirst, '记录巡检')\r\n      if (typeof yuanchu != 'undefined') {\r\n        yuanchu.locationAMap.requestSingleLocation(\r\n          ['1'],\r\n          (res) => {\r\n            let { latitude, longitude } = res\r\n            let path\r\n            if (isFirst) {\r\n              path =\r\n                this.PatrolData && this.PatrolData.patrolPointTrackList\r\n                  ? this.PatrolData.patrolPointTrackList\r\n                  : []\r\n              console.log(path)\r\n            } else {\r\n              path = JSON.parse(JSON.stringify(this.$store.state.pump.pumpPath))\r\n            }\r\n\r\n            path.push({\r\n              lat: latitude,\r\n              lon: longitude,\r\n            })\r\n            this.$store.commit('setPumpPath', path)\r\n\r\n            console.log(this.$store.state.pump.pumpPath)\r\n          },\r\n          (err) => {\r\n            console.log('err=', err)\r\n          }\r\n        )\r\n      }\r\n    },\r\n\r\n    //结束定位\r\n    stopRequestLocations() {\r\n      console.log('结束巡检')\r\n      if (typeof yuanchu != 'undefined') {\r\n        yuanchu.locationAMap.stopRequestLocations()\r\n      }\r\n    },\r\n\r\n    //完成巡检提交\r\n    async submit(type) {\r\n      this.submitData = JSON.parse(JSON.stringify(this.PatrolData))\r\n      this.submitData.patrolStatus = type\r\n      this.submitData.patrolEndTime = this.$dayjs().format('YYYY-MM-DD HH:mm:ss')\r\n      this.submitData.submitTime = this.$dayjs().format('YYYY-MM-DD HH:mm:ss')\r\n      this.submitShow = true\r\n    },\r\n\r\n    //获取实际巡检人\r\n    getActualPerson(actualPerson) {\r\n      this.$set(this.submitData,'actualPerson',actualPerson)\r\n    },\r\n\r\n    //任务提交确认\r\n    async onConfirm() {\r\n      try {\r\n        let query = {\r\n          patrolTaskId: this.$store.state.pump.urlQuery.taskId,\r\n          trackDTOS: this.$store.state.pump.pumpPath,\r\n        }\r\n\r\n        const path = await uploadTrackList(query)\r\n        this.$store.commit('setPumpPath', [])\r\n\r\n        const res = await patrolEdit(this.submitData)\r\n        this.$parent.getPatrol()\r\n        this.firstConfig = false\r\n        this.$router.replace('/pump/inspectionManage')\r\n      } catch (error) {\r\n        console.log(error)\r\n      }\r\n    },\r\n  },\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.inspection-submit {\r\n  width: calc(100% - 150px);\r\n  position: fixed;\r\n  bottom: 0;\r\n  display: flex;\r\n  justify-content: space-around;\r\n  align-items: center;\r\n  height: 112px;\r\n  padding: 10px 30px 10px 120px;\r\n  background-color: #fff;\r\n\r\n  .inspection-map {\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    position: absolute;\r\n    left: 40px;\r\n    width: 40px;\r\n    height: 40px;\r\n\r\n    .inspection-icon {\r\n      width: 100%;\r\n      height: 100%;\r\n    }\r\n  }\r\n\r\n  .inspection-btn {\r\n    width: 288px;\r\n    height: 88px;\r\n    border-radius: 44px;\r\n  }\r\n\r\n  .inspection-btn-one {\r\n    width: 100%;\r\n  }\r\n}\r\n</style>\r\n"],"mappings":"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"}]}