{"remainingRequest":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\babel-loader\\lib\\index.js!E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\eslint-loader\\index.js??ref--14-0!E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\src\\components\\map\\utils\\area\\area.js","dependencies":[{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\src\\components\\map\\utils\\area\\area.js","mtime":1708928163326},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\babel.config.js","mtime":1705912799600},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9kZWZpbmVQcm9wZXJ0eSBmcm9tICJFOi90eV9wcm9qZWN0L3hhc3cteXkvcmV2ZW51ZS94YXN3LW1vYmlsZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vZGVmaW5lUHJvcGVydHkuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5wdXNoLmpzIjsKaW1wb3J0ICogYXMgdHVyZiBmcm9tICdAdHVyZi90dXJmJzsKaW1wb3J0IG1hcGJveGdsIGZyb20gJ21hcGJveC1nbCc7CmltcG9ydCAnbWFwYm94LWdsL2Rpc3QvbWFwYm94LWdsLmNzcyc7CmltcG9ydCBWdWUgZnJvbSAidnVlIjsKaW1wb3J0IGNsb3NlQnV0dG9uIGZyb20gIi4uL2NvbW1vbi9wb3B1cC9jbG9zZUJ1dHRvbiI7CmltcG9ydCBwb3B1cCBmcm9tICIuLi9jb21tb24vcG9wdXAvcHVwb3AudnVlIjsKaW1wb3J0IHN3YW5Ub29sIGZyb20gIi4uL3N3YW5Ub29sIjsKCi8qKg0KICog6Z2i56ev5rWL6YePDQogKi8KZXhwb3J0IGRlZmF1bHQgY2xhc3Mgc3dhbkFyZWEgZXh0ZW5kcyBzd2FuVG9vbCB7CiAgY29uc3RydWN0b3IobWFwKSB7CiAgICBzdXBlcihtYXApOwogICAgX2RlZmluZVByb3BlcnR5KHRoaXMsICJhZGRQb2x5Z29uIiwgZSA9PiB7CiAgICAgIHRoaXMuc3RhcnREcmF3ID0gdHJ1ZTsKICAgICAgdGhpcy5wb2x5Z29uRGF0YVswXS5nZW9tZXRyeS5jb29yZGluYXRlc1swXS5wdXNoKFtlLmxuZ0xhdC5sbmcsIGUubG5nTGF0LmxhdF0pOwogICAgICBsZXQgZ2VvanNvbiA9IHsKICAgICAgICAidHlwZSI6ICJGZWF0dXJlQ29sbGVjdGlvbiIsCiAgICAgICAgImZlYXR1cmVzIjogdGhpcy5wb2x5Z29uRGF0YQogICAgICB9OwogICAgICB0aGlzLm1hcC5nZXRTb3VyY2UoInBvbHlnb24iKS5zZXREYXRhKGdlb2pzb24pOwogICAgfSk7CiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgImFkZE1vdmVQb2x5Z29uIiwgZSA9PiB7CiAgICAgIGlmICghdGhpcy5zdGFydERyYXcpIHJldHVybjsKICAgICAgdGhpcy5tb3ZlRGF0YSA9IFt7CiAgICAgICAgInR5cGUiOiAiRmVhdHVyZSIsCiAgICAgICAgImdlb21ldHJ5IjogewogICAgICAgICAgInR5cGUiOiAiUG9seWdvbiIsCiAgICAgICAgICAiY29vcmRpbmF0ZXMiOiBbW11dCiAgICAgICAgfQogICAgICB9XTsKICAgICAgdGhpcy5tb3ZlRGF0YVswXS5nZW9tZXRyeS5jb29yZGluYXRlc1swXSA9IFsuLi50aGlzLnBvbHlnb25EYXRhWzBdLmdlb21ldHJ5LmNvb3JkaW5hdGVzWzBdLCBbZS5sbmdMYXQubG5nLCBlLmxuZ0xhdC5sYXRdXTsKICAgICAgbGV0IGdlb2pzb24gPSB7CiAgICAgICAgInR5cGUiOiAiRmVhdHVyZUNvbGxlY3Rpb24iLAogICAgICAgICJmZWF0dXJlcyI6IHRoaXMubW92ZURhdGEKICAgICAgfTsKICAgICAgdGhpcy5tYXAuZ2V0U291cmNlKCJwb2x5Z29uIikuc2V0RGF0YShnZW9qc29uKTsKICAgICAgdGhpcy5sYXN0UG9wdXAgJiYgdGhpcy5sYXN0UG9wdXAucmVtb3ZlKCk7CiAgICAgIGlmICh0aGlzLm1vdmVEYXRhWzBdLmdlb21ldHJ5LmNvb3JkaW5hdGVzWzBdLmxlbmd0aCA8IDQpIHJldHVybjsKICAgICAgbGV0IGFyZWEgPSB0aGlzLmdldEFyZWEodGhpcy5tb3ZlRGF0YVswXS5nZW9tZXRyeS5jb29yZGluYXRlc1swXSk7CiAgICAgIGxldCBkaXNwbGF5VGV4dCA9IFt7CiAgICAgICAga2V5OiAi6Z2i56evOiIsCiAgICAgICAgdmFsdWU6IGFyZWEKICAgICAgfV07CiAgICAgIGxldCBwb3B1cFYgPSBWdWUuZXh0ZW5kKHBvcHVwKTsKICAgICAgbGV0IHBvcHVwRG9tID0gbmV3IHBvcHVwVih7CiAgICAgICAgcHJvcHNEYXRhOiB7CiAgICAgICAgICBkaXNwbGF5VGV4dAogICAgICAgIH0KICAgICAgfSkuJG1vdW50KCk7CiAgICAgIHRoaXMudm1MaXN0LnB1c2gocG9wdXBEb20pOwogICAgICB0aGlzLmxhc3RQb3B1cCA9IG5ldyBtYXBib3hnbC5Qb3B1cCh7CiAgICAgICAgb2Zmc2V0OiB7CiAgICAgICAgICAndG9wJzogWzAsIDIyXQogICAgICAgIH0sCiAgICAgICAgY2xvc2VCdXR0b246IGZhbHNlLAogICAgICAgIC8v5aaC5p6c5Li6IHRydWUg77yM5by556qX5Y+z5LiK6KeS5bCG5Ye6546w5YWz6Zet5oyJ6ZKu44CCCiAgICAgICAgY2xvc2VPbkNsaWNrOiBmYWxzZSwKICAgICAgICAvL+WmguaenOS4uiB0cnVlIO+8jOeCueWHu+WcsOWbvuaXtuW8ueeql+WwhuWFs+mXreOAggogICAgICAgIGNsYXNzTmFtZTogJ3N3YW4tcG9wdXAnCiAgICAgIH0pLnNldExuZ0xhdChlLmxuZ0xhdCkuc2V0RE9NQ29udGVudChwb3B1cERvbS4kZWwpLmFkZFRvKHRoaXMubWFwKTsKICAgIH0pOwogICAgX2RlZmluZVByb3BlcnR5KHRoaXMsICJzdG9wQWRkIiwgKCkgPT4gewogICAgICBpZiAoIXRoaXMuc3RhcnREcmF3KSByZXR1cm47CiAgICAgIHRoaXMuY2xlYXJMaXN0ZW5lcigpOwogICAgICBpZiAodGhpcy5tb3ZlRGF0YVswXS5nZW9tZXRyeS5jb29yZGluYXRlc1swXS5sZW5ndGggLSAxID09IHRoaXMucG9wdXBMaXN0Lmxlbmd0aCkgewogICAgICAgIHRoaXMucG9wdXBMaXN0W3RoaXMucG9wdXBMaXN0Lmxlbmd0aCAtIDFdLnJlbW92ZSgpOwogICAgICB9CiAgICAgIC8vIGNsb3NlQnV0dG9uCiAgICAgIC8v5re75Yqg5YWz6Zet5oyJ6ZKuCiAgICAgIGxldCBwb3B1cENsb3NlID0gVnVlLmV4dGVuZChjbG9zZUJ1dHRvbik7CiAgICAgIGxldCBwb3B1cENsb3NlRG9tID0gbmV3IHBvcHVwQ2xvc2Uoe30pLiRtb3VudCgpOwogICAgICBwb3B1cENsb3NlRG9tLiRvbigiY2xvc2UiLCAoKSA9PiB7CiAgICAgICAgdGhpcy5vbkNhbmNlbCgpOwogICAgICB9KTsKICAgICAgdGhpcy52bUxpc3QucHVzaChwb3B1cENsb3NlRG9tKTsKICAgICAgbGV0IGdlb20gPSB0aGlzLm1vdmVEYXRhWzBdLmdlb21ldHJ5LmNvb3JkaW5hdGVzWzBdOwogICAgICB0aGlzLnBvcHVwTGlzdC5wdXNoKG5ldyBtYXBib3hnbC5Qb3B1cCh7CiAgICAgICAgb2Zmc2V0OiB7CiAgICAgICAgICAnYm90dG9tJzogWzAsIDQwXQogICAgICAgIH0sCiAgICAgICAgY2xvc2VCdXR0b246IGZhbHNlLAogICAgICAgIC8v5aaC5p6c5Li6IHRydWUg77yM5by556qX5Y+z5LiK6KeS5bCG5Ye6546w5YWz6Zet5oyJ6ZKu44CCCiAgICAgICAgY2xvc2VPbkNsaWNrOiBmYWxzZSwKICAgICAgICAvL+WmguaenOS4uiB0cnVlIO+8jOeCueWHu+WcsOWbvuaXtuW8ueeql+WwhuWFs+mXreOAggogICAgICAgIGNsYXNzTmFtZTogJ3N3YW4tcG9wdXAtY2xvc2UnCiAgICAgIH0pLnNldExuZ0xhdChnZW9tW2dlb20ubGVuZ3RoIC0gMV0pLnNldERPTUNvbnRlbnQocG9wdXBDbG9zZURvbS4kZWwpLmFkZFRvKHRoaXMubWFwKSk7CiAgICB9KTsKICAgIHRoaXMucG9seWdvbkRhdGEgPSBbXTsKICAgIHRoaXMubW92ZURhdGEgPSBbXTsKICAgIHRoaXMuc3RhcnREcmF3ID0gZmFsc2U7CiAgICB0aGlzLnBvcHVwTGlzdCA9IFtdOwogICAgdGhpcy52bUxpc3QgPSBbXTsKICAgIHRoaXMubGFzdFBvcHVwID0gbnVsbDsKICB9CiAgb25BZGQoKSB7CiAgICB0aGlzLmluaXRNZWFzdXJlKCk7CiAgICB0aGlzLm1hcC5vbigiY2xpY2siLCB0aGlzLmFkZFBvbHlnb24pOwogICAgdGhpcy5tYXAub24oIm1vdXNlbW92ZSIsIHRoaXMuYWRkTW92ZVBvbHlnb24pOwogICAgdGhpcy5tYXAub24oImRibGNsaWNrIiwgdGhpcy5zdG9wQWRkKTsKICB9CiAgaW5pdE1lYXN1cmUoKSB7CiAgICB0aGlzLnBvcHVwTGlzdC5mb3JFYWNoKGl0ZW0gPT4gewogICAgICBpdGVtLnJlbW92ZSgpOwogICAgfSk7CiAgICB0aGlzLmxhc3RQb3B1cCAmJiB0aGlzLmxhc3RQb3B1cC5yZW1vdmUoKTsKICAgIHRoaXMucG9seWdvbkRhdGEgPSBbewogICAgICAidHlwZSI6ICJGZWF0dXJlIiwKICAgICAgImdlb21ldHJ5IjogewogICAgICAgICJ0eXBlIjogIlBvbHlnb24iLAogICAgICAgICJjb29yZGluYXRlcyI6IFtbXV0KICAgICAgfQogICAgfV07CiAgICB0aGlzLm1hcC5nZXRDYW52YXMoKS5zdHlsZS5jdXJzb3IgPSAiY3Jvc3NoYWlyIjsKICAgICF0aGlzLm1hcC5nZXRTb3VyY2UoInBvbHlnb24iKSAmJiB0aGlzLm1hcC5hZGRTb3VyY2UoInBvbHlnb24iLCB7CiAgICAgICJ0eXBlIjogImdlb2pzb24iLAogICAgICAiZGF0YSI6IHsKICAgICAgICAidHlwZSI6ICJGZWF0dXJlQ29sbGVjdGlvbiIsCiAgICAgICAgImZlYXR1cmVzIjogW10KICAgICAgfSwKICAgICAgIm1heHpvb20iOiAxMiAvL+W9k+S7peabtOmrmOeahOe8qeaUvue6p+WIq+aYvuekuuWcsOWbvuaXtu+8jOWwhuS9v+eUqOadpeiHquacgOWkp+e8qeaUvueahOeTpueJh+eahOaVsOaNrgogICAgfSk7CiAgICAhdGhpcy5tYXAuZ2V0TGF5ZXIoInBvbHlnb24iKSAmJiB0aGlzLm1hcC5hZGRMYXllcih7CiAgICAgICJpZCI6ICJwb2x5Z29uIiwKICAgICAgInNvdXJjZSI6ICJwb2x5Z29uIiwKICAgICAgInR5cGUiOiAiZmlsbCIsCiAgICAgICJwYWludCI6IHsKICAgICAgICAvLyDnu5jliLbnsbvlsZ7mgKcKICAgICAgICAiZmlsbC1hbnRpYWxpYXMiOiB0cnVlLAogICAgICAgIC8vIOWhq+WFheaXtuaYr+WQpuWPjemUr+m9v++8iOWPr+mAie+8jOm7mOiupOWAvOS4uiB0cnVl77yJCiAgICAgICAgImZpbGwtb3BhY2l0eSI6IDAuMSwKICAgICAgICAvLyDloavlhYXnmoTkuI3pgI/mmI7luqbvvIjlj6/pgInvvIzlj5blgLzojIPlm7TkuLogMCB+IDHvvIzpu5jorqTlgLzkuLogMe+8iQogICAgICAgICJmaWxsLWNvbG9yIjogIiNGRkZGMDAiLAogICAgICAgIC8vIOWhq+WFheeahOminOiJsu+8iOWPr+mAie+8jOm7mOiupOWAvOS4uiAjMDAwMDAw44CC5aaC5p6c6K6+572u5LqGIGZpbGwtcGF0dGVybu+8jOWImSBmaWxsLWNvbG9yIOWwhuaXoOaViO+8iQogICAgICAgICJmaWxsLW91dGxpbmUtY29sb3IiOiAiIzA2Q0VBRSIKICAgICAgfQogICAgfSk7CiAgICAhdGhpcy5tYXAuZ2V0TGF5ZXIoInBvbHlnb25fY2FwIikgJiYgdGhpcy5tYXAuYWRkTGF5ZXIoewogICAgICAiaWQiOiAicG9seWdvbl9jYXAiLAogICAgICAic291cmNlIjogInBvbHlnb24iLAogICAgICAidHlwZSI6ICJjaXJjbGUiLAogICAgICAicGFpbnQiOiB7CiAgICAgICAgLy8g57uY5Yi257G75bGe5oCnCiAgICAgICAgImNpcmNsZS1vcGFjaXR5IjogMSwKICAgICAgICAvLyDlnIbngrnnmoTkuI3pgI/mmI7luqbvvIjlj6/pgInvvIzlj5blgLzojIPlm7TkuLogMCB+IDHvvIzpu5jorqTlgLzkuLogMe+8iQogICAgICAgICJjaXJjbGUtcmFkaXVzIjogNCwKICAgICAgICAvLyDlnIbngrnnmoTljYrlvoTvvIjlj6/pgInvvIzlgLwgPj0gMO+8jOm7mOiupOWAvOS4uiA177yM5Y2V5L2N77ya5YOP57Sg77yJCiAgICAgICAgImNpcmNsZS1jb2xvciI6ICIjRkZGRjAwIiAvLyDlnIbngrnnmoTpopzoibLvvIjlj6/pgInvvIzpu5jorqTlgLzkuLogIzAwMDAwMO+8iQogICAgICB9CiAgICB9KTsKICB9CiAgZ2V0QXJlYShhcmVhTGlzdCkgewogICAgbGV0IHBvbHlnb24gPSB0dXJmLnBvbHlnb24oW1suLi5hcmVhTGlzdCwgYXJlYUxpc3RbMF1dXSk7CiAgICBsZXQgYXJlYSA9IHR1cmYuYXJlYShwb2x5Z29uKTsKICAgIGlmIChhcmVhIDwgMTAwMDAwMCkgewogICAgICByZXR1cm4gYCR7YXJlYS50b0ZpeGVkKDIpfeOOoWA7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gYCR7KGFyZWEgLyAxMDAwMDAwKS50b0ZpeGVkKDIpfWvjjqFgOwogICAgfQogIH0KICBjbGVhckxpc3RlbmVyKCkgewogICAgdGhpcy5zdGFydERyYXcgPSBmYWxzZTsKICAgIHRoaXMubWFwLmdldENhbnZhcygpLnN0eWxlLmN1cnNvciA9ICIiOwogICAgdGhpcy5tYXAub2ZmKCJjbGljayIsIHRoaXMuYWRkUG9seWdvbik7CiAgICB0aGlzLm1hcC5vZmYoIm1vdXNlbW92ZSIsIHRoaXMuYWRkTW92ZVBvbHlnb24pOwogICAgdGhpcy5tYXAub2ZmKCJkYmxjbGljayIsIHRoaXMuc3RvcEFkZCk7CiAgfQogIG9uQ2FuY2VsKCkgewogICAgdGhpcy5jbGVhckxpc3RlbmVyKCk7CiAgICB0aGlzLnBvcHVwTGlzdC5mb3JFYWNoKGl0ZW0gPT4gewogICAgICBpdGVtLnJlbW92ZSgpOwogICAgfSk7CiAgICB0aGlzLnZtTGlzdC5mb3JFYWNoKGl0ZW0gPT4gewogICAgICBpdGVtLiRkZXN0cm95KCk7CiAgICB9KTsKICAgIHRoaXMubGFzdFBvcHVwICYmIHRoaXMubGFzdFBvcHVwLnJlbW92ZSgpOwogICAgdGhpcy5tYXAuZ2V0TGF5ZXIoInBvbHlnb24iKSAmJiB0aGlzLm1hcC5yZW1vdmVMYXllcigicG9seWdvbiIpOwogICAgdGhpcy5tYXAuZ2V0TGF5ZXIoInBvbHlnb25fY2FwIikgJiYgdGhpcy5tYXAucmVtb3ZlTGF5ZXIoInBvbHlnb25fY2FwIik7CiAgICB0aGlzLm1hcC5nZXRTb3VyY2UoInBvbHlnb24iKSAmJiB0aGlzLm1hcC5yZW1vdmVTb3VyY2UoInBvbHlnb24iKTsKICB9Cn0="},{"version":3,"names":["turf","mapboxgl","Vue","closeButton","popup","swanTool","swanArea","constructor","map","_defineProperty","e","startDraw","polygonData","geometry","coordinates","push","lngLat","lng","lat","geojson","getSource","setData","moveData","lastPopup","remove","length","area","getArea","displayText","key","value","popupV","extend","popupDom","propsData","$mount","vmList","Popup","offset","closeOnClick","className","setLngLat","setDOMContent","$el","addTo","clearListener","popupList","popupClose","popupCloseDom","$on","onCancel","geom","onAdd","initMeasure","on","addPolygon","addMovePolygon","stopAdd","forEach","item","getCanvas","style","cursor","addSource","getLayer","addLayer","areaList","polygon","toFixed","off","$destroy","removeLayer","removeSource"],"sources":["E:/ty_project/xasw-yy/revenue/xasw-mobile/src/components/map/utils/area/area.js"],"sourcesContent":["import * as turf from '@turf/turf';\r\nimport mapboxgl from 'mapbox-gl';\r\nimport 'mapbox-gl/dist/mapbox-gl.css';\r\nimport Vue from \"vue\";\r\nimport closeButton from \"../common/popup/closeButton\";\r\nimport popup from \"../common/popup/pupop.vue\";\r\nimport swanTool from \"../swanTool\";\r\n\r\n/**\r\n * 面积测量\r\n */\r\nexport default class swanArea extends swanTool {\r\n  constructor(map) {\r\n    super(map);\r\n    this.polygonData = [];\r\n    this.moveData = [];\r\n    this.startDraw = false;\r\n    this.popupList = [];\r\n    this.vmList = [];\r\n    this.lastPopup = null;\r\n  }\r\n\r\n  onAdd() {\r\n    this.initMeasure();\r\n    this.map.on(\"click\", this.addPolygon)\r\n    this.map.on(\"mousemove\", this.addMovePolygon)\r\n    this.map.on(\"dblclick\", this.stopAdd)\r\n  }\r\n\r\n  initMeasure() {\r\n    this.popupList.forEach(item => {\r\n      item.remove()\r\n    })\r\n    this.lastPopup && this.lastPopup.remove()\r\n    this.polygonData = [{\r\n      \"type\": \"Feature\",\r\n      \"geometry\": {\r\n        \"type\": \"Polygon\",\r\n        \"coordinates\": [[]]\r\n      }\r\n    }]\r\n    this.map.getCanvas().style.cursor = \"crosshair\";\r\n    !this.map.getSource(\"polygon\") && this.map.addSource(\"polygon\", {\r\n      \"type\": \"geojson\",\r\n      \"data\": {\r\n        \"type\": \"FeatureCollection\",\r\n        \"features\": []\r\n      },\r\n      \"maxzoom\": 12 //当以更高的缩放级别显示地图时，将使用来自最大缩放的瓦片的数据\r\n    })\r\n    !this.map.getLayer(\"polygon\") && this.map.addLayer({\r\n      \"id\": \"polygon\",\r\n      \"source\": \"polygon\",\r\n      \"type\": \"fill\",\r\n      \"paint\": { // 绘制类属性\r\n        \"fill-antialias\": true, // 填充时是否反锯齿（可选，默认值为 true）\r\n        \"fill-opacity\": 0.1, // 填充的不透明度（可选，取值范围为 0 ~ 1，默认值为 1）\r\n        \"fill-color\": \"#FFFF00\", // 填充的颜色（可选，默认值为 #000000。如果设置了 fill-pattern，则 fill-color 将无效）\r\n        \"fill-outline-color\": \"#06CEAE\",\r\n      }\r\n    })\r\n    !this.map.getLayer(\"polygon_cap\") && this.map.addLayer({\r\n      \"id\": \"polygon_cap\",\r\n      \"source\": \"polygon\",\r\n      \"type\": \"circle\",\r\n      \"paint\": { // 绘制类属性\r\n        \"circle-opacity\": 1, // 圆点的不透明度（可选，取值范围为 0 ~ 1，默认值为 1）\r\n        \"circle-radius\": 4, // 圆点的半径（可选，值 >= 0，默认值为 5，单位：像素）\r\n        \"circle-color\": \"#FFFF00\", // 圆点的颜色（可选，默认值为 #000000）\r\n      }\r\n    })\r\n  }\r\n\r\n  addPolygon = (e) => {\r\n    this.startDraw = true\r\n    this.polygonData[0].geometry.coordinates[0].push([e.lngLat.lng, e.lngLat.lat]);\r\n    let geojson = {\r\n      \"type\": \"FeatureCollection\",\r\n      \"features\": this.polygonData\r\n    };\r\n    this.map.getSource(\"polygon\").setData(geojson);\r\n  }\r\n\r\n  addMovePolygon = (e) => {\r\n    if (!this.startDraw) return\r\n    this.moveData = [{\r\n      \"type\": \"Feature\",\r\n      \"geometry\": {\r\n        \"type\": \"Polygon\",\r\n        \"coordinates\": [[]]\r\n      }\r\n    }]\r\n    this.moveData[0].geometry.coordinates[0] = [\r\n      ...this.polygonData[0].geometry.coordinates[0],\r\n      [e.lngLat.lng, e.lngLat.lat]\r\n    ]\r\n    let geojson = {\r\n      \"type\": \"FeatureCollection\",\r\n      \"features\": this.moveData\r\n    };\r\n    this.map.getSource(\"polygon\").setData(geojson);\r\n\r\n    this.lastPopup && this.lastPopup.remove()\r\n    if (this.moveData[0].geometry.coordinates[0].length < 4) return\r\n    let area = this.getArea(this.moveData[0].geometry.coordinates[0])\r\n    let displayText = [{\r\n      key: \"面积:\",\r\n      value: area\r\n    }]\r\n    let popupV = Vue.extend(popup);\r\n    let popupDom = new popupV({\r\n      propsData: { displayText }\r\n    }).$mount();\r\n    this.vmList.push(popupDom);\r\n    this.lastPopup = new mapboxgl.Popup({\r\n      offset: {\r\n        'top': [0, 22],\r\n      },\r\n      closeButton: false,//如果为 true ，弹窗右上角将出现关闭按钮。\r\n      closeOnClick: false, //如果为 true ，点击地图时弹窗将关闭。\r\n      className: 'swan-popup'\r\n    })\r\n      .setLngLat(e.lngLat)\r\n      .setDOMContent(popupDom.$el)\r\n      .addTo(this.map)\r\n  }\r\n\r\n  getArea(areaList) {\r\n    let polygon = turf.polygon([[...areaList, areaList[0]]]);\r\n    let area = turf.area(polygon);\r\n    if (area < 1000000) {\r\n      return `${area.toFixed(2)}㎡`\r\n    } else {\r\n      return `${(area / 1000000).toFixed(2)}k㎡`\r\n    }\r\n  }\r\n\r\n  stopAdd = () => {\r\n    if (!this.startDraw)\r\n      return\r\n    this.clearListener()\r\n    if (this.moveData[0].geometry.coordinates[0].length - 1 == this.popupList.length) {\r\n      this.popupList[this.popupList.length - 1].remove()\r\n    }\r\n    // closeButton\r\n    //添加关闭按钮\r\n    let popupClose = Vue.extend(closeButton);\r\n    let popupCloseDom = new popupClose({}).$mount();\r\n    popupCloseDom.$on(\"close\", () => {\r\n      this.onCancel();\r\n    })\r\n    this.vmList.push(popupCloseDom);\r\n    let geom = this.moveData[0].geometry.coordinates[0]\r\n    this.popupList.push(\r\n      new mapboxgl.Popup({\r\n        offset: {\r\n          'bottom': [0, 40],\r\n        },\r\n        closeButton: false,//如果为 true ，弹窗右上角将出现关闭按钮。\r\n        closeOnClick: false, //如果为 true ，点击地图时弹窗将关闭。\r\n        className: 'swan-popup-close'\r\n      })\r\n        .setLngLat(geom[geom.length - 1])\r\n        .setDOMContent(popupCloseDom.$el)\r\n        .addTo(this.map)\r\n    )\r\n  }\r\n\r\n  clearListener() {\r\n    this.startDraw = false\r\n    this.map.getCanvas().style.cursor = \"\";\r\n    this.map.off(\"click\", this.addPolygon)\r\n    this.map.off(\"mousemove\", this.addMovePolygon)\r\n    this.map.off(\"dblclick\", this.stopAdd)\r\n  }\r\n\r\n  onCancel() {\r\n    this.clearListener()\r\n    this.popupList.forEach(item => {\r\n      item.remove()\r\n    })\r\n    this.vmList.forEach(item => {\r\n      item.$destroy();\r\n    })\r\n    this.lastPopup && this.lastPopup.remove()\r\n    this.map.getLayer(\"polygon\") && this.map.removeLayer(\"polygon\");\r\n    this.map.getLayer(\"polygon_cap\") && this.map.removeLayer(\"polygon_cap\");\r\n    this.map.getSource(\"polygon\") && this.map.removeSource(\"polygon\");\r\n  }\r\n}"],"mappings":"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"}]}