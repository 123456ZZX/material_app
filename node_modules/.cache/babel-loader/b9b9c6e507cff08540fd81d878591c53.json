{"remainingRequest":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\babel-loader\\lib\\index.js!E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\src\\views\\DispatchCenter\\components\\PressureAnalysis\\index.vue?vue&type=script&lang=js","dependencies":[{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\src\\views\\DispatchCenter\\components\\PressureAnalysis\\index.vue","mtime":1708928163368},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\babel.config.js","mtime":1705912799600},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCB7IGRlZmFsdExlZ2VuZExpc3QgfSBmcm9tICcuL2RlZmF1bHRMZWdlbmRMaXN0LmpzJzsKaW1wb3J0ICogYXMgYXBpcyBmcm9tICcuL2FwaSc7CmltcG9ydCB7IGFkZEljb25Ub01hcCB9IGZyb20gJ0AvdXRpbHMvbWFwVXRpbHMnOwppbXBvcnQgbWFwYm94Z2wgZnJvbSAnbWFwYm94LWdsJzsKY29uc3QgbWFwT2JqID0gewogIG1hcEluc3RhbmNlOiBudWxsLAogIG1hcDogbnVsbCwKICBwb3B1cExpc3Q6IFtdCn07CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAncHJlc3N1cmVBbmFseXNpcycsCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIG9wZW5Qb3B1cDogdHJ1ZSwKICAgICAgaXNEYXRhTG9hZGVkOiB0cnVlLAogICAgICBsZWdlbmRDb25maWc6IFtdLAogICAgICBzdXBwbHlQcmVzc3VyZTogW10sCiAgICAgIGljb25zOiBbewogICAgICAgIG5hbWU6ICfljovlipvnm5HmtYso5L6bKSonLAogICAgICAgIHVybDogcmVxdWlyZSgnQC9hc3NldHMvaW1nL21hcC/ljovlipvnm5HmtYsucG5nJykKICAgICAgfSwgewogICAgICAgIG5hbWU6ICfljovlipvnm5HmtYvnprvnur/kvpsnLAogICAgICAgIHVybDogcmVxdWlyZSgnQC9hc3NldHMvaW1nL21hcC/ljovlipvnprvnur/kvpvlnLDlm74ucG5nJykKICAgICAgfSwgewogICAgICAgIG5hbWU6ICfljovlipvnm5HmtYvmiqXorabkvpsnLAogICAgICAgIHVybDogcmVxdWlyZSgnQC9hc3NldHMvaW1nL21hcC/ljovlipvmiqXorabkvpvlnLDlm74ucG5nJykKICAgICAgfV0KICAgIH07CiAgfSwKICBtb3VudGVkKCkge30sCiAgbWV0aG9kczogewogICAgY2hhbmdlUG9wdXAodmFsKSB7CiAgICAgIGlmICh2YWwpIHsKICAgICAgICBsZXQgZmVhdHVyZXMgPSB0aGlzLnN1cHBseVByZXNzdXJlLm1hcChpdCA9PiB7CiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICB0eXBlOiAnRmVhdHVyZScsCiAgICAgICAgICAgIGdlb21ldHJ5OiB7CiAgICAgICAgICAgICAgdHlwZTogJ1BvaW50JywKICAgICAgICAgICAgICBjb29yZGluYXRlczogW051bWJlcihpdC5sb24pLCBOdW1iZXIoaXQubGF0KV0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgcHJvcGVydGllczogewogICAgICAgICAgICAgIHZhbHVlOiBpc05hTihOdW1iZXIoaXQucmVhbHRpbWVEYXRhLmZpbHRlcihpdCA9PiBpdC5pc1Nob3cgPT0gMClbMF0udmFsKSkgPyAwIDogTnVtYmVyKGl0LnJlYWx0aW1lRGF0YS5maWx0ZXIoaXQgPT4gaXQuaXNTaG93ID09IDApWzBdLnZhbCksCiAgICAgICAgICAgICAgLi4uaXQKICAgICAgICAgICAgfQogICAgICAgICAgfTsKICAgICAgICB9KTsKICAgICAgICBmZWF0dXJlcy5mb3JFYWNoKGl0ID0+IHsKICAgICAgICAgIHRoaXMuYWRkVGl0bGVNYXJrZXIoaXQucHJvcGVydGllcy52YWx1ZSwgaXQuZ2VvbWV0cnkuY29vcmRpbmF0ZXMpOwogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIG1hcE9iai5wb3B1cExpc3QubGVuZ3RoID4gMCAmJiBtYXBPYmoucG9wdXBMaXN0LmZvckVhY2goaXQgPT4gaXQucmVtb3ZlKCkpOwogICAgICAgIG1hcE9iai5wb3B1cExpc3QgPSBbXTsKICAgICAgfQogICAgfSwKICAgIGFkZFRpdGxlTWFya2VyKG5hbWUsIHBvaW50cykgewogICAgICBsZXQgcG9wID0gbmV3IG1hcGJveGdsLlBvcHVwKHsKICAgICAgICBjbG9zZUJ1dHRvbjogZmFsc2UsCiAgICAgICAgY2xvc2VPbkNsaWNrOiBmYWxzZSwKICAgICAgICBvZmZzZXQ6IFswLCAtMTVdCiAgICAgIH0pOwogICAgICBtYXBPYmoucG9wdXBMaXN0LnB1c2gocG9wKTsKICAgICAgbGV0IHRpbWVyID0gc2V0SW50ZXJ2YWwoKCkgPT4gewogICAgICAgIGlmIChtYXBPYmoubWFwLmdldFNvdXJjZSgnc3VwcGx5UHJlc3NNb25pdG9yJykpIHsKICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGltZXIpOwogICAgICAgICAgcG9wLnNldExuZ0xhdChwb2ludHMpLnNldFRleHQobmFtZSArICdNcGEnKS5hZGRUbyhtYXBPYmoubWFwKTsKICAgICAgICB9CiAgICAgIH0sIDUwMCk7CiAgICB9LAogICAgYXN5bmMgbWFwTG9hZGVkKCkgewogICAgICBtYXBPYmoubWFwSW5zdGFuY2UgPSB3aW5kb3cueGFNYXBCdWlsZGVyOwogICAgICBtYXBPYmoubWFwID0gd2luZG93LnhhTWFwOwogICAgICBtYXBPYmoubWFwLnNldFpvb20oMTIpOwogICAgICB0aGlzLmxlZ2VuZENvbmZpZyA9IGRlZmFsdExlZ2VuZExpc3Q7CiAgICAgIGF3YWl0IGFkZEljb25Ub01hcChtYXBPYmoubWFwLCB0aGlzLmljb25zKTsKICAgICAgbWFwT2JqLm1hcC5hZGRTb3VyY2UoJ3N1cHBseVByZXNzTW9uaXRvcicsIHsKICAgICAgICB0eXBlOiAnZ2VvanNvbicsCiAgICAgICAgZGF0YTogewogICAgICAgICAgdHlwZTogJ0ZlYXR1cmVDb2xsZWN0aW9uJywKICAgICAgICAgIGZlYXR1cmVzOiBbXQogICAgICAgIH0KICAgICAgfSk7CiAgICAgIG1hcE9iai5tYXAuYWRkTGF5ZXIoewogICAgICAgIGlkOiAnc3VwcGx5UHJlc3NNb25pdG9yTGF5ZXItaGVhdCcsCiAgICAgICAgdHlwZTogJ2hlYXRtYXAnLAogICAgICAgIHNvdXJjZTogJ3N1cHBseVByZXNzTW9uaXRvcicsCiAgICAgICAgbWF4em9vbTogMTQuNiwKICAgICAgICBwYWludDogewogICAgICAgICAgJ2hlYXRtYXAtd2VpZ2h0JzogWydpbnRlcnBvbGF0ZScsIFsnbGluZWFyJ10sIFsnZ2V0JywgJ3ZhbHVlJ10sIDAsIDAsIDEsIDFdLAogICAgICAgICAgJ2hlYXRtYXAtaW50ZW5zaXR5JzogWydpbnRlcnBvbGF0ZScsIFsnbGluZWFyJ10sIFsnem9vbSddLCAxMCwgMSwgMTMsIDEyXSwKICAgICAgICAgICdoZWF0bWFwLWNvbG9yJzogWydpbnRlcnBvbGF0ZScsIFsnbGluZWFyJ10sIFsnaGVhdG1hcC1kZW5zaXR5J10sIDAsICdyZ2JhKDE0OSwgMTg5LCAyNTUsIDAuMSknLCAwLjIsICdyZ2IoMTgzLCAyMzIsIDE1OCknLCAwLjQsICdyZ2IoMjU1LCAyMjcsIDEwNiknLCAwLjYsICdyZ2IoMjU1LCAxNzUsIDk2KScsIDAuOCwgJ3JnYmEoMjQ5LCAxMTksIDExOSwgMC45KScsIDEsICdyZ2IoMjQ5LCAxMTksIDExOSknXSwKICAgICAgICAgIC8vIEFkanVzdCB0aGUgaGVhdG1hcCByYWRpdXMgYnkgem9vbSBsZXZlbAogICAgICAgICAgJ2hlYXRtYXAtcmFkaXVzJzogWydpbnRlcnBvbGF0ZScsIFsnbGluZWFyJ10sIFsnem9vbSddLCAxMCwgNDAsIDEyLCAzMCwgMTQsIDIwXSwKICAgICAgICAgIC8vIFRyYW5zaXRpb24gZnJvbSBoZWF0bWFwIHRvIGNpcmNsZSBsYXllciBieSB6b29tIGxldmVsCiAgICAgICAgICAnaGVhdG1hcC1vcGFjaXR5JzogWydpbnRlcnBvbGF0ZScsIFsnbGluZWFyJ10sIFsnem9vbSddLCAxMCwgMSwgMTIsIDAuOCwgMTMuNSwgMC41LCAxNC41LCAwLjFdCiAgICAgICAgfQogICAgICB9KTsKICAgICAgbWFwT2JqLm1hcC5hZGRMYXllcih7CiAgICAgICAgaWQ6ICdzdXBwbHlQcmVzc01vbml0b3JMYXllcicsCiAgICAgICAgc291cmNlOiAnc3VwcGx5UHJlc3NNb25pdG9yJywKICAgICAgICB0eXBlOiAnc3ltYm9sJywKICAgICAgICBtaW56b29tOiAxNC41LAogICAgICAgIGxheW91dDogewogICAgICAgICAgJ2ljb24taW1hZ2UnOiBbJ2Nhc2UnLCBbJ2FsbCcsIFsnPT0nLCBbJ2dldCcsICdpb3RPbmxpbmUnXSwgJzAnXSwgWychPScsIFsnZ2V0JywgJ2lzV2FybiddLCAnMSddXSwgJ+WOi+WKm+ebkea1iyjkvpspKicsIFsnPT0nLCBbJ2dldCcsICdpb3RPbmxpbmUnXSwgJzEnXSwgJ+WOi+WKm+ebkea1i+emu+e6v+S+mycsIFsnYWxsJywgWyc9PScsIFsnZ2V0JywgJ2lvdE9ubGluZSddLCAnMCddLCBbJz09JywgWydnZXQnLCAnaXNXYXJuJ10sICcxJ11dLCAn5Y6L5Yqb55uR5rWL5oql6K2m5L6bJywgJ+WOi+WKm+ebkea1iyjkvpspKiddCiAgICAgICAgfSwKICAgICAgICAnaWNvbi1zaXplJzogMC43LAogICAgICAgIC8vIOWbvuagh+W8uuWItuWFqOmDqOaYvuekugogICAgICAgICdpY29uLWlnbm9yZS1wbGFjZW1lbnQnOiB0cnVlCiAgICAgIH0pOwogICAgICB0aGlzLmdldEFsbFN1cHBseVdhdGVyUHJlc3MoKTsKICAgICAgbWFwT2JqLm1hcC5vbignY2xpY2snLCAnc3VwcGx5UHJlc3NNb25pdG9yTGF5ZXInLCB0aGlzLnByZXNzdXJlRGV0YWlsKTsKICAgIH0sCiAgICBwcmVzc3VyZURldGFpbChlKSB7CiAgICAgIGxldCBmZWF0dXJlID0gbWFwT2JqLm1hcC5xdWVyeVJlbmRlcmVkRmVhdHVyZXMoZS5wb2ludClbMF07CiAgICAgIGlmIChmZWF0dXJlLmxheWVyLmlkID09ICdzdXBwbHlQcmVzc01vbml0b3JMYXllcicpIHsKICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgICBwYXRoOiAnL0Rpc3BhdGNoQ2VudGVyL1ByZXNzdXJlRGV0YWlsJywKICAgICAgICAgIHF1ZXJ5OiB7CiAgICAgICAgICAgIGRldmljZUluZm86IGZlYXR1cmUucHJvcGVydGllcywKICAgICAgICAgICAgcHJlc3N1cmVTdGF0aW9uOiB0aGlzLnN1cHBseVByZXNzdXJlCiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBnZXRBbGxTdXBwbHlXYXRlclByZXNzKCkgewogICAgICBsZXQgcGFyYW1zID0gewogICAgICAgIGRldmljZVR5cGU6ICdJVlRNJwogICAgICB9OwogICAgICBhcGlzLmdldEFsbEVxdWlwbWVudEluZm9ybWF0aW9uKHBhcmFtcykudGhlbihyZXMgPT4gewogICAgICAgIGlmIChyZXMuc3RhdHVzKSB7CiAgICAgICAgICB0aGlzLnN1cHBseVByZXNzdXJlID0gcmVzLmRhdGEuZmlsdGVyKGl0ZW0gPT4gaXRlbS5iZWxvbmdTeXN0ZW0gPT0gJ+S+m+awtCcgfHwgaXRlbS5iZWxvbmdTeXN0ZW0gPT0gJ+WGjeeUn+awtCcpOwogICAgICAgICAgdGhpcy5pc0RhdGFMb2FkZWQgPSBmYWxzZTsKICAgICAgICAgIGxldCBmZWF0dXJlcyA9IHRoaXMuc3VwcGx5UHJlc3N1cmUubWFwKGl0ID0+IHsKICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICB0eXBlOiAnRmVhdHVyZScsCiAgICAgICAgICAgICAgZ2VvbWV0cnk6IHsKICAgICAgICAgICAgICAgIHR5cGU6ICdQb2ludCcsCiAgICAgICAgICAgICAgICBjb29yZGluYXRlczogW051bWJlcihpdC5sb24pLCBOdW1iZXIoaXQubGF0KV0KICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIHByb3BlcnRpZXM6IHsKICAgICAgICAgICAgICAgIHZhbHVlOiBpc05hTihOdW1iZXIoaXQucmVhbHRpbWVEYXRhLmZpbHRlcihpdCA9PiBpdC5pc1Nob3cgPT0gMClbMF0udmFsKSkgPyAwIDogTnVtYmVyKGl0LnJlYWx0aW1lRGF0YS5maWx0ZXIoaXQgPT4gaXQuaXNTaG93ID09IDApWzBdLnZhbCksCiAgICAgICAgICAgICAgICAuLi5pdAogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsKICAgICAgICAgIH0pOwogICAgICAgICAgaWYgKG1hcE9iai5tYXAuZ2V0U291cmNlKCdzdXBwbHlQcmVzc01vbml0b3InKSkgewogICAgICAgICAgICBtYXBPYmoubWFwLmdldFNvdXJjZSgnc3VwcGx5UHJlc3NNb25pdG9yJykuc2V0RGF0YSh7CiAgICAgICAgICAgICAgdHlwZTogJ0ZlYXR1cmVDb2xsZWN0aW9uJywKICAgICAgICAgICAgICBmZWF0dXJlczogZmVhdHVyZXMKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgICB0aGlzLm9wZW5Qb3B1cCAmJiBmZWF0dXJlcy5mb3JFYWNoKGl0ID0+IHsKICAgICAgICAgICAgdGhpcy5hZGRUaXRsZU1hcmtlcihpdC5wcm9wZXJ0aWVzLnZhbHVlLCBpdC5nZW9tZXRyeS5jb29yZGluYXRlcyk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0KfTs="},{"version":3,"names":["defaltLegendList","apis","addIconToMap","mapboxgl","mapObj","mapInstance","map","popupList","name","data","openPopup","isDataLoaded","legendConfig","supplyPressure","icons","url","require","mounted","methods","changePopup","val","features","it","type","geometry","coordinates","Number","lon","lat","properties","value","isNaN","realtimeData","filter","isShow","forEach","addTitleMarker","length","remove","points","pop","Popup","closeButton","closeOnClick","offset","push","timer","setInterval","getSource","clearInterval","setLngLat","setText","addTo","mapLoaded","window","xaMapBuilder","xaMap","setZoom","addSource","addLayer","id","source","maxzoom","paint","minzoom","layout","getAllSupplyWaterPress","on","pressureDetail","e","feature","queryRenderedFeatures","point","layer","$router","path","query","deviceInfo","pressureStation","params","deviceType","getAllEquipmentInformation","then","res","status","item","belongSystem","setData"],"sources":["src/views/DispatchCenter/components/PressureAnalysis/index.vue"],"sourcesContent":["<template>\r\n  <div class=\"main\">\r\n    <fm-nav-bar title=\"压力分析\" left-arrow @click-left=\"$router.go(-1)\">\r\n      <template #right>\r\n        <fm-switch v-model=\"openPopup\" @change=\"changePopup\" size=\"24px\" :disabled=\"isDataLoaded\" />\r\n      </template>\r\n    </fm-nav-bar>\r\n    <div class=\"mapContainer\">\r\n      <xa-map :create=\"mapLoaded\" :legendConfig=\"legendConfig\" />\r\n      <div class=\"mapLegend\">\r\n        <div class=\"legendItem\">\r\n          <div class=\"colorItem\" style=\"background: #F97777;\"></div>\r\n          <div class=\"pressureSpan\">>0.35MPa</div>\r\n        </div>\r\n        <div class=\"legendItem\">\r\n          <div class=\"colorItem\" style=\"background: #FFAF60;\"></div>\r\n          <div class=\"pressureSpan\">0.25 ~ 0.35MPa</div>\r\n        </div>\r\n        <div class=\"legendItem\">\r\n          <div class=\"colorItem\" style=\"background: #FFE36A;\"></div>\r\n          <div class=\"pressureSpan\">0.20 ~ 0.25MPa</div>\r\n        </div>\r\n        <div class=\"legendItem\">\r\n          <div class=\"colorItem\" style=\"background: #B7E89E;\"></div>\r\n          <div class=\"pressureSpan\">0.15 ~ 0.20MPa</div>\r\n        </div>\r\n        <div class=\"legendItem\">\r\n          <div class=\"colorItem\" style=\"background: #95BDFF;\"></div>\r\n          <div class=\"pressureSpan\">0.00 ~ 0.15MPa</div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { defaltLegendList } from './defaultLegendList.js'\r\nimport * as apis from './api';\r\nimport { addIconToMap } from '@/utils/mapUtils';\r\nimport mapboxgl from 'mapbox-gl';\r\nconst mapObj = {\r\n  mapInstance: null,\r\n  map: null,\r\n  popupList: []\r\n}\r\nexport default {\r\n  name: 'pressureAnalysis',\r\n  data() {\r\n    return {\r\n      openPopup: true,\r\n      isDataLoaded: true,\r\n      legendConfig: [],\r\n      supplyPressure: [],\r\n      icons: [\r\n        {\r\n          name: '压力监测(供)*',\r\n          url: require('@/assets/img/map/压力监测.png'),\r\n        },\r\n        {\r\n          name: '压力监测离线供',\r\n          url: require('@/assets/img/map/压力离线供地图.png'),\r\n        },\r\n        {\r\n          name: '压力监测报警供',\r\n          url: require('@/assets/img/map/压力报警供地图.png'),\r\n        }\r\n      ]\r\n    }\r\n  },\r\n  mounted() {\r\n    \r\n  },\r\n  methods: {\r\n    changePopup(val) {\r\n      if (val) {\r\n        let features = this.supplyPressure.map(it => {\r\n          return {\r\n            type: 'Feature',\r\n            geometry: {\r\n              type: 'Point',\r\n              coordinates: [Number(it.lon), Number(it.lat)],\r\n            },\r\n            properties: {\r\n              value: isNaN(Number(it.realtimeData.filter(it => it.isShow == 0)[0].val)) ? 0 : Number(it.realtimeData.filter(it => it.isShow == 0)[0].val),\r\n              ...it\r\n            }\r\n          }\r\n        })\r\n        features.forEach(it => {\r\n          this.addTitleMarker(it.properties.value, it.geometry.coordinates)\r\n        })\r\n      } else {\r\n        mapObj.popupList.length > 0 && mapObj.popupList.forEach(it => it.remove())\r\n        mapObj.popupList = []\r\n      }\r\n    },\r\n    addTitleMarker(name, points) {\r\n      let pop = new mapboxgl.Popup({\r\n        closeButton: false,\r\n        closeOnClick: false,\r\n        offset: [0, -15]\r\n      });\r\n      mapObj.popupList.push(pop)\r\n      let timer = setInterval(() => {\r\n        if (mapObj.map.getSource('supplyPressMonitor')) {\r\n          clearInterval(timer)\r\n          pop\r\n            .setLngLat(points)\r\n            .setText(name + 'Mpa')\r\n            .addTo(mapObj.map);\r\n        }\r\n      }, 500)\r\n    },\r\n    async mapLoaded() {\r\n      mapObj.mapInstance = window.xaMapBuilder\r\n      mapObj.map = window.xaMap\r\n      mapObj.map.setZoom(12)\r\n      this.legendConfig = defaltLegendList\r\n      await addIconToMap(mapObj.map, this.icons)\r\n      mapObj.map.addSource('supplyPressMonitor', {\r\n        type: 'geojson',\r\n        data: {\r\n            type: 'FeatureCollection',\r\n            features: []\r\n        }\r\n      })\r\n      mapObj.map.addLayer({\r\n        id: 'supplyPressMonitorLayer-heat',\r\n        type: 'heatmap',\r\n        source: 'supplyPressMonitor',\r\n        maxzoom: 14.6,\r\n        paint: {\r\n            'heatmap-weight': [\r\n                'interpolate',\r\n                ['linear'],\r\n                ['get', 'value'],\r\n                0,\r\n                0,\r\n                1,\r\n                1\r\n            ],\r\n            'heatmap-intensity': [\r\n                'interpolate',\r\n                ['linear'],\r\n                ['zoom'],\r\n                10,\r\n                1,\r\n                13,\r\n                12\r\n            ],\r\n            'heatmap-color': [\r\n                'interpolate',\r\n                ['linear'],\r\n                ['heatmap-density'],\r\n                0,\r\n                'rgba(149, 189, 255, 0.1)',\r\n                0.2,\r\n                'rgb(183, 232, 158)',\r\n                0.4,\r\n                'rgb(255, 227, 106)',\r\n                0.6,\r\n                'rgb(255, 175, 96)',\r\n                0.8,\r\n                'rgba(249, 119, 119, 0.9)',\r\n                1,\r\n                'rgb(249, 119, 119)'\r\n            ],\r\n            // Adjust the heatmap radius by zoom level\r\n            'heatmap-radius': [\r\n                'interpolate',\r\n                ['linear'],\r\n                ['zoom'],\r\n                10,\r\n                40,\r\n                12,\r\n                30,\r\n                14,\r\n                20\r\n            ],\r\n            // Transition from heatmap to circle layer by zoom level\r\n            'heatmap-opacity': [\r\n                'interpolate',\r\n                ['linear'],\r\n                ['zoom'],\r\n                10,\r\n                1,\r\n                12,\r\n                0.8,\r\n                13.5,\r\n                0.5,\r\n                14.5,\r\n                0.1\r\n            ]\r\n        }\r\n      })\r\n      mapObj.map.addLayer({\r\n        id: 'supplyPressMonitorLayer',\r\n        source: 'supplyPressMonitor',\r\n        type: 'symbol',\r\n        minzoom: 14.5,\r\n        layout: {\r\n          'icon-image': [\r\n            'case',\r\n            [\r\n              'all',\r\n              ['==', ['get', 'iotOnline'], '0'],\r\n              ['!=', ['get', 'isWarn'], '1'],\r\n            ],\r\n            '压力监测(供)*',\r\n            ['==', ['get', 'iotOnline'], '1'],\r\n            '压力监测离线供',\r\n            [\r\n              'all',\r\n              ['==', ['get', 'iotOnline'], '0'],\r\n              ['==', ['get', 'isWarn'], '1'],\r\n            ],\r\n            '压力监测报警供',\r\n            '压力监测(供)*'\r\n          ]\r\n        },\r\n        'icon-size': 0.7,\r\n        // 图标强制全部显示\r\n        'icon-ignore-placement': true,\r\n      })\r\n      this.getAllSupplyWaterPress()\r\n      mapObj.map.on('click', 'supplyPressMonitorLayer', this.pressureDetail)\r\n    },\r\n    pressureDetail(e) {\r\n      let feature = mapObj.map.queryRenderedFeatures(e.point)[0]\r\n      if (feature.layer.id == 'supplyPressMonitorLayer') {\r\n        this.$router.push({\r\n          path: '/DispatchCenter/PressureDetail',\r\n          query: { deviceInfo: feature.properties, pressureStation: this.supplyPressure }\r\n        })\r\n      }\r\n    },\r\n    getAllSupplyWaterPress() {\r\n      let params = {\r\n        deviceType: 'IVTM',\r\n      }\r\n      apis.getAllEquipmentInformation(params).then((res) => {\r\n        if (res.status) {\r\n          this.supplyPressure = res.data.filter(\r\n            (item) => item.belongSystem == '供水' || item.belongSystem == '再生水'\r\n          )\r\n          this.isDataLoaded = false\r\n          let features = this.supplyPressure.map(it => {\r\n            return {\r\n                type: 'Feature',\r\n                geometry: {\r\n                    type: 'Point',\r\n                    coordinates: [Number(it.lon), Number(it.lat)],\r\n                },\r\n                properties: {\r\n                    value: isNaN(Number(it.realtimeData.filter(it => it.isShow == 0)[0].val)) ? 0 : Number(it.realtimeData.filter(it => it.isShow == 0)[0].val),\r\n                    ...it\r\n                }\r\n            }\r\n          })\r\n          if (mapObj.map.getSource('supplyPressMonitor')) {\r\n            mapObj.map.getSource('supplyPressMonitor').setData({\r\n                type: 'FeatureCollection',\r\n                features: features\r\n            })\r\n          }\r\n          this.openPopup && features.forEach(it => {\r\n            this.addTitleMarker(it.properties.value, it.geometry.coordinates)\r\n          })\r\n        }\r\n      })\r\n    }\r\n  },\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.main {\r\n  width: 100%;\r\n  height: 100%;\r\n  .mapContainer {\r\n    height: calc(100% - 46px);\r\n    width: 100%;\r\n    background: linear-gradient(180deg, #e5f2ff 0%, #f6f8fa 25%, #f5f7f9 100%);\r\n    .mapLegend {\r\n      width: auto;\r\n      min-width: 310px;\r\n      height: 320px;\r\n      background: #ffffff;\r\n      position: absolute;\r\n      bottom: 30px;\r\n      left: 30px;\r\n      padding: 20px 30px;\r\n      display: flex;\r\n      flex-direction: column;\r\n      .legendItem {\r\n        width: 100%;\r\n        height: 45px;\r\n        margin: 10px 0;\r\n        display: flex;\r\n        .colorItem {\r\n          width: 16px;\r\n          height: 16px;\r\n          margin: auto;\r\n          border-radius: 50%;\r\n        }\r\n        .pressureSpan {\r\n          margin-left: 20px;\r\n          height: 45px;\r\n          font-size: 32px;\r\n          font-family: PingFangSC-Regular, PingFang SC;\r\n          font-weight: 400;\r\n          color: #333333;\r\n          line-height: 45px;\r\n          width: 240px;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>"],"mappings":";AAoCA,SAAAA,gBAAA;AACA,YAAAC,IAAA;AACA,SAAAC,YAAA;AACA,OAAAC,QAAA;AACA,MAAAC,MAAA;EACAC,WAAA;EACAC,GAAA;EACAC,SAAA;AACA;AACA;EACAC,IAAA;EACAC,KAAA;IACA;MACAC,SAAA;MACAC,YAAA;MACAC,YAAA;MACAC,cAAA;MACAC,KAAA,GACA;QACAN,IAAA;QACAO,GAAA,EAAAC,OAAA;MACA,GACA;QACAR,IAAA;QACAO,GAAA,EAAAC,OAAA;MACA,GACA;QACAR,IAAA;QACAO,GAAA,EAAAC,OAAA;MACA;IAEA;EACA;EACAC,QAAA,GAEA;EACAC,OAAA;IACAC,YAAAC,GAAA;MACA,IAAAA,GAAA;QACA,IAAAC,QAAA,QAAAR,cAAA,CAAAP,GAAA,CAAAgB,EAAA;UACA;YACAC,IAAA;YACAC,QAAA;cACAD,IAAA;cACAE,WAAA,GAAAC,MAAA,CAAAJ,EAAA,CAAAK,GAAA,GAAAD,MAAA,CAAAJ,EAAA,CAAAM,GAAA;YACA;YACAC,UAAA;cACAC,KAAA,EAAAC,KAAA,CAAAL,MAAA,CAAAJ,EAAA,CAAAU,YAAA,CAAAC,MAAA,CAAAX,EAAA,IAAAA,EAAA,CAAAY,MAAA,UAAAd,GAAA,SAAAM,MAAA,CAAAJ,EAAA,CAAAU,YAAA,CAAAC,MAAA,CAAAX,EAAA,IAAAA,EAAA,CAAAY,MAAA,UAAAd,GAAA;cACA,GAAAE;YACA;UACA;QACA;QACAD,QAAA,CAAAc,OAAA,CAAAb,EAAA;UACA,KAAAc,cAAA,CAAAd,EAAA,CAAAO,UAAA,CAAAC,KAAA,EAAAR,EAAA,CAAAE,QAAA,CAAAC,WAAA;QACA;MACA;QACArB,MAAA,CAAAG,SAAA,CAAA8B,MAAA,QAAAjC,MAAA,CAAAG,SAAA,CAAA4B,OAAA,CAAAb,EAAA,IAAAA,EAAA,CAAAgB,MAAA;QACAlC,MAAA,CAAAG,SAAA;MACA;IACA;IACA6B,eAAA5B,IAAA,EAAA+B,MAAA;MACA,IAAAC,GAAA,OAAArC,QAAA,CAAAsC,KAAA;QACAC,WAAA;QACAC,YAAA;QACAC,MAAA;MACA;MACAxC,MAAA,CAAAG,SAAA,CAAAsC,IAAA,CAAAL,GAAA;MACA,IAAAM,KAAA,GAAAC,WAAA;QACA,IAAA3C,MAAA,CAAAE,GAAA,CAAA0C,SAAA;UACAC,aAAA,CAAAH,KAAA;UACAN,GAAA,CACAU,SAAA,CAAAX,MAAA,EACAY,OAAA,CAAA3C,IAAA,UACA4C,KAAA,CAAAhD,MAAA,CAAAE,GAAA;QACA;MACA;IACA;IACA,MAAA+C,UAAA;MACAjD,MAAA,CAAAC,WAAA,GAAAiD,MAAA,CAAAC,YAAA;MACAnD,MAAA,CAAAE,GAAA,GAAAgD,MAAA,CAAAE,KAAA;MACApD,MAAA,CAAAE,GAAA,CAAAmD,OAAA;MACA,KAAA7C,YAAA,GAAAZ,gBAAA;MACA,MAAAE,YAAA,CAAAE,MAAA,CAAAE,GAAA,OAAAQ,KAAA;MACAV,MAAA,CAAAE,GAAA,CAAAoD,SAAA;QACAnC,IAAA;QACAd,IAAA;UACAc,IAAA;UACAF,QAAA;QACA;MACA;MACAjB,MAAA,CAAAE,GAAA,CAAAqD,QAAA;QACAC,EAAA;QACArC,IAAA;QACAsC,MAAA;QACAC,OAAA;QACAC,KAAA;UACA,mBACA,eACA,YACA,kBACA,GACA,GACA,GACA,EACA;UACA,sBACA,eACA,YACA,UACA,IACA,GACA,IACA,GACA;UACA,kBACA,eACA,YACA,qBACA,GACA,4BACA,KACA,sBACA,KACA,sBACA,KACA,qBACA,KACA,4BACA,GACA,qBACA;UACA;UACA,mBACA,eACA,YACA,UACA,IACA,IACA,IACA,IACA,IACA,GACA;UACA;UACA,oBACA,eACA,YACA,UACA,IACA,GACA,IACA,KACA,MACA,KACA,MACA;QAEA;MACA;MACA3D,MAAA,CAAAE,GAAA,CAAAqD,QAAA;QACAC,EAAA;QACAC,MAAA;QACAtC,IAAA;QACAyC,OAAA;QACAC,MAAA;UACA,eACA,QACA,CACA,OACA,mCACA,+BACA,EACA,YACA,mCACA,WACA,CACA,OACA,mCACA,+BACA,EACA,WACA;QAEA;QACA;QACA;QACA;MACA;MACA,KAAAC,sBAAA;MACA9D,MAAA,CAAAE,GAAA,CAAA6D,EAAA,0CAAAC,cAAA;IACA;IACAA,eAAAC,CAAA;MACA,IAAAC,OAAA,GAAAlE,MAAA,CAAAE,GAAA,CAAAiE,qBAAA,CAAAF,CAAA,CAAAG,KAAA;MACA,IAAAF,OAAA,CAAAG,KAAA,CAAAb,EAAA;QACA,KAAAc,OAAA,CAAA7B,IAAA;UACA8B,IAAA;UACAC,KAAA;YAAAC,UAAA,EAAAP,OAAA,CAAAzC,UAAA;YAAAiD,eAAA,OAAAjE;UAAA;QACA;MACA;IACA;IACAqD,uBAAA;MACA,IAAAa,MAAA;QACAC,UAAA;MACA;MACA/E,IAAA,CAAAgF,0BAAA,CAAAF,MAAA,EAAAG,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA,CAAAC,MAAA;UACA,KAAAvE,cAAA,GAAAsE,GAAA,CAAA1E,IAAA,CAAAwB,MAAA,CACAoD,IAAA,IAAAA,IAAA,CAAAC,YAAA,YAAAD,IAAA,CAAAC,YAAA,SACA;UACA,KAAA3E,YAAA;UACA,IAAAU,QAAA,QAAAR,cAAA,CAAAP,GAAA,CAAAgB,EAAA;YACA;cACAC,IAAA;cACAC,QAAA;gBACAD,IAAA;gBACAE,WAAA,GAAAC,MAAA,CAAAJ,EAAA,CAAAK,GAAA,GAAAD,MAAA,CAAAJ,EAAA,CAAAM,GAAA;cACA;cACAC,UAAA;gBACAC,KAAA,EAAAC,KAAA,CAAAL,MAAA,CAAAJ,EAAA,CAAAU,YAAA,CAAAC,MAAA,CAAAX,EAAA,IAAAA,EAAA,CAAAY,MAAA,UAAAd,GAAA,SAAAM,MAAA,CAAAJ,EAAA,CAAAU,YAAA,CAAAC,MAAA,CAAAX,EAAA,IAAAA,EAAA,CAAAY,MAAA,UAAAd,GAAA;gBACA,GAAAE;cACA;YACA;UACA;UACA,IAAAlB,MAAA,CAAAE,GAAA,CAAA0C,SAAA;YACA5C,MAAA,CAAAE,GAAA,CAAA0C,SAAA,uBAAAuC,OAAA;cACAhE,IAAA;cACAF,QAAA,EAAAA;YACA;UACA;UACA,KAAAX,SAAA,IAAAW,QAAA,CAAAc,OAAA,CAAAb,EAAA;YACA,KAAAc,cAAA,CAAAd,EAAA,CAAAO,UAAA,CAAAC,KAAA,EAAAR,EAAA,CAAAE,QAAA,CAAAC,WAAA;UACA;QACA;MACA;IACA;EACA;AACA"}]}