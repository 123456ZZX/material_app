{"remainingRequest":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\babel-loader\\lib\\index.js!E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\src\\views\\inspectionManage\\daily-task.vue?vue&type=script&lang=js","dependencies":[{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\src\\views\\inspectionManage\\daily-task.vue","mtime":1705912915829},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\babel.config.js","mtime":1705912799600},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCBidXMgZnJvbSAnLi4vLi4vdmlld3MvaW5zcGVjdE1hcC91dGlscy9CdXMuanMnOwppbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnOwppbXBvcnQgZGF5anMgZnJvbSAnZGF5anMnOwppbXBvcnQgTWFwQ29tcCBmcm9tICcuLi8uLi92aWV3cy9pbnNwZWN0TWFwL2luZGV4LnZ1ZSc7CmltcG9ydCBrZXlQb2ludExpc3QgZnJvbSAnLi9rZXlwb2ludC1saXN0LnZ1ZSc7CmltcG9ydCByZXF1ZXN0IGZyb20gJ0AvdXRpbHMvcmVxdWVzdCc7CmltcG9ydCAqIGFzIGFwaSBmcm9tICcuL2FwaSc7CmltcG9ydCB7IFRvYXN0LCBEaWFsb2cgfSBmcm9tICdmYXdrZXMtbW9iaWxlLWxpYic7CmltcG9ydCAqIGFzIHR1cmYgZnJvbSAnQHR1cmYvdHVyZic7CmltcG9ydCBVcGxvYWRlciBmcm9tICdAL2NvbXBvbmVudHMvdXBsb2FkL1VwbG9hZGVyLnZ1ZSc7CmltcG9ydCBwcm9ibGVtQ2FyZEluZm8gZnJvbSAnLi9wcm9ibGVtQ2FyZEluZm8nOwppbXBvcnQgQVBJIGZyb20gIkAvY29tbW9uL2NvbmZpZy5qcyI7CmNvbnN0IG1hcE9iaiA9IHsKICBtYXA6IG51bGwsCiAgbWFwSW5zdGFuY2U6IG51bGwKfTsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdkYWlseS10YXNrJywKICBjb21wb25lbnRzOiB7CiAgICBNYXBDb21wLAogICAga2V5UG9pbnRMaXN0LAogICAgVXBsb2FkZXIsCiAgICBwcm9ibGVtQ2FyZEluZm8KICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBpZlRpcHM6IGZhbHNlLAogICAgICByZXBvcnREYXRhSXNMb2FkZWQ6IGZhbHNlLAogICAgICAvLyDlt6Hmo4Dku7vliqHkuIvmiYDmnInlt6Hmo4DnrqHnur8KICAgICAgYWxsVGFza0xpbmVzOiBbXSwKICAgICAgaXNWaWV3OiB0cnVlLAogICAgICBhY3RpdmU6IDAsCiAgICAgIGRldmljZU5hbWU6ICcnLAogICAgICBoYXNTaWduSW46IGZhbHNlLAogICAgICBzaG93UG9wb3ZlcjogZmFsc2UsCiAgICAgIGFjdGlvbnM6IFt7CiAgICAgICAgdGV4dDogJ+mXrumimOS4iuaKpScKICAgICAgfSwgewogICAgICAgIHRleHQ6ICforr7mlr3nvLrpmbcnCiAgICAgIH1dLAogICAgICBjdXJyZW50UmF0ZTogMCwKICAgICAgLy8g5o6n5Yi25YWz6ZSu54K55YiX6KGo5pi+6ZqQCiAgICAgIHBvaW50TGlzdFNob3c6IGZhbHNlLAogICAgICAvLyDlhajlsYDlj5Hlo7Dlh73mlbAKICAgICAgLy8g6K6w5b2V5byA5aeL5beh5qOA55qE5pe26Ze077yM55So5LqO5Yik5pat5piv5ZCm5Zyo5byA5aeL5beh5qOA55qEMTBz5YaFCiAgICAgIHN0YXJ0UmVjb3JkVGltZXI6ICcnLAogICAgICBuYXZiYXJUaXRsZTogJ+aXpeW4uOS7u+WKoScsCiAgICAgIC8vIOS4iuaKpeWksei0peeahOW3oeajgOi9qOi/ueeCueS9jeaVsOe7hAogICAgICByZXBvcnRGYWlsVHJhY2tQb2ludHM6IFtdLAogICAgICBpc1Nob3dSb3V0ZTogdHJ1ZSwKICAgICAgaW5zcEJ1c2luZXNzVHlwZTogJycsCiAgICAgIHJlY29yZERhdGE6IFtdLAogICAgICAvLyDlvZPliY3lt6Hmo4DlkZjmiYDlpITkvY3nva4KICAgICAgY3VycmVudFBvc2l0aW9uOiBudWxsLAogICAgICBsaW5lczogW10sCiAgICAgIC8vIOW3oeajgOWRmOS/oeaBrwogICAgICB1c2VySW5mbzoge30sCiAgICAgIGlmUmVjb3JkaW5nOiBmYWxzZSwKICAgICAgZW5kUmVjb3JkU2hvdzogZmFsc2UsCiAgICAgIHNlbGVjdEV2ZW50VHlwZTogZmFsc2UsCiAgICAgIGV2ZW50VHlwZUxpc3Q6IFtdLAogICAgICBzaWduU2hvdzogZmFsc2UsCiAgICAgIGF0dGFjaG1lbnQ6ICcnLAogICAgICBzaWduRm9ybTogewogICAgICAgIGRldmljZVN0YXR1czogJzEnLAogICAgICAgIGluc3BJbWFnZXNMaXN0OiBbXSwKICAgICAgICByZW1hcms6ICcnLAogICAgICAgIGlzUmVwb3J0OiAnJywKICAgICAgICB0YXNrSWQ6ICcnLAogICAgICAgIHBvaW50SWQ6ICcnCiAgICAgIH0sCiAgICAgIHRhc2tEZXRhaWw6IHsKICAgICAgICBjb3ZlcmFnZTogJzAvMCcsCiAgICAgICAgcmVwb3J0UmF0ZTogJzAvMCcsCiAgICAgICAgcGxhbkVuZFRpbWU6ICcnCiAgICAgIH0sCiAgICAgIGVuZ0luZm9EVE86IHt9LAogICAgICB0YXNrUmVzdFRpbWU6IDAsCiAgICAgIHJlcG9ydEZvb3RlclNob3c6IGZhbHNlLAogICAgICBmZWF0dXJlOiB7fSwKICAgICAgcGxhbkRldGFpbDoge30sCiAgICAgIC8vIOeUqOS6juWcsOWbvuS4reaYvuekuuiMg+WbtOWSjOWFs+mUrueCuQogICAgICBpbnNwUmFuZ2VMaXN0OiBbXSwKICAgICAgcmFuZ2VMaXN0OiBbXSwKICAgICAga2V5RGV0YWlsTGlzdDogW10sCiAgICAgIGlzUnVuTGlzdDogW3sKICAgICAgICBuYW1lOiAn5q2j5bi4JywKICAgICAgICB2YWx1ZTogJzEnCiAgICAgIH0sIHsKICAgICAgICBuYW1lOiAn5byC5bi4JywKICAgICAgICB2YWx1ZTogJzAnCiAgICAgIH1dLAogICAgICByZXBvcnRDaG9zZTogW3sKICAgICAgICBuYW1lOiAn6Zeu6aKY5LiK5oqlJywKICAgICAgICB2YWx1ZTogJ+mXrumimOS4iuaKpScKICAgICAgfSwgewogICAgICAgIG5hbWU6ICfmlrDlop7nvLrpmbcnLAogICAgICAgIHZhbHVlOiAn5paw5aKe57y66Zm3JwogICAgICB9LCB7CiAgICAgICAgbmFtZTogJ+aXoOmcgOS4iuaKpScsCiAgICAgICAgdmFsdWU6ICfml6DpnIDkuIrmiqUnCiAgICAgIH1dLAogICAgICBydWxlczoge30sCiAgICAgIHByZXZpZXdVUkw6ICcvc3lzLXN0b3JhZ2UvZG93bmxvYWRfaW1hZ2U/ZjhzPScsCiAgICAgIHVwaW1nUHJldmlldzogW10sCiAgICAgIGhlYWRlcnM6IHt9LAogICAgICB1cmw6IHsKICAgICAgICAvLyDmnKzpobXpnaLkvb/nlKjliLDnmoR1cmwKICAgICAgICB1cGxvYWRGaWxlOiAnc3lzLXN0b3JhZ2UvdXBsb2FkJywKICAgICAgICBmaW5kRmlsZTogJ2VjaWRpLWNtcC9maWxlL2NtcEZpbGVHcm91cC9maW5kRmlsZXNCeUdyb3VwSWQnCiAgICAgIH0sCiAgICAgIHBvbGxpbmdGbGFnOiBmYWxzZSwKICAgICAgcG9sbGluZ0dhcFRpbWU6IDMsCiAgICAgIHRyYWNrUG9pbnRMaXN0OiBbXSwKICAgICAgdHJhY2tQb2ludFRpbWVMaXN0OiBbXSwKICAgICAgb3ZlclNwZWVkVHJhY2tMaW5lTGlzdDogW10sCiAgICAgIHRyYWNrTG9jYXRpb25fc3RhcnQ6ICcnLAogICAgICB0cmFja0xvY2F0aW9uX2VuZDogJycsCiAgICAgIHNob3dWaXNpYmxlOiBmYWxzZSwKICAgICAgaXNNYXNrOiBmYWxzZSwKICAgICAgLy/mmK/lkKbmmL7npLrpga7nvanlsYIKICAgICAgcmVwb3J0U2hvdzogZmFsc2UsCiAgICAgIC8vIOmXrumimOS4iuaKpemdouadv+aYvuekugogICAgICBhY2Nlc3NUb2tlbjogdGhpcy4kc3RvcmFnZS5nZXQoJ2FjY2Vzc190b2tlbicpLAogICAgICBoZWFkZXI6IHt9LAogICAgICBmb3JtVG9rZW46ICcnLAogICAgICAvLyDpl67popjkuIrmiqVsaXN0CiAgICAgIHByb2JsZW1EYXRhTGlzdDE6IFtdLAogICAgICAvLyDorr7mlr3nvLrpmbdsaXN0CiAgICAgIHByb2JsZW1EYXRhTGlzdDI6IFtdCiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHt9LAogIGNyZWF0ZWQoKSB7CiAgICAvLyDojrflj5bpl67popjkuIrmiqXlkozorr7mlr3nvLrpmbfmlbDmja4KICAgIHRoaXMuZ2V0Q2FyZExpc3REYXRhKCk7CiAgfSwKICBtb3VudGVkKCkgewogICAgdGhpcy51c2VySW5mbyA9IHRoaXMuJHN0b3JlLnN0YXRlLnVzZXJJbmZvOwogICAgY29uc29sZS5sb2coJ3RoaXMudXNlckluZm86ICcsIHRoaXMudXNlckluZm8pOwogICAgdGhpcy5pc1N0YXJ0ID0gZmFsc2U7CiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnc3RhcnRSZWNvcmRMaW5lcycsICdlbmQnKTsKICAgIHRoaXMubmF2YmFyVGl0bGUgPSAn5pel5bi45Lu75YqhJzsKICAgIGJ1cy4kb24oJ3N0YXJ0U2lnbkluJywgZmVhdHVyZSA9PiB7CiAgICAgIHRoaXMuc3RhcnRTaWduSW4oZmVhdHVyZSk7CiAgICB9KTsKICAgIHRoaXMuaXNWaWV3ID0gdGhpcy4kcm91dGUucXVlcnkuaXNWaWV3OwogICAgY29uc3QgaWQgPSB0aGlzLiRyb3V0ZS5xdWVyeS50YXNrSWQ7CiAgICB0aGlzLmdldFRhc2tCeUlkKGlkKTsKICAgIHRoaXMuZ2V0VHJhY2tSZWNvcmRzQnlJZChpZCk7CiAgICAvLyB0aGlzLmdldEFwcEluc3BEYXRhKGlkKQogICAgbGV0IHRoYXQgPSB0aGlzOwogICAgIWZ1bmN0aW9uIGNvbXB1dGVkUG9zaXRpb24oKSB7CiAgICAgIGxldCBnYXBUaW1lciA9IDEwOwogICAgICBpZiAodGhhdC5jdXJyZW50UG9zaXRpb24pIHsKICAgICAgICAvLyDorqHnrpflvZPliY3ml7bpl7TkuI7lvZPliY3mj5Lku7bov5Tlm57nmoTml7bpl7TnmoTpl7TpmpQKICAgICAgICBsZXQgZ2FwID0gKG5ldyBEYXRlKCkuZ2V0VGltZSgpIC0gbmV3IERhdGUodGhhdC5jdXJyZW50UG9zaXRpb24ubG9jVGltZSkuZ2V0VGltZSgpKSAvIDEwMDA7CiAgICAgICAgLy8g5aaC5p6c6Ze06ZqU5pe26Ze05aSn5LqO5p+Q5LiA5YC877yM5YiZ6K+05piO5ZyoZ2FwVGltZXLml7bpl7TlhoXmsqHmnInmlLbliLDmnaXoh6rmj5Lku7bnmoTmlrDngrnkvY0KICAgICAgICBpZiAoZ2FwID4gZ2FwVGltZXIpIHsKICAgICAgICAgIC8vIOW8gOWQr+aPkOekugogICAgICAgICAgLy8gTm90aWZ5Lndhcm5pbmcoeyBtZXNzYWdlOiAn5b2T5YmNR1BT5L+h5Y+36L6D5byxLOS9jee9ruWSjOi9qOi/ueabtOaWsOWPr+iDvee8k+aFoicsIGR1cmF0aW9uOiA1MDAwIH0pCiAgICAgICAgICBsZXQgdCA9IHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAvLyDmj5DnpLrnu5PmnZ/vvIzlubblvIDlp4vkuIvmrKHosIPnlKgKICAgICAgICAgICAgY29tcHV0ZWRQb3NpdGlvbigpOwogICAgICAgICAgfSwgMTUwMDApOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyDlvIDlp4vkuIvmrKHosIPnlKgKICAgICAgICAgIGxldCB0ID0gc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgIGNvbXB1dGVkUG9zaXRpb24oKTsKICAgICAgICAgIH0sIDEwMDAwKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gTm90aWZ5Lndhcm5pbmcoeyBtZXNzYWdlOiAn5b2T5YmNR1BT5peg5L+hJywgZHVyYXRpb246IDUwMDAgfSkKICAgICAgICBsZXQgdCA9IHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgY29tcHV0ZWRQb3NpdGlvbigpOwogICAgICAgIH0sIDEwMDAwKTsKICAgICAgfQogICAgfSgpOwogIH0sCiAgbWV0aG9kczogewogICAgLy8g6I635Y+W6Zeu6aKY5LiK5oql5ZKM6K6+5pa957y66Zm35pWw5o2uCiAgICBnZXRDYXJkTGlzdERhdGEoKSB7CiAgICAgIC8vIOiOt+WPlmhlYWRlcu+8jOafpeivouW3peWNleeUqAogICAgICBheGlvcyh7CiAgICAgICAgdXJsOiBBUEkuVlVFX0FQUF9XUEdfVVJMICsgJy9tYWluL3VzZXJDZW50ZXJBcGkvc3NvL3Rva2VuQnlUb2tlbicsCiAgICAgICAgbWV0aG9kOiAncG9zdCcsCiAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICB0b2tlbjogdGhpcy5hY2Nlc3NUb2tlbgogICAgICAgIH0sCiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgQXV0aG9yaXphdGlvbjogJ0Jhc2ljIGIzVjBkMjl5YXpwM2NHY3lNREl3JwogICAgICAgIH0KICAgICAgfSkudGhlbihyZXMgPT4gewogICAgICAgIGlmIChyZXMuc3RhdHVzID09IDIwMCkgewogICAgICAgICAgdGhpcy5mb3JtVG9rZW4gPSByZXMuZGF0YS5yZXN1bHREYXRhLnRva2VuOwogICAgICAgICAgdGhpcy5oZWFkZXIgPSB7CiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsCiAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICdCZWFyZXIgJyArIHRoaXMuZm9ybVRva2VuCiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgLy8g6Zeu6aKY5LiK5oqlKHNtYWxsVHlwZTogJ2Fibm9ybWFsX2luZm9ybScp44CB6K6+5pa957y66Zm3KHNtYWxsVHlwZTogImRlZmVjdCIp5L2/55So5ZCM5LiA5o6l5Y+jCiAgICBhc3luYyBnZXRQcm9ibGVtRGF0YUxpc3QocGFyYW1zKSB7CiAgICAgIHRoaXMucHJvYmxlbURhdGFMaXN0MSA9IFtdOwogICAgICB0aGlzLnByb2JsZW1EYXRhTGlzdDIgPSBbXTsKICAgICAgbGV0IGNvbW1vblBhcmFtcyA9IE9iamVjdC5hc3NpZ24oewogICAgICAgIHN5c0NvZGU6ICdvdXR3b3JrJywKICAgICAgICAvLyB0b2tlbjogdGhpcy5hY2Nlc3NUb2tlbiwKICAgICAgICBwYWdlOiB7CiAgICAgICAgICBjdXJyZW50OiAxLAogICAgICAgICAgc2l6ZTogOTk5OTkgLy8g5p+l5YWo6YOoCiAgICAgICAgfQogICAgICB9LCBwYXJhbXMpOwogICAgICAvLyDpl67popjkuIrmiqUKICAgICAgbGV0IHBhcmFtczEgPSB7CiAgICAgICAgLi4uY29tbW9uUGFyYW1zLAogICAgICAgIHNtYWxsVHlwZTogJ2Fibm9ybWFsX2luZm9ybScKICAgICAgfTsKICAgICAgLy8g6K6+5pa957y66Zm3CiAgICAgIGxldCBwYXJhbXMyID0gewogICAgICAgIC4uLmNvbW1vblBhcmFtcywKICAgICAgICBzbWFsbFR5cGU6ICdkZWZlY3QnCiAgICAgIH07CiAgICAgIGxldCBwcm9ibGVtUG9pbnRGZWF0dXJlcyA9IFtdOwogICAgICAvLyDpl67popjkuIrmiqUKICAgICAgYXdhaXQgdGhpcy5nZXRBeGlvc0RhdGEocGFyYW1zMSwgdGhpcy5wcm9ibGVtRGF0YUxpc3QxKTsKICAgICAgLy8g6K6+5pa957y66Zm3CiAgICAgIGF3YWl0IHRoaXMuZ2V0QXhpb3NEYXRhKHBhcmFtczIsIHRoaXMucHJvYmxlbURhdGFMaXN0Mik7CiAgICAgIGxldCBhbGxQcm9ibGVtID0gdGhpcy5wcm9ibGVtRGF0YUxpc3QxLmNvbmNhdCh0aGlzLnByb2JsZW1EYXRhTGlzdDIpOwogICAgICBhbGxQcm9ibGVtLmZvckVhY2goaXQgPT4gewogICAgICAgIHByb2JsZW1Qb2ludEZlYXR1cmVzLnB1c2goewogICAgICAgICAgdHlwZTogJ0ZlYXR1cmUnLAogICAgICAgICAgZ2VvbWV0cnk6IHsKICAgICAgICAgICAgdHlwZTogJ1BvaW50JywKICAgICAgICAgICAgY29vcmRpbmF0ZXM6IGl0LmxuZ2xhdAogICAgICAgICAgfSwKICAgICAgICAgIHByb3BlcnRpZXM6IHsKICAgICAgICAgICAgaWQ6IGl0LmlkLAogICAgICAgICAgICB0aXRsZTogaXQudGl0bGUKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSk7CiAgICAgIHRoaXMuJHJlZnMubXltYXAuYWRkSW5zcEV2ZW50TGF5ZXIocHJvYmxlbVBvaW50RmVhdHVyZXMpOwogICAgICB0aGlzLnJlcG9ydERhdGFJc0xvYWRlZCA9IHRydWU7CiAgICB9LAogICAgZ2V0QXhpb3NEYXRhKHBhcmFtcywgcHJvYmxlbURhdGFMaXN0KSB7CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CiAgICAgICAgYXhpb3MoewogICAgICAgICAgdXJsOiBBUEkuVlVFX0FQUF9XUEdfVVJMICsgJy9tYWluL291dHdvcmthcGkvdGlja2V0U3RhdGlzdGljQ2xpZW50L2dldFRpY2tldExpc3QnLAogICAgICAgICAgbWV0aG9kOiAncG9zdCcsCiAgICAgICAgICBkYXRhOiBwYXJhbXMsCiAgICAgICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcgogICAgICAgIH0pLnRoZW4ocmVzID0+IHsKICAgICAgICAgIGlmIChyZXMuc3RhdHVzID09IDIwMCkgewogICAgICAgICAgICByZXMuZGF0YS5yZXN1bHREYXRhLnJlY29yZHMuZm9yRWFjaChpdGVtID0+IHsKICAgICAgICAgICAgICB2YXIgX2l0ZW0kZm9ybVZhbHVlLCBfaXRlbSRmb3JtVmFsdWUyLCBfaXRlbSRmb3JtVmFsdWUzOwogICAgICAgICAgICAgIHByb2JsZW1EYXRhTGlzdC5wdXNoKHsKICAgICAgICAgICAgICAgIGlkOiBpdGVtLmlkLAogICAgICAgICAgICAgICAgLy8g5bel5Y2VSUQKICAgICAgICAgICAgICAgIHRpdGxlOiBpdGVtLnRpdGxlLAogICAgICAgICAgICAgICAgLy8g5bel5Y2V5qCH6aKYCiAgICAgICAgICAgICAgICB0aWNrZXRTdGF0dXNOYW1lOiBpdGVtLnRpY2tldFN0YXR1c05hbWUsCiAgICAgICAgICAgICAgICBoYW5kbGVUeXBlOiBpdGVtLmZvcm1WYWx1ZS5oYW5kbGVUeXBlLAogICAgICAgICAgICAgICAgLy8g5o+P6L+wCiAgICAgICAgICAgICAgICBjcmVhdGVCeU5hbWU6IGl0ZW0uY3JlYXRlQnlOYW1lLAogICAgICAgICAgICAgICAgLy8g5Yib5bu65Lq6CiAgICAgICAgICAgICAgICBjcmVhdGVUaW1lOiBpdGVtLmNyZWF0ZVRpbWUuc3Vic3RyaW5nKDAsIDEwKSwKICAgICAgICAgICAgICAgIC8vIOWIm+W7uuaXtumXtAogICAgICAgICAgICAgICAgZGVmZWN0RnJvbTogaXRlbS5mb3JtVmFsdWUuZGVmZWN0RnJvbSwKICAgICAgICAgICAgICAgIGZhdWx0VHlwZXM6IGl0ZW0uZm9ybVZhbHVlLmZhdWx0VHlwZXMsCiAgICAgICAgICAgICAgICBmaWxlVXJsOiAoX2l0ZW0kZm9ybVZhbHVlID0gaXRlbS5mb3JtVmFsdWUpID09PSBudWxsIHx8IF9pdGVtJGZvcm1WYWx1ZSA9PT0gdm9pZCAwIHx8IChfaXRlbSRmb3JtVmFsdWUgPSBfaXRlbSRmb3JtVmFsdWUuaGFuZGxlSW1ncykgPT09IG51bGwgfHwgX2l0ZW0kZm9ybVZhbHVlID09PSB2b2lkIDAgfHwgKF9pdGVtJGZvcm1WYWx1ZSA9IF9pdGVtJGZvcm1WYWx1ZVswXSkgPT09IG51bGwgfHwgX2l0ZW0kZm9ybVZhbHVlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfaXRlbSRmb3JtVmFsdWUuZmlsZVVybCwKICAgICAgICAgICAgICAgIC8vIOWbvueJh+WcsOWdgAogICAgICAgICAgICAgICAgdXJsOiAoX2l0ZW0kZm9ybVZhbHVlMiA9IGl0ZW0uZm9ybVZhbHVlKSA9PT0gbnVsbCB8fCBfaXRlbSRmb3JtVmFsdWUyID09PSB2b2lkIDAgfHwgKF9pdGVtJGZvcm1WYWx1ZTIgPSBfaXRlbSRmb3JtVmFsdWUyLmZpbGVzKSA9PT0gbnVsbCB8fCBfaXRlbSRmb3JtVmFsdWUyID09PSB2b2lkIDAgfHwgKF9pdGVtJGZvcm1WYWx1ZTIgPSBfaXRlbSRmb3JtVmFsdWUyWzBdKSA9PT0gbnVsbCB8fCBfaXRlbSRmb3JtVmFsdWUyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfaXRlbSRmb3JtVmFsdWUyLnVybCwKICAgICAgICAgICAgICAgIC8vIOWPkeeUn+e7j+e6rOW6pgogICAgICAgICAgICAgICAgbG5nbGF0OiBbaXRlbS5hcHBlYWxMbmcsIGl0ZW0uYXBwZWFsTGF0XSwKICAgICAgICAgICAgICAgIGRldmljZV90eXBlOiAoKF9pdGVtJGZvcm1WYWx1ZTMgPSBpdGVtLmZvcm1WYWx1ZSkgPT09IG51bGwgfHwgX2l0ZW0kZm9ybVZhbHVlMyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2l0ZW0kZm9ybVZhbHVlMy5kZXZpY2VfdHlwZSkgfHwgW10sCiAgICAgICAgICAgICAgICBxdWVzdGlvbkRlc2NyaWJlOiBpdGVtLmZvcm1WYWx1ZS5xdWVzdGlvbkRlc2NyaWJlCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXNvbHZlKCk7CiAgICAgICAgICB9CiAgICAgICAgICAvLyBwcm9ibGVtRGF0YUxpc3QuZm9yRWFjaCgoaXRlbSkgPT4gewogICAgICAgICAgLy8gICAvLyBjb25zb2xlLmxvZygn5Zu+54mH5Zyw5Z2AJywgaXRlbS51cmwpCiAgICAgICAgICAvLyB9KQogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICAvLyDpl67popjkuIrmiqXngrnlh7vmoIfpopjjgIHorr7mlr3nvLrpmbfngrnlh7vljaHniYfov5vlhaXor6bmg4XpobUKICAgIHRvRGV0YWlsUGFuZWwoY2FyZERldGFpbCkgewogICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICdodHRwOi8vMTcyLjIwLjc5LjcwL291dHdvcmtBcHAvIy9wYWdlcy90aWNrZXQvZGV0YWlsL2luZGV4P2lkPScgKyBjYXJkRGV0YWlsLmlkICsgJyZzeXNDb2RlPW91dHdvcmsnICsgJyZ0b2tlbj0nICsgdGhpcy5mb3JtVG9rZW47CiAgICB9LAogICAgLy8g5Y2h54mH5a6a5L2NCiAgICBmbHlUb1BvaW50KGxuZ2xhdCkgewogICAgICBtYXBPYmoubWFwLmZseVRvKHsKICAgICAgICBjZW50ZXI6IGxuZ2xhdCwKICAgICAgICB6b29tOiAxNy41CiAgICAgIH0pOwogICAgfSwKICAgIC8vIOS4iuaKpQogICAgcmVwb3J0Q2xpY2soKSB7CiAgICAgIGlmICh0aGlzLnJlcG9ydERhdGFJc0xvYWRlZCkgewogICAgICAgIHRoaXMucmVwb3J0U2hvdyA9IHRydWU7CiAgICAgICAgbWFwT2JqLm1hcC5zZXRMYXlvdXRQcm9wZXJ0eSgnZXZlbnRQb2ludHNMYXllcicsICd2aXNpYmlsaXR5JywgJ3Zpc2libGUnKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBUb2FzdCh7CiAgICAgICAgICBtZXNzYWdlOiAn5LiK5oql5pWw5o2u5Yqg6L295Lit44CC44CC44CCJywKICAgICAgICAgIGR1cmF0aW9uOiAxNTAwCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICB9LAogICAgaGFuZGxlQ2xvc2UoKSB7CiAgICAgIG1hcE9iai5tYXAuc2V0TGF5b3V0UHJvcGVydHkoJ2V2ZW50UG9pbnRzTGF5ZXInLCAndmlzaWJpbGl0eScsICdub25lJyk7CiAgICB9LAogICAgZmlsZUNoYW5nZShmaWxlKSB7CiAgICAgIHRoaXMuc2lnbkZvcm0uaW5zcEltYWdlc0xpc3QgPSBbXTsKICAgICAgZmlsZS5maWxlTGlzdC5mb3JFYWNoKGl0ID0+IHsKICAgICAgICB0aGlzLnNpZ25Gb3JtLmluc3BJbWFnZXNMaXN0LnB1c2goewogICAgICAgICAgZmlsZUlkOiBpdC5yZXNwb25zZS5ncm91cFRva2VuLAogICAgICAgICAgaW1hZ2VzTmFtZTogaXQudXJsCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgICBjb25zb2xlLmxvZyh0aGlzLnNpZ25Gb3JtKTsKICAgIH0sCiAgICBhc3luYyBlbmRUYXNrKCkgewogICAgICBpZiAodGhpcy5pc1ZpZXcpIHsKICAgICAgICBUb2FzdCh7CiAgICAgICAgICBtZXNzYWdlOiAn6K+l5beh5qOA5Lu75Yqh5bey57uT5p2fJywKICAgICAgICAgIGR1cmF0aW9uOiAxNTAwCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGF3YWl0IHRoaXMuZ2V0VGFza0J5SWQodGhpcy4kcm91dGUucXVlcnkudGFza0lkKTsKICAgICAgbGV0IGhhc0luc3BLcCA9IHRoaXMuY2hhbmdlVG9JbnNwQ291bnQodGhpcy50YXNrRGV0YWlsLnJlcG9ydFJhdGUpOwogICAgICBsZXQgYWxsSW5zcEtwID0gdGhpcy5jaGFuZ2VUb0FsbEluc3BDb3VudCh0aGlzLnRhc2tEZXRhaWwucmVwb3J0UmF0ZSk7CiAgICAgIERpYWxvZy5jb25maXJtKHsKICAgICAgICB0aXRsZTogJ+aPkOekuicsCiAgICAgICAgbWVzc2FnZTogYOaCqOi/mOaciSR7YWxsSW5zcEtwIC0gaGFzSW5zcEtwfeS4quWFs+mUrueCueacquaJk+WNoe+8jOehruWumue7k+adn+W3oeajgOS7u+WKoe+8n2AKICAgICAgfSkudGhlbigoKSA9PiB7CiAgICAgICAgdGhpcy5lbmRSZWNvcmRDb25maXJtKCd0YXNrJyk7CiAgICAgIH0pLmNhdGNoKCgpID0+IHsKICAgICAgICB0aGlzLmVuZFJlY29yZENhbmNlbCgpOwogICAgICB9KTsKICAgIH0sCiAgICBvcGVuUG9wdXAoKSB7CiAgICAgIHRoaXMuc2hvd1BvcG92ZXIgPSB0cnVlOwogICAgfSwKICAgIG9uU2VsZWN0KHZhbCkgewogICAgICBpZiAodGhpcy5pc1ZpZXcpIHsKICAgICAgICBUb2FzdCh7CiAgICAgICAgICBtZXNzYWdlOiAn6K+l5beh5qOA5Lu75Yqh5bey57uT5p2fJywKICAgICAgICAgIGR1cmF0aW9uOiAnMTUwMCcKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgLy8gVG9hc3QoewogICAgICAvLyAgIG1lc3NhZ2U6ICfor7flnKjlnLDlm77kuIrpgInmi6norr7mlr3miJbogIXngrnkvY0nLAogICAgICAvLyAgIGR1cmF0aW9uOiAxNTAwCiAgICAgIC8vIH0pOwogICAgICB0aGlzLmlmVGlwcyA9IHRydWU7CiAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIHRoaXMuaWZUaXBzID0gZmFsc2U7CiAgICAgIH0sIDI1MDApOwogICAgICBtYXBPYmoubWFwLm9mZignY2xpY2snLCAna2V5cG9pbnRzTGF5ZXInLCB0aGlzLiRyZWZzLm15bWFwLnNpZ25JbkJ1ZmZlcik7CiAgICAgIHZhbC50ZXh0ID09ICfpl67popjkuIrmiqUnID8gbWFwT2JqLm1hcC5vbignY2xpY2snLCB0aGlzLnNlbGVjdFJlcG9ydFBvaW50KSA6IG1hcE9iai5tYXAub24oJ2NsaWNrJywgdGhpcy5zZWxlY3RGbGF3UG9pbnQpOwogICAgfSwKICAgIHNlbGVjdFJlcG9ydFBvaW50KGUpIHsKICAgICAgbGV0IGZlYXR1cmVzID0gbWFwT2JqLm1hcC5xdWVyeVJlbmRlcmVkRmVhdHVyZXMoZS5wb2ludCk7CiAgICAgIGNvbnNvbGUubG9nKGZlYXR1cmVzKTsKICAgICAgaWYgKGZlYXR1cmVzLmxlbmd0aCA+IDApIHsKICAgICAgICBpZiAoZmVhdHVyZXNbMF0uc291cmNlICE9ICJpbnNwVXNlciIgJiYgZmVhdHVyZXNbMF0uc291cmNlICE9ICJpbml0SW5zcExpbmVTb3VyY2UiICYmIGZlYXR1cmVzWzBdLnNvdXJjZSAhPSAia2V5cG9pbnRzIiAmJiBmZWF0dXJlc1swXS5nZW9tZXRyeS50eXBlID09PSAiUG9pbnQiKSB7CiAgICAgICAgICB0aGlzLiRyZWZzLm15bWFwLmFkZEV2ZW50T2JqTWFya2VyKGZlYXR1cmVzWzBdLCAnZXZlbnQnLCB7CiAgICAgICAgICAgIGdyaWRJZDogdGhpcy5wbGFuRGV0YWlsLmdyaWRJZCwKICAgICAgICAgICAgZ3JpZE5hbWU6IHRoaXMucGxhbkRldGFpbC5ncmlkTmFtZQogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIGlmIChmZWF0dXJlcy5sZW5ndGggPiAxICYmIGZlYXR1cmVzWzFdLnNvdXJjZSAhPSAiZXZlbnRQb2ludHMiICYmIGZlYXR1cmVzWzFdLnNvdXJjZSAhPSAiaW5zcFVzZXIiICYmIGZlYXR1cmVzWzFdLnNvdXJjZSAhPSAia2V5cG9pbnRzIiAmJiBmZWF0dXJlc1sxXS5nZW9tZXRyeS50eXBlID09PSAiUG9pbnQiKSB7CiAgICAgICAgICB0aGlzLiRyZWZzLm15bWFwLmFkZEV2ZW50T2JqTWFya2VyKGZlYXR1cmVzWzFdLCAnZXZlbnQnLCB7CiAgICAgICAgICAgIGdyaWRJZDogdGhpcy5wbGFuRGV0YWlsLmdyaWRJZCwKICAgICAgICAgICAgZ3JpZE5hbWU6IHRoaXMucGxhbkRldGFpbC5ncmlkTmFtZQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIG1hcE9iai5tYXAub24oJ2NsaWNrJywgJ2tleXBvaW50c0xheWVyJywgdGhpcy4kcmVmcy5teW1hcC5zaWduSW5CdWZmZXIpOwogICAgICBtYXBPYmoubWFwLm9mZignY2xpY2snLCB0aGlzLnNlbGVjdFJlcG9ydFBvaW50KTsKICAgIH0sCiAgICBzZWxlY3RGbGF3UG9pbnQoZSkgewogICAgICBsZXQgZmVhdHVyZXMgPSBtYXBPYmoubWFwLnF1ZXJ5UmVuZGVyZWRGZWF0dXJlcyhlLnBvaW50KTsKICAgICAgY29uc29sZS5sb2coZmVhdHVyZXMpOwogICAgICBpZiAoZmVhdHVyZXMubGVuZ3RoID4gMCkgewogICAgICAgIGlmIChmZWF0dXJlc1swXS5zb3VyY2UgIT0gImV2ZW50UG9pbnRzIiAmJiBmZWF0dXJlc1swXS5zb3VyY2UgIT0gImluc3BVc2VyIiAmJiBmZWF0dXJlc1swXS5zb3VyY2UgIT0gImluaXRJbnNwTGluZVNvdXJjZSIgJiYgZmVhdHVyZXNbMF0uc291cmNlICE9ICJrZXlwb2ludHMiICYmIGZlYXR1cmVzWzBdLmdlb21ldHJ5LnR5cGUgPT09ICJQb2ludCIpIHsKICAgICAgICAgIHRoaXMuJHJlZnMubXltYXAuYWRkRXZlbnRPYmpNYXJrZXIoZmVhdHVyZXNbMF0sICdmbGF3JywgewogICAgICAgICAgICBncmlkSWQ6IHRoaXMucGxhbkRldGFpbC5ncmlkSWQsCiAgICAgICAgICAgIGdyaWROYW1lOiB0aGlzLnBsYW5EZXRhaWwuZ3JpZE5hbWUKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSBpZiAoZmVhdHVyZXMubGVuZ3RoID4gMSAmJiBmZWF0dXJlc1sxXS5zb3VyY2UgIT0gImV2ZW50UG9pbnRzIiAmJiBmZWF0dXJlc1sxXS5zb3VyY2UgIT0gImluc3BVc2VyIiAmJiBmZWF0dXJlc1sxXS5zb3VyY2UgIT0gImtleXBvaW50cyIgJiYgZmVhdHVyZXNbMV0uZ2VvbWV0cnkudHlwZSA9PT0gIlBvaW50IikgewogICAgICAgICAgdGhpcy4kcmVmcy5teW1hcC5hZGRFdmVudE9iak1hcmtlcihmZWF0dXJlc1sxXSwgJ2ZsYXcnLCB7CiAgICAgICAgICAgIGdyaWRJZDogdGhpcy5wbGFuRGV0YWlsLmdyaWRJZCwKICAgICAgICAgICAgZ3JpZE5hbWU6IHRoaXMucGxhbkRldGFpbC5ncmlkTmFtZQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIG1hcE9iai5tYXAub24oJ2NsaWNrJywgJ2tleXBvaW50c0xheWVyJywgdGhpcy4kcmVmcy5teW1hcC5zaWduSW5CdWZmZXIpOwogICAgICBtYXBPYmoubWFwLm9mZignY2xpY2snLCB0aGlzLnNlbGVjdEZsYXdQb2ludCk7CiAgICB9LAogICAgZ2V0UmVzdFRpbWUodGltZSkgewogICAgICByZXR1cm4gdGltZSA/IG5ldyBEYXRlKHRpbWUpLmdldFRpbWUoKSAtIG5ldyBEYXRlKCkuZ2V0VGltZSgpIDogMDsKICAgIH0sCiAgICBjaGFuZ2VUb0luc3BDb3VudChyZXBvcnRSYXRlKSB7CiAgICAgIGlmIChyZXBvcnRSYXRlLmluY2x1ZGVzKCcvJykpIHsKICAgICAgICByZXR1cm4gTnVtYmVyKHJlcG9ydFJhdGUuc3BsaXQoJy8nKVswXSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIDA7CiAgICAgIH0KICAgIH0sCiAgICBjaGFuZ2VUb0FsbEluc3BDb3VudChyZXBvcnRSYXRlKSB7CiAgICAgIGlmIChyZXBvcnRSYXRlLmluY2x1ZGVzKCcvJykpIHsKICAgICAgICByZXR1cm4gTnVtYmVyKHJlcG9ydFJhdGUuc3BsaXQoJy8nKVsxXSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIDA7CiAgICAgIH0KICAgIH0sCiAgICBjaGFuZ2VUb1JhdGUoY292ZXJhZ2UpIHsKICAgICAgaWYgKGNvdmVyYWdlLmluY2x1ZGVzKCcvJykpIHsKICAgICAgICBsZXQgaW5zcCA9IE51bWJlcihjb3ZlcmFnZS5zcGxpdCgnLycpWzBdKTsKICAgICAgICBsZXQgdW5pbnNwID0gTnVtYmVyKGNvdmVyYWdlLnNwbGl0KCcvJylbMV0pOwogICAgICAgIGlmICh1bmluc3ApIHsKICAgICAgICAgIHJldHVybiAoaW5zcCAvIHVuaW5zcCAqIDEwMCkudG9GaXhlZCgyKSArICclJzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmV0dXJuICcwJSc7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiAnMCUnOwogICAgICB9CiAgICB9LAogICAgbWFwTG9hZGVkKG1hcEluc3RhbmNlKSB7CiAgICAgIGNvbnNvbGUubG9nKCdtYXBMb2FkZWRkZGRkZGRkJyk7CiAgICAgIGxldCB0aGF0ID0gdGhpczsKICAgICAgbWFwT2JqLm1hcEluc3RhbmNlID0gbWFwSW5zdGFuY2U7CiAgICAgIG1hcE9iai5tYXAgPSBtYXBJbnN0YW5jZS5tYXA7CiAgICAgIC8vIHRoaXMuJHJlZnMubXltYXAuc2V0SW5zcFVzZXJQb3NpdGlvbih7CiAgICAgIC8vICAgbG9uZ2l0dWRlOiAxMTUuODU0NTYzLAogICAgICAvLyAgIGxhdGl0dWRlOiAzOS4wNDM0MDcKICAgICAgLy8gfSkKICAgICAgeXVhbmNodS5sb2NhdGlvbkFNYXAucmVxdWVzdFNpbmdsZUxvY2F0aW9uKFsnMSddLCByZXMgPT4gewogICAgICAgIHRoYXQuY3VycmVudFBvc2l0aW9uID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShyZXMpKTsKICAgICAgICBjb25zdCBwYXJhbSA9IHsKICAgICAgICAgIC4uLnRoYXQuY3VycmVudFBvc2l0aW9uCiAgICAgICAgfTsKICAgICAgICB0aGlzLiRyZWZzLm15bWFwLnNldEluc3BVc2VyUG9zaXRpb24ocGFyYW0pOwogICAgICB9LCBlcnIgPT4gewogICAgICAgIGNvbnNvbGUubG9nKCdlcnI9JywgZXJyKTsKICAgICAgfSk7CiAgICB9LAogICAgLy8g5Yi35paw5Zyw5Zu+CiAgICByZWZyZXNoTWFwKCkgewogICAgICB0cnkgewogICAgICAgIHRoaXMuY2xlYXJCdWZmZXJUcmFjaygpOwogICAgICAgIC8vIOa4heepuuaJgOacieeahHBvcHVwCiAgICAgICAgbGV0IGNsYXNzTmFtZXMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdtYXBib3hnbC1wb3B1cC1hbmNob3ItYm90dG9tJyk7CiAgICAgICAgZm9yIChsZXQgaSA9IGNsYXNzTmFtZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHsKICAgICAgICAgIGlmIChjbGFzc05hbWVzW2ldICE9IG51bGwpIHsKICAgICAgICAgICAgY2xhc3NOYW1lc1tpXS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGNsYXNzTmFtZXNbaV0pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAvLyDmuIXnqbrmiYDmnInlhbPplK7ngrltYXJrZXIKICAgICAgICBsZXQgaWRzID0gW107CiAgICAgICAgdGhpcy5rZXlEZXRhaWxMaXN0LmZvckVhY2goaXRlbSA9PiB7CiAgICAgICAgICBpZiAoaXRlbS5lbmdJbmZvRFRPKSB7CiAgICAgICAgICAgIGlkcy5wdXNoKGl0ZW0uZW5nSW5mb0RUTy5lbmdJZCk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgbWFwT2JqLm1hcEluc3RhbmNlICYmIHRoaXMuJHJlZnMubXltYXAucmVtb3ZlS2V5UG9pbnRNYXJrZXIoaWRzKTsKICAgICAgICAvLyDmuIXnqbrlt6Hmo4DojIPlm7Tlm77lsYIKICAgICAgICBtYXBPYmoubWFwLmdldFNvdXJjZSgncmFuZ2VTb3VyY2UnKSAmJiBtYXBPYmoubWFwSW5zdGFuY2Uuc2V0U291cmNlRGF0YSgncmFuZ2VTb3VyY2UnLCB7CiAgICAgICAgICB0eXBlOiAnRmVhdHVyZUNvbGxlY3Rpb24nLAogICAgICAgICAgZmVhdHVyZXM6IFtdCiAgICAgICAgfSk7CiAgICAgICAgLy8g5riF56m65beh5qOA566h57q/5Zu+5bGCCiAgICAgICAgbWFwT2JqLm1hcC5nZXRTb3VyY2UoJ2luaXRJbnNwTGluZVNvdXJjZScpICYmIG1hcE9iai5tYXBJbnN0YW5jZS5zZXRTb3VyY2VEYXRhKCdpbml0SW5zcExpbmVTb3VyY2UnLCB7CiAgICAgICAgICB0eXBlOiAnRmVhdHVyZUNvbGxlY3Rpb24nLAogICAgICAgICAgZmVhdHVyZXM6IFtdCiAgICAgICAgfSk7CiAgICAgICAgbWFwT2JqLm1hcC5nZXRTb3VyY2UoJ3VuSW5zcExpbmVTb3VyY2UnKSAmJiBtYXBPYmoubWFwSW5zdGFuY2Uuc2V0U291cmNlRGF0YSgndW5JbnNwTGluZVNvdXJjZScsIHsKICAgICAgICAgIHR5cGU6ICdGZWF0dXJlQ29sbGVjdGlvbicsCiAgICAgICAgICBmZWF0dXJlczogW10KICAgICAgICB9KTsKICAgICAgICBtYXBPYmoubWFwLmdldFNvdXJjZSgnaW5zcExpbmVTb3VyY2UnKSAmJiBtYXBPYmoubWFwSW5zdGFuY2Uuc2V0U291cmNlRGF0YSgnaW5zcExpbmVTb3VyY2UnLCB7CiAgICAgICAgICB0eXBlOiAnRmVhdHVyZUNvbGxlY3Rpb24nLAogICAgICAgICAgZmVhdHVyZXM6IFtdCiAgICAgICAgfSk7CiAgICAgICAgbWFwT2JqLm1hcC5nZXRTb3VyY2UoJ2luc3BVc2VyTGluZVNvdXJjZScpICYmIG1hcE9iai5tYXBJbnN0YW5jZS5zZXRTb3VyY2VEYXRhKCdpbnNwVXNlckxpbmVTb3VyY2UnLCB7CiAgICAgICAgICB0eXBlOiAnRmVhdHVyZUNvbGxlY3Rpb24nLAogICAgICAgICAgZmVhdHVyZXM6IFtdCiAgICAgICAgfSk7CiAgICAgICAgbWFwT2JqLm1hcC5nZXRTb3VyY2UoJ2luc3BVc2VyJykgJiYgbWFwT2JqLm1hcEluc3RhbmNlLnNldFNvdXJjZURhdGEoJ2luc3BVc2VyJywgewogICAgICAgICAgdHlwZTogJ0ZlYXR1cmVDb2xsZWN0aW9uJywKICAgICAgICAgIGZlYXR1cmVzOiBbXQogICAgICAgIH0pOwogICAgICAgIG1hcE9iai5tYXAuZ2V0U291cmNlKCdidWZmZXJlZCcpICYmIG1hcE9iai5tYXBJbnN0YW5jZS5zZXRTb3VyY2VEYXRhKCdidWZmZXJlZCcsIHsKICAgICAgICAgIHR5cGU6ICdGZWF0dXJlQ29sbGVjdGlvbicsCiAgICAgICAgICBmZWF0dXJlczogW10KICAgICAgICB9KTsKICAgICAgICAvLyDlpoLmnpzlrZjlnKjkuovku7blm77lsYLvvIzlsLHnp7vpmaTor6Xlm77lsYIKICAgICAgICBtYXBPYmoubWFwLmdldExheWVyKCdldmVudFBvaW50c0xheWVyJykgJiYgbWFwT2JqLm1hcC5yZW1vdmVMYXllcignZXZlbnRQb2ludHNMYXllcicpOwogICAgICAgIG1hcE9iai5tYXAuZ2V0U291cmNlKCdldmVudFBvaW50cycpICYmIG1hcE9iai5tYXAucmVtb3ZlU291cmNlKCdldmVudFBvaW50cycpOwogICAgICAgIHRoaXMuJHJlZnMubXltYXAucmVtb3ZlRXZlbnRPYmpNYXJrZXIoKTsKICAgICAgICB0aGlzLiRyZWZzLm15bWFwLnJlbW92ZVJhbmdlTVZUKCk7CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5sb2coZXJyb3IpOwogICAgICB9CiAgICB9LAogICAgLy8g5Yi35paw5Lu75YqhCiAgICByZWZyZXNoVGFzaygpIHsKICAgICAgLy8gbGV0IGlkcyA9IFtdCiAgICAgIC8vIHRoaXMua2V5RGV0YWlsTGlzdC5mb3JFYWNoKChpdGVtKSA9PiB7CiAgICAgIC8vICAgaWYgKGl0ZW0uZW5nSW5mb0RUTykgewogICAgICAvLyAgICAgaWRzLnB1c2goaXRlbS5lbmdJbmZvRFRPLmVuZ0lkKQogICAgICAvLyAgIH0KICAgICAgLy8gfSkKICAgICAgLy8gbWFwT2JqLm1hcEluc3RhbmNlICYmIHRoaXMuJHJlZnMubXltYXAucmVtb3ZlS2V5UG9pbnRNYXJrZXIoaWRzKQogICAgICBjb25zdCBpZCA9IHRoaXMuJHJvdXRlLnF1ZXJ5LnRhc2tJZDsKICAgICAgdGhpcy5nZXRUYXNrQnlJZChpZCwgJ3JlZnJlc2gnKTsKICAgICAgLy8gYXdhaXQgdGhpcy5nZXRBcHBJbnNwRGF0YShpZCkKICAgIH0sCiAgICBhc3luYyBnZXRUcmFja1JlY29yZHNCeUlkKGlkKSB7CiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHJlcXVlc3QoewogICAgICAgIHVybDogJy94YXN3LXBpcGUtb3BlcmF0aW9uL2luc3BUYXNrL3RyYWNrJywKICAgICAgICBtZXRob2Q6ICdnZXQnLAogICAgICAgIHBhcmFtczogewogICAgICAgICAgaWQsCiAgICAgICAgICBwYWdlTnVtOiAxLAogICAgICAgICAgcGFnZVNpemU6IDk5OTkKICAgICAgICB9CiAgICAgIH0pOwogICAgICBpZiAocmVzICYmIHJlcy5zdGF0dXMpIHsKICAgICAgICBjb25zb2xlLmxvZyhyZXMpOwogICAgICB9CiAgICB9LAogICAgLy8g5qC55o2u5Lu75YqhaWTojrflj5blt6Hmo4DnirblhrUKICAgIGFzeW5jIGdldFRhc2tCeUlkKGlkLCB0eXBlID0gbnVsbCkgewogICAgICBUb2FzdC5sb2FkaW5nKHsKICAgICAgICBtZXNzYWdlOiAn5Zyw5Zu+5Yqg6L295LitLi4uJywKICAgICAgICBmb3JiaWRDbGljazogdHJ1ZQogICAgICB9KTsKICAgICAgdGhpcy5pc01hc2sgPSB0cnVlOwogICAgICAvLyBhd2FpdCB0aGlzLnBvc3RBcHBEYXRhKGlkKTsKICAgICAgLy8g5aSE55CG5bey5beh5qOA566h57q/55qE5o6l5Y+jCiAgICAgIGNvbnN0IHJlY29yZExpbmVzID0gYXdhaXQgYXBpLnJlY29yZGVkUGlwZUxpbmUoewogICAgICAgIHRhc2tJZDogaWQsCiAgICAgICAgcGFnZTogMSwKICAgICAgICBzaXplOiA5OTk5CiAgICAgIH0pOwogICAgICB0aGlzLmxpbmVzID0gW107CiAgICAgIGlmIChyZWNvcmRMaW5lcy5zdGF0dXMpIHsKICAgICAgICB0aGlzLmxpbmVzID0gcmVjb3JkTGluZXMuZGF0YS5yZWNvcmRzLm1hcChpdGVtID0+IGl0ZW0ucGlwZUlkKTsKICAgICAgfQogICAgICB0aGlzLnJlcG9ydEZvb3RlclNob3cgPSBmYWxzZTsgLy8g5LqL5Lu25LiK5oql5by556qX5byA5YWzCiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHJlcXVlc3QoewogICAgICAgIHVybDogJy94YXN3LXBpcGUtb3BlcmF0aW9uL2luc3BUYXNrL2dldEJ5SWQnLAogICAgICAgIG1ldGhvZDogJ2dldCcsCiAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICBpZAogICAgICAgIH0KICAgICAgfSk7CiAgICAgIC8vIGxldCBwb2ludCA9IHR1cmYucG9pbnQoWzExNS44NTQ1NDYsIDM5LjA0MzQxNV0pCiAgICAgIC8vIHRoaXMuJHJlZnMubXltYXAuZHJhd0J1ZmZlcihwb2ludCwgNSkKICAgICAgaWYgKHJlcyAmJiByZXMuc3RhdHVzKSB7CiAgICAgICAgdGhpcy50YXNrRGV0YWlsID0gcmVzLmRhdGEuaW5zcFRhc2s7CiAgICAgICAgdGhpcy5wbGFuRGV0YWlsID0gcmVzLmRhdGEuaW5zcFBsYW47CiAgICAgICAgdGhpcy5pbnNwUmFuZ2VMaXN0ID0gcmVzLmRhdGEuZGV0YWlsTGlzdC5tYXAocmFuZ2UgPT4gewogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgdGFza0lkOiBpZCwKICAgICAgICAgICAgLi4ucmFuZ2UKICAgICAgICAgIH07CiAgICAgICAgfSk7CiAgICAgICAgLy8g5L+u5pS55pyq5beh5qOAKDAp5Lu75Yqh54q25oCB6Iez5beh5qOA5LitKDEpCiAgICAgICAgaWYgKHRoaXMuJHJvdXRlLnF1ZXJ5LmlzTmV3ICYmIHRoaXMudGFza0RldGFpbC50YXNrU3RhdHVzICE9IDEpIHsKICAgICAgICAgIHRoaXMuc3RyYXRPckVuZFRhc2tSZWNvcmQoMSk7CiAgICAgICAgfQogICAgICAgIGlmICh0eXBlICE9ICdyZWZyZXNoJykgewogICAgICAgICAgY29uc3QgYWxsVGFza0xpbmVzID0gYXdhaXQgYXBpLmdldEFsbFRhc2tMaW5lcyh7CiAgICAgICAgICAgIGRldlR5cGU6ICfnrqHnur8nLAogICAgICAgICAgICBncmlkSWQ6IHRoaXMucGxhbkRldGFpbC5ncmlkSWQsCiAgICAgICAgICAgIHBhZ2VOdW06IDEsCiAgICAgICAgICAgIHBhZ2VTaXplOiA5OTk5OQogICAgICAgICAgfSk7CiAgICAgICAgICBpZiAoYWxsVGFza0xpbmVzLnN0YXR1cykgewogICAgICAgICAgICBhbGxUYXNrTGluZXMuZGF0YS5saXN0LmZvckVhY2goaXRlbSA9PiB7CiAgICAgICAgICAgICAgdGhpcy5hbGxUYXNrTGluZXMucHVzaCh7CiAgICAgICAgICAgICAgICB0eXBlOiAnRmVhdHVyZScsCiAgICAgICAgICAgICAgICBpZDogaXRlbS5pZCwKICAgICAgICAgICAgICAgIGdlb21ldHJ5OiBKU09OLnBhcnNlKGl0ZW0uZ2VvbSksCiAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7CiAgICAgICAgICAgICAgICAgIGlkOiBpdGVtLmlkLAogICAgICAgICAgICAgICAgICBsZW5ndGg6IGl0ZW1bJ2xlbmd0aCddCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICB0aGlzLiRyZWZzLm15bWFwLnNldEFsbEluc3BMaW5lU291cmNlKHRoaXMuYWxsVGFza0xpbmVzKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgY29uc3Qga3BSZXMgPSBhd2FpdCByZXF1ZXN0KHsKICAgICAgICAgIHVybDogJy94YXN3LXBpcGUtb3BlcmF0aW9uL2luc3BUYXNrL3BvaW50JywKICAgICAgICAgIG1ldGhvZDogJ2dldCcsCiAgICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgICAgaWQsCiAgICAgICAgICAgIGdyaWRJZDogdGhpcy5wbGFuRGV0YWlsLmdyaWRJZCwKICAgICAgICAgICAgcGFnZU51bTogMSwKICAgICAgICAgICAgcGFnZVNpemU6IDk5OTksCiAgICAgICAgICAgIGJpelNjb3BlOiB0aGlzLiRyb3V0ZS5xdWVyeS50YXNrVHlwZQogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIHRoaXMua2V5RGV0YWlsTGlzdCA9IFtdOwogICAgICAgIGlmIChrcFJlcyAmJiBrcFJlcy5zdGF0dXMpIHsKICAgICAgICAgIGxldCBrZXlzID0gT2JqZWN0LmtleXMoa3BSZXMuZGF0YSk7CiAgICAgICAgICBrZXlzLmZvckVhY2goaXRlbSA9PiB7CiAgICAgICAgICAgIHRoaXMua2V5RGV0YWlsTGlzdC5wdXNoKC4uLmtwUmVzLmRhdGFbaXRlbV0ubGlzdCk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgbGV0IGNvbXBsZXRpb24gPSB0aGlzLmNoYW5nZVRvUmF0ZSh0aGlzLnRhc2tEZXRhaWwuY292ZXJhZ2UpOwogICAgICAgIHRoaXMubmF2YmFyVGl0bGUgPSB0aGlzLnRhc2tEZXRhaWwudGFza05hbWU7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIGNvbnN0IHRoYXQgPSB0aGlzOwogICAgICAgICAgbGV0IHRpbWVyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAvLyAzMHPlkI7lj5bmtogKICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aW1lcik7CiAgICAgICAgICAgIH0sIDMwMDAwKTsKICAgICAgICAgICAgaWYgKHRoYXQuJHJlZnMubXltYXAuaXNPbkxvYWRlZCgpKSB7CiAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aW1lcik7CiAgICAgICAgICAgICAgdGhhdC4kcmVmcy5teW1hcC5hZGRLZXlQb2ludHModGhhdC5rZXlEZXRhaWxMaXN0KTsKICAgICAgICAgICAgICBpZiAodHlwZSAhPSAncmVmcmVzaCcpIHsKICAgICAgICAgICAgICAgIHRoYXQuJHJlZnMubXltYXAuYWRkUmFuZ2VMaXN0KHRoYXQuaW5zcFJhbmdlTGlzdCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGNvbnN0IHBhcmFtcyA9IHsKICAgICAgICAgICAgICAgIGV4dFBhcmFtOiB7CiAgICAgICAgICAgICAgICAgIHRhc2tfaWQ6IHRoYXQuJHJvdXRlLnF1ZXJ5LnRhc2tJZAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgLy8gdGhhdC5nZXRFdmVudEFsbChwYXJhbXMpOwogICAgICAgICAgICAgIC8vIOmXrumimOS4iuaKpeOAgeiuvuaWvee8uumZt+aOpeWPowogICAgICAgICAgICAgIHRoYXQuZ2V0UHJvYmxlbURhdGFMaXN0KHBhcmFtcyk7CiAgICAgICAgICAgICAgLy8gbGV0IHJlc2xpbmVzID0gdGhhdC5saW5lcy5jb25jYXQodGhhdC5yZWNvcmREYXRhKTsKICAgICAgICAgICAgICAvLyDlm77lsYLlm57mmL7mlrnlvI/mlLnlj5gKICAgICAgICAgICAgICB0aGF0LiRyZWZzLm15bWFwLmFkZEluc3BSZWNvcmRUaWxlTGluZVNvdXJjZSh0aGF0LmxpbmVzLCBjb21wbGV0aW9uKTsKICAgICAgICAgICAgICBpZiAoIXRoYXQuY3VycmVudFBvc2l0aW9uKSByZXR1cm47CiAgICAgICAgICAgICAgY29uc3QgcGFyYW0gPSB7CiAgICAgICAgICAgICAgICAuLi50aGF0LmN1cnJlbnRQb3NpdGlvbgogICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgdGhhdC4kcmVmcy5teW1hcC5zZXRJbnNwVXNlclBvc2l0aW9uKHBhcmFtKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSwgNTAwKTsKICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICBjb25zb2xlLmxvZyhlKTsKICAgICAgICAgIGlmICh0aGlzLmlzTWFzaykgewogICAgICAgICAgICB0aGlzLmlzTWFzayA9IGZhbHNlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAodGhpcy5pc01hc2spIHsKICAgICAgICAgIHRoaXMuaXNNYXNrID0gZmFsc2U7CiAgICAgICAgfQogICAgICAgIFRvYXN0KHsKICAgICAgICAgIG1lc3NhZ2U6ICfnvZHnu5znirbmgIHovoPlt67vvIzliqDovb3ku7vliqHlpLHotKUnLAogICAgICAgICAgaWNvbjogJ3dhcm4nLAogICAgICAgICAgZHVyYXRpb246IDMwMDAKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIC8vIOiOt+WPluS7jmFwcOerr+S8oOadpeeahOaVsOaNrgogICAgcG9zdEFwcERhdGEoaWQpIHsKICAgICAgbGV0IHRoYXQgPSB0aGlzOwogICAgICByZXR1cm4gbmV3IFByb21pc2UoYXN5bmMgZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIC8qKiAyMDIxLzkvMjIg5Y+W5raI57yT5a2Y5ZyoYXBw56uv55qE5pWw5o2u5LiK5oqlDQogICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoYXQuJGFwaS5wb3N0QWN0aW9uKCIvb3BzLWluc3BlY3Rpb24vYXBpL2luc3BlY3Rpb25SZWNvcmRNdWx0aXBsZSIsIHRoYXQucmVjb3JkRGF0YSk7DQogICAgICAgIGlmIChyZXN1bHQuc3RhdHVzKSB7DQogICAgICAgICAgY29uc29sZS5sb2coIuS4iuaKpee8k+WtmOWcqGFwcOeahOaVsOaNriIpOw0KICAgICAgICB9Ow0KICAgICAgICAqLwogICAgICAgIGlmICh0aGF0LnJlcG9ydEZhaWxUcmFja1BvaW50cy5sZW5ndGggPD0gMCkgewogICAgICAgICAgcmVzb2x2ZSgpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBjb25zdCByZXN1bHQyID0gYXdhaXQgaW5zcGVjdGlvblRyYWNrTXVsdGlwbGUodGhhdC5yZXBvcnRGYWlsVHJhY2tQb2ludHMpOwogICAgICAgIGlmIChyZXN1bHQyICYmIHJlc3VsdDIuc3RhdHVzKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygn5LiK5oql57yT5a2Y5ZyoYXBw56uv55qE6L2o6L+554K55pWw5o2uJyk7CiAgICAgICAgICBsZXQgcmVzZXRUcmFja1BvaW50cyA9IFtdOwogICAgICAgICAgdGhhdC5yZXBvcnRGYWlsVHJhY2tQb2ludHMgPSByZXNldFRyYWNrUG9pbnRzOwogICAgICAgICAgdW5pV2ViVmlldy5wb3N0TWVzc2FnZSh7CiAgICAgICAgICAgIGRhdGE6IHsKICAgICAgICAgICAgICBhY3Rpb246ICdzYXZlVHJhY2tQb2ludHMnLAogICAgICAgICAgICAgIHRyYWNrRGF0YTogSlNPTi5zdHJpbmdpZnkocmVzZXRUcmFja1BvaW50cyksCiAgICAgICAgICAgICAgdGFza0lkOiBpZAogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgcmVzb2x2ZSgpOwogICAgICB9KTsKICAgIH0sCiAgICAvLyDojrflj5blt6Hmo4Dkuovku7YKICAgIGFzeW5jIGdldEV2ZW50QWxsKHBhcmFtcykgewogICAgICBjb25zdCByZXMgPSBhd2FpdCBpbnNwZWN0aW9uRXZlbnRBbGwocGFyYW1zKTsKICAgICAgaWYgKHJlcyAmJiByZXMuc3RhdHVzKSB7CiAgICAgICAgbGV0IGZlYXR1cmVzID0gW107CiAgICAgICAgcmVzLmRhdGEuZm9yRWFjaChpdGVtID0+IHsKICAgICAgICAgIGlmIChpdGVtLmV2ZW50SXRlbVRleHQpIHsKICAgICAgICAgICAgY29uc3QgZ2VvbSA9IEpTT04ucGFyc2UoaXRlbS5ldmVudEl0ZW1UZXh0KTsKICAgICAgICAgICAgbGV0IGZlYXR1cmUgPSB7CiAgICAgICAgICAgICAgZ2VvbWV0cnk6IGdlb20udHlwZSA9PT0gJ0ZlYXR1cmUnID8gZ2VvbS5nZW9tZXRyeSA6IGdlb20sCiAgICAgICAgICAgICAgcHJvcGVydGllczoge30KICAgICAgICAgICAgfTsKICAgICAgICAgICAgdGhpcy4kc2V0KGZlYXR1cmUsICdnZW9tZXRyeScsIHRoaXMuY29tcHV0ZUNlbnRlcihmZWF0dXJlLmdlb21ldHJ5KSk7CiAgICAgICAgICAgIHRoaXMuJHNldChmZWF0dXJlLCAnaWQnLCBpdGVtLmlkKTsKICAgICAgICAgICAgdGhpcy4kc2V0KGZlYXR1cmUucHJvcGVydGllcywgJ2V2ZW50VHlwZScsIGl0ZW0uZXZlbnRUeXBlKTsKICAgICAgICAgICAgLy8gdGhpcy4kc2V0KGZlYXR1cmUsICJldmVudFR5cGUiLCBpdGVtLmV2ZW50VHlwZSk7CiAgICAgICAgICAgIC8vIHRoaXMuJHJlZnMubXltYXAuYWRkSW5zcEV2ZW50TWFya2VyKGZlYXR1cmUpOwogICAgICAgICAgICBmZWF0dXJlcy5wdXNoKGZlYXR1cmUpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIHRoaXMuJHJlZnMubXltYXAuYWRkSW5zcEV2ZW50TGF5ZXIoZmVhdHVyZXMpOwogICAgICB9CiAgICB9LAogICAgLy8g6I635Y+W5LqL5Lu257G75Z6LCiAgICBnZXRFdmVudFR5cGVMaXN0KCkgewogICAgICBnZXRFdmVudFR5cGVMaXN0KCkudGhlbihyZXMgPT4gewogICAgICAgIHRoaXMuZXZlbnRUeXBlTGlzdCA9IHJlcy5kYXRhLnNvbnMubWFwKGl0ZW0gPT4gewogICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgdmFsdWU6IGl0ZW0uY29kZSwKICAgICAgICAgICAgbGFiZWw6IGl0ZW0ubmFtZSwKICAgICAgICAgICAgY2hpbGRyZW46IGl0ZW0uc29ucy5tYXAoaXRlbSA9PiB7CiAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgIHZhbHVlOiBpdGVtLmNvZGUsCiAgICAgICAgICAgICAgICBsYWJlbDogaXRlbS5uYW1lLAogICAgICAgICAgICAgICAgY2hpbGRyZW46IGl0ZW0uc29ucy5tYXAoaXRlbSA9PiB7CiAgICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGl0ZW0uY29kZSwKICAgICAgICAgICAgICAgICAgICBsYWJlbDogaXRlbS5uYW1lCiAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0pCiAgICAgICAgICB9OwogICAgICAgIH0pOwogICAgICB9KS5jYXRjaCgoKSA9PiB7CiAgICAgICAgVG9hc3QoewogICAgICAgICAgbWVzc2FnZTogJ+Wtl+WFuOWKoOi9veWksei0pScKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgLy8g6L2u6K+iIGN1cnJlbnRQb3NpdGlvbu+8jOe7mOWItui9qOi/uee6vwogICAgcG9sbGluZygpIHsKICAgICAgbGV0IHRoYXQgPSB0aGlzOwogICAgICBpZiAodGhhdC5wb2xsaW5nRmxhZykgewogICAgICAgIHl1YW5jaHUubG9jYXRpb25BTWFwLnJlcXVlc3RMb2NhdGlvbnMoWyc1JywgJzEnLCAnMTAnLCAnMzAnLCAnMCcsIHRydWVdLCByZXMgPT4gewogICAgICAgICAgdGhhdC5jdXJyZW50UG9zaXRpb24gPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHJlcykpOwogICAgICAgICAgdGhhdC5jdXJyZW50UG9zaXRpb24gPSBPYmplY3QuYXNzaWduKHRoYXQuY3VycmVudFBvc2l0aW9uLCB7CiAgICAgICAgICAgIGRpcmVjdGlvbjogMAogICAgICAgICAgfSk7CiAgICAgICAgICBpZiAoIXRoYXQuY3VycmVudFBvc2l0aW9uKSB7CiAgICAgICAgICAgIFRvYXN0KHsKICAgICAgICAgICAgICBtZXNzYWdlOiAn5b2T5YmNR1BT5L+h5Y+35byxJywKICAgICAgICAgICAgICBkdXJhdGlvbjogMTUwMAogICAgICAgICAgICB9KTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgICAgaWYgKHRoYXQudHJhY2tQb2ludExpc3QubGVuZ3RoICE9IDAgJiYgdGhhdC50cmFja1BvaW50TGlzdFt0aGF0LnRyYWNrUG9pbnRMaXN0Lmxlbmd0aCAtIDFdWzBdICE9IHRoYXQuY3VycmVudFBvc2l0aW9uLmxvbmdpdHVkZSAmJiB0aGF0LnRyYWNrUG9pbnRMaXN0W3RoYXQudHJhY2tQb2ludExpc3QubGVuZ3RoIC0gMV1bMV0gIT0gdGhhdC5jdXJyZW50UG9zaXRpb24ubGF0aXR1ZGUpIHsKICAgICAgICAgICAgLy8g5paw5LiA5qyh6L2u6K+i55qE5b2T5YmN5pe26Ze0CiAgICAgICAgICAgIGxldCBkYXRlX25vdyA9IGRheWpzKCkuZm9ybWF0KCdZWVlZLU1NLUREIEhIOm1tOnNzJyk7CiAgICAgICAgICAgIC8vIOS4iuasoeacgOWQjueahOeCueS9jQogICAgICAgICAgICBsZXQgbGFzdFBvaW50ID0gdGhhdC50cmFja1BvaW50TGlzdFt0aGF0LnRyYWNrUG9pbnRMaXN0Lmxlbmd0aCAtIDFdOwogICAgICAgICAgICAvLyDlvZPliY3ngrnkvY0KICAgICAgICAgICAgbGV0IGN1cnJlbnRQb2ludCA9IFt0aGF0LmN1cnJlbnRQb3NpdGlvbi5sb25naXR1ZGUsIHRoYXQuY3VycmVudFBvc2l0aW9uLmxhdGl0dWRlXTsKICAgICAgICAgICAgbGV0IGRpc3RhbmNlID0gTnVtYmVyKHRoYXQuR2V0RGlzdGFuY2UobGFzdFBvaW50LCBjdXJyZW50UG9pbnQpKSAqIDEwMDA7CiAgICAgICAgICAgIHRoYXQudHJhY2tQb2ludExpc3QucHVzaChbdGhhdC5jdXJyZW50UG9zaXRpb24ubG9uZ2l0dWRlLCB0aGF0LmN1cnJlbnRQb3NpdGlvbi5sYXRpdHVkZV0pOwogICAgICAgICAgICB0aGF0LnRyYWNrUG9pbnRUaW1lTGlzdC5wdXNoKGRhdGVfbm93KTsKICAgICAgICAgICAgY29uc29sZS5sb2codGhhdC50cmFja1BvaW50TGlzdCwgdGhpcy50cmFja1BvaW50VGltZUxpc3QpOwoKICAgICAgICAgICAgLy8g5p6E6YCg5Li05pe257q/5a+56LGhCiAgICAgICAgICAgIGxldCBqc29uTGluZSA9IHsKICAgICAgICAgICAgICB0eXBlOiAnRmVhdHVyZScsCiAgICAgICAgICAgICAgcHJvcGVydGllczoge30sCiAgICAgICAgICAgICAgZ2VvbWV0cnk6IHsKICAgICAgICAgICAgICAgIHR5cGU6ICdMaW5lU3RyaW5nJywKICAgICAgICAgICAgICAgIGNvb3JkaW5hdGVzOiB0aGF0LnRyYWNrUG9pbnRMaXN0CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAgICAgICBjb25zdCBjb29yZCA9IFtwYXJzZUZsb2F0KHRoYXQuY3VycmVudFBvc2l0aW9uLmxvbmdpdHVkZSksIHBhcnNlRmxvYXQodGhhdC5jdXJyZW50UG9zaXRpb24ubGF0aXR1ZGUpXTsKICAgICAgICAgICAgY29uc3QgcG9pbnQgPSB0dXJmLnBvaW50KGNvb3JkKTsKICAgICAgICAgICAgbWFwT2JqLm1hcEluc3RhbmNlLnNldFNvdXJjZURhdGEoImluc3BVc2VyIiwgewogICAgICAgICAgICAgIHR5cGU6ICJGZWF0dXJlQ29sbGVjdGlvbiIsCiAgICAgICAgICAgICAgZmVhdHVyZXM6IFtwb2ludF0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGxldCBqc29uTGluZUZlYXR1cmVDb2xsZWN0aW9uID0gewogICAgICAgICAgICAgIHR5cGU6ICdGZWF0dXJlQ29sbGVjdGlvbicsCiAgICAgICAgICAgICAgZmVhdHVyZXM6IFtqc29uTGluZV0KICAgICAgICAgICAgfTsKICAgICAgICAgICAgaWYgKG1hcE9iai5tYXAuZ2V0U291cmNlKCd0cmFja0xpbmVTb3VyY2Vfbm93JykpIHsKICAgICAgICAgICAgICBtYXBPYmoubWFwLmdldFNvdXJjZSgndHJhY2tMaW5lU291cmNlX25vdycpLnNldERhdGEoanNvbkxpbmVGZWF0dXJlQ29sbGVjdGlvbik7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgbWFwT2JqLm1hcC5hZGRTb3VyY2UoJ3RyYWNrTGluZVNvdXJjZV9ub3cnLCB7CiAgICAgICAgICAgICAgICB0eXBlOiAnZ2VvanNvbicsCiAgICAgICAgICAgICAgICBkYXRhOiBqc29uTGluZUZlYXR1cmVDb2xsZWN0aW9uCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKG1hcE9iai5tYXAuZ2V0TGF5ZXIoJ3RyYWNrTGluZUxheWVyX25vdycpKSB7fSBlbHNlIHsKICAgICAgICAgICAgICBtYXBPYmoubWFwLmFkZExheWVyKHsKICAgICAgICAgICAgICAgIGlkOiAndHJhY2tMaW5lTGF5ZXJfbm93JywKICAgICAgICAgICAgICAgIHR5cGU6ICdsaW5lJywKICAgICAgICAgICAgICAgIHNvdXJjZTogJ3RyYWNrTGluZVNvdXJjZV9ub3cnLAogICAgICAgICAgICAgICAgbGF5b3V0OiB7CiAgICAgICAgICAgICAgICAgICdsaW5lLWNhcCc6ICdyb3VuZCcsCiAgICAgICAgICAgICAgICAgICdsaW5lLWpvaW4nOiAncm91bmQnLAogICAgICAgICAgICAgICAgICAnbGluZS1zb3J0LWtleSc6IDEsCiAgICAgICAgICAgICAgICAgIHZpc2liaWxpdHk6ICd2aXNpYmxlJwogICAgICAgICAgICAgICAgICAvLyB2aXNpYmlsaXR5OiAibm9uZSIKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBwYWludDogewogICAgICAgICAgICAgICAgICAnbGluZS1jb2xvcic6ICcjYWRkZDUyJywKICAgICAgICAgICAgICAgICAgJ2xpbmUtd2lkdGgnOiA1LAogICAgICAgICAgICAgICAgICAnbGluZS1vcGFjaXR5JzogMC44CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSwgJ2luc3BVc2VyTGF5ZXInKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBsZXQgcGFyYW0gPSB7CiAgICAgICAgICAgICAgLi4udGhhdC5jdXJyZW50UG9zaXRpb24KICAgICAgICAgICAgfTsKICAgICAgICAgICAgLy8gdGhhdC4kcmVmcy5teW1hcC5zZXRJbnNwVXNlclBvc2l0aW9uKHBhcmFtKQogICAgICAgICAgICBpZiAobWFwT2JqLm1hcC5nZXRMYXllcigndHJhY2tMaW5lTGF5ZXJfYXJyb3cnKSkge30gZWxzZSB7CiAgICAgICAgICAgICAgbWFwT2JqLm1hcC5hZGRMYXllcih7CiAgICAgICAgICAgICAgICBpZDogJ3RyYWNrTGluZUxheWVyX2Fycm93JywKICAgICAgICAgICAgICAgIHR5cGU6ICdzeW1ib2wnLAogICAgICAgICAgICAgICAgc291cmNlOiAndHJhY2tMaW5lU291cmNlX25vdycsCiAgICAgICAgICAgICAgICBsYXlvdXQ6IHsKICAgICAgICAgICAgICAgICAgJ3N5bWJvbC1wbGFjZW1lbnQnOiAnbGluZScsCiAgICAgICAgICAgICAgICAgICdzeW1ib2wtc3BhY2luZyc6IDIwLAogICAgICAgICAgICAgICAgICAnaWNvbi1pbWFnZSc6ICdhcnJvd0ljb24nLAogICAgICAgICAgICAgICAgICAnaWNvbi1zaXplJzogMC41LAogICAgICAgICAgICAgICAgICAnaWNvbi1hbGxvdy1vdmVybGFwJzogdHJ1ZSwKICAgICAgICAgICAgICAgICAgJ3N5bWJvbC1zb3J0LWtleSc6IDMsCiAgICAgICAgICAgICAgICAgIHZpc2liaWxpdHk6ICd2aXNpYmxlJwogICAgICAgICAgICAgICAgICAvLyB2aXNpYmlsaXR5OiAibm9uZSIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9LCAnaW5zcFVzZXJMYXllcicpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIOaUueWPmOeuoee6v+minOiJsgogICAgICAgICAgICB0aGF0LiRyZWZzLm15bWFwLmNoYW5nZUluc3BMaW5lU291cmNlQnlTcGVlZCh0aGF0LmN1cnJlbnRQb3NpdGlvbik7CiAgICAgICAgICAgIC8vIOiusOW9lei/h+eoi+eCuQogICAgICAgICAgICB0aGF0LnBvc3RUcmFja0RhdGFfUG9pbnQodGhhdC50cmFja1BvaW50TGlzdFt0aGF0LnRyYWNrUG9pbnRMaXN0Lmxlbmd0aCAtIDFdLCB0aGF0LnRyYWNrUG9pbnRUaW1lTGlzdFt0aGF0LnRyYWNrUG9pbnRUaW1lTGlzdC5sZW5ndGggLSAxXSwgZGlzdGFuY2UpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgVG9hc3QoewogICAgICAgICAgICAgIG1lc3NhZ2U6ICflvZPliY1HUFPkv6Hlj7flvLEs5peg5rOV6I635Y+W5pyA5paw5a6a5L2N5pWw5o2uJywKICAgICAgICAgICAgICBkdXJhdGlvbjogMTUwMAogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9LCBlcnIgPT4gewogICAgICAgICAgVG9hc3QoewogICAgICAgICAgICBtZXNzYWdlOiAnZXJyJyArIGVyciwKICAgICAgICAgICAgZHVyYXRpb246IDIwMDAKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICAgIC8vIHRoaXMudXBsb2FkSW5zcFJvdXRlKCkKICAgICAgfQogICAgfSwKICAgIC8vIOe7mOWItui2hemAn+e6v+autQogICAgZHJhd092ZXJTcGVlZFRyYWNrKGxhc3RQb2ludCwgY3VycmVudFBvaW50LCBnYXBUaW1lID0gMykgewogICAgICBsZXQgdGhhdCA9IHRoaXM7CiAgICAgIGlmICh0aGF0LkdldERpc3RhbmNlKGxhc3RQb2ludCwgY3VycmVudFBvaW50KSAqIDEwMDAgLyBnYXBUaW1lID4gMTApIHsKICAgICAgICB0aGF0Lm92ZXJTcGVlZFRyYWNrTGluZUxpc3QucHVzaChbbGFzdFBvaW50LCBjdXJyZW50UG9pbnRdKTsKICAgICAgICBsZXQgb3ZlclNwZWVkVHJhY2tMaW5lQ29sbGVjdGlvbiA9IHsKICAgICAgICAgIHR5cGU6ICdGZWF0dXJlJywKICAgICAgICAgIHByb3BlcnRpZXM6IHt9LAogICAgICAgICAgZ2VvbWV0cnk6IHsKICAgICAgICAgICAgdHlwZTogJ011bHRpTGluZVN0cmluZycsCiAgICAgICAgICAgIGNvb3JkaW5hdGVzOiB0aGF0Lm92ZXJTcGVlZFRyYWNrTGluZUxpc3QKICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIGxldCBvdmVyU3BlZWRUcmFja0xpbmVGZWF0dXJlQ29sbGVjdGlvbiA9IHsKICAgICAgICAgIHR5cGU6ICdGZWF0dXJlQ29sbGVjdGlvbicsCiAgICAgICAgICBmZWF0dXJlczogW292ZXJTcGVlZFRyYWNrTGluZUNvbGxlY3Rpb25dCiAgICAgICAgfTsKICAgICAgICBpZiAobWFwT2JqLm1hcC5nZXRTb3VyY2UoJ3RyYWNrTGluZVNvdXJjZV9vdmVyU3BlZWQnKSkgewogICAgICAgICAgbWFwT2JqLm1hcC5nZXRTb3VyY2UoJ3RyYWNrTGluZVNvdXJjZV9vdmVyU3BlZWQnKS5zZXREYXRhKG92ZXJTcGVlZFRyYWNrTGluZUZlYXR1cmVDb2xsZWN0aW9uKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgbWFwT2JqLm1hcC5hZGRTb3VyY2UoJ3RyYWNrTGluZVNvdXJjZV9vdmVyU3BlZWQnLCB7CiAgICAgICAgICAgIHR5cGU6ICdnZW9qc29uJywKICAgICAgICAgICAgZGF0YTogb3ZlclNwZWVkVHJhY2tMaW5lRmVhdHVyZUNvbGxlY3Rpb24KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgICBpZiAobWFwT2JqLm1hcC5nZXRMYXllcigndHJhY2tMaW5lTGF5ZXJfb3ZlclNwZWVkJykpIHt9IGVsc2UgewogICAgICAgICAgbWFwT2JqLm1hcC5hZGRMYXllcih7CiAgICAgICAgICAgIGlkOiAndHJhY2tMaW5lTGF5ZXJfb3ZlclNwZWVkJywKICAgICAgICAgICAgdHlwZTogJ2xpbmUnLAogICAgICAgICAgICBzb3VyY2U6ICd0cmFja0xpbmVTb3VyY2Vfb3ZlclNwZWVkJywKICAgICAgICAgICAgbGF5b3V0OiB7CiAgICAgICAgICAgICAgJ2xpbmUtY2FwJzogJ3JvdW5kJywKICAgICAgICAgICAgICAnbGluZS1qb2luJzogJ3JvdW5kJywKICAgICAgICAgICAgICAnbGluZS1zb3J0LWtleSc6IDIsCiAgICAgICAgICAgICAgdmlzaWJpbGl0eTogJ3Zpc2libGUnCiAgICAgICAgICAgICAgLy8gdmlzaWJpbGl0eTogIm5vbmUiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHBhaW50OiB7CiAgICAgICAgICAgICAgJ2xpbmUtY29sb3InOiAnI0ZGQjEzQicsCiAgICAgICAgICAgICAgJ2xpbmUtd2lkdGgnOiA1LAogICAgICAgICAgICAgICdsaW5lLW9wYWNpdHknOiAxCiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIC8vIOe7mOWItui1t+Wni+eCuQogICAgZHJhd1N0YXJ0UG9pbnQoKSB7CiAgICAgIGxldCB0aGF0ID0gdGhpczsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGFzeW5jIGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICB5dWFuY2h1LmxvY2F0aW9uQU1hcC5yZXF1ZXN0U2luZ2xlTG9jYXRpb24oWycxJ10sIHJlcyA9PiB7CiAgICAgICAgICB0aGF0LmN1cnJlbnRQb3NpdGlvbiA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkocmVzKSk7CiAgICAgICAgICBjb25zdCBwYXJhbSA9IHsKICAgICAgICAgICAgLi4udGhhdC5jdXJyZW50UG9zaXRpb24KICAgICAgICAgIH07CiAgICAgICAgICB0aGF0LiRyZWZzLm15bWFwLnNldEluc3BVc2VyUG9zaXRpb24ocGFyYW0pOwogICAgICAgIH0sIGVyciA9PiB7CiAgICAgICAgICBjb25zb2xlLmxvZygnZXJyPScsIGVycik7CiAgICAgICAgfSk7CiAgICAgICAgaWYgKHRoYXQuY3VycmVudFBvc2l0aW9uICE9IG51bGwpIHsKICAgICAgICAgIC8vIOS4tOaXtuiusOW9lei1t+Wni+eCueWSjOi1t+Wni+aXtumXtAogICAgICAgICAgbGV0IHBvc2l0aW9uID0gdGhhdC5jdXJyZW50UG9zaXRpb247CiAgICAgICAgICBsZXQgdGVtcFBvaW50TGlzdCA9IFtdOwogICAgICAgICAgdGVtcFBvaW50TGlzdC5wdXNoKFtwb3NpdGlvbi5sb25naXR1ZGUsIHBvc2l0aW9uLmxhdGl0dWRlXSk7CiAgICAgICAgICBsZXQgZGF0ZV9ub3cgPSBkYXlqcygpLmZvcm1hdCgnWVlZWS1NTS1ERCBISDptbTpzcycpOwogICAgICAgICAgLy8g6L+b6KGM56ys5LiA5Liq54K55L2N5LiK5oqlCiAgICAgICAgICBsZXQgcG9pbnREYXRhID0gdGVtcFBvaW50TGlzdFt0ZW1wUG9pbnRMaXN0Lmxlbmd0aCAtIDFdOwoKICAgICAgICAgIC8vIOe7j+e6rOW6puaVsOWtl+WMlgogICAgICAgICAgZm9yIChsZXQgcCA9IDA7IHAgPCBwb2ludERhdGEubGVuZ3RoOyBwKyspIHsKICAgICAgICAgICAgcG9pbnREYXRhW3BdID0gTnVtYmVyKHBvaW50RGF0YVtwXSk7CiAgICAgICAgICB9CiAgICAgICAgICBsZXQgcmVjb3JkRGF0YSA9IFtdOwogICAgICAgICAgcmVjb3JkRGF0YS5wdXNoKHsKICAgICAgICAgICAgdGFza0lkOiB0aGF0LnRhc2tEZXRhaWwuaWQsCiAgICAgICAgICAgIC8vIOS7u+WKoWlkCiAgICAgICAgICAgIGxvbmdpdHVkZTogcG9pbnREYXRhWzBdLAogICAgICAgICAgICBsYXRpdHVkZTogcG9pbnREYXRhWzFdLAogICAgICAgICAgICBpbnNwVGltZTogZGF0ZV9ub3csCiAgICAgICAgICAgIGRpc3RhbmNlOiAwLAogICAgICAgICAgICAvLyDnrKzkuIDkuKrngrnot53nprvkuLowCiAgICAgICAgICAgIGluc3BEYXRlOiBkYXRlX25vdywKICAgICAgICAgICAgaW5zcGVjdG9yOiB0aGF0LnVzZXJJbmZvLnVzZXJGdWxsTmFtZQogICAgICAgICAgfSk7CiAgICAgICAgICAvLyDkvb/nlKjkuIrmiqXngrnkvY3kvZzkuLrotbfngrkKICAgICAgICAgIHRoYXQudHJhY2tQb2ludExpc3QucHVzaChbcG9zaXRpb24ubG9uZ2l0dWRlLCBwb3NpdGlvbi5sYXRpdHVkZV0pOwogICAgICAgICAgdGhhdC50cmFja1BvaW50VGltZUxpc3QucHVzaChkYXRlX25vdyk7CiAgICAgICAgICAvLyBsZXQganNvblBvaW50ID0gewogICAgICAgICAgLy8gICB0eXBlOiAnRmVhdHVyZScsCiAgICAgICAgICAvLyAgIHByb3BlcnRpZXM6IHt9LAogICAgICAgICAgLy8gICBnZW9tZXRyeTogewogICAgICAgICAgLy8gICAgIHR5cGU6ICdQb2ludCcsCiAgICAgICAgICAvLyAgICAgY29vcmRpbmF0ZXM6IFtwb3NpdGlvbi5sb25naXR1ZGUsIHBvc2l0aW9uLmxhdGl0dWRlXSwKICAgICAgICAgIC8vICAgfSwKICAgICAgICAgIC8vIH0KICAgICAgICAgIC8vIGxldCBqc29uUG9pbnRGZWF0dXJlQ29sbGVjdGlvbiA9IHsKICAgICAgICAgIC8vICAgdHlwZTogJ0ZlYXR1cmVDb2xsZWN0aW9uJywKICAgICAgICAgIC8vICAgZmVhdHVyZXM6IFtqc29uUG9pbnRdLAogICAgICAgICAgLy8gfQogICAgICAgICAgLy8gaWYgKG1hcE9iai5tYXAuZ2V0U291cmNlKCdzdGFydFBvaW50U291cmNlX25vdycpKSB7CiAgICAgICAgICAvLyAgIG1hcE9iai5tYXAKICAgICAgICAgIC8vICAgICAuZ2V0U291cmNlKCdzdGFydFBvaW50U291cmNlX25vdycpCiAgICAgICAgICAvLyAgICAgLnNldERhdGEoanNvblBvaW50RmVhdHVyZUNvbGxlY3Rpb24pCiAgICAgICAgICAvLyB9IGVsc2UgewogICAgICAgICAgLy8gICBtYXBPYmoubWFwLmFkZFNvdXJjZSgnc3RhcnRQb2ludFNvdXJjZV9ub3cnLCB7CiAgICAgICAgICAvLyAgICAgdHlwZTogJ2dlb2pzb24nLAogICAgICAgICAgLy8gICAgIGRhdGE6IGpzb25Qb2ludEZlYXR1cmVDb2xsZWN0aW9uLAogICAgICAgICAgLy8gICB9KQogICAgICAgICAgLy8gfQogICAgICAgICAgLy8gaWYgKG1hcE9iai5tYXAuZ2V0TGF5ZXIoJ3N0YXJ0UG9pbnRMYXllcl9ub3cnKSkgewogICAgICAgICAgLy8gfSBlbHNlIHsKICAgICAgICAgIC8vICAgbWFwT2JqLm1hcC5hZGRMYXllcih7CiAgICAgICAgICAvLyAgICAgaWQ6ICdzdGFydFBvaW50TGF5ZXJfbm93JywKICAgICAgICAgIC8vICAgICB0eXBlOiAnY2lyY2xlJywKICAgICAgICAgIC8vICAgICBzb3VyY2U6ICdzdGFydFBvaW50U291cmNlX25vdycsCiAgICAgICAgICAvLyAgICAgbGF5b3V0OiB7CiAgICAgICAgICAvLyAgICAgICAnY2lyY2xlLXNvcnQta2V5JzogNSwKICAgICAgICAgIC8vICAgICAgIHZpc2liaWxpdHk6ICd2aXNpYmxlJywKICAgICAgICAgIC8vICAgICAgIC8vIHZpc2liaWxpdHk6ICJub25lIgogICAgICAgICAgLy8gICAgIH0sCiAgICAgICAgICAvLyAgICAgcGFpbnQ6IHsKICAgICAgICAgIC8vICAgICAgICdjaXJjbGUtcmFkaXVzJzogMywKICAgICAgICAgIC8vICAgICAgICdjaXJjbGUtc3Ryb2tlLXdpZHRoJzogNSwKICAgICAgICAgIC8vICAgICAgICdjaXJjbGUtc3Ryb2tlLWNvbG9yJzogJyMyQTgzRTYnLAogICAgICAgICAgLy8gICAgICAgJ2NpcmNsZS1jb2xvcic6ICd3aGl0ZScsCiAgICAgICAgICAvLyAgICAgfSwKICAgICAgICAgIC8vICAgfSkKICAgICAgICAgIC8vIH0KICAgICAgICAgIC8vIC8vIGxhYmVsCiAgICAgICAgICAvLyBpZiAobWFwT2JqLm1hcC5nZXRMYXllcignc3RhcnRQb2ludF9sYWJlbCcpKSB7CiAgICAgICAgICAvLyB9IGVsc2UgewogICAgICAgICAgLy8gICBtYXBPYmoubWFwLmFkZExheWVyKHsKICAgICAgICAgIC8vICAgICBpZDogJ3N0YXJ0UG9pbnRfbGFiZWwnLAogICAgICAgICAgLy8gICAgIHR5cGU6ICdzeW1ib2wnLAogICAgICAgICAgLy8gICAgIHNvdXJjZTogJ3N0YXJ0UG9pbnRTb3VyY2Vfbm93JywKICAgICAgICAgIC8vICAgICBsYXlvdXQ6IHsKICAgICAgICAgIC8vICAgICAgICdzeW1ib2wtcGxhY2VtZW50JzogJ3BvaW50JywKICAgICAgICAgIC8vICAgICAgICdpY29uLWltYWdlJzogJ3N0YXJ0X3BvaW50JywKICAgICAgICAgIC8vICAgICAgICdpY29uLXNpemUnOiAwLjYsCiAgICAgICAgICAvLyAgICAgICAnaWNvbi1vZmZzZXQnOiBbMCwgLTM1XSwKICAgICAgICAgIC8vICAgICAgICdpY29uLWFsbG93LW92ZXJsYXAnOiB0cnVlLAogICAgICAgICAgLy8gICAgICAgJ3N5bWJvbC1zb3J0LWtleSc6IDIsCiAgICAgICAgICAvLyAgICAgICB2aXNpYmlsaXR5OiAndmlzaWJsZScsCiAgICAgICAgICAvLyAgICAgICAvLyB2aXNpYmlsaXR5OiAibm9uZSIKICAgICAgICAgIC8vICAgICB9LAogICAgICAgICAgLy8gICB9KQogICAgICAgICAgLy8gfQogICAgICAgICAgLy8gcmVzb2x2ZSh0cnVlKQogICAgICAgICAgYXdhaXQgYXBpLmluc3BlY3Rpb25UcmFjayhyZWNvcmREYXRhKS50aGVuKHJlcyA9PiB7CiAgICAgICAgICAgIGlmIChyZXMgJiYgcmVzLnN0YXR1cykgewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCfovajov7nlrZjlgqjmiJDlip8nKTsKICAgICAgICAgICAgICAvLyDkvb/nlKjkuIrmiqXngrnkvY3kvZzkuLrotbfngrkKICAgICAgICAgICAgICAvLyB0aGF0LnRyYWNrUG9pbnRMaXN0LnB1c2goWwogICAgICAgICAgICAgIC8vICAgcG9zaXRpb24ubG9uZ2l0dWRlLAogICAgICAgICAgICAgIC8vICAgcG9zaXRpb24ubGF0aXR1ZGUKICAgICAgICAgICAgICAvLyBdKTsKICAgICAgICAgICAgICAvLyB0aGF0LnRyYWNrUG9pbnRUaW1lTGlzdC5wdXNoKGRhdGVfbm93KTsKICAgICAgICAgICAgICBsZXQganNvblBvaW50ID0gewogICAgICAgICAgICAgICAgdHlwZTogJ0ZlYXR1cmUnLAogICAgICAgICAgICAgICAgcHJvcGVydGllczoge30sCiAgICAgICAgICAgICAgICBnZW9tZXRyeTogewogICAgICAgICAgICAgICAgICB0eXBlOiAnUG9pbnQnLAogICAgICAgICAgICAgICAgICBjb29yZGluYXRlczogW3Bvc2l0aW9uLmxvbmdpdHVkZSwgcG9zaXRpb24ubGF0aXR1ZGVdCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICBsZXQganNvblBvaW50RmVhdHVyZUNvbGxlY3Rpb24gPSB7CiAgICAgICAgICAgICAgICB0eXBlOiAnRmVhdHVyZUNvbGxlY3Rpb24nLAogICAgICAgICAgICAgICAgZmVhdHVyZXM6IFtqc29uUG9pbnRdCiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICBpZiAobWFwT2JqLm1hcC5nZXRTb3VyY2UoJ3N0YXJ0UG9pbnRTb3VyY2Vfbm93JykpIHsKICAgICAgICAgICAgICAgIG1hcE9iai5tYXAuZ2V0U291cmNlKCdzdGFydFBvaW50U291cmNlX25vdycpLnNldERhdGEoanNvblBvaW50RmVhdHVyZUNvbGxlY3Rpb24pOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBtYXBPYmoubWFwLmFkZFNvdXJjZSgnc3RhcnRQb2ludFNvdXJjZV9ub3cnLCB7CiAgICAgICAgICAgICAgICAgIHR5cGU6ICdnZW9qc29uJywKICAgICAgICAgICAgICAgICAgZGF0YToganNvblBvaW50RmVhdHVyZUNvbGxlY3Rpb24KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBpZiAobWFwT2JqLm1hcC5nZXRMYXllcignc3RhcnRQb2ludExheWVyX25vdycpKSB7fSBlbHNlIHsKICAgICAgICAgICAgICAgIG1hcE9iai5tYXAuYWRkTGF5ZXIoewogICAgICAgICAgICAgICAgICBpZDogJ3N0YXJ0UG9pbnRMYXllcl9ub3cnLAogICAgICAgICAgICAgICAgICB0eXBlOiAnY2lyY2xlJywKICAgICAgICAgICAgICAgICAgc291cmNlOiAnc3RhcnRQb2ludFNvdXJjZV9ub3cnLAogICAgICAgICAgICAgICAgICBsYXlvdXQ6IHsKICAgICAgICAgICAgICAgICAgICAnY2lyY2xlLXNvcnQta2V5JzogNSwKICAgICAgICAgICAgICAgICAgICB2aXNpYmlsaXR5OiAndmlzaWJsZScKICAgICAgICAgICAgICAgICAgICAvLyB2aXNpYmlsaXR5OiAibm9uZSIKICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgcGFpbnQ6IHsKICAgICAgICAgICAgICAgICAgICAnY2lyY2xlLXJhZGl1cyc6IDMsCiAgICAgICAgICAgICAgICAgICAgJ2NpcmNsZS1zdHJva2Utd2lkdGgnOiA1LAogICAgICAgICAgICAgICAgICAgICdjaXJjbGUtc3Ryb2tlLWNvbG9yJzogJyMyQTgzRTYnLAogICAgICAgICAgICAgICAgICAgICdjaXJjbGUtY29sb3InOiAnd2hpdGUnCiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sICdpbnNwVXNlckxheWVyJyk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIC8vIGxhYmVsCiAgICAgICAgICAgICAgaWYgKG1hcE9iai5tYXAuZ2V0TGF5ZXIoJ3N0YXJ0UG9pbnRfbGFiZWwnKSkge30gZWxzZSB7CiAgICAgICAgICAgICAgICBtYXBPYmoubWFwLmFkZExheWVyKHsKICAgICAgICAgICAgICAgICAgaWQ6ICdzdGFydFBvaW50X2xhYmVsJywKICAgICAgICAgICAgICAgICAgdHlwZTogJ3N5bWJvbCcsCiAgICAgICAgICAgICAgICAgIHNvdXJjZTogJ3N0YXJ0UG9pbnRTb3VyY2Vfbm93JywKICAgICAgICAgICAgICAgICAgbGF5b3V0OiB7CiAgICAgICAgICAgICAgICAgICAgJ3N5bWJvbC1wbGFjZW1lbnQnOiAncG9pbnQnLAogICAgICAgICAgICAgICAgICAgICdpY29uLWltYWdlJzogJ3N0YXJ0X3BvaW50JywKICAgICAgICAgICAgICAgICAgICAnaWNvbi1zaXplJzogMC42LAogICAgICAgICAgICAgICAgICAgICdpY29uLW9mZnNldCc6IFswLCAtMzVdLAogICAgICAgICAgICAgICAgICAgICdpY29uLWFsbG93LW92ZXJsYXAnOiB0cnVlLAogICAgICAgICAgICAgICAgICAgICdzeW1ib2wtc29ydC1rZXknOiAyLAogICAgICAgICAgICAgICAgICAgIHZpc2liaWxpdHk6ICd2aXNpYmxlJwogICAgICAgICAgICAgICAgICAgIC8vIHZpc2liaWxpdHk6ICJub25lIgogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZygi6L2o6L+55a2Y5YKo5aSx6LSlIik7CiAgICAgICAgICAgICAgcmVzb2x2ZShmYWxzZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pLmNhdGNoKGVyciA9PiB7CiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCLovajov7nlrZjlgqjlpLHotKVlcnIiLCBlcnIpOwogICAgICAgICAgICByZWplY3QoZXJyKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgLy8g57uY5Yi257uI5q2i54K5CiAgICBhc3luYyBkcmF3RW5kUG9pbnQodHlwZSA9IG51bGwpIHsKICAgICAgbGV0IHRoYXQgPSB0aGlzOwogICAgICB5dWFuY2h1LmxvY2F0aW9uQU1hcC5zdG9wUmVxdWVzdExvY2F0aW9ucygpOwogICAgICBpZiAodGhhdC5jdXJyZW50UG9zaXRpb24gIT0gbnVsbCkgewogICAgICAgIGxldCBsYXN0UG9pbnQgPSB0aGF0LnRyYWNrUG9pbnRMaXN0W3RoYXQudHJhY2tQb2ludExpc3QubGVuZ3RoIC0gMV07CiAgICAgICAgbGV0IGN1cnJlbnRQb2ludCA9IFt0aGF0LmN1cnJlbnRQb3NpdGlvbi5sb25naXR1ZGUsIHRoYXQuY3VycmVudFBvc2l0aW9uLmxhdGl0dWRlXTsKICAgICAgICBsZXQgZGlzdGFuY2UgPSBOdW1iZXIodGhhdC5HZXREaXN0YW5jZShsYXN0UG9pbnQsIGN1cnJlbnRQb2ludCkpICogMTAwMDsKICAgICAgICB0aGF0LnRyYWNrUG9pbnRMaXN0LnB1c2goW3RoYXQuY3VycmVudFBvc2l0aW9uLmxvbmdpdHVkZSwgdGhhdC5jdXJyZW50UG9zaXRpb24ubGF0aXR1ZGVdKTsKICAgICAgICBsZXQgZGF0ZV9ub3cgPSBkYXlqcygpLmZvcm1hdCgnWVlZWS1NTS1ERCBISDptbTpzcycpOwogICAgICAgIHRoYXQudHJhY2tQb2ludFRpbWVMaXN0LnB1c2goZGF0ZV9ub3cpOwogICAgICAgIGxldCBqc29uUG9pbnQgPSB7CiAgICAgICAgICB0eXBlOiAnRmVhdHVyZScsCiAgICAgICAgICBwcm9wZXJ0aWVzOiB7fSwKICAgICAgICAgIGdlb21ldHJ5OiB7CiAgICAgICAgICAgIHR5cGU6ICdQb2ludCcsCiAgICAgICAgICAgIGNvb3JkaW5hdGVzOiBbdGhhdC5jdXJyZW50UG9zaXRpb24ubG9uZ2l0dWRlLCB0aGF0LmN1cnJlbnRQb3NpdGlvbi5sYXRpdHVkZV0KICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIGxldCBqc29uUG9pbnRGZWF0dXJlQ29sbGVjdGlvbiA9IHsKICAgICAgICAgIHR5cGU6ICdGZWF0dXJlQ29sbGVjdGlvbicsCiAgICAgICAgICBmZWF0dXJlczogW2pzb25Qb2ludF0KICAgICAgICB9OwogICAgICAgIGlmIChtYXBPYmoubWFwLmdldFNvdXJjZSgnZW5kUG9pbnRTb3VyY2Vfbm93JykpIHsKICAgICAgICAgIG1hcE9iai5tYXAuZ2V0U291cmNlKCdlbmRQb2ludFNvdXJjZV9ub3cnKS5zZXREYXRhKGpzb25Qb2ludEZlYXR1cmVDb2xsZWN0aW9uKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgbWFwT2JqLm1hcC5hZGRTb3VyY2UoJ2VuZFBvaW50U291cmNlX25vdycsIHsKICAgICAgICAgICAgdHlwZTogJ2dlb2pzb24nLAogICAgICAgICAgICBkYXRhOiBqc29uUG9pbnRGZWF0dXJlQ29sbGVjdGlvbgogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIGlmIChtYXBPYmoubWFwLmdldExheWVyKCdlbmRQb2ludExheWVyX25vdycpKSB7fSBlbHNlIHsKICAgICAgICAgIG1hcE9iai5tYXAuYWRkTGF5ZXIoewogICAgICAgICAgICBpZDogJ2VuZFBvaW50TGF5ZXJfbm93JywKICAgICAgICAgICAgdHlwZTogJ2NpcmNsZScsCiAgICAgICAgICAgIHNvdXJjZTogJ2VuZFBvaW50U291cmNlX25vdycsCiAgICAgICAgICAgIGxheW91dDogewogICAgICAgICAgICAgICdjaXJjbGUtc29ydC1rZXknOiA1LAogICAgICAgICAgICAgIHZpc2liaWxpdHk6ICd2aXNpYmxlJwogICAgICAgICAgICAgIC8vIHZpc2liaWxpdHk6ICJub25lIgogICAgICAgICAgICB9LAogICAgICAgICAgICBwYWludDogewogICAgICAgICAgICAgICdjaXJjbGUtcmFkaXVzJzogMywKICAgICAgICAgICAgICAnY2lyY2xlLXN0cm9rZS13aWR0aCc6IDUsCiAgICAgICAgICAgICAgJ2NpcmNsZS1zdHJva2UtY29sb3InOiAnI2FkZGQ1MicsCiAgICAgICAgICAgICAgJ2NpcmNsZS1jb2xvcic6ICd3aGl0ZScKICAgICAgICAgICAgfQogICAgICAgICAgfSwgJ2luc3BVc2VyTGF5ZXInKTsKICAgICAgICB9CgogICAgICAgIC8vIOihpeWFhXRyYWNrbGluZQogICAgICAgIGxldCBqc29uTGluZSA9IHsKICAgICAgICAgIHR5cGU6ICdGZWF0dXJlJywKICAgICAgICAgIHByb3BlcnRpZXM6IHt9LAogICAgICAgICAgZ2VvbWV0cnk6IHsKICAgICAgICAgICAgdHlwZTogJ0xpbmVTdHJpbmcnLAogICAgICAgICAgICBjb29yZGluYXRlczogdGhhdC50cmFja1BvaW50TGlzdAogICAgICAgICAgfQogICAgICAgIH07CiAgICAgICAgbGV0IGpzb25MaW5lRmVhdHVyZUNvbGxlY3Rpb24gPSB7CiAgICAgICAgICB0eXBlOiAnRmVhdHVyZUNvbGxlY3Rpb24nLAogICAgICAgICAgZmVhdHVyZXM6IFtqc29uTGluZV0KICAgICAgICB9OwogICAgICAgIGlmIChtYXBPYmoubWFwLmdldFNvdXJjZSgndHJhY2tMaW5lU291cmNlX25vdycpKSB7CiAgICAgICAgICBtYXBPYmoubWFwLmdldFNvdXJjZSgndHJhY2tMaW5lU291cmNlX25vdycpLnNldERhdGEoanNvbkxpbmVGZWF0dXJlQ29sbGVjdGlvbik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIG1hcE9iai5tYXAuYWRkU291cmNlKCd0cmFja0xpbmVTb3VyY2Vfbm93JywgewogICAgICAgICAgICB0eXBlOiAnZ2VvanNvbicsCiAgICAgICAgICAgIGRhdGE6IGpzb25MaW5lRmVhdHVyZUNvbGxlY3Rpb24KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgICBpZiAobWFwT2JqLm1hcC5nZXRMYXllcigndHJhY2tMaW5lTGF5ZXJfbm93JykpIHt9IGVsc2UgewogICAgICAgICAgbWFwT2JqLm1hcC5hZGRMYXllcih7CiAgICAgICAgICAgIGlkOiAndHJhY2tMaW5lTGF5ZXJfbm93JywKICAgICAgICAgICAgdHlwZTogJ2xpbmUnLAogICAgICAgICAgICBzb3VyY2U6ICd0cmFja0xpbmVTb3VyY2Vfbm93JywKICAgICAgICAgICAgbGF5b3V0OiB7CiAgICAgICAgICAgICAgJ2xpbmUtY2FwJzogJ3JvdW5kJywKICAgICAgICAgICAgICAnbGluZS1qb2luJzogJ3JvdW5kJywKICAgICAgICAgICAgICB2aXNpYmlsaXR5OiAndmlzaWJsZScKICAgICAgICAgICAgICAvLyB2aXNpYmlsaXR5OiAibm9uZSIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgcGFpbnQ6IHsKICAgICAgICAgICAgICAnbGluZS1jb2xvcic6ICcjYWRkZDUyJywKICAgICAgICAgICAgICAnbGluZS13aWR0aCc6IDUsCiAgICAgICAgICAgICAgJ2xpbmUtb3BhY2l0eSc6IDAuOAogICAgICAgICAgICB9CiAgICAgICAgICB9LCAnaW5zcFVzZXJMYXllcicpOwogICAgICAgIH0KICAgICAgICAvLyBsYWJlbAogICAgICAgIGlmIChtYXBPYmoubWFwLmdldExheWVyKCdlbmRQb2ludF9sYWJlbCcpKSB7fSBlbHNlIHsKICAgICAgICAgIG1hcE9iai5tYXAuYWRkTGF5ZXIoewogICAgICAgICAgICBpZDogJ2VuZFBvaW50X2xhYmVsJywKICAgICAgICAgICAgdHlwZTogJ3N5bWJvbCcsCiAgICAgICAgICAgIHNvdXJjZTogJ2VuZFBvaW50U291cmNlX25vdycsCiAgICAgICAgICAgIGxheW91dDogewogICAgICAgICAgICAgICdzeW1ib2wtcGxhY2VtZW50JzogJ3BvaW50JywKICAgICAgICAgICAgICAnaWNvbi1pbWFnZSc6ICdlbmRfcG9pbnQnLAogICAgICAgICAgICAgICdpY29uLXNpemUnOiAwLjYsCiAgICAgICAgICAgICAgJ2ljb24tb2Zmc2V0JzogWzAsIC0zNV0sCiAgICAgICAgICAgICAgJ2ljb24tYWxsb3ctb3ZlcmxhcCc6IHRydWUsCiAgICAgICAgICAgICAgJ3N5bWJvbC1zb3J0LWtleSc6IDIsCiAgICAgICAgICAgICAgdmlzaWJpbGl0eTogJ3Zpc2libGUnCiAgICAgICAgICAgICAgLy8gdmlzaWJpbGl0eTogIm5vbmUiCiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgICB0aGF0LnBvbGxpbmdGbGFnID0gZmFsc2U7CiAgICAgICAgLy8g6K6w5b2V57uI5q2i54K5CiAgICAgICAgdGhhdC5wb3N0VHJhY2tEYXRhX1BvaW50KHRoYXQudHJhY2tQb2ludExpc3RbdGhhdC50cmFja1BvaW50TGlzdC5sZW5ndGggLSAxXSwgdGhhdC50cmFja1BvaW50VGltZUxpc3RbdGhhdC50cmFja1BvaW50VGltZUxpc3QubGVuZ3RoIC0gMV0sIGRpc3RhbmNlKTsKICAgICAgICAvLyDkuIrkvKDkuYvliY3kuIrkvKDlpLHotKXnmoTngrnkvY0KICAgICAgICB0aGF0LnJlcG9ydEZhaWxUcmFja1BvaW50cy5sZW5ndGggPiAwICYmIHRoYXQucG9zdEZhaWxUcmFja0RhdGEoKTsKICAgICAgICB0aGF0LiRyZWZzLm15bWFwLnVwbG9hZEZpbGVkUGlwZUlkTGlzdC5sZW5ndGggPiAwICYmIGFwaS5yZWNvcmRJbnNwTGluZSh0aGF0LiRyZWZzLm15bWFwLnVwbG9hZEZpbGVkUGlwZUlkTGlzdCkudGhlbihyZXMgPT4gewogICAgICAgICAgaWYgKHJlcy5zdGF0dXMpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coJ+euoee6v+ihpeWFheS4iuS8oOaIkOWKnycpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIGlmICh0eXBlID09ICd0YXNrJykgewogICAgICAgICAgdGhpcy5zdHJhdE9yRW5kVGFza1JlY29yZCgyKTsgLy8g5bey5beh5qOA54q25oCBICcyJwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBsZXQgdHlwZSA9IHR5cGU7CiAgICAgICAgbGV0IHRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICB0aGF0LmRyYXdFbmRQb2ludCh0eXBlKTsKICAgICAgICB9LCAxMDAwKTsKICAgICAgfQogICAgfSwKICAgIGFzeW5jIHBvc3RGYWlsVHJhY2tEYXRhKCkgewogICAgICBsZXQgdGhhdCA9IHRoaXM7CiAgICAgIGF3YWl0IGFwaS5pbnNwZWN0aW9uVHJhY2sodGhhdC5yZXBvcnRGYWlsVHJhY2tQb2ludHMpLnRoZW4ocmVzID0+IHsKICAgICAgICBpZiAocmVzICYmIHJlcy5zdGF0dXMpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCfovajov7nlrZjlgqjmiJDlip8nKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy8g5LiK5Lyg5aSx6LSl55qE54K55L2N77yM5pqC5pe25a2Y5ZyoYXBw56uvCiAgICAgICAgICBsZXQgdGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgdGhhdC5wb3N0RmFpbFRyYWNrRGF0YSgpOwogICAgICAgICAgfSwgMjAwMCk7CiAgICAgICAgfQogICAgICB9KS5jYXRjaChlcnIgPT4gewogICAgICAgIGNvbnNvbGUubG9nKCflt6Hmo4Dovajov7nlrZjlgqjlpLHotKXvvJonICsgZXJyKTsKICAgICAgfSk7CiAgICB9LAogICAgLy8g5Y2V54K5LeWQjuerr+iusOW9lei9qOi/ueaVsOaNrgogICAgYXN5bmMgcG9zdFRyYWNrRGF0YV9Qb2ludChwb2ludERhdGEsIHRpbWVEYXRhLCBkaXN0YW5jZSkgewogICAgICBsZXQgdGhhdCA9IHRoaXM7CiAgICAgIGZvciAobGV0IHAgPSAwOyBwIDwgcG9pbnREYXRhLmxlbmd0aDsgcCsrKSB7CiAgICAgICAgcG9pbnREYXRhW3BdID0gTnVtYmVyKHBvaW50RGF0YVtwXSk7CiAgICAgIH0KICAgICAgbGV0IGRhdGVfbm93ID0gZGF5anMoKS5mb3JtYXQoJ1lZWVktTU0tREQgSEg6bW06c3MnKTsKICAgICAgbGV0IHJlY29yZERhdGEgPSBbXTsKICAgICAgcmVjb3JkRGF0YS5wdXNoKHsKICAgICAgICB0YXNrSWQ6IHRoYXQudGFza0RldGFpbC5pZCwKICAgICAgICBpbnNwRGF0ZTogdGltZURhdGEsCiAgICAgICAgaW5zcFRpbWU6IGRhdGVfbm93LAogICAgICAgIGRpc3RhbmNlLAogICAgICAgIGluc3BlY3RvcjogdGhhdC51c2VySW5mby51c2VyRnVsbG5hbWUsCiAgICAgICAgbG9uZ2l0dWRlOiBwb2ludERhdGFbMF0sCiAgICAgICAgbGF0aXR1ZGU6IHBvaW50RGF0YVsxXQogICAgICB9KTsKICAgICAgYXdhaXQgYXBpLmluc3BlY3Rpb25UcmFjayhyZWNvcmREYXRhKS50aGVuKHJlcyA9PiB7CiAgICAgICAgaWYgKHJlcyAmJiByZXMuc3RhdHVzKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygn6L2o6L+55a2Y5YKo5oiQ5YqfJywgcmVjb3JkRGF0YSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8vIOS4iuS8oOWksei0peeahOeCueS9je+8jOaaguaXtuWtmOWcqGFwcOerrwogICAgICAgICAgdGhhdC5yZXBvcnRGYWlsVHJhY2tQb2ludHMucHVzaChyZWNvcmREYXRhKTsKICAgICAgICAgIGNvbnNvbGUubG9nKCd0aGF0LnJlcG9ydEZhaWxUcmFja1BvaW50czogJywgdGhhdC5yZXBvcnRGYWlsVHJhY2tQb2ludHMpOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZXJyID0+IHsKICAgICAgICBjb25zb2xlLmxvZygn5beh5qOA6L2o6L+55a2Y5YKo5aSx6LSl77yaJyArIGVycik7CiAgICAgIH0pOwogICAgfSwKICAgIHN0cmF0T3JFbmRUYXNrUmVjb3JkKHN0YXR1cykgewogICAgICBsZXQgZGF0YSA9IHsKICAgICAgICBwbGFuSWQ6IHRoaXMucGxhbkRldGFpbC5wbGFuSWQsCiAgICAgICAgdGFza05hbWU6IHRoaXMudGFza0RldGFpbC50YXNrTmFtZSwKICAgICAgICB0YXNrQ29kZTogdGhpcy50YXNrRGV0YWlsLnRhc2tDb2RlLAogICAgICAgIHRhc2tTdGF0dXM6IHN0YXR1cywKICAgICAgICBpZDogdGhpcy50YXNrRGV0YWlsLmlkLAogICAgICAgIHRhc2tUeXBlOiB0aGlzLnRhc2tEZXRhaWwudGFza1R5cGUKICAgICAgfTsKICAgICAgYXBpLmNoYW5nZVRhc2tTdGF0dXMoZGF0YSkudGhlbihyZXMgPT4gewogICAgICAgIGlmIChyZXMuc3RhdHVzKSB7CiAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgLy8g5riF6Zmk57yT5a2Y55qE6L2o6L+55pWw5o2uCiAgICBjbGVhckJ1ZmZlclRyYWNrKCkgewogICAgICBsZXQgdGhhdCA9IHRoaXM7CiAgICAgIC8v5pWw57uE5b2S6Zu2CiAgICAgIHRoYXQudHJhY2tQb2ludExpc3QgPSBbXTsKICAgICAgdGhhdC50cmFja1BvaW50VGltZUxpc3QgPSBbXTsKICAgICAgdGhhdC5vdmVyU3BlZWRUcmFja0xpbmVMaXN0ID0gW107CiAgICAgIC8v5pWw5o2u5rqQ5riF56m6CiAgICAgIGlmIChtYXBPYmoubWFwLmdldFNvdXJjZSgndHJhY2tMaW5lU291cmNlX25vdycpKSB7CiAgICAgICAgbWFwT2JqLm1hcC5nZXRTb3VyY2UoJ3RyYWNrTGluZVNvdXJjZV9ub3cnKS5zZXREYXRhKHsKICAgICAgICAgIHR5cGU6ICdGZWF0dXJlQ29sbGVjdGlvbicsCiAgICAgICAgICBmZWF0dXJlczogW10KICAgICAgICB9KTsKICAgICAgfQogICAgICBpZiAobWFwT2JqLm1hcC5nZXRTb3VyY2UoJ3RyYWNrTGluZVNvdXJjZV9vdmVyU3BlZWQnKSkgewogICAgICAgIG1hcE9iai5tYXAuZ2V0U291cmNlKCd0cmFja0xpbmVTb3VyY2Vfb3ZlclNwZWVkJykuc2V0RGF0YSh7CiAgICAgICAgICB0eXBlOiAnRmVhdHVyZUNvbGxlY3Rpb24nLAogICAgICAgICAgZmVhdHVyZXM6IFtdCiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgaWYgKG1hcE9iai5tYXAuZ2V0U291cmNlKCdzdGFydFBvaW50U291cmNlX25vdycpKSB7CiAgICAgICAgbWFwT2JqLm1hcC5nZXRTb3VyY2UoJ3N0YXJ0UG9pbnRTb3VyY2Vfbm93Jykuc2V0RGF0YSh7CiAgICAgICAgICB0eXBlOiAnRmVhdHVyZUNvbGxlY3Rpb24nLAogICAgICAgICAgZmVhdHVyZXM6IFtdCiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgaWYgKG1hcE9iai5tYXAuZ2V0U291cmNlKCdlbmRQb2ludFNvdXJjZV9ub3cnKSkgewogICAgICAgIG1hcE9iai5tYXAuZ2V0U291cmNlKCdlbmRQb2ludFNvdXJjZV9ub3cnKS5zZXREYXRhKHsKICAgICAgICAgIHR5cGU6ICdGZWF0dXJlQ29sbGVjdGlvbicsCiAgICAgICAgICBmZWF0dXJlczogW10KICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIGFkZE1hcEltZygpIHsKICAgICAgbGV0IHRoYXQgPSB0aGlzOwogICAgICBtYXBPYmoubWFwLmxvYWRJbWFnZShyZXF1aXJlKCdAYXNzZXRzL2ltZy9pbnNwZWN0aW9uL3doaXRlX2Fycm93X3JpZ2h0LnBuZycpLCBmdW5jdGlvbiAoZXJyb3IsIGltYWdlKSB7CiAgICAgICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvcjsKICAgICAgICBpZiAoIW1hcE9iai5tYXAuaGFzSW1hZ2UoJ2Fycm93SWNvbicpKSB7CiAgICAgICAgICBtYXBPYmoubWFwLmFkZEltYWdlKCdhcnJvd0ljb24nLCBpbWFnZSwge30pOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIG1hcE9iai5tYXAubG9hZEltYWdlKHJlcXVpcmUoJ0Bhc3NldHMvaW1nL2luc3BlY3Rpb24vaWNvbl9zdGFydGluZ19wb2ludC5wbmcnKSwgZnVuY3Rpb24gKGVycm9yLCBpbWFnZSkgewogICAgICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3I7CiAgICAgICAgaWYgKCFtYXBPYmoubWFwLmhhc0ltYWdlKCdzdGFydF9wb2ludCcpKSB7CiAgICAgICAgICBtYXBPYmoubWFwLmFkZEltYWdlKCdzdGFydF9wb2ludCcsIGltYWdlLCB7fSk7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgbWFwT2JqLm1hcC5sb2FkSW1hZ2UocmVxdWlyZSgnQGFzc2V0cy9pbWcvaW5zcGVjdGlvbi9pY29uX2F0X2VuZC5wbmcnKSwgZnVuY3Rpb24gKGVycm9yLCBpbWFnZSkgewogICAgICAgIGlmIChlcnJvcikgdGhyb3cgZXJyb3I7CiAgICAgICAgaWYgKCFtYXBPYmoubWFwLmhhc0ltYWdlKCdlbmRfcG9pbnQnKSkgewogICAgICAgICAgbWFwT2JqLm1hcC5hZGRJbWFnZSgnZW5kX3BvaW50JywgaW1hZ2UsIHt9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIC8vIOW8gOWni+iusOW9lSDkuIrkvKDotbfngrnmiJDlip/lkI7miY3ov5vlhaXlt6Hmo4Dov4fnqIsKICAgIHN0YXJ0SW5zcFJlY29yZCgpIHsKICAgICAgaWYgKHRoaXMuaXNWaWV3KSB7CiAgICAgICAgVG9hc3QoewogICAgICAgICAgbWVzc2FnZTogJ+ivpeW3oeajgOS7u+WKoeW3sue7k+adnycsCiAgICAgICAgICBkdXJhdGlvbjogMTUwMAogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpZiAoIXRoaXMuY3VycmVudFBvc2l0aW9uIHx8ICF0aGlzLmN1cnJlbnRQb3NpdGlvbi5sb25naXR1ZGUpIHsKICAgICAgICBUb2FzdCh7CiAgICAgICAgICBtZXNzYWdlOiAn5b2T5YmNR1BT5L+h5Y+35byx77yM5peg5rOV5byA5aeL5Lu75YqhJywKICAgICAgICAgIGR1cmF0aW9uOiAxMDAwCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHRoaXMuaWZSZWNvcmRpbmcgPSB0cnVlOwogICAgICB0aGlzLmNsZWFyQnVmZmVyVHJhY2soKTsKICAgICAgdGhpcy5hZGRNYXBJbWcoKTsKICAgICAgdGhpcy5kcmF3U3RhcnRQb2ludCgpLnRoZW4ocmVzID0+IHsKICAgICAgICBpZiAocmVzKSB7CiAgICAgICAgICBUb2FzdCh7CiAgICAgICAgICAgIG1lc3NhZ2U6ICflvIDlp4vorrDlvZUnLAogICAgICAgICAgICBkdXJhdGlvbjogMTAwMAogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLnBvbGxpbmdGbGFnID0gdHJ1ZTsKICAgICAgICAgIHRoaXMuaWZSZWNvcmRpbmcgPSB0cnVlOwogICAgICAgICAgdGhpcy5zdGFydExvY2F0aW9uKCk7CiAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnc3RhcnRSZWNvcmRMaW5lcycsICdzdGFydCcpOwogICAgICAgICAgLy8g5byA5aeL6L2u6K+iCiAgICAgICAgICB0aGlzLnBvbGxpbmcoKTsKICAgICAgICAgIC8vIOiusOW9leW9k+WJjeaXtumXtAogICAgICAgICAgdGhpcy5zdGFydFJlY29yZFRpbWVyID0gbmV3IERhdGUoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgVG9hc3QoewogICAgICAgICAgICBtZXNzYWdlOiAn572R57uc54q25oCB5byC5bi477yM5peg5rOV5byA5aeL5Lu75YqhJywKICAgICAgICAgICAgZHVyYXRpb246IDMwMDAKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSkuY2F0Y2goZXJyID0+IHsKICAgICAgICBjb25zb2xlLmxvZyhlcnIpOwogICAgICAgIC8vIFRvYXN0KHsKICAgICAgICAvLyAgIG1lc3NhZ2U6IGAke2Vycn1gLAogICAgICAgIC8vICAgZHVyYXRpb246IDMwMDAKICAgICAgICAvLyB9KTsKICAgICAgfSk7CiAgICB9LAogICAgLy8g57uT5p2f6K6w5b2VCiAgICBlbmRSZWNvcmQodHlwZSA9IG51bGwpIHsKICAgICAgbGV0IGRpZmYgPSBNYXRoLmZsb29yKChuZXcgRGF0ZSgpIC0gdGhpcy5zdGFydFJlY29yZFRpbWVyKSAvIDEwMDApOwogICAgICBpZiAoZGlmZiA8PSAxMCkgewogICAgICAgIFRvYXN0KHsKICAgICAgICAgIG1lc3NhZ2U6IGDnu5PmnZ/lpKrlv6vkuoYs6K+3JHsxMCAtIGRpZmZ956eS5ZCO5YaN6K+VYCwKICAgICAgICAgIGR1cmF0aW9uOiAxMDAwCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIERpYWxvZy5jb25maXJtKHsKICAgICAgICB0aXRsZTogJ+agh+mimCcsCiAgICAgICAgbWVzc2FnZTogJ+ehruWumue7k+adn+acrOasoeW3oeajgO+8nycKICAgICAgfSkudGhlbigoKSA9PiB7CiAgICAgICAgdGhpcy5lbmRSZWNvcmRDb25maXJtKHR5cGUpOwogICAgICB9KS5jYXRjaCgoKSA9PiB7CiAgICAgICAgdGhpcy5lbmRSZWNvcmRDYW5jZWwoKTsKICAgICAgfSk7CiAgICB9LAogICAgLy8gdXBsb2FkSW5zcFJvdXRlKCkgewogICAgLy8gICB0cnkgewogICAgLy8gICAgIGNvbnN0IHRoYXQgPSB0aGlzOwogICAgLy8gICAgIC8vIOWumuaXtuWZqAogICAgLy8gICAgIGxldCB0aW1lciA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHsKICAgIC8vICAgICAgIC8vIOa4hemZpOWumuaXtuWZqAogICAgLy8gICAgICAgLy8gY2xlYXJJbnRlcnZhbCh0aW1lcik7CiAgICAvLyAgICAgICBsZXQgdGVtcFRyYWNrUG9sbnRMaXN0ID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLnRyYWNrUG9pbnRMaXN0KSkKICAgIC8vICAgICAgIGlmICh0ZW1wVHJhY2tQb2xudExpc3QubGVuZ3RoID4gMCkgewoKICAgIC8vICAgICAgIH0KICAgIC8vICAgICB9LCAxMDAwICogNjAgKiA2MCAqIDI0ICogMSkKICAgIC8vICAgfSBjYXRjaCAoZSkgewogICAgLy8gICAgIGNvbnNvbGUubG9nKGUpCiAgICAvLyAgIH0KICAgIC8vIH0sCiAgICAvLyDnu5PmnZ/orrDlvZXlj5bmtogKICAgIGVuZFJlY29yZENhbmNlbCgpIHsKICAgICAgdGhpcy5lbmRSZWNvcmRTaG93ID0gZmFsc2U7CiAgICB9LAogICAgLy8g57uT5p2f6K6w5b2V56Gu6K6kCiAgICBhc3luYyBlbmRSZWNvcmRDb25maXJtKHR5cGUgPSBudWxsKSB7CiAgICAgIHRoaXMuZW5kUmVjb3JkU2hvdyA9IGZhbHNlOwogICAgICB0aGlzLnBvbGxpbmdGbGFnID0gZmFsc2U7CiAgICAgIHl1YW5jaHUubG9jYXRpb25BTWFwLnN0b3BSZXF1ZXN0TG9jYXRpb25zKCk7CiAgICAgIGF3YWl0IHRoaXMuZHJhd0VuZFBvaW50KHR5cGUpOwogICAgICB0aGlzLmlmUmVjb3JkaW5nID0gZmFsc2U7CiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdzdGFydFJlY29yZExpbmVzJywgJ2VuZCcpOwogICAgICBpZiAodHlwZSAhPSAnbGVhdmUnKSB7CiAgICAgICAgdGhpcy5yZWZyZXNoVGFzaygpOwogICAgICB9CiAgICAgIFRvYXN0KHsKICAgICAgICBtZXNzYWdlOiAn57uT5p2f5oiQ5YqfJywKICAgICAgICBkdXJhdGlvbjogMjAwMAogICAgICB9KTsKICAgICAgLyoqIDIwMjEvOS8yMiDlj5bmtojkuIrmiqXlt7Llt6Hmo4DnrqHnur8NCiAgICAgIC8vIOS4iuaKpeW3oeajgOiusOW9lQ0KICAgICAgLy8g6ZyA6L+H5ruk5Ye65bey5beh5qOA566h57q/DQogICAgICBsZXQgc291cmNlRGF0YSA9IGF3YWl0IHRoaXMuJHJlZnMubXltYXAuZmluZEhhZEluc3BGZWF0dXJlKCk7DQogICAgICBsZXQgcmVjb3JkRGF0YSA9IHNvdXJjZURhdGEubWFwKChpdGVtKSA9PiB7DQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgY2FsaWJlcjogIGl0ZW0ucHJvcGVydGllcy5jYWxpYmVyLA0KICAgICAgICAgIGd1aWQ6IGl0ZW0ucHJvcGVydGllcy5ndWlkLA0KICAgICAgICAgIGxlbmd0aDogaXRlbS5wcm9wZXJ0aWVzLmxlbmd0aCwNCiAgICAgICAgICB0YXNrSWQ6IHRoaXMudGFza0RldGFpbC50YXNrSWQsDQogICAgICAgIH07DQogICAgICB9KTsNCiAgICAgIHJlY29yZERhdGEgPSByZWNvcmREYXRhLmZpbHRlcih4ID0+IHRoaXMubGluZXMuZXZlcnkoeSA9PiB5Lmd1aWQgIT0geC5ndWlkKSk7DQogICAgICBpZiAocmVjb3JkRGF0YS5sZW5ndGggPD0gMCkgew0KICAgICAgICB1bmkuc2hvd1RvYXN0KHsNCiAgICAgICAgICB0aXRsZTogIue7k+adn+iusOW9lSIsDQogICAgICAgICAgZHVyYXRpb246IDMwMDAsDQogICAgICAgIH0pOw0KICAgICAgICBsZXQgdCA9IHNldFRpbWVvdXQoKCk9PnsNCiAgICAgICAgICB0aGlzLnJlY29yZEJ1dHRvbkxvYWRpbmcgPSBmYWxzZTsNCiAgICAgICAgfSwgMTAwMCk7DQogICAgICAgIHJldHVybjsNCiAgICAgIH0NCiAgICAgIHRoaXMuJGFwaS5wb3N0QWN0aW9uKCIvb3BzLWluc3BlY3Rpb24vYXBpL2luc3BlY3Rpb25SZWNvcmRNdWx0aXBsZSIsIHJlY29yZERhdGEpDQogICAgICAgIC50aGVuKChyZXMpID0+IHsNCiAgICAgICAgICBpZiAocmVzICYmIHJlcy5zdGF0dXMpIHsNCiAgICAgICAgICAgIGNvbnNvbGUubG9nKCLmlrDlop7lt6Hmo4DorrDlvZXmiJDlip8iKTsNCiAgICAgICAgICAgIC8vIOe7k+adn+iusOW9leWQjuWwseWIoOmZpOacrOWcsOe8k+WtmA0KICAgICAgICAgICAgdW5pV2ViVmlldy5wb3N0TWVzc2FnZSh7DQogICAgICAgICAgICAgIGRhdGE6IHsNCiAgICAgICAgICAgICAgICBhY3Rpb246ICJyZW1vdmVJbnNwUmVjb3JkIiwNCiAgICAgICAgICAgICAgICB0YXNrSWQ6IHRoaXMudGFza0RldGFpbC50YXNrSWQNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSkNCiAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgaWYgKHJlY29yZERhdGEubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgICB1bmlXZWJWaWV3LnBvc3RNZXNzYWdlKHsNCiAgICAgICAgICAgICAgICBkYXRhOiB7DQogICAgICAgICAgICAgICAgICBhY3Rpb246ICJzYXZlSW5zcFJlY29yZCIsDQogICAgICAgICAgICAgICAgICBpbnNwUmVjb3JkRGF0YTogSlNPTi5zdHJpbmdpZnkocmVjb3JkRGF0YSksDQogICAgICAgICAgICAgICAgICB0YXNrSWQ6IHRoaXMudGFza0RldGFpbC50YXNrSWQsDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgfQ0KICAgICAgICB9KQ0KICAgICAgICAuZmluYWxseSgoKT0+ew0KICAgICAgICAgIHVuaS5zaG93VG9hc3Qoew0KICAgICAgICAgICAgdGl0bGU6ICLnu5PmnZ/orrDlvZUiLA0KICAgICAgICAgICAgZHVyYXRpb246IDMwMDAsDQogICAgICAgICAgfSk7DQogICAgICAgICAgbGV0IHQgPSBzZXRUaW1lb3V0KCgpPT57DQogICAgICAgICAgICB0aGlzLnJlY29yZEJ1dHRvbkxvYWRpbmcgPSBmYWxzZTsNCiAgICAgICAgICB9LCAxMDAwKTsNCiAgICAgICAgfSkNCiAgICAgICovCiAgICB9LAogICAgLy8g5a6a5pe25ZCR5pys5py65Y+R6YCB5a2Y5YKo5L+h5oGvCiAgICBhc3luYyBzZXRMb2NhbFN0b3JhZ2UoKSB7CiAgICAgIGxldCB0aGF0ID0gdGhpczsKICAgICAgaWYgKHRoaXMucG9sbGluZ0ZsYWcpIHsKICAgICAgICAvKiBsZXQgc3RvcmFnZVRyYWNrRGF0YSA9IHsNCiAgICAgICAgICB0cmFja1BvaW50TGlzdDogdGhhdC50cmFja1BvaW50TGlzdCwNCiAgICAgICAgICB0cmFja1BvaW50VGltZUxpc3Q6IHRoYXQudHJhY2tQb2ludFRpbWVMaXN0LA0KICAgICAgICAgIG92ZXJTcGVlZFRyYWNrTGluZUxpc3Q6IHRoYXQub3ZlclNwZWVkVHJhY2tMaW5lTGlzdCwNCiAgICAgICAgfTsNCiAgICAgICAgICB1bmlXZWJWaWV3LnBvc3RNZXNzYWdlKHsNCiAgICAgICAgICBkYXRhOiB7DQogICAgICAgICAgICBhY3Rpb246ICJzYXZlSW5zcFRyYWNrIiwNCiAgICAgICAgICAgIGluc3BUcmFja0RhdGE6IEpTT04uc3RyaW5naWZ5KHN0b3JhZ2VUcmFja0RhdGEpLA0KICAgICAgICAgICAgdGFza0lkOiB0aGF0LnRhc2tEZXRhaWwudGFza0lkLA0KICAgICAgICAgIH0sDQogICAgICAgIH0pOyAqLwoKICAgICAgICAvLyDkuIrmiqXlt6Hmo4DorrDlvZUKICAgICAgICBsZXQgc291cmNlRGF0YSA9IGF3YWl0IHRoaXMuJHJlZnMubXltYXAuZmluZEhhZEluc3BGZWF0dXJlKCk7CiAgICAgICAgbGV0IHJlY29yZERhdGEgPSBzb3VyY2VEYXRhLm1hcChpdGVtID0+IHsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGNhbGliZXI6IGl0ZW0ucHJvcGVydGllcy5jYWxpYmVyLAogICAgICAgICAgICBndWlkOiBpdGVtLnByb3BlcnRpZXMuZ3VpZCwKICAgICAgICAgICAgbGVuZ3RoOiBpdGVtLnByb3BlcnRpZXMubGVuZ3RoLAogICAgICAgICAgICB0YXNrSWQ6IHRoaXMudGFza0RldGFpbC50YXNrSWQKICAgICAgICAgIH07CiAgICAgICAgfSk7CiAgICAgICAgcmVjb3JkRGF0YSA9IHJlY29yZERhdGEuZmlsdGVyKHggPT4gdGhpcy5saW5lcy5ldmVyeSh5ID0+IHkuZ3VpZCAhPSB4Lmd1aWQpKTsKICAgICAgICBpZiAocmVjb3JkRGF0YS5sZW5ndGggPiAwKSB7CiAgICAgICAgICB0aGlzLiRhcGkucG9zdEFjdGlvbignL29wcy1pbnNwZWN0aW9uL2FwaS9pbnNwZWN0aW9uUmVjb3JkTXVsdGlwbGUnLCByZWNvcmREYXRhKS50aGVuKHJlcyA9PiB7CiAgICAgICAgICAgIGlmIChyZXMgJiYgcmVzLnN0YXR1cykgewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCfmlrDlop7lt6Hmo4DorrDlvZXmiJDlip8nKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB1bmlXZWJWaWV3LnBvc3RNZXNzYWdlKHsKICAgICAgICAgICAgICAgIGRhdGE6IHsKICAgICAgICAgICAgICAgICAgYWN0aW9uOiAnc2F2ZUluc3BSZWNvcmQnLAogICAgICAgICAgICAgICAgICBpbnNwUmVjb3JkRGF0YTogSlNPTi5zdHJpbmdpZnkocmVjb3JkRGF0YSksCiAgICAgICAgICAgICAgICAgIHRhc2tJZDogdGhpcy50YXNrRGV0YWlsLnRhc2tJZAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgbGV0IHRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICB0aGlzLnNldExvY2FsU3RvcmFnZSgpOwogICAgICAgIH0sIDE1MDAwKTsKICAgICAgfQogICAgfSwKICAgIC8vIOafpeivomFwcOerr+WtmOWCqOeahOivpeS7u+WKoeeahOW3oeajgOiusOW9leWSjOi9qOi/ueeCueS9jeaVsOaNrgogICAgZ2V0QXBwSW5zcERhdGEoaWQpIHsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgICAgLyoqIDIwMjEvOS8yMiDlj5bmtojojrflj5ZhcHDnq6/nvJPlrZjnmoTmlbDmja4NCiAgICAgICAgdW5pV2ViVmlldy5wb3N0TWVzc2FnZSh7DQogICAgICAgICAgZGF0YTogew0KICAgICAgICAgICAgYWN0aW9uOiAiZ2V0SW5zcFJlY29yZCIsDQogICAgICAgICAgICB0YXNrSWQ6IGlkLA0KICAgICAgICAgIH0sDQogICAgICAgIH0pOw0KICAgICAgICAqLwogICAgICAgIC8vIHVuaVdlYlZpZXcucG9zdE1lc3NhZ2UoewogICAgICAgIC8vICAgZGF0YTogewogICAgICAgIC8vICAgICBhY3Rpb246ICJnZXRUcmFja1BvaW50cyIsCiAgICAgICAgLy8gICAgIHRhc2tJZDogaWQKICAgICAgICAvLyAgIH0KICAgICAgICAvLyB9KQogICAgICAgIHJlc29sdmUoKTsKICAgICAgfSk7CiAgICB9LAogICAgLy8g5byA5aeL5a6a5L2NCiAgICBzdGFydExvY2F0aW9uKCkgewogICAgICBpZiAoIXRoaXMuY3VycmVudFBvc2l0aW9uIHx8ICF0aGlzLmN1cnJlbnRQb3NpdGlvbi5sb25naXR1ZGUgfHwgIXRoaXMuY3VycmVudFBvc2l0aW9uLmxhdGl0dWRlKSB7CiAgICAgICAgVG9hc3QoewogICAgICAgICAgbWVzc2FnZTogJ+iOt+WPluS9jee9ruWksei0pSEnLAogICAgICAgICAgZHVyYXRpb246IDIwMDAKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3QgY29vcmQgPSBbcGFyc2VGbG9hdCh0aGlzLmN1cnJlbnRQb3NpdGlvbi5sb25naXR1ZGUpLCBwYXJzZUZsb2F0KHRoaXMuY3VycmVudFBvc2l0aW9uLmxhdGl0dWRlKV07CiAgICAgICAgdGhpcy5mbHlUb1BvaW50KGNvb3JkKTsKICAgICAgfQogICAgfSwKICAgIC8qKg0KICAgICAqIOi2heWbvuWdkOagh+i9rOaNouS4umZlYXR1cmUNCiAgICAgKi8KICAgIHN1cGVyTWFwUGFyYW1zVG9GZWF0dXJlKGdlb21ldHJ5KSB7CiAgICAgIGxldCBjb29yZDsKICAgICAgbGV0IHR5cGU7CiAgICAgIHN3aXRjaCAoZ2VvbWV0cnkudHlwZSkgewogICAgICAgIGNhc2UgJ1BPSU5UJzoKICAgICAgICAgIHR5cGUgPSAnUG9pbnQnOwogICAgICAgICAgY29vcmQgPSBbZ2VvbWV0cnkucG9pbnRzWzBdLngsIGdlb21ldHJ5LnBvaW50c1swXS55XTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgJ0xJTkUnOgogICAgICAgICAgdHlwZSA9ICdMaW5lU3RyaW5nJzsKICAgICAgICAgIGNvb3JkID0gZ2VvbWV0cnkucG9pbnRzLm1hcChwb2ludCA9PiBbcG9pbnQueCwgcG9pbnQueV0pOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAnUkVHSU9OJzoKICAgICAgICAgIHR5cGUgPSAnUG9seWdvbic7CiAgICAgICAgICBjb29yZCA9IFtnZW9tZXRyeS5wb2ludHMubWFwKHBvaW50ID0+IFtwb2ludC54LCBwb2ludC55XSldOwogICAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgICAgcmV0dXJuIHsKICAgICAgICB0eXBlOiAnRmVhdHVyZScsCiAgICAgICAgZ2VvbWV0cnk6IHsKICAgICAgICAgIHR5cGUsCiAgICAgICAgICBjb29yZGluYXRlczogY29vcmQKICAgICAgICB9CiAgICAgIH07CiAgICB9LAogICAgZmVhdHVyZVRvT2JqZWN0KG5hbWVzLCB2YWx1ZXMpIHsKICAgICAgbGV0IG9iaiA9IHt9OwogICAgICBuYW1lcy5mb3JFYWNoKChuYW1lLCBpbmRleCkgPT4gewogICAgICAgIG9ialtuYW1lXSA9IHZhbHVlc1tpbmRleF07CiAgICAgIH0pOwogICAgICByZXR1cm4gb2JqOwogICAgfSwKICAgIGdvRXZlbnRPckZsYXdEZXRhaWwoZmVhdHVyZSwgdHlwZSkgewogICAgICBsZXQgY3VycmVudFBvaW50ID0gZmVhdHVyZTsKICAgICAgY3VycmVudFBvaW50ID0gZmVhdHVyZTsKICAgICAgY3VycmVudFBvaW50LmNvZGUgPSBmZWF0dXJlLmRldmljZUlkIHx8ICcnOwogICAgICBjdXJyZW50UG9pbnQuYmlnVHlwZSA9IGZlYXR1cmUuYml6VHlwZSB8fCAnJzsKICAgICAgY3VycmVudFBvaW50LmxuZyA9IGZlYXR1cmUuc3RhcnRMb25naXR1ZGU7CiAgICAgIGN1cnJlbnRQb2ludC5sYXQgPSBmZWF0dXJlLnN0YXJ0TGF0aXR1ZGU7CiAgICAgIC8vIOimgee0oOaJgOWcqOWbvuWxgklE5ZKM5bGe5oCn5L+h5oGvCiAgICAgIC8vIGN1cnJlbnRQb2ludC5sYXllcklEID0gZmVhdHVyZS5sYXllci5pZCB8fCAnJwogICAgICAvLyBjdXJyZW50UG9pbnQubGF5ZXJUeXBlID0gZmVhdHVyZS5sYXllci50eXBlIHx8ICcnCiAgICAgIC8vIGN1cnJlbnRQb2ludC5wcm9wZXJ0aWVzID0gZmVhdHVyZS5wcm9wZXJ0aWVzIHx8ICcnCiAgICAgIC8vIOW6leWbvuimgee0oG5hbWVfbG9jYWzmiJborr7mlr3opoHntKByb2FkX25hbWUsaWQKICAgICAgY3VycmVudFBvaW50LnJvYWRfbmFtZSA9IGZlYXR1cmUucm9hZDsKICAgICAgLy8gY3VycmVudFBvaW50LmlkID0gZmVhdHVyZS5wcm9wZXJ0aWVzLmlkCiAgICAgIGlmICh0eXBlID09ICdldmVudCcpIHsKICAgICAgICAvLyB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgLy8gICBuYW1lOiAnYWRkUHJvYmxlbUluZGV4JywKICAgICAgICAvLyAgIHF1ZXJ5OiB7IG1zZzogY3VycmVudFBvaW50LCB0b2tlbjogdGhpcy5mb3JtVG9rZW4sIHRhc2tJZDogdGhpcy4kcm91dGUucXVlcnkudGFza0lkIH0sCiAgICAgICAgLy8gICBwYXJhbXM6IHsgdHlwZTogJ2FkZCcgfQogICAgICAgIC8vIH0pCiAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goewogICAgICAgICAgbmFtZTogJ2FkZFByb2JsZW1JbmRleCcsCiAgICAgICAgICBxdWVyeTogewogICAgICAgICAgICBtc2c6IGN1cnJlbnRQb2ludCwKICAgICAgICAgICAgdG9rZW46IHRoaXMuZm9ybVRva2VuLAogICAgICAgICAgICB0YXNrSWQ6IHRoaXMuJHJvdXRlLnF1ZXJ5LnRhc2tJZAogICAgICAgICAgfSwKICAgICAgICAgIHBhcmFtczogewogICAgICAgICAgICB0eXBlOiAnYWRkJwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICAgIG5hbWU6ICdhZGRGbGF3cycsCiAgICAgICAgICBxdWVyeTogewogICAgICAgICAgICBtc2c6IGN1cnJlbnRQb2ludCwKICAgICAgICAgICAgdG9rZW46IHRoaXMuZm9ybVRva2VuLAogICAgICAgICAgICB0YXNrSWQ6IHRoaXMuJHJvdXRlLnF1ZXJ5LnRhc2tJZAogICAgICAgICAgfSwKICAgICAgICAgIHBhcmFtczogewogICAgICAgICAgICB0eXBlOiAnYWRkJwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgLy8g56Gu6K6kCiAgICBvbkNvbmZpcm0oKSB7CiAgICAgIGlmICh0cnVlKSB7CiAgICAgICAgbGV0IGZlYXR1cmUgPSB0aGlzLnNpZ25Gb3JtLmZlYXR1cmU7CiAgICAgICAgbGV0IGNvcHlTaWduRm9ybSA9IHRoaXMuZGVlcENsb25lKHRoaXMuc2lnbkZvcm0pOwogICAgICAgIGNvcHlTaWduRm9ybS5pbnNwRGF0ZSA9IGRheWpzKCkuZm9ybWF0KCdZWVlZLU1NLUREIEhIOm1tOnNzJyk7CiAgICAgICAgY29weVNpZ25Gb3JtLmV4dDEgPSBjb3B5U2lnbkZvcm0ucmVtYXJrOyAvLyDlpIfms6gKICAgICAgICBkZWxldGUgY29weVNpZ25Gb3JtLmZlYXR1cmU7CiAgICAgICAgYXBpLnNpZ25Jbihjb3B5U2lnbkZvcm0pLnRoZW4ocmVzID0+IHsKICAgICAgICAgIGlmIChyZXMgJiYgcmVzLnN0YXR1cykgewogICAgICAgICAgICBUb2FzdCh7CiAgICAgICAgICAgICAgbWVzc2FnZTogJ+atpOWFs+mUrueCueetvuWIsOaIkOWKnycsCiAgICAgICAgICAgICAgZHVyYXRpb246IDIwMDAKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIC8vIOW3oeajgOS6i+S7tuS4iuaKpQogICAgICAgICAgICBpZiAoY29weVNpZ25Gb3JtLmlzUmVwb3J0ID09ICfpl67popjkuIrmiqUnKSB7CiAgICAgICAgICAgICAgdGhpcy5nb0V2ZW50T3JGbGF3RGV0YWlsKGZlYXR1cmUsICdldmVudCcpOwogICAgICAgICAgICB9IGVsc2UgaWYgKGNvcHlTaWduRm9ybS5pc1JlcG9ydCA9PSAn5paw5aKe57y66Zm3JykgewogICAgICAgICAgICAgIHRoaXMuZ29FdmVudE9yRmxhd0RldGFpbChmZWF0dXJlLCAnZmxhdycpOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBUb2FzdCh7CiAgICAgICAgICAgICAgbWVzc2FnZTogJ+atpOWFs+mUrueCueetvuWIsOWksei0pScsCiAgICAgICAgICAgICAgZHVyYXRpb246IDIwMDAKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgdGhpcy5zaWduU2hvdyA9IGZhbHNlOwogICAgICAgIHRoaXMuc2lnbkZvcm0ucmVtYXJrID0gJyc7CiAgICAgICAgdGhpcy5zaWduRm9ybS5kZXZpY2VTdGF0dXMgPSAnMCc7CiAgICAgICAgdGhpcy5zaWduRm9ybS5pc1JlcG9ydCA9ICcnOwogICAgICAgIHRoaXMuc2lnbkZvcm0uaW5zcEltYWdlc0xpc3QgPSBbXTsKICAgICAgICB0aGlzLmF0dGFjaG1lbnQgPSAnJzsKICAgICAgICBtYXBPYmoubWFwSW5zdGFuY2Uuc2V0U291cmNlRGF0YSgnYnVmZmVyZWQnLCB7CiAgICAgICAgICB0eXBlOiAnRmVhdHVyZUNvbGxlY3Rpb24nLAogICAgICAgICAgZmVhdHVyZXM6IFtdCiAgICAgICAgfSk7CiAgICAgICAgLy8gbG9jYWxTdG9yYWdlLnNldEl0ZW0oImlzUmVwb3J0RXZlbnQiLCBmYWxzZSk7CiAgICAgICAgdGhpcy5yZWZyZXNoVGFzaygpOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnNvbGUubG9nKCfpqozor4HlpLHotKUnKTsKICAgICAgfQogICAgfSwKICAgIC8vIOWPlua2iAogICAgb25DYW5jZWwoKSB7CiAgICAgIGNvbnNvbGUubG9nKCdjbGljayBjYW5jZWwnKTsKICAgICAgLy8gbG9jYWxTdG9yYWdlLnNldEl0ZW0oImlzUmVwb3J0RXZlbnQiLCBmYWxzZSk7CiAgICAgIHRoaXMuc2lnblNob3cgPSBmYWxzZTsKICAgICAgbWFwT2JqLm1hcEluc3RhbmNlLnNldFNvdXJjZURhdGEoJ2J1ZmZlcmVkJywgewogICAgICAgIHR5cGU6ICdGZWF0dXJlQ29sbGVjdGlvbicsCiAgICAgICAgZmVhdHVyZXM6IFtdCiAgICAgIH0pOwogICAgfSwKICAgIC8vIOetvuWIsAogICAgYXN5bmMgc3RhcnRTaWduSW4oZmVhdHVyZSkgewogICAgICAvLyDliKnnlKhmZWF0dXJl5p2l5Yik5pat5piv5ZCm5aSE5LqOMzVt6IyD5Zu05YaF77yM5aaC5p6c5aSE5LqO77yM5Y+v5Lul6L+b6KGM562+5Yiw77yM5ZCm5YiZ5LiN6IO96L+b6KGM562+5YiwCiAgICAgIGNvbnN0IHBvc2l0aW9uID0gdGhpcy5jdXJyZW50UG9zaXRpb247CiAgICAgIGlmICghcG9zaXRpb24pIHsKICAgICAgICBUb2FzdC53YXJuaW5nKHsKICAgICAgICAgIG1lc3NhZ2U6ICfojrflj5bkuI3liLDlt6Hmo4DkurrkvY3nva4nLAogICAgICAgICAgZHVyYXRpb246IDIwMDAKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgY29uc3QgY29vcmQgPSBbcGFyc2VGbG9hdChwb3NpdGlvbi5sb25naXR1ZGUpLCBwYXJzZUZsb2F0KHBvc2l0aW9uLmxhdGl0dWRlKV07CiAgICAgIGNvbnN0IHBvaW50ID0gdHVyZi5wb2ludChjb29yZCk7CiAgICAgIGNvbnN0IGVuZ0dlb20gPSBmZWF0dXJlLmdlb207CiAgICAgIGNvbnN0IGJ1ZmZlcmVkID0gdHVyZi5idWZmZXIoZW5nR2VvbSwgMC4wMzUsIHsKICAgICAgICB1bml0OiAna2lsb21ldGVycycKICAgICAgfSk7CiAgICAgIGNvbnN0IGlzSW5CdWZmZXIgPSB0dXJmLmluc2lkZShwb2ludCwgYnVmZmVyZWQpOwogICAgICBpZiAoIWlzSW5CdWZmZXIpIHsKICAgICAgICBUb2FzdCh7CiAgICAgICAgICBtZXNzYWdlOiAn5pyq5aSE5LqO6K+l5YWz6ZSu54K56IyD5Zu05YaFJywKICAgICAgICAgIGR1cmF0aW9uOiAyMDAwCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIFRvYXN0LmxvYWRpbmcoewogICAgICAgIG1lc3NhZ2U6ICfmraPlnKjliqDovb0nLAogICAgICAgIGZvcmJpZENsaWNrOiB0cnVlCiAgICAgIH0pOwogICAgICB0aGlzLnNpZ25TaG93ID0gdHJ1ZTsKICAgICAgdGhpcy5wb2ludExpc3RTaG93ID0gZmFsc2U7CiAgICAgIHRoaXMuYXR0YWNobWVudCA9ICcnOwogICAgICB0aGlzLmlzUmVwb3J0ID0gJyc7CiAgICAgIHRoaXMuZGV2aWNlTmFtZSA9IGZlYXR1cmUuZGV2aWNlVHlwZSArIChmZWF0dXJlLmRldmljZUlkIHx8ICcnKTsKICAgICAgaWYgKCFmZWF0dXJlLmRldmljZVN0YXR1cyB8fCBmZWF0dXJlLmRldmljZVN0YXR1cyA9PSAnMicpIHsKICAgICAgICAvLyDmnKrlt6Hmo4AKICAgICAgICB0aGlzLmhhc1NpZ25JbiA9IGZhbHNlOwogICAgICAgIHRoaXMuc2lnbkZvcm0ucmVtYXJrID0gJyc7CiAgICAgICAgdGhpcy5zaWduRm9ybS5kZXZpY2VTdGF0dXMgPSAnMCc7CiAgICAgICAgdGhpcy5zaWduRm9ybS5pbnNwSW1hZ2VzTGlzdCA9IFtdOwogICAgICAgIHRoaXMuc2lnbkZvcm0ucG9pbnRJZCA9IGZlYXR1cmUuaWQ7CiAgICAgICAgdGhpcy5zaWduRm9ybS50YXNrSWQgPSB0aGlzLiRyb3V0ZS5xdWVyeS50YXNrSWQsIHRoaXMuc2lnbkZvcm0uZmVhdHVyZSA9IGZlYXR1cmU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5oYXNTaWduSW4gPSB0cnVlOwogICAgICAgIGxldCBwYXJhbXMgPSB7CiAgICAgICAgICBwYWdlOiAxLAogICAgICAgICAgc2l6ZTogOTk5LAogICAgICAgICAgZGV2aWNlU3RhdHVzOiBmZWF0dXJlLmRldmljZVN0YXR1cywKICAgICAgICAgIHBvaW50SWQ6IGZlYXR1cmUuaWQsCiAgICAgICAgICB0YXNrSWQ6IHRoaXMuJHJvdXRlLnF1ZXJ5LnRhc2tJZAogICAgICAgIH07CiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgcmVxdWVzdCh7CiAgICAgICAgICB1cmw6ICcveGFzdy1waXBlLW9wZXJhdGlvbi9pbnNwUG9pbnRSZWNvcmQvcGFnZScsCiAgICAgICAgICBtZXRob2Q6ICdnZXQnLAogICAgICAgICAgcGFyYW1zOiBwYXJhbXMKICAgICAgICB9KTsKICAgICAgICBpZiAocmVzICYmIHJlcy5zdGF0dXMpIHsKICAgICAgICAgIGxldCByZXN1bHQgPSByZXMuZGF0YS5yZWNvcmRzWzBdOwogICAgICAgICAgdGhpcy5zaWduRm9ybS5kZXZpY2VTdGF0dXMgPSByZXN1bHQuZGV2aWNlU3RhdHVzOwogICAgICAgICAgdGhpcy5zaWduRm9ybS5yZW1hcmsgPSByZXN1bHQuZXh0MTsKICAgICAgICAgIHRoaXMuc2lnbkZvcm0uaXNSZXBvcnQgPSByZXN1bHQuaXNSZXBvcnQ7CiAgICAgICAgICBjb25zdCBhdHQgPSBhd2FpdCByZXF1ZXN0KHsKICAgICAgICAgICAgdXJsOiAnL3hhc3ctcGlwZS1vcGVyYXRpb24vaW5zcFBvaW50UmVjb3JkJywKICAgICAgICAgICAgbWV0aG9kOiAnZ2V0JywKICAgICAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICAgICAgaWQ6IHJlc3VsdC5pZAogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICAgIGlmIChhdHQgJiYgYXR0LnN0YXR1cykgewogICAgICAgICAgICB0aGlzLnNpZ25Gb3JtLmluc3BJbWFnZXNMaXN0ID0gYXR0LmRhdGEuaW5zcEltYWdlc0xpc3Q7CiAgICAgICAgICAgIHRoaXMuYXR0YWNobWVudCA9IGF0dC5kYXRhLmluc3BJbWFnZXNMaXN0WzBdLmZpbGVJZDsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgY29uc29sZS5sb2coJ3NpZ25Gb3JtJywgdGhpcy5zaWduRm9ybSk7CiAgICB9LAogICAgLy8g5LqL5Lu257G75Z6L6YCJ5oup56Gu6K6kCiAgICBldmVudFR5cGVDb25maXJtKGV2ZW50KSB7CiAgICAgIHRoaXMuJHNldCh0aGlzLnNpZ25Gb3JtLCAnZXZlbnRUeXBlJywgZXZlbnRbMV0ubGFiZWwpOwogICAgICB0aGlzLnNpZ25Gb3JtLmluc3BJdGVtSWQgPSBldmVudFsxXS52YWx1ZTsKICAgIH0sCiAgICAvLyDmt7Hmi7fotJ0KICAgIGRlZXBDbG9uZShkYXRhKSB7CiAgICAgIHJldHVybiBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGRhdGEpKTsKICAgIH0sCiAgICAvLyDorqHnrpfkuK3lv4PngrkKICAgIGNvbXB1dGVDZW50ZXIoZmVhdHVyZSkgewogICAgICBsZXQgcG9zaXRpb247CiAgICAgIGlmIChmZWF0dXJlLnR5cGUgPT09ICdQb2x5Z29uJyB8fCBmZWF0dXJlLnR5cGUgPT09ICdNdWx0aVBvbHlnb24nKSB7CiAgICAgICAgY29uc3QgY2VudGVyID0gdHVyZi5jZW50ZXIoZmVhdHVyZSk7CiAgICAgICAgcG9zaXRpb24gPSBjZW50ZXIuZ2VvbWV0cnk7CiAgICAgIH0gZWxzZSBpZiAoZmVhdHVyZS50eXBlID09PSAnTGluZVN0cmluZycpIHsKICAgICAgICBjb25zdCBjZW50ZXIgPSB0dXJmLmNlbnRlcihmZWF0dXJlKTsKICAgICAgICBwb3NpdGlvbiA9IGNlbnRlci5nZW9tZXRyeTsKICAgICAgfSBlbHNlIGlmIChmZWF0dXJlLnR5cGUgPT09ICdQb2ludCcpIHsKICAgICAgICBwb3NpdGlvbiA9IGZlYXR1cmU7CiAgICAgIH0KICAgICAgcmV0dXJuIHBvc2l0aW9uOwogICAgfSwKICAgIHJlcG9ydEV2ZW50KGZlYXR1cmUpIHsKICAgICAgdGhpcy5yZXBvcnRGb290ZXJTaG93ID0gZmFsc2U7CiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICBwYXRoOiAnL3BhZ2VzL2luc3BlY3Rpb25NYW5hZ2UvYWRkLWV2ZW50JywKICAgICAgICBxdWVyeTogewogICAgICAgICAgdGFza0lkOiB0aGlzLnRhc2tEZXRhaWwudGFza0lkLAogICAgICAgICAgZmVhdHVyZTogZmVhdHVyZSwKICAgICAgICAgIHJhbmdlTGlzdDogdGhpcy5yYW5nZUxpc3QsCiAgICAgICAgICB0YXNrRGV0YWlsOiB0aGlzLnRhc2tEZXRhaWwKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIEdldERpc3RhbmNlKGNvb3JkQXJyYXkxLCBjb29yZEFycmF5MikgewogICAgICBsZXQgbG5nMSA9IGNvb3JkQXJyYXkxWzBdOwogICAgICBsZXQgbGF0MSA9IGNvb3JkQXJyYXkxWzFdOwogICAgICBsZXQgbG5nMiA9IGNvb3JkQXJyYXkyWzBdOwogICAgICBsZXQgbGF0MiA9IGNvb3JkQXJyYXkyWzFdOwogICAgICBsZXQgcmFkTGF0MSA9IGxhdDEgKiBNYXRoLlBJIC8gMTgwLjA7CiAgICAgIGxldCByYWRMYXQyID0gbGF0MiAqIE1hdGguUEkgLyAxODAuMDsKICAgICAgbGV0IGEgPSByYWRMYXQxIC0gcmFkTGF0MjsKICAgICAgbGV0IGIgPSBsbmcxICogTWF0aC5QSSAvIDE4MC4wIC0gbG5nMiAqIE1hdGguUEkgLyAxODAuMDsKICAgICAgbGV0IHMgPSAyICogTWF0aC5hc2luKE1hdGguc3FydChNYXRoLnBvdyhNYXRoLnNpbihhIC8gMiksIDIpICsgTWF0aC5jb3MocmFkTGF0MSkgKiBNYXRoLmNvcyhyYWRMYXQyKSAqIE1hdGgucG93KE1hdGguc2luKGIgLyAyKSwgMikpKTsKICAgICAgcyA9IHMgKiA2Mzc4LjEzNzsgLy8gRUFSVEhfUkFESVVTOwogICAgICBzID0gTWF0aC5yb3VuZChzICogMTAwMDApIC8gMTAwMDA7CiAgICAgIHJldHVybiBzOwogICAgfSwKICAgIHNob3dSb3V0ZSgpIHsKICAgICAgdGhpcy5pc1Nob3dSb3V0ZSA9ICF0aGlzLmlzU2hvd1JvdXRlOwogICAgICBpZiAobWFwT2JqLm1hcC5nZXRMYXlvdXRQcm9wZXJ0eSgndHJhY2tMaW5lTGF5ZXJfbm93JywgJ3Zpc2liaWxpdHknKSA9PT0gJ3Zpc2libGUnKSB7CiAgICAgICAgbWFwT2JqLm1hcC5zZXRMYXlvdXRQcm9wZXJ0eSgndHJhY2tMaW5lTGF5ZXJfbm93JywgJ3Zpc2liaWxpdHknLCAnbm9uZScpOwogICAgICB9IGVsc2UgewogICAgICAgIG1hcE9iai5tYXAuc2V0TGF5b3V0UHJvcGVydHkoJ3RyYWNrTGluZUxheWVyX25vdycsICd2aXNpYmlsaXR5JywgJ3Zpc2libGUnKTsKICAgICAgfQogICAgICBpZiAobWFwT2JqLm1hcC5nZXRMYXlvdXRQcm9wZXJ0eSgndHJhY2tMaW5lTGF5ZXJfYXJyb3cnLCAndmlzaWJpbGl0eScpID09PSAndmlzaWJsZScpIHsKICAgICAgICBtYXBPYmoubWFwLnNldExheW91dFByb3BlcnR5KCd0cmFja0xpbmVMYXllcl9hcnJvdycsICd2aXNpYmlsaXR5JywgJ25vbmUnKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBtYXBPYmoubWFwLnNldExheW91dFByb3BlcnR5KCd0cmFja0xpbmVMYXllcl9hcnJvdycsICd2aXNpYmlsaXR5JywgJ3Zpc2libGUnKTsKICAgICAgfQogICAgICBpZiAobWFwT2JqLm1hcC5nZXRMYXlvdXRQcm9wZXJ0eSgndHJhY2tMaW5lTGF5ZXJfb3ZlclNwZWVkJywgJ3Zpc2liaWxpdHknKSA9PT0gJ3Zpc2libGUnKSB7CiAgICAgICAgbWFwT2JqLm1hcC5zZXRMYXlvdXRQcm9wZXJ0eSgndHJhY2tMaW5lTGF5ZXJfb3ZlclNwZWVkJywgJ3Zpc2liaWxpdHknLCAnbm9uZScpOwogICAgICB9IGVsc2UgewogICAgICAgIG1hcE9iai5tYXAuc2V0TGF5b3V0UHJvcGVydHkoJ3RyYWNrTGluZUxheWVyX292ZXJTcGVlZCcsICd2aXNpYmlsaXR5JywgJ3Zpc2libGUnKTsKICAgICAgfQogICAgICBpZiAobWFwT2JqLm1hcC5nZXRMYXlvdXRQcm9wZXJ0eSgnc3RhcnRQb2ludExheWVyX25vdycsICd2aXNpYmlsaXR5JykgPT09ICd2aXNpYmxlJykgewogICAgICAgIG1hcE9iai5tYXAuc2V0TGF5b3V0UHJvcGVydHkoJ3N0YXJ0UG9pbnRMYXllcl9ub3cnLCAndmlzaWJpbGl0eScsICdub25lJyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbWFwT2JqLm1hcC5zZXRMYXlvdXRQcm9wZXJ0eSgnc3RhcnRQb2ludExheWVyX25vdycsICd2aXNpYmlsaXR5JywgJ3Zpc2libGUnKTsKICAgICAgfQogICAgICBpZiAobWFwT2JqLm1hcC5nZXRMYXlvdXRQcm9wZXJ0eSgnZW5kUG9pbnRMYXllcl9ub3cnLCAndmlzaWJpbGl0eScpID09PSAndmlzaWJsZScpIHsKICAgICAgICBtYXBPYmoubWFwLnNldExheW91dFByb3BlcnR5KCdlbmRQb2ludExheWVyX25vdycsICd2aXNpYmlsaXR5JywgJ25vbmUnKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBtYXBPYmoubWFwLnNldExheW91dFByb3BlcnR5KCdlbmRQb2ludExheWVyX25vdycsICd2aXNpYmlsaXR5JywgJ3Zpc2libGUnKTsKICAgICAgfQogICAgICBpZiAobWFwT2JqLm1hcC5nZXRMYXlvdXRQcm9wZXJ0eSgnc3RhcnRQb2ludF9sYWJlbCcsICd2aXNpYmlsaXR5JykgPT09ICd2aXNpYmxlJykgewogICAgICAgIG1hcE9iai5tYXAuc2V0TGF5b3V0UHJvcGVydHkoJ3N0YXJ0UG9pbnRfbGFiZWwnLCAndmlzaWJpbGl0eScsICdub25lJyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbWFwT2JqLm1hcC5zZXRMYXlvdXRQcm9wZXJ0eSgnc3RhcnRQb2ludF9sYWJlbCcsICd2aXNpYmlsaXR5JywgJ3Zpc2libGUnKTsKICAgICAgfQogICAgICBpZiAobWFwT2JqLm1hcC5nZXRMYXlvdXRQcm9wZXJ0eSgnZW5kUG9pbnRfbGFiZWwnLCAndmlzaWJpbGl0eScpID09PSAndmlzaWJsZScpIHsKICAgICAgICBtYXBPYmoubWFwLnNldExheW91dFByb3BlcnR5KCdlbmRQb2ludF9sYWJlbCcsICd2aXNpYmlsaXR5JywgJ25vbmUnKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBtYXBPYmoubWFwLnNldExheW91dFByb3BlcnR5KCdlbmRQb2ludF9sYWJlbCcsICd2aXNpYmlsaXR5JywgJ3Zpc2libGUnKTsKICAgICAgfQogICAgfSwKICAgIHJlc2V0TWFwVmlldygpIHsKICAgICAgdGhpcy4kcmVmcy5teW1hcCAmJiBtYXBPYmoubWFwLnJlc2V0Tm9ydGhQaXRjaCgpOwogICAgfSwKICAgIGNsaWNrUmVwb3J0RXZlbnQoKSB7CiAgICAgIGNvbnNvbGUubG9nKCdjbGljayB0aGUgY2xpY2tSZXBvcnRFdmVudCcpOwogICAgICBsZXQgcG9zaXRpb24gPSBbXTsKICAgICAgaWYgKCF0aGlzLmN1cnJlbnRQb3NpdGlvbikgewogICAgICAgIGxldCBwb3MgPSB1bmRlZmluZWQ7CiAgICAgICAgaWYgKHRoaXMucmFuZ2VMaXN0Lmxlbmd0aCA+IDApIHsKICAgICAgICAgIGxldCBmZWF0dXJlID0gSlNPTi5wYXJzZSh0aGlzLnJhbmdlTGlzdFswXS50YXNrUmFuZ2VyR2VvbSk7CiAgICAgICAgICBpZiAoZmVhdHVyZS5nZW9tZXRyeS50eXBlID09PSAnUG9seWdvbicgfHwgZmVhdHVyZS5nZW9tZXRyeS50eXBlID09PSAnTXVsdGlQb2x5Z29uJykgewogICAgICAgICAgICBjb25zdCBjZW50ZXIgPSB0dXJmLmNlbnRlcihmZWF0dXJlLmdlb21ldHJ5KTsKICAgICAgICAgICAgcG9zID0gY2VudGVyLmdlb21ldHJ5OwogICAgICAgICAgfSBlbHNlIGlmIChmZWF0dXJlLmdlb21ldHJ5LnR5cGUgPT09ICdMaW5lU3RyaW5nJykgewogICAgICAgICAgICBjb25zdCBjZW50ZXIgPSB0dXJmLmNlbnRlcihmZWF0dXJlLmdlb21ldHJ5KTsKICAgICAgICAgICAgcG9zID0gY2VudGVyLmdlb21ldHJ5OwogICAgICAgICAgfSBlbHNlIGlmIChmZWF0dXJlLmdlb21ldHJ5LnR5cGUgPT09ICdQb2ludCcpIHsKICAgICAgICAgICAgcG9zID0gZmVhdHVyZS5nZW9tZXRyeTsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChwb3MpIHsKICAgICAgICAgICAgcG9zaXRpb24gPSBwb3MuY29vcmRpbmF0ZXM7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBwb3NpdGlvbiA9IFsxMTkuOTYxMjM1NTk3NzI5NjgsIDMwLjI3MDk0NjkxOTkxODA2XTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcG9zaXRpb24gPSBbcGFyc2VGbG9hdCh0aGlzLmN1cnJlbnRQb3NpdGlvbi5sb25naXR1ZGUpLCBwYXJzZUZsb2F0KHRoaXMuY3VycmVudFBvc2l0aW9uLmxhdGl0dWRlKV07CiAgICAgIH0KICAgICAgdGhpcy5zaWduU2hvdyA9IGZhbHNlOwogICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgbmFtZTogJ2FkZEV2ZW50JywKICAgICAgICBxdWVyeTogewogICAgICAgICAgdGFza0lkOiB0aGlzLnRhc2tEZXRhaWwudGFza0lkLAogICAgICAgICAgcmFuZ2VMaXN0OiB0aGlzLnJhbmdlTGlzdCwKICAgICAgICAgIHRhc2tEZXRhaWw6IHRoaXMudGFza0RldGFpbCwKICAgICAgICAgIHBvc2l0aW9uOiBwb3NpdGlvbgogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgLy8g57O757uf5o+Q56S66Z+zCiAgICAvLyBzcGVlY2goKSB7CiAgICAvLyAgIC8vIOengeacieWPmOmHj3RpbWVyCiAgICAvLyAgIGxldCB0aW1lciA9IG5ldyBEYXRlKCk7CiAgICAvLyAgIC8vIOesrOS4gOasoei/m+WFpQogICAgLy8gICBsZXQgaXNGaXJzdEluID0gdHJ1ZTsKICAgIC8vICAgcmV0dXJuIHsKICAgIC8vICAgICBwdWJsaWNTcGVlY2g6IGZ1bmN0aW9uICgpIHsKICAgIC8vICAgICAgIGlmIChpc0ZpcnN0SW4gfHwgKG5ldyBEYXRlKCkgLSB0aW1lcikvMTAwMCA+IDIwKSB7CiAgICAvLyAgICAgICAgIGNvbnN0IGlubmVyQXVkaW9Db250ZXh0ID0gdW5pLmNyZWF0ZUlubmVyQXVkaW9Db250ZXh0KCk7CiAgICAvLyAgICAgICAgIGlubmVyQXVkaW9Db250ZXh0LmF1dG9wbGF5ID0gdHJ1ZTsKICAgIC8vICAgICAgICAgaW5uZXJBdWRpb0NvbnRleHQuc3JjID0gcmVxdWlyZSgiQHN0YXRpYy9hdWRpby90aXBzLm1wMyIpOwogICAgLy8gICAgICAgICBpbm5lckF1ZGlvQ29udGV4dC5vblBsYXkoKCkgPT4gewogICAgLy8gICAgICAgICAgIGNvbnNvbGUubG9nKCLlvIDlp4vmkq3mlL4iKTsKICAgIC8vICAgICAgICAgfSk7CiAgICAvLyAgICAgICAgIGlubmVyQXVkaW9Db250ZXh0Lm9uRXJyb3IoKHJlcykgPT4gewogICAgLy8gICAgICAgICAgIGNvbnNvbGUubG9nKHJlcz8uZXJyTXNnKTsKICAgIC8vICAgICAgICAgICBjb25zb2xlLmxvZyhyZXM/LmVyckNvZGUpOwogICAgLy8gICAgICAgICB9KQogICAgLy8gICAgICAgICBpbm5lckF1ZGlvQ29udGV4dC5wbGF5KCk7CiAgICAvLyAgICAgICAgIC8vIOWvueengeacieWPmOmHj+i/m+ihjOi1i+WAvAogICAgLy8gICAgICAgICBpc0ZpcnN0SW4gPSBmYWxzZTsKICAgIC8vICAgICAgICAgdGltZXIgPSBuZXcgRGF0ZSgpOwogICAgLy8gICAgICAgfQogICAgLy8gICAgIH0sCiAgICAvLyAgICAgcmVzZXRGaXJzdEluOiBmdW5jdGlvbiAoKSB7CiAgICAvLyAgICAgICBpc0ZpcnN0SW4gPSB0cnVlOwogICAgLy8gICAgIH0KICAgIC8vICAgfTsKICAgIC8vIH0sCiAgICAvLyDliKTmlq3mmK/lkKblnKjlhbPplK7ngrnojIPlm7TlhoUKICAgIGlzSW5LZXlQb2ludEJ1ZmZlcigpIHsKICAgICAgY29uc3QgcG9zaXRpb24gPSB0aGlzLmN1cnJlbnRQb3NpdGlvbjsKICAgICAgdGhpcy5rZXlEZXRhaWxMaXN0LmZvckVhY2goaXRlbSA9PiB7CiAgICAgICAgdmFyIF9pdGVtJGluc3BlY3Rpb25UYXNrRDsKICAgICAgICBsZXQgZGV0YWlsID0gaXRlbSA9PT0gbnVsbCB8fCBpdGVtID09PSB2b2lkIDAgfHwgKF9pdGVtJGluc3BlY3Rpb25UYXNrRCA9IGl0ZW0uaW5zcGVjdGlvblRhc2tEZXRhaWxEVE8pID09PSBudWxsIHx8IF9pdGVtJGluc3BlY3Rpb25UYXNrRCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2l0ZW0kaW5zcGVjdGlvblRhc2tELmluc3BlY3Rpb25UYXNrRGV0YWlsOwogICAgICAgIGlmICh0cnVlKSB7CiAgICAgICAgICBjb25zdCBjb29yZCA9IFtwYXJzZUZsb2F0KHBvc2l0aW9uLmxvbmdpdHVkZSksIHBhcnNlRmxvYXQocG9zaXRpb24ubGF0aXR1ZGUpXTsKICAgICAgICAgIGNvbnN0IHBvaW50ID0gdHVyZi5wb2ludChjb29yZCk7CiAgICAgICAgICBjb25zdCBlbmdHZW9tID0gdHlwZW9mIGl0ZW0uZW5nSW5mb0RUTy5lbmdHZW9tICE9PSAnb2JqZWN0JyA/IEpTT04ucGFyc2UoaXRlbS5lbmdJbmZvRFRPLmVuZ0dlb20pIDogaXRlbS5lbmdJbmZvRFRPLmVuZ0dlb207CiAgICAgICAgICBjb25zdCBidWZmZXJlZCA9IHR1cmYuYnVmZmVyKGVuZ0dlb20sIDAuMDM1LCAna2lsb21ldGVycycpOwogICAgICAgICAgY29uc3QgaXNJbkJ1ZmZlciA9IHR1cmYuaW5zaWRlKHBvaW50LCBidWZmZXJlZCk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9LAogIHdhdGNoOiB7CiAgICAvLyAkcm91dGU6IHsKICAgIC8vICAgaGFuZGxlcih0bywgZnJvbSwgbmV4dCkgewogICAgLy8gICAgIGlmIChmcm9tLnBhdGggPT09ICcvcHJldmlldy1pbWFnZScpIHsKICAgIC8vICAgICAgIHRoaXMuc2hvd1Zpc2libGUgPSB0cnVlCiAgICAvLyAgICAgfSBlbHNlIHsKICAgIC8vICAgICAgIHRoaXMuc2hvd1Zpc2libGUgPSBmYWxzZQogICAgLy8gICAgIH0KICAgIC8vICAgfSwKICAgIC8vIH0sCiAgfSwKICBiZWZvcmVSb3V0ZUxlYXZlKHRvLCBmcm9tLCBuZXh0KSB7CiAgICBpZiAodG8ubmFtZSA9PSAnSW5zcGVjdGlvbicgJiYgZnJvbS5uYW1lID09ICdJbnNwZWN0aW9uTWFuYWdlJykgewogICAgICBpZiAodGhpcy5pZlJlY29yZGluZykgewogICAgICAgIHRoaXMuZW5kUmVjb3JkKCdsZWF2ZScpOwogICAgICB9IGVsc2UgewogICAgICAgIG5leHQoKTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgbmV4dCgpOwogICAgfQogIH0sCiAgYmVmb3JlRGVzdHJveSgpIHsKICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdzdGFydFJlY29yZExpbmVzJyk7CiAgICBidXMuJG9mZignc3RhcnRTaWduSW4nKTsKICAgIC8vIGJ1cy4kb2ZmKCJyZXBvcnRJbnNwRXZlbnQiKTsKICB9LAogIC8vIOi/lOWbnuWIsOWIl+ihqOmhtemdogogIG9uQmFja1ByZXNzKCkgewogICAgLy8gdW5pLnJlZGlyZWN0VG8oIi9wYWdlcy9wcm9qZWN0TWFuYWdlbWVudC9wcm9qZWN0TGlzdFBhZ2UiKTsKICAgIHJldHVybiB0cnVlOwogIH0sCiAgb25OYXZpZ2F0aW9uQmFyQnV0dG9uVGFwOiBmdW5jdGlvbiAoZSkge30KfTs="},{"version":3,"names":["bus","axios","dayjs","MapComp","keyPointList","request","api","Toast","Dialog","turf","Uploader","problemCardInfo","API","mapObj","map","mapInstance","name","components","data","ifTips","reportDataIsLoaded","allTaskLines","isView","active","deviceName","hasSignIn","showPopover","actions","text","currentRate","pointListShow","startRecordTimer","navbarTitle","reportFailTrackPoints","isShowRoute","inspBusinessType","recordData","currentPosition","lines","userInfo","ifRecording","endRecordShow","selectEventType","eventTypeList","signShow","attachment","signForm","deviceStatus","inspImagesList","remark","isReport","taskId","pointId","taskDetail","coverage","reportRate","planEndTime","engInfoDTO","taskRestTime","reportFooterShow","feature","planDetail","inspRangeList","rangeList","keyDetailList","isRunList","value","reportChose","rules","previewURL","upimgPreview","headers","url","uploadFile","findFile","pollingFlag","pollingGapTime","trackPointList","trackPointTimeList","overSpeedTrackLineList","trackLocation_start","trackLocation_end","showVisible","isMask","reportShow","accessToken","$storage","get","header","formToken","problemDataList1","problemDataList2","computed","created","getCardListData","mounted","$store","state","console","log","isStart","localStorage","setItem","$on","startSignIn","$route","query","id","getTaskById","getTrackRecordsById","that","computedPosition","gapTimer","gap","Date","getTime","locTime","t","setTimeout","methods","VUE_APP_WPG_URL","method","params","token","Authorization","then","res","status","resultData","getProblemDataList","commonParams","Object","assign","sysCode","page","current","size","params1","smallType","params2","problemPointFeatures","getAxiosData","allProblem","concat","forEach","it","push","type","geometry","coordinates","lnglat","properties","title","$refs","mymap","addInspEventLayer","problemDataList","Promise","resolve","reject","records","item","_item$formValue","_item$formValue2","_item$formValue3","ticketStatusName","handleType","formValue","createByName","createTime","substring","defectFrom","faultTypes","fileUrl","handleImgs","files","appealLng","appealLat","device_type","questionDescribe","toDetailPanel","cardDetail","window","location","href","flyToPoint","flyTo","center","zoom","reportClick","setLayoutProperty","message","duration","handleClose","fileChange","file","fileList","fileId","response","groupToken","imagesName","endTask","hasInspKp","changeToInspCount","allInspKp","changeToAllInspCount","confirm","endRecordConfirm","catch","endRecordCancel","openPopup","onSelect","val","off","signInBuffer","on","selectReportPoint","selectFlawPoint","e","features","queryRenderedFeatures","point","length","source","addEventObjMarker","gridId","gridName","getRestTime","time","includes","Number","split","changeToRate","insp","uninsp","toFixed","mapLoaded","yuanchu","locationAMap","requestSingleLocation","JSON","parse","stringify","param","setInspUserPosition","err","refreshMap","clearBufferTrack","classNames","document","getElementsByClassName","i","parentNode","removeChild","ids","engId","removeKeyPointMarker","getSource","setSourceData","getLayer","removeLayer","removeSource","removeEventObjMarker","removeRangeMVT","error","refreshTask","pageNum","pageSize","loading","forbidClick","recordLines","recordedPipeLine","pipeId","inspTask","inspPlan","detailList","range","isNew","taskStatus","stratOrEndTaskRecord","getAllTaskLines","devType","list","geom","setAllInspLineSource","kpRes","bizScope","taskType","keys","completion","taskName","timer","setInterval","clearInterval","isOnLoaded","addKeyPoints","addRangeList","extParam","task_id","addInspRecordTileLineSource","icon","postAppData","result2","inspectionTrackMultiple","resetTrackPoints","uniWebView","postMessage","action","trackData","getEventAll","inspectionEventAll","eventItemText","$set","computeCenter","eventType","getEventTypeList","sons","code","label","children","polling","requestLocations","direction","longitude","latitude","date_now","format","lastPoint","currentPoint","distance","GetDistance","jsonLine","coord","parseFloat","jsonLineFeatureCollection","setData","addSource","addLayer","layout","visibility","paint","changeInspLineSourceBySpeed","postTrackData_Point","drawOverSpeedTrack","gapTime","overSpeedTrackLineCollection","overSpeedTrackLineFeatureCollection","drawStartPoint","position","tempPointList","pointData","p","inspTime","inspDate","inspector","userFullName","inspectionTrack","jsonPoint","jsonPointFeatureCollection","drawEndPoint","stopRequestLocations","postFailTrackData","uploadFiledPipeIdList","recordInspLine","timeData","userFullname","planId","taskCode","changeTaskStatus","addMapImg","loadImage","require","image","hasImage","addImage","startInspRecord","startLocation","endRecord","diff","Math","floor","setLocalStorage","sourceData","findHadInspFeature","caliber","guid","filter","x","every","y","$api","postAction","inspRecordData","getAppInspData","superMapParamsToFeature","points","featureToObject","names","values","obj","index","goEventOrFlawDetail","deviceId","bigType","bizType","lng","startLongitude","lat","startLatitude","road_name","road","$router","msg","onConfirm","copySignForm","deepClone","ext1","signIn","onCancel","warning","engGeom","buffered","buffer","unit","isInBuffer","inside","deviceType","result","att","eventTypeConfirm","event","inspItemId","reportEvent","path","coordArray1","coordArray2","lng1","lat1","lng2","lat2","radLat1","PI","radLat2","a","b","s","asin","sqrt","pow","sin","cos","round","showRoute","getLayoutProperty","resetMapView","resetNorthPitch","clickReportEvent","pos","undefined","taskRangerGeom","isInKeyPointBuffer","_item$inspectionTaskD","detail","inspectionTaskDetailDTO","inspectionTaskDetail","watch","beforeRouteLeave","to","from","next","beforeDestroy","removeItem","$off","onBackPress","onNavigationBarButtonTap"],"sources":["src/views/inspectionManage/daily-task.vue"],"sourcesContent":["<template>\r\n  <div class=\"task-map full-width\">\r\n    <!-- 导航栏 -->\r\n    <div class=\"navbar-box\">\r\n      <fm-nav-bar\r\n        :title=\"navbarTitle\"\r\n        left-arrow\r\n        @click-left=\"$router.go(-1)\"\r\n        @click-right=\"openPopup\"\r\n      >     \r\n        <template #right>\r\n          <fm-popover\r\n            :visible.sync=\"showPopover\"\r\n            trigger=\"click\"\r\n            :actions=\"actions\"\r\n            @select=\"onSelect\"\r\n            placement=\"bottom-end\"\r\n          >\r\n            <template #reference>\r\n              <img style=\"width: 34px\" :src=\"require('@/assets/img/inspection/增加.png')\" />\r\n            </template>\r\n          </fm-popover>\r\n        </template>\r\n      </fm-nav-bar>\r\n    </div>\r\n    <!-- 地图 -->\r\n    <MapComp\r\n      ref=\"mymap\"\r\n      :ifInspection=\"true\"\r\n      @mapLoaded=\"mapLoaded\"\r\n    ></MapComp>\r\n    <!-- <fm-popup\r\n      :visible.sync=\"pointListShow\"\r\n      close-on-click-modal\r\n      :close-on-popstate=\"true\"\r\n      position=\"bottom\"\r\n      safe-area-inset-bottom\r\n    >\r\n      <fm-tabs type=\"card\" style=\"padding-top: 20px\">\r\n        <fm-tab label=\"未上报关键点\">\r\n          <fm-empty v-if=\"keyDetailList.length <= 0\" description=\"暂无数据\" mode=\"list\"></fm-empty>\r\n        </fm-tab>\r\n        <fm-tab label=\"已上报关键点\">\r\n          <fm-empty v-if=\"keyDetailList.length <= 0\" description=\"暂无数据\" mode=\"list\"></fm-empty>\r\n        </fm-tab>\r\n      </fm-tabs>\r\n    </fm-popup> -->\r\n    <!-- 开始记录与结束记录 -->\r\n    <div class=\"start-record\">\r\n      <img\r\n        v-if=\"!ifRecording\"\r\n        :src=\"require('@/assets/img/inspection/暂停.png')\"\r\n        @click=\"startInspRecord\"\r\n      />\r\n      <img v-else :src=\"require('@/assets/img/inspection/开始.png')\" @click=\"endRecord\" />\r\n      <!-- <fm-button\r\n        v-if=\"!ifRecording\"\r\n        :loading=\"recordButtonLoading\"\r\n        :disabled=\"recordButtonLoading\"\r\n        class=\"start-button\"\r\n        type=\"primary\"\r\n        @click=\"startInspRecord\"\r\n      >开始记录</fm-button>\r\n      <fm-button\r\n        v-else\r\n        :loading=\"recordButtonLoading\"\r\n        :disabled=\"recordButtonLoading\"\r\n        class=\"start-button\"\r\n        type=\"primary\"\r\n        @click=\"endRecord\"\r\n      >结束记录</fm-button> -->\r\n    </div>\r\n    <!-- 数据面板 -->\r\n    <div class=\"controlCard\">\r\n      <div class=\"controlContent\">\r\n        <div class=\"infoContent\">\r\n          <div class=\"endControl\">\r\n            <div class=\"leftText\">\r\n              <img :src=\"require('@/assets/img/inspection/剩余时间.png')\" />\r\n              <fm-count-down\r\n                style=\"margin: auto\"\r\n                :time=\"getRestTime(taskDetail.planEndTime)\"\r\n                format=\"DD天HH小时\"\r\n              />\r\n            </div>\r\n            <div class=\"rightButton\">\r\n              <fm-button v-show=\"ifRecording\" class=\"endBtn\" round @click=\"endTask\">结束</fm-button>\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"bottomSide\">\r\n            <div class=\"block\">\r\n              <div class=\"rate\" style=\"font-size: 18px\">\r\n                <div class=\"centerStyle\">\r\n                  {{ changeToRate(taskDetail.coverage) }}\r\n                </div>\r\n              </div>\r\n              <div class=\"name\" style=\"font-size: 14px\">覆盖率</div>\r\n            </div>\r\n\r\n            <div class=\"block\">\r\n              <div class=\"rate\">\r\n                <div class=\"centerStyle\">\r\n                  <div class=\"inspKp\" style=\"font-size: 19px\">\r\n                    {{ changeToInspCount(taskDetail.reportRate) }}\r\n                  </div>\r\n                  <div class=\"uninspKp\" style=\"font-size: 14px\">\r\n                    /{{ changeToAllInspCount(taskDetail.reportRate) }}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div class=\"name\" style=\"font-size: 14px\">关键点</div>\r\n            </div>\r\n\r\n            <div class=\"block\" @click=\"reportClick\" style=\"cursor: pointer;\">\r\n              <div class=\"rate\" style=\"font-size: 18px\">\r\n                <div class=\"centerStyle\">\r\n                  {{ problemDataList1.length + problemDataList2.length }}\r\n                </div>\r\n              </div>\r\n              <div class=\"name\" style=\"font-size: 14px\">上报</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <!-- 轨迹显示与定位功能 -->\r\n    <div class=\"tool-box\">\r\n      <!-- 地图旋转、俯视角度重置 -->\r\n      <!-- <div class=\"refresh\" @click=\"resetMapView\">\r\n        <fm-image class=\"refresh-image\" :src=\"require('@/assets/img/inspection/reset.png')\"></fm-image>\r\n      </div>\r\n      <div class=\"route\" @click=\"showRoute\">\r\n        <fm-image\r\n          v-if=\"isShowRoute\"\r\n          class=\"route-image\"\r\n          :src=\"require('@/assets/img/inspection/route2.png')\"\r\n        ></fm-image>\r\n        <fm-image v-else class=\"route-image\" :src=\"require('@/assets/img/inspection/route.png')\"></fm-image>\r\n      </div> -->\r\n      <div class=\"location\" @click=\"startLocation\">\r\n        <fm-image\r\n          class=\"location-image\"\r\n          :src=\"require('@/assets/img/inspection/location.png')\"\r\n        ></fm-image>\r\n      </div>\r\n    </div>\r\n    <!-- 签到框 -->\r\n    <fm-popup\r\n      :visible.sync=\"signShow\"\r\n      :modal=\"false\"\r\n      round\r\n      position=\"bottom\"\r\n      :style=\"{ height: signForm.deviceStatus == '1' ? '76%' : '62%' }\"\r\n    >\r\n      <div class=\"popup-view\">\r\n        <fm-form ref=\"signForm\">\r\n          <div class=\"title\">\r\n            <img :src=\"require('@/assets/img/inspection/sideIcon.png')\" />\r\n            <div class=\"deviceId\">{{ deviceName }}</div>\r\n          </div>\r\n          <fm-field :name=\"signForm.deviceStatus\" label=\"运行情况\" required>\r\n            <template #input>\r\n              <fm-radio-group v-model=\"signForm.deviceStatus\" direction=\"horizontal\">\r\n                <fm-radio name=\"0\">正常</fm-radio>\r\n                <fm-radio name=\"1\">异常</fm-radio>\r\n              </fm-radio-group>\r\n            </template>\r\n          </fm-field>\r\n          <fm-field v-if=\"signForm.deviceStatus == '1'\" label=\"是否上报\" required>\r\n          </fm-field>\r\n          <fm-field :name=\"signForm.isReport\" v-if=\"signForm.deviceStatus == '1'\">\r\n            <template #input>\r\n              <fm-radio-group v-model=\"signForm.isReport\" direction=\"horizontal\">\r\n                <fm-radio v-for=\"(item, index) in reportChose\" :key=\"index\" :name=\"item.value\"\r\n                  >{{ item.name }}\r\n                </fm-radio>\r\n              </fm-radio-group>\r\n            </template>\r\n          </fm-field>\r\n          <uploader\r\n            v-model=\"attachment\"\r\n            @fileChange=\"fileChange\"\r\n            multiple\r\n            :maxImagesCount=\"2\"\r\n            type=\"image\"\r\n          />\r\n          <fm-field label=\"备注\" type=\"textarea\" placehold=\"请输入\" v-model=\"signForm.remark\">\r\n          </fm-field>\r\n        </fm-form>\r\n      </div>\r\n      <div class=\"btnArea\" v-show=\"!hasSignIn\">\r\n        <fm-button class=\"btn1\" @click=\"onCancel\" round type=\"default\">取消</fm-button>\r\n        <fm-button class=\"btn2\" @click=\"onConfirm\" round type=\"primary\">提交</fm-button>\r\n      </div>\r\n      <div class=\"btnArea\" v-show=\"hasSignIn\">\r\n        <fm-button class=\"btn\" @click=\"onCancel\" round type=\"default\">关闭</fm-button>\r\n      </div>\r\n    </fm-popup>\r\n    <fm-popup :visible.sync=\"reportShow\" @close=\"handleClose\" round position=\"bottom\" :overlay-style=\"{ background: 'rgba(0, 0, 0, 0.1)' }\" :style=\"{ height: '50%' }\">\r\n      <fm-tabs v-model=\"active\" swipeable style=\"height: 100%\">\r\n        <fm-tab label=\"问题上报\">\r\n          <div v-for=\"(item, index) in problemDataList1\" :key=\"index\">\r\n            <problemCardInfo\r\n              type=\"001\"\r\n              :cardInfo=\"item\"\r\n              @toDetailPanel=\"toDetailPanel\"\r\n              @flyToPoint=\"flyToPoint\"\r\n            ></problemCardInfo>\r\n          </div>\r\n        </fm-tab>\r\n        <fm-tab label=\"设施缺陷\">\r\n          <div v-for=\"(item, index) in problemDataList2\" :key=\"index\">\r\n            <problemCardInfo\r\n              type=\"002\"\r\n              :cardInfo=\"item\"\r\n              @toDetailPanel=\"toDetailPanel\"\r\n              @flyToPoint=\"flyToPoint\"\r\n            ></problemCardInfo>\r\n          </div>\r\n        </fm-tab>\r\n      </fm-tabs>\r\n    </fm-popup>\r\n    \r\n    <!-- 提示层 -->\r\n    <div v-show=\"ifTips\" class=\"tip-tools\">\r\n      <img :src=\"require('@/assets/img/tips.png')\" class=\"tipImg\" />\r\n      <div class=\"context\">请在地图上选择设施或者点位</div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport bus from '../../views/inspectMap/utils/Bus.js'\r\nimport axios from 'axios'\r\nimport dayjs from 'dayjs'\r\nimport MapComp from '../../views/inspectMap/index.vue'\r\nimport keyPointList from './keypoint-list.vue'\r\nimport request from '@/utils/request'\r\nimport * as api from './api'\r\nimport { Toast, Dialog } from 'fawkes-mobile-lib'\r\nimport * as turf from '@turf/turf'\r\nimport Uploader from '@/components/upload/Uploader.vue'\r\nimport problemCardInfo from './problemCardInfo';\r\nimport API from \"@/common/config.js\";\r\nconst mapObj = {\r\n  map: null,\r\n  mapInstance: null,\r\n}\r\nexport default {\r\n  name: 'daily-task',\r\n  components: {\r\n    MapComp,\r\n    keyPointList,\r\n    Uploader,\r\n    problemCardInfo,\r\n  },\r\n  data() {\r\n    return {\r\n      ifTips: false,\r\n      reportDataIsLoaded: false,\r\n      // 巡检任务下所有巡检管线\r\n      allTaskLines: [],\r\n      isView: true,\r\n      active: 0,\r\n      deviceName: '',\r\n      hasSignIn: false,\r\n      showPopover: false,\r\n      actions: [\r\n        {\r\n          text: '问题上报',\r\n        },\r\n        {\r\n          text: '设施缺陷',\r\n        },\r\n      ],\r\n      currentRate: 0,\r\n      // 控制关键点列表显隐\r\n      pointListShow: false,\r\n      // 全局发声函数\r\n      // 记录开始巡检的时间，用于判断是否在开始巡检的10s内\r\n      startRecordTimer: '',\r\n      navbarTitle: '日常任务',\r\n      // 上报失败的巡检轨迹点位数组\r\n      reportFailTrackPoints: [],\r\n      isShowRoute: true,\r\n      inspBusinessType: '',\r\n      recordData: [],\r\n      // 当前巡检员所处位置\r\n      currentPosition: null,\r\n      lines: [],\r\n      // 巡检员信息\r\n      userInfo: {},\r\n      ifRecording: false,\r\n      endRecordShow: false,\r\n      selectEventType: false,\r\n      eventTypeList: [],\r\n      signShow: false,\r\n      attachment: '',\r\n      signForm: {\r\n        deviceStatus: '1',\r\n        inspImagesList: [],\r\n        remark: '',\r\n        isReport: '',\r\n        taskId: '',\r\n        pointId: '',\r\n      },\r\n      taskDetail: {\r\n        coverage: '0/0',\r\n        reportRate: '0/0',\r\n        planEndTime: '',\r\n      },\r\n      engInfoDTO: {},\r\n      taskRestTime: 0,\r\n      reportFooterShow: false,\r\n      feature: {},\r\n      planDetail: {},\r\n      // 用于地图中显示范围和关键点\r\n      inspRangeList: [],\r\n      rangeList: [],\r\n      keyDetailList: [],\r\n      isRunList: [\r\n        {\r\n          name: '正常',\r\n          value: '1',\r\n        },\r\n        {\r\n          name: '异常',\r\n          value: '0',\r\n        },\r\n      ],\r\n      reportChose: [\r\n        {\r\n          name: '问题上报',\r\n          value: '问题上报',\r\n        },\r\n        {\r\n          name: '新增缺陷',\r\n          value: '新增缺陷',\r\n        },\r\n        {\r\n          name: '无需上报',\r\n          value: '无需上报',\r\n        },\r\n      ],\r\n      rules: {\r\n      },\r\n      previewURL: '/sys-storage/download_image?f8s=',\r\n      upimgPreview: [],\r\n      headers: {},\r\n      url: {\r\n        // 本页面使用到的url\r\n        uploadFile: 'sys-storage/upload',\r\n        findFile: 'ecidi-cmp/file/cmpFileGroup/findFilesByGroupId',\r\n      },\r\n      pollingFlag: false,\r\n      pollingGapTime: 3,\r\n      trackPointList: [],\r\n      trackPointTimeList: [],\r\n      overSpeedTrackLineList: [],\r\n      trackLocation_start: '',\r\n      trackLocation_end: '',\r\n      showVisible: false,\r\n      isMask: false, //是否显示遮罩层\r\n      reportShow: false, // 问题上报面板显示\r\n      accessToken: this.$storage.get('access_token'),\r\n      header: {},\r\n      formToken: '',\r\n      // 问题上报list\r\n      problemDataList1: [],\r\n      // 设施缺陷list\r\n      problemDataList2: []\r\n    }\r\n  },\r\n  computed: {\r\n  },\r\n  created() {\r\n    // 获取问题上报和设施缺陷数据\r\n    this.getCardListData()\r\n  },\r\n  mounted() {\r\n    this.userInfo = this.$store.state.userInfo\r\n    console.log('this.userInfo: ', this.userInfo);\r\n    this.isStart = false\r\n    localStorage.setItem('startRecordLines', 'end')\r\n    this.navbarTitle = '日常任务'\r\n    bus.$on('startSignIn', (feature) => {\r\n      this.startSignIn(feature)\r\n    })\r\n    this.isView = this.$route.query.isView\r\n    const id = this.$route.query.taskId\r\n    this.getTaskById(id)\r\n    this.getTrackRecordsById(id)\r\n    // this.getAppInspData(id)\r\n    let that = this\r\n    !(function computedPosition() {\r\n      let gapTimer = 10\r\n      if (that.currentPosition) {\r\n        // 计算当前时间与当前插件返回的时间的间隔\r\n        let gap = (new Date().getTime() - new Date(that.currentPosition.locTime).getTime()) / 1000\r\n        // 如果间隔时间大于某一值，则说明在gapTimer时间内没有收到来自插件的新点位\r\n        if (gap > gapTimer) {\r\n          // 开启提示\r\n          // Notify.warning({ message: '当前GPS信号较弱,位置和轨迹更新可能缓慢', duration: 5000 })\r\n          let t = setTimeout(() => {\r\n            // 提示结束，并开始下次调用\r\n            computedPosition()\r\n          }, 15000)\r\n        } else {\r\n          // 开始下次调用\r\n          let t = setTimeout(() => {\r\n            computedPosition()\r\n          }, 10000)\r\n        }\r\n      } else {\r\n        // Notify.warning({ message: '当前GPS无信', duration: 5000 })\r\n        let t = setTimeout(() => {\r\n          computedPosition()\r\n        }, 10000)\r\n      }\r\n    })()\r\n  },\r\n  methods: {\r\n    // 获取问题上报和设施缺陷数据\r\n    getCardListData() {\r\n      // 获取header，查询工单用\r\n      axios({\r\n        url: API.VUE_APP_WPG_URL + '/main/userCenterApi/sso/tokenByToken',\r\n        method: 'post',\r\n        params: {\r\n          token: this.accessToken,\r\n        },\r\n        headers: {\r\n          Authorization: 'Basic b3V0d29yazp3cGcyMDIw',\r\n        },\r\n      }).then((res) => {\r\n        if (res.status == 200) {\r\n          this.formToken = res.data.resultData.token\r\n          this.header = {\r\n            'Content-Type': 'application/json',\r\n            Authorization: 'Bearer ' + this.formToken,\r\n          }\r\n        }\r\n      })\r\n    },\r\n    // 问题上报(smallType: 'abnormal_inform')、设施缺陷(smallType: \"defect\")使用同一接口\r\n    async getProblemDataList(params) {\r\n      this.problemDataList1 = []\r\n      this.problemDataList2 = []\r\n\r\n      let commonParams = Object.assign({\r\n        sysCode: 'outwork',\r\n        // token: this.accessToken,\r\n        page: {\r\n          current: 1,\r\n          size: 99999, // 查全部\r\n        }\r\n      }, params)\r\n      // 问题上报\r\n      let params1 = {\r\n        ...commonParams,\r\n        smallType: 'abnormal_inform'\r\n      }\r\n      // 设施缺陷\r\n      let params2 = {\r\n        ...commonParams,\r\n        smallType: 'defect'\r\n      }\r\n      let problemPointFeatures = []\r\n      // 问题上报\r\n      await this.getAxiosData(params1, this.problemDataList1)\r\n      // 设施缺陷\r\n      await this.getAxiosData(params2, this.problemDataList2)\r\n      let allProblem = this.problemDataList1.concat(this.problemDataList2)\r\n      allProblem.forEach(it => {\r\n        problemPointFeatures.push({\r\n          type: 'Feature',\r\n          geometry: {\r\n            type: 'Point',\r\n            coordinates: it.lnglat\r\n          },\r\n          properties: {\r\n            id: it.id,\r\n            title: it.title\r\n          }\r\n        })\r\n      })\r\n      this.$refs.mymap.addInspEventLayer(problemPointFeatures)\r\n      this.reportDataIsLoaded = true\r\n    },\r\n    getAxiosData(params, problemDataList) {\r\n      return new Promise((resolve, reject) => {\r\n        axios({\r\n          url: API.VUE_APP_WPG_URL + '/main/outworkapi/ticketStatisticClient/getTicketList',\r\n          method: 'post',\r\n          data: params,\r\n          headers: this.header,\r\n        }).then((res) => {\r\n          if (res.status == 200) {\r\n            res.data.resultData.records.forEach((item) => {\r\n              problemDataList.push({\r\n                id: item.id, // 工单ID\r\n                title: item.title, // 工单标题\r\n                ticketStatusName: item.ticketStatusName,\r\n                handleType: item.formValue.handleType, // 描述\r\n                createByName: item.createByName, // 创建人\r\n                createTime: item.createTime.substring(0, 10), // 创建时间\r\n                defectFrom: item.formValue.defectFrom,\r\n                faultTypes: item.formValue.faultTypes,\r\n                fileUrl: item.formValue?.handleImgs?.[0]?.fileUrl,\r\n                // 图片地址\r\n                url: item.formValue?.files?.[0]?.url,\r\n                // 发生经纬度\r\n                lnglat: [item.appealLng, item.appealLat],\r\n                device_type: item.formValue?.device_type || [],\r\n                questionDescribe: item.formValue.questionDescribe,\r\n              })\r\n            })\r\n            resolve()\r\n          }\r\n          // problemDataList.forEach((item) => {\r\n          //   // console.log('图片地址', item.url)\r\n          // })\r\n        })\r\n      })\r\n    },\r\n    // 问题上报点击标题、设施缺陷点击卡片进入详情页\r\n    toDetailPanel(cardDetail) {\r\n      window.location.href =\r\n        'http://172.20.79.70/outworkApp/#/pages/ticket/detail/index?id=' +\r\n        cardDetail.id +\r\n        '&sysCode=outwork' +\r\n        '&token=' +\r\n        this.formToken\r\n    },\r\n    // 卡片定位\r\n    flyToPoint(lnglat) {\r\n      mapObj.map.flyTo({ center: lnglat, zoom: 17.5 })\r\n    },\r\n    // 上报\r\n    reportClick() {\r\n      if (this.reportDataIsLoaded) {\r\n        this.reportShow = true\r\n        mapObj.map.setLayoutProperty('eventPointsLayer', 'visibility', 'visible')\r\n      } else {\r\n        Toast({\r\n          message: '上报数据加载中。。。',\r\n          duration: 1500\r\n        })\r\n        return\r\n      }\r\n    },\r\n    handleClose() {\r\n      mapObj.map.setLayoutProperty('eventPointsLayer', 'visibility', 'none')\r\n    },\r\n    fileChange(file) {\r\n      this.signForm.inspImagesList = []\r\n      file.fileList.forEach(it => {\r\n        this.signForm.inspImagesList.push(\r\n          {\r\n            fileId: it.response.groupToken,\r\n            imagesName: it.url\r\n          }\r\n        )\r\n      })\r\n      console.log(this.signForm)\r\n    },\r\n    async endTask() {\r\n      if (this.isView) {\r\n        Toast({\r\n          message: '该巡检任务已结束',\r\n          duration: 1500\r\n        })\r\n        return\r\n      }\r\n      await this.getTaskById(this.$route.query.taskId)\r\n      let hasInspKp = this.changeToInspCount(this.taskDetail.reportRate)\r\n      let allInspKp = this.changeToAllInspCount(this.taskDetail.reportRate)\r\n      Dialog.confirm({\r\n        title: '提示',\r\n        message: `您还有${allInspKp - hasInspKp}个关键点未打卡，确定结束巡检任务？`,\r\n      })\r\n        .then(() => {\r\n          this.endRecordConfirm('task')\r\n        })\r\n        .catch(() => {\r\n          this.endRecordCancel()\r\n        })\r\n    },\r\n    openPopup() {\r\n      this.showPopover = true\r\n    },\r\n    onSelect(val) {\r\n      if (this.isView) {\r\n        Toast({\r\n          message: '该巡检任务已结束',\r\n          duration: '1500'\r\n        })\r\n        return\r\n      }\r\n      // Toast({\r\n      //   message: '请在地图上选择设施或者点位',\r\n      //   duration: 1500\r\n      // });\r\n      this.ifTips = true\r\n      setTimeout(() => {\r\n        this.ifTips = false\r\n      }, 2500)\r\n      mapObj.map.off('click', 'keypointsLayer', this.$refs.mymap.signInBuffer)\r\n      val.text == '问题上报' ? mapObj.map.on('click', this.selectReportPoint) : mapObj.map.on('click', this.selectFlawPoint)\r\n    },\r\n    selectReportPoint(e) {\r\n      let features = mapObj.map.queryRenderedFeatures(e.point)\r\n      console.log(features)\r\n      if (features.length > 0) {\r\n        if (\r\n        features[0].source != \"inspUser\" \r\n        && features[0].source != \"initInspLineSource\" \r\n        && features[0].source != \"keypoints\" \r\n        &&(features[0].geometry.type === \"Point\")\r\n        ) {\r\n        this.$refs.mymap.addEventObjMarker(features[0], 'event', { gridId: this.planDetail.gridId, gridName: this.planDetail.gridName });\r\n        } else if (features.length > 1 \r\n          && features[1].source !=\"eventPoints\" \r\n          && features[1].source != \"inspUser\" \r\n          && features[1].source != \"keypoints\" \r\n          && (features[1].geometry.type === \"Point\")\r\n          ) {\r\n          this.$refs.mymap.addEventObjMarker(features[1], 'event', { gridId: this.planDetail.gridId, gridName: this.planDetail.gridName });\r\n        }\r\n      }\r\n      mapObj.map.on('click', 'keypointsLayer', this.$refs.mymap.signInBuffer)\r\n      mapObj.map.off('click', this.selectReportPoint)\r\n    },\r\n    selectFlawPoint(e) {\r\n      let features = mapObj.map.queryRenderedFeatures(e.point)\r\n      console.log(features)\r\n      if (features.length > 0) {\r\n        if (\r\n        features[0].source !=\"eventPoints\"\r\n        && features[0].source != \"inspUser\" \r\n        && features[0].source != \"initInspLineSource\" \r\n        && features[0].source != \"keypoints\" \r\n        &&(features[0].geometry.type === \"Point\")\r\n        ) {\r\n        this.$refs.mymap.addEventObjMarker(features[0], 'flaw', { gridId: this.planDetail.gridId, gridName: this.planDetail.gridName });\r\n        } else if (features.length > 1 \r\n          && features[1].source !=\"eventPoints\"\r\n          && features[1].source != \"inspUser\" \r\n          && features[1].source != \"keypoints\"\r\n          && (features[1].geometry.type === \"Point\")\r\n          ) {\r\n          this.$refs.mymap.addEventObjMarker(features[1], 'flaw', { gridId: this.planDetail.gridId, gridName: this.planDetail.gridName });\r\n        }\r\n      }\r\n      mapObj.map.on('click', 'keypointsLayer', this.$refs.mymap.signInBuffer)\r\n      mapObj.map.off('click', this.selectFlawPoint)\r\n    },\r\n    getRestTime(time) {\r\n      return time ? new Date(time).getTime() - new Date().getTime() : 0\r\n    },\r\n    changeToInspCount(reportRate) {\r\n      if (reportRate.includes('/')) {\r\n        return Number(reportRate.split('/')[0])\r\n      } else {\r\n        return 0\r\n      }\r\n    },\r\n    changeToAllInspCount(reportRate) {\r\n      if (reportRate.includes('/')) {\r\n        return Number(reportRate.split('/')[1])\r\n      } else {\r\n        return 0\r\n      }\r\n    },\r\n    changeToRate(coverage) {\r\n      if (coverage.includes('/')) {\r\n        let insp = Number(coverage.split('/')[0])\r\n        let uninsp = Number(coverage.split('/')[1])\r\n        if (uninsp) {\r\n          return ((insp / uninsp) * 100).toFixed(2) + '%'\r\n        } else {\r\n          return '0%'\r\n        }\r\n      } else {\r\n        return '0%'\r\n      }\r\n    },\r\n    mapLoaded(mapInstance) {\r\n      console.log('mapLoadedddddddd')\r\n      let that = this\r\n      mapObj.mapInstance = mapInstance\r\n      mapObj.map = mapInstance.map\r\n      // this.$refs.mymap.setInspUserPosition({\r\n      //   longitude: 115.854563,\r\n      //   latitude: 39.043407\r\n      // })\r\n      yuanchu.locationAMap.requestSingleLocation(\r\n        ['1'],\r\n        (res) => {\r\n          that.currentPosition = JSON.parse(JSON.stringify(res))\r\n          const param = {\r\n            ...that.currentPosition,\r\n          }\r\n          this.$refs.mymap.setInspUserPosition(param)\r\n        },\r\n        (err) => {\r\n          console.log('err=', err)\r\n        }\r\n      )\r\n    },\r\n    // 刷新地图\r\n    refreshMap() {\r\n      try {\r\n        this.clearBufferTrack()\r\n        // 清空所有的popup\r\n        let classNames = document.getElementsByClassName('mapboxgl-popup-anchor-bottom')\r\n        for (let i = classNames.length - 1; i >= 0; i--) {\r\n          if (classNames[i] != null) {\r\n            classNames[i].parentNode.removeChild(classNames[i])\r\n          }\r\n        }\r\n        // 清空所有关键点marker\r\n        let ids = []\r\n        this.keyDetailList.forEach((item) => {\r\n          if (item.engInfoDTO) {\r\n            ids.push(item.engInfoDTO.engId)\r\n          }\r\n        })\r\n        mapObj.mapInstance && this.$refs.mymap.removeKeyPointMarker(ids)\r\n        // 清空巡检范围图层\r\n        mapObj.map.getSource('rangeSource') &&\r\n          mapObj.mapInstance.setSourceData('rangeSource', {\r\n            type: 'FeatureCollection',\r\n            features: [],\r\n          })\r\n        // 清空巡检管线图层\r\n        mapObj.map.getSource('initInspLineSource') &&\r\n          mapObj.mapInstance.setSourceData('initInspLineSource', {\r\n            type: 'FeatureCollection',\r\n            features: [],\r\n          })\r\n        mapObj.map.getSource('unInspLineSource') &&\r\n          mapObj.mapInstance.setSourceData('unInspLineSource', {\r\n            type: 'FeatureCollection',\r\n            features: [],\r\n          })\r\n        mapObj.map.getSource('inspLineSource') &&\r\n          mapObj.mapInstance.setSourceData('inspLineSource', {\r\n            type: 'FeatureCollection',\r\n            features: [],\r\n          })\r\n        mapObj.map.getSource('inspUserLineSource') &&\r\n          mapObj.mapInstance.setSourceData('inspUserLineSource', {\r\n            type: 'FeatureCollection',\r\n            features: [],\r\n          })\r\n        mapObj.map.getSource('inspUser') &&\r\n          mapObj.mapInstance.setSourceData('inspUser', {\r\n            type: 'FeatureCollection',\r\n            features: [],\r\n          })\r\n        mapObj.map.getSource('buffered') &&\r\n          mapObj.mapInstance.setSourceData('buffered', {\r\n            type: 'FeatureCollection',\r\n            features: [],\r\n          })\r\n        // 如果存在事件图层，就移除该图层\r\n        mapObj.map.getLayer('eventPointsLayer') && mapObj.map.removeLayer('eventPointsLayer')\r\n        mapObj.map.getSource('eventPoints') && mapObj.map.removeSource('eventPoints')\r\n        this.$refs.mymap.removeEventObjMarker()\r\n        this.$refs.mymap.removeRangeMVT()\r\n      } catch (error) {\r\n        console.log(error)\r\n      }\r\n    },\r\n    // 刷新任务\r\n    refreshTask() {\r\n      // let ids = []\r\n      // this.keyDetailList.forEach((item) => {\r\n      //   if (item.engInfoDTO) {\r\n      //     ids.push(item.engInfoDTO.engId)\r\n      //   }\r\n      // })\r\n      // mapObj.mapInstance && this.$refs.mymap.removeKeyPointMarker(ids)\r\n      const id = this.$route.query.taskId\r\n      this.getTaskById(id, 'refresh')\r\n      // await this.getAppInspData(id)\r\n    },\r\n    async getTrackRecordsById(id) {\r\n      const res = await request({\r\n        url: '/xasw-pipe-operation/inspTask/track',\r\n        method: 'get',\r\n        params: { id, pageNum: 1, pageSize: 9999 },\r\n      })\r\n      if (res && res.status) {\r\n        console.log(res)\r\n      }\r\n    },\r\n    // 根据任务id获取巡检状况\r\n    async getTaskById(id, type=null) {\r\n      Toast.loading({\r\n        message: '地图加载中...',\r\n        forbidClick: true,\r\n      })\r\n      this.isMask = true\r\n      // await this.postAppData(id);\r\n      // 处理已巡检管线的接口\r\n      const recordLines = await api.recordedPipeLine({\r\n        taskId: id,\r\n        page: 1,\r\n        size: 9999\r\n      })\r\n      this.lines = []\r\n      if (recordLines.status) {\r\n        this.lines = recordLines.data.records.map((item) => item.pipeId)\r\n      }\r\n      this.reportFooterShow = false // 事件上报弹窗开关\r\n      const res = await request({\r\n        url: '/xasw-pipe-operation/inspTask/getById',\r\n        method: 'get',\r\n        params: { id },\r\n      })\r\n      // let point = turf.point([115.854546, 39.043415])\r\n      // this.$refs.mymap.drawBuffer(point, 5)\r\n      if (res && res.status) {\r\n        this.taskDetail = res.data.inspTask\r\n        this.planDetail = res.data.inspPlan\r\n        this.inspRangeList = res.data.detailList.map((range) => {\r\n          return {\r\n            taskId: id,\r\n            ...range,\r\n          }\r\n        })\r\n        // 修改未巡检(0)任务状态至巡检中(1)\r\n        if (this.$route.query.isNew && this.taskDetail.taskStatus != 1) {\r\n          this.stratOrEndTaskRecord(1)\r\n        }\r\n        if (type != 'refresh') {\r\n          const allTaskLines = await api.getAllTaskLines({\r\n            devType: '管线',\r\n            gridId: this.planDetail.gridId,\r\n            pageNum: 1,\r\n            pageSize: 99999\r\n          })\r\n          if (allTaskLines.status) {\r\n            allTaskLines.data.list.forEach(item => {\r\n              this.allTaskLines.push({\r\n                type: 'Feature',\r\n                id: item.id,\r\n                geometry: JSON.parse(item.geom),\r\n                properties: {\r\n                  id: item.id,\r\n                  length: item['length']\r\n                }\r\n              })\r\n            })\r\n            this.$refs.mymap.setAllInspLineSource(this.allTaskLines)\r\n          }\r\n        }\r\n        const kpRes = await request({\r\n          url: '/xasw-pipe-operation/inspTask/point',\r\n          method: 'get',\r\n          params: { id, gridId: this.planDetail.gridId, pageNum: 1, pageSize: 9999, bizScope: this.$route.query.taskType },\r\n        })\r\n        this.keyDetailList = []\r\n        if (kpRes && kpRes.status) {\r\n          let keys = Object.keys(kpRes.data)\r\n          keys.forEach((item) => {\r\n            this.keyDetailList.push(...kpRes.data[item].list)\r\n          })\r\n        }\r\n        let completion = this.changeToRate(this.taskDetail.coverage)\r\n        this.navbarTitle = this.taskDetail.taskName\r\n        try {\r\n          const that = this\r\n          let timer = setInterval(function () {\r\n            // 30s后取消\r\n            setTimeout(() => {\r\n              clearInterval(timer)\r\n            }, 30000)\r\n            if (that.$refs.mymap.isOnLoaded()) {\r\n              clearInterval(timer)\r\n              that.$refs.mymap.addKeyPoints(that.keyDetailList)\r\n              if (type != 'refresh') {\r\n                that.$refs.mymap.addRangeList(that.inspRangeList)\r\n              }\r\n              const params = {\r\n                extParam: {\r\n                  task_id: that.$route.query.taskId\r\n                }\r\n              }\r\n              // that.getEventAll(params);\r\n              // 问题上报、设施缺陷接口\r\n              that.getProblemDataList(params)\r\n              // let reslines = that.lines.concat(that.recordData);\r\n              // 图层回显方式改变\r\n              that.$refs.mymap.addInspRecordTileLineSource(that.lines, completion)\r\n              if (!that.currentPosition) return\r\n              const param = {\r\n                ...that.currentPosition,\r\n              }\r\n              that.$refs.mymap.setInspUserPosition(param)\r\n            }\r\n          }, 500)\r\n        } catch (e) {\r\n          console.log(e)\r\n          if (this.isMask) {\r\n            this.isMask = false\r\n          }\r\n        }\r\n      } else {\r\n        if (this.isMask) {\r\n          this.isMask = false\r\n        }\r\n        Toast({\r\n          message: '网络状态较差，加载任务失败',\r\n          icon: 'warn',\r\n          duration: 3000,\r\n        })\r\n      }\r\n    },\r\n    // 获取从app端传来的数据\r\n    postAppData(id) {\r\n      let that = this\r\n      return new Promise(async function (resolve, reject) {\r\n        /** 2021/9/22 取消缓存在app端的数据上报\r\n        const result = await that.$api.postAction(\"/ops-inspection/api/inspectionRecordMultiple\", that.recordData);\r\n        if (result.status) {\r\n          console.log(\"上报缓存在app的数据\");\r\n        };\r\n        */\r\n        if (that.reportFailTrackPoints.length <= 0) {\r\n          resolve()\r\n          return\r\n        }\r\n        const result2 = await inspectionTrackMultiple(that.reportFailTrackPoints)\r\n        if (result2 && result2.status) {\r\n          console.log('上报缓存在app端的轨迹点数据')\r\n          let resetTrackPoints = []\r\n          that.reportFailTrackPoints = resetTrackPoints\r\n          uniWebView.postMessage({\r\n            data: {\r\n              action: 'saveTrackPoints',\r\n              trackData: JSON.stringify(resetTrackPoints),\r\n              taskId: id,\r\n            },\r\n          })\r\n        }\r\n        resolve()\r\n      })\r\n    },\r\n    // 获取巡检事件\r\n    async getEventAll(params) {\r\n      const res = await inspectionEventAll(params)\r\n      if (res && res.status) {\r\n        let features = []\r\n        res.data.forEach((item) => {\r\n          if (item.eventItemText) {\r\n            const geom = JSON.parse(item.eventItemText)\r\n            let feature = {\r\n              geometry: geom.type === 'Feature' ? geom.geometry : geom,\r\n              properties: {},\r\n            }\r\n            this.$set(feature, 'geometry', this.computeCenter(feature.geometry))\r\n            this.$set(feature, 'id', item.id)\r\n            this.$set(feature.properties, 'eventType', item.eventType)\r\n            // this.$set(feature, \"eventType\", item.eventType);\r\n            // this.$refs.mymap.addInspEventMarker(feature);\r\n            features.push(feature)\r\n          }\r\n        })\r\n        this.$refs.mymap.addInspEventLayer(features)\r\n      }\r\n    },\r\n    // 获取事件类型\r\n    getEventTypeList() {\r\n      getEventTypeList()\r\n        .then((res) => {\r\n          this.eventTypeList = res.data.sons.map((item) => {\r\n            return {\r\n              value: item.code,\r\n              label: item.name,\r\n              children: item.sons.map((item) => {\r\n                return {\r\n                  value: item.code,\r\n                  label: item.name,\r\n                  children: item.sons.map((item) => {\r\n                    return {\r\n                      value: item.code,\r\n                      label: item.name,\r\n                    }\r\n                  }),\r\n                }\r\n              }),\r\n            }\r\n          })\r\n        })\r\n        .catch(() => {\r\n          Toast({\r\n            message: '字典加载失败',\r\n          })\r\n        })\r\n    },\r\n    // 轮询 currentPosition，绘制轨迹线\r\n    polling() {\r\n      let that = this\r\n      if (that.pollingFlag) {\r\n        yuanchu.locationAMap.requestLocations(\r\n          ['5', '1', '10', '30', '0', true],\r\n          (res) => {\r\n            that.currentPosition = JSON.parse(JSON.stringify(res))\r\n            that.currentPosition = Object.assign(that.currentPosition, {\r\n              direction: 0\r\n            })\r\n            if (!that.currentPosition) {\r\n              Toast({\r\n                message: '当前GPS信号弱',\r\n                duration: 1500\r\n              })\r\n              return\r\n            }\r\n            if (\r\n              that.trackPointList.length != 0 &&\r\n              that.trackPointList[that.trackPointList.length - 1][0] !=\r\n                that.currentPosition.longitude &&\r\n              that.trackPointList[that.trackPointList.length - 1][1] !=\r\n                that.currentPosition.latitude\r\n            ) {\r\n              // 新一次轮询的当前时间\r\n              let date_now = dayjs().format('YYYY-MM-DD HH:mm:ss')\r\n              // 上次最后的点位\r\n              let lastPoint = that.trackPointList[that.trackPointList.length - 1]\r\n              // 当前点位\r\n              let currentPoint = [that.currentPosition.longitude, that.currentPosition.latitude]\r\n              let distance = (Number(that.GetDistance(lastPoint, currentPoint))) * 1000\r\n              that.trackPointList.push([\r\n                that.currentPosition.longitude,\r\n                that.currentPosition.latitude\r\n              ])\r\n              that.trackPointTimeList.push(date_now)\r\n              console.log(that.trackPointList, this.trackPointTimeList)\r\n\r\n              // 构造临时线对象\r\n              let jsonLine = {\r\n                type: 'Feature',\r\n                properties: {},\r\n                geometry: {\r\n                  type: 'LineString',\r\n                  coordinates: that.trackPointList,\r\n                },\r\n              }\r\n              const coord = [parseFloat(that.currentPosition.longitude), parseFloat(that.currentPosition.latitude)];\r\n              const point = turf.point(coord);\r\n              mapObj.mapInstance.setSourceData(\"inspUser\", {\r\n                type: \"FeatureCollection\",\r\n                features: [point]\r\n              })\r\n              let jsonLineFeatureCollection = {\r\n                type: 'FeatureCollection',\r\n                features: [jsonLine],\r\n              }\r\n              if (mapObj.map.getSource('trackLineSource_now')) {\r\n                mapObj.map.getSource('trackLineSource_now').setData(jsonLineFeatureCollection)\r\n              } else {\r\n                mapObj.map.addSource('trackLineSource_now', {\r\n                  type: 'geojson',\r\n                  data: jsonLineFeatureCollection,\r\n                })\r\n              }\r\n              if (mapObj.map.getLayer('trackLineLayer_now')) {\r\n              } else {\r\n                mapObj.map.addLayer({\r\n                  id: 'trackLineLayer_now',\r\n                  type: 'line',\r\n                  source: 'trackLineSource_now',\r\n                  layout: {\r\n                    'line-cap': 'round',\r\n                    'line-join': 'round',\r\n                    'line-sort-key': 1,\r\n                    visibility: 'visible',\r\n                    // visibility: \"none\"\r\n                  },\r\n                  paint: {\r\n                    'line-color': '#addd52',\r\n                    'line-width': 5,\r\n                    'line-opacity': 0.8,\r\n                  },\r\n                }, 'inspUserLayer')\r\n              }\r\n              let param = {\r\n                ...that.currentPosition,\r\n              }\r\n              // that.$refs.mymap.setInspUserPosition(param)\r\n              if (mapObj.map.getLayer('trackLineLayer_arrow')) {\r\n              } else {\r\n                mapObj.map.addLayer({\r\n                  id: 'trackLineLayer_arrow',\r\n                  type: 'symbol',\r\n                  source: 'trackLineSource_now',\r\n                  layout: {\r\n                    'symbol-placement': 'line',\r\n                    'symbol-spacing': 20,\r\n                    'icon-image': 'arrowIcon',\r\n                    'icon-size': 0.5,\r\n                    'icon-allow-overlap': true,\r\n                    'symbol-sort-key': 3,\r\n                    visibility: 'visible',\r\n                    // visibility: \"none\"\r\n                  },\r\n                }, 'inspUserLayer')\r\n              }\r\n              // 改变管线颜色\r\n              that.$refs.mymap.changeInspLineSourceBySpeed(that.currentPosition)\r\n              // 记录过程点\r\n              that.postTrackData_Point(\r\n                that.trackPointList[that.trackPointList.length - 1],\r\n                that.trackPointTimeList[that.trackPointTimeList.length - 1],\r\n                distance\r\n              )\r\n            } else {\r\n              Toast({\r\n                message: '当前GPS信号弱,无法获取最新定位数据',\r\n                duration: 1500\r\n              })\r\n            }\r\n          },\r\n          (err) => {\r\n            Toast({\r\n              message: 'err' + err,\r\n              duration: 2000,\r\n            })\r\n          }\r\n        )\r\n        // this.uploadInspRoute()\r\n      }\r\n    },\r\n    // 绘制超速线段\r\n    drawOverSpeedTrack(lastPoint, currentPoint, gapTime = 3) {\r\n      let that = this\r\n      if ((that.GetDistance(lastPoint, currentPoint) * 1000) / gapTime > 10) {\r\n        that.overSpeedTrackLineList.push([lastPoint, currentPoint])\r\n        let overSpeedTrackLineCollection = {\r\n          type: 'Feature',\r\n          properties: {},\r\n          geometry: {\r\n            type: 'MultiLineString',\r\n            coordinates: that.overSpeedTrackLineList,\r\n          },\r\n        }\r\n        let overSpeedTrackLineFeatureCollection = {\r\n          type: 'FeatureCollection',\r\n          features: [overSpeedTrackLineCollection],\r\n        }\r\n        if (mapObj.map.getSource('trackLineSource_overSpeed')) {\r\n          mapObj.map\r\n            .getSource('trackLineSource_overSpeed')\r\n            .setData(overSpeedTrackLineFeatureCollection)\r\n        } else {\r\n          mapObj.map.addSource('trackLineSource_overSpeed', {\r\n            type: 'geojson',\r\n            data: overSpeedTrackLineFeatureCollection,\r\n          })\r\n        }\r\n        if (mapObj.map.getLayer('trackLineLayer_overSpeed')) {\r\n        } else {\r\n          mapObj.map.addLayer({\r\n            id: 'trackLineLayer_overSpeed',\r\n            type: 'line',\r\n            source: 'trackLineSource_overSpeed',\r\n            layout: {\r\n              'line-cap': 'round',\r\n              'line-join': 'round',\r\n              'line-sort-key': 2,\r\n              visibility: 'visible',\r\n              // visibility: \"none\"\r\n            },\r\n            paint: {\r\n              'line-color': '#FFB13B',\r\n              'line-width': 5,\r\n              'line-opacity': 1,\r\n            },\r\n          })\r\n        }\r\n      }\r\n    },\r\n    // 绘制起始点\r\n    drawStartPoint() {\r\n      let that = this\r\n      return new Promise(async function (resolve, reject) {\r\n        yuanchu.locationAMap.requestSingleLocation(\r\n          ['1'],\r\n          (res) => {\r\n            that.currentPosition = JSON.parse(JSON.stringify(res))\r\n            const param = {\r\n              ...that.currentPosition,\r\n            }\r\n            that.$refs.mymap.setInspUserPosition(param)\r\n          },\r\n          (err) => {\r\n            console.log('err=', err)\r\n          }\r\n        )\r\n        if (that.currentPosition != null) {\r\n          // 临时记录起始点和起始时间\r\n          let position = that.currentPosition\r\n          let tempPointList = []\r\n          tempPointList.push([position.longitude, position.latitude])\r\n          let date_now = dayjs().format('YYYY-MM-DD HH:mm:ss')\r\n          // 进行第一个点位上报\r\n          let pointData = tempPointList[tempPointList.length - 1]\r\n\r\n          // 经纬度数字化\r\n          for (let p = 0; p < pointData.length; p++) {\r\n            pointData[p] = Number(pointData[p])\r\n          }\r\n          let recordData = []\r\n          recordData.push({\r\n            taskId: that.taskDetail.id, // 任务id\r\n            longitude: pointData[0],\r\n            latitude: pointData[1],\r\n            inspTime: date_now,\r\n            distance: 0, // 第一个点距离为0\r\n            inspDate: date_now,\r\n            inspector: that.userInfo.userFullName,\r\n          })\r\n          // 使用上报点位作为起点\r\n          that.trackPointList.push([position.longitude, position.latitude])\r\n          that.trackPointTimeList.push(date_now)\r\n          // let jsonPoint = {\r\n          //   type: 'Feature',\r\n          //   properties: {},\r\n          //   geometry: {\r\n          //     type: 'Point',\r\n          //     coordinates: [position.longitude, position.latitude],\r\n          //   },\r\n          // }\r\n          // let jsonPointFeatureCollection = {\r\n          //   type: 'FeatureCollection',\r\n          //   features: [jsonPoint],\r\n          // }\r\n          // if (mapObj.map.getSource('startPointSource_now')) {\r\n          //   mapObj.map\r\n          //     .getSource('startPointSource_now')\r\n          //     .setData(jsonPointFeatureCollection)\r\n          // } else {\r\n          //   mapObj.map.addSource('startPointSource_now', {\r\n          //     type: 'geojson',\r\n          //     data: jsonPointFeatureCollection,\r\n          //   })\r\n          // }\r\n          // if (mapObj.map.getLayer('startPointLayer_now')) {\r\n          // } else {\r\n          //   mapObj.map.addLayer({\r\n          //     id: 'startPointLayer_now',\r\n          //     type: 'circle',\r\n          //     source: 'startPointSource_now',\r\n          //     layout: {\r\n          //       'circle-sort-key': 5,\r\n          //       visibility: 'visible',\r\n          //       // visibility: \"none\"\r\n          //     },\r\n          //     paint: {\r\n          //       'circle-radius': 3,\r\n          //       'circle-stroke-width': 5,\r\n          //       'circle-stroke-color': '#2A83E6',\r\n          //       'circle-color': 'white',\r\n          //     },\r\n          //   })\r\n          // }\r\n          // // label\r\n          // if (mapObj.map.getLayer('startPoint_label')) {\r\n          // } else {\r\n          //   mapObj.map.addLayer({\r\n          //     id: 'startPoint_label',\r\n          //     type: 'symbol',\r\n          //     source: 'startPointSource_now',\r\n          //     layout: {\r\n          //       'symbol-placement': 'point',\r\n          //       'icon-image': 'start_point',\r\n          //       'icon-size': 0.6,\r\n          //       'icon-offset': [0, -35],\r\n          //       'icon-allow-overlap': true,\r\n          //       'symbol-sort-key': 2,\r\n          //       visibility: 'visible',\r\n          //       // visibility: \"none\"\r\n          //     },\r\n          //   })\r\n          // }\r\n          // resolve(true)\r\n          await api\r\n            .inspectionTrack(recordData)\r\n            .then((res) => {\r\n              if (res && res.status) {\r\n                console.log('轨迹存储成功')\r\n                // 使用上报点位作为起点\r\n                // that.trackPointList.push([\r\n                //   position.longitude,\r\n                //   position.latitude\r\n                // ]);\r\n                // that.trackPointTimeList.push(date_now);\r\n                let jsonPoint = {\r\n                  type: 'Feature',\r\n                  properties: {},\r\n                  geometry: {\r\n                    type: 'Point',\r\n                    coordinates: [position.longitude, position.latitude],\r\n                  },\r\n                }\r\n                let jsonPointFeatureCollection = {\r\n                  type: 'FeatureCollection',\r\n                  features: [jsonPoint],\r\n                }\r\n                if (mapObj.map.getSource('startPointSource_now')) {\r\n                  mapObj.map.getSource('startPointSource_now').setData(jsonPointFeatureCollection)\r\n                } else {\r\n                  mapObj.map.addSource('startPointSource_now', {\r\n                    type: 'geojson',\r\n                    data: jsonPointFeatureCollection,\r\n                  })\r\n                }\r\n                if (mapObj.map.getLayer('startPointLayer_now')) {\r\n                } else {\r\n                  mapObj.map.addLayer({\r\n                    id: 'startPointLayer_now',\r\n                    type: 'circle',\r\n                    source: 'startPointSource_now',\r\n                    layout: {\r\n                      'circle-sort-key': 5,\r\n                      visibility: 'visible',\r\n                      // visibility: \"none\"\r\n                    },\r\n                    paint: {\r\n                      'circle-radius': 3,\r\n                      'circle-stroke-width': 5,\r\n                      'circle-stroke-color': '#2A83E6',\r\n                      'circle-color': 'white',\r\n                    },\r\n                  }, 'inspUserLayer')\r\n                }\r\n                // label\r\n                if (mapObj.map.getLayer('startPoint_label')) {\r\n                } else {\r\n                  mapObj.map.addLayer({\r\n                    id: 'startPoint_label',\r\n                    type: 'symbol',\r\n                    source: 'startPointSource_now',\r\n                    layout: {\r\n                      'symbol-placement': 'point',\r\n                      'icon-image': 'start_point',\r\n                      'icon-size': 0.6,\r\n                      'icon-offset': [0, -35],\r\n                      'icon-allow-overlap': true,\r\n                      'symbol-sort-key': 2,\r\n                      visibility: 'visible',\r\n                      // visibility: \"none\"\r\n                    },\r\n                  })\r\n                }\r\n                resolve(true)\r\n              } else {\r\n                // console.log(\"轨迹存储失败\");\r\n                resolve(false)\r\n              }\r\n            })\r\n            .catch((err) => {\r\n              // console.log(\"轨迹存储失败err\", err);\r\n              reject(err)\r\n            })\r\n        }\r\n      })\r\n    },\r\n    // 绘制终止点\r\n    async drawEndPoint(type = null) {\r\n      let that = this\r\n      yuanchu.locationAMap.stopRequestLocations()\r\n      if (that.currentPosition != null) {\r\n        let lastPoint = that.trackPointList[that.trackPointList.length - 1]\r\n        let currentPoint = [that.currentPosition.longitude, that.currentPosition.latitude]\r\n        let distance = (Number(that.GetDistance(lastPoint, currentPoint))) * 1000\r\n        that.trackPointList.push([that.currentPosition.longitude, that.currentPosition.latitude])\r\n        let date_now = dayjs().format('YYYY-MM-DD HH:mm:ss')\r\n        that.trackPointTimeList.push(date_now)\r\n        let jsonPoint = {\r\n          type: 'Feature',\r\n          properties: {},\r\n          geometry: {\r\n            type: 'Point',\r\n            coordinates: [that.currentPosition.longitude, that.currentPosition.latitude],\r\n          },\r\n        }\r\n        let jsonPointFeatureCollection = {\r\n          type: 'FeatureCollection',\r\n          features: [jsonPoint],\r\n        }\r\n        if (mapObj.map.getSource('endPointSource_now')) {\r\n          mapObj.map.getSource('endPointSource_now').setData(jsonPointFeatureCollection)\r\n        } else {\r\n          mapObj.map.addSource('endPointSource_now', {\r\n            type: 'geojson',\r\n            data: jsonPointFeatureCollection,\r\n          })\r\n        }\r\n        if (mapObj.map.getLayer('endPointLayer_now')) {\r\n        } else {\r\n          mapObj.map.addLayer({\r\n            id: 'endPointLayer_now',\r\n            type: 'circle',\r\n            source: 'endPointSource_now',\r\n            layout: {\r\n              'circle-sort-key': 5,\r\n              visibility: 'visible',\r\n              // visibility: \"none\"\r\n            },\r\n            paint: {\r\n              'circle-radius': 3,\r\n              'circle-stroke-width': 5,\r\n              'circle-stroke-color': '#addd52',\r\n              'circle-color': 'white',\r\n            },\r\n          }, 'inspUserLayer')\r\n        }\r\n\r\n        // 补充trackline\r\n        let jsonLine = {\r\n          type: 'Feature',\r\n          properties: {},\r\n          geometry: {\r\n            type: 'LineString',\r\n            coordinates: that.trackPointList,\r\n          },\r\n        }\r\n        let jsonLineFeatureCollection = {\r\n          type: 'FeatureCollection',\r\n          features: [jsonLine],\r\n        }\r\n        if (mapObj.map.getSource('trackLineSource_now')) {\r\n          mapObj.map.getSource('trackLineSource_now').setData(jsonLineFeatureCollection)\r\n        } else {\r\n          mapObj.map.addSource('trackLineSource_now', {\r\n            type: 'geojson',\r\n            data: jsonLineFeatureCollection,\r\n          })\r\n        }\r\n        if (mapObj.map.getLayer('trackLineLayer_now')) {\r\n        } else {\r\n          mapObj.map.addLayer({\r\n            id: 'trackLineLayer_now',\r\n            type: 'line',\r\n            source: 'trackLineSource_now',\r\n            layout: {\r\n              'line-cap': 'round',\r\n              'line-join': 'round',\r\n              visibility: 'visible',\r\n              // visibility: \"none\"\r\n            },\r\n            paint: {\r\n              'line-color': '#addd52',\r\n              'line-width': 5,\r\n              'line-opacity': 0.8,\r\n            },\r\n          }, 'inspUserLayer')\r\n        }\r\n        // label\r\n        if (mapObj.map.getLayer('endPoint_label')) {\r\n        } else {\r\n          mapObj.map.addLayer({\r\n            id: 'endPoint_label',\r\n            type: 'symbol',\r\n            source: 'endPointSource_now',\r\n            layout: {\r\n              'symbol-placement': 'point',\r\n              'icon-image': 'end_point',\r\n              'icon-size': 0.6,\r\n              'icon-offset': [0, -35],\r\n              'icon-allow-overlap': true,\r\n              'symbol-sort-key': 2,\r\n              visibility: 'visible',\r\n              // visibility: \"none\"\r\n            },\r\n          })\r\n        }\r\n        that.pollingFlag = false\r\n        // 记录终止点\r\n        that.postTrackData_Point(\r\n          that.trackPointList[that.trackPointList.length - 1],\r\n          that.trackPointTimeList[that.trackPointTimeList.length - 1],\r\n          distance\r\n        )\r\n        // 上传之前上传失败的点位\r\n        that.reportFailTrackPoints.length > 0 && that.postFailTrackData()\r\n        that.$refs.mymap.uploadFiledPipeIdList.length > 0 && api.recordInspLine(that.$refs.mymap.uploadFiledPipeIdList).then(res => {\r\n          if (res.status) {\r\n            console.log('管线补充上传成功')\r\n          }\r\n        })\r\n        if (type == 'task') {\r\n          this.stratOrEndTaskRecord(2) // 已巡检状态 '2'\r\n        }\r\n      } else {\r\n        let type = type\r\n        let timer = setTimeout(() => {\r\n          that.drawEndPoint(type)\r\n        }, 1000)\r\n      }\r\n    },\r\n    async postFailTrackData() {\r\n      let that = this\r\n      await api\r\n        .inspectionTrack(that.reportFailTrackPoints)\r\n        .then((res) => {\r\n          if (res && res.status) {\r\n            console.log('轨迹存储成功')\r\n          } else {\r\n            // 上传失败的点位，暂时存在app端\r\n            let timer = setTimeout(() => {\r\n              that.postFailTrackData()\r\n            }, 2000)\r\n          }\r\n        })\r\n        .catch((err) => {\r\n          console.log('巡检轨迹存储失败：' + err)\r\n        })\r\n    },\r\n\r\n    // 单点-后端记录轨迹数据\r\n    async postTrackData_Point(pointData, timeData, distance) {\r\n      let that = this\r\n      for (let p = 0; p < pointData.length; p++) {\r\n        pointData[p] = Number(pointData[p])\r\n      }\r\n      let date_now = dayjs().format('YYYY-MM-DD HH:mm:ss')\r\n      let recordData = []\r\n      recordData.push({\r\n        taskId: that.taskDetail.id,\r\n        inspDate: timeData,\r\n        inspTime: date_now,\r\n        distance,\r\n        inspector: that.userInfo.userFullname,\r\n        longitude: pointData[0],\r\n        latitude: pointData[1],\r\n      })\r\n      await api\r\n        .inspectionTrack(recordData)\r\n        .then((res) => {\r\n          if (res && res.status) {\r\n            console.log('轨迹存储成功', recordData)\r\n          } else {\r\n            // 上传失败的点位，暂时存在app端\r\n            that.reportFailTrackPoints.push(recordData)\r\n            console.log('that.reportFailTrackPoints: ', that.reportFailTrackPoints);\r\n          }\r\n        })\r\n        .catch((err) => {\r\n          console.log('巡检轨迹存储失败：' + err)\r\n        })\r\n    },\r\n    stratOrEndTaskRecord(status) {\r\n      let data = {\r\n        planId: this.planDetail.planId,\r\n        taskName: this.taskDetail.taskName,\r\n        taskCode: this.taskDetail.taskCode,\r\n        taskStatus: status,\r\n        id: this.taskDetail.id,\r\n        taskType: this.taskDetail.taskType\r\n      }\r\n      api.changeTaskStatus(data).then((res) => {\r\n        if (res.status) {\r\n          console.log(res)\r\n        }\r\n      })\r\n    },\r\n    // 清除缓存的轨迹数据\r\n    clearBufferTrack() {\r\n      let that = this\r\n      //数组归零\r\n      that.trackPointList = []\r\n      that.trackPointTimeList = []\r\n      that.overSpeedTrackLineList = []\r\n      //数据源清空\r\n      if (mapObj.map.getSource('trackLineSource_now')) {\r\n        mapObj.map.getSource('trackLineSource_now').setData({\r\n          type: 'FeatureCollection',\r\n          features: [],\r\n        })\r\n      }\r\n      if (mapObj.map.getSource('trackLineSource_overSpeed')) {\r\n        mapObj.map.getSource('trackLineSource_overSpeed').setData({\r\n          type: 'FeatureCollection',\r\n          features: [],\r\n        })\r\n      }\r\n      if (mapObj.map.getSource('startPointSource_now')) {\r\n        mapObj.map.getSource('startPointSource_now').setData({\r\n          type: 'FeatureCollection',\r\n          features: [],\r\n        })\r\n      }\r\n\r\n      if (mapObj.map.getSource('endPointSource_now')) {\r\n        mapObj.map.getSource('endPointSource_now').setData({\r\n          type: 'FeatureCollection',\r\n          features: [],\r\n        })\r\n      }\r\n    },\r\n    addMapImg() {\r\n      let that = this\r\n      mapObj.map.loadImage(\r\n        require('@assets/img/inspection/white_arrow_right.png'),\r\n        function (error, image) {\r\n          if (error) throw error\r\n          if (!mapObj.map.hasImage('arrowIcon')) {\r\n            mapObj.map.addImage('arrowIcon', image, {})\r\n          }\r\n        }\r\n      )\r\n      mapObj.map.loadImage(\r\n        require('@assets/img/inspection/icon_starting_point.png'),\r\n        function (error, image) {\r\n          if (error) throw error\r\n          if (!mapObj.map.hasImage('start_point')) {\r\n            mapObj.map.addImage('start_point', image, {})\r\n          }\r\n        }\r\n      )\r\n      mapObj.map.loadImage(\r\n        require('@assets/img/inspection/icon_at_end.png'),\r\n        function (error, image) {\r\n          if (error) throw error\r\n          if (!mapObj.map.hasImage('end_point')) {\r\n            mapObj.map.addImage('end_point', image, {})\r\n          }\r\n        }\r\n      )\r\n    },\r\n    // 开始记录 上传起点成功后才进入巡检过程\r\n    startInspRecord() {\r\n      if (this.isView) {\r\n        Toast({\r\n          message: '该巡检任务已结束',\r\n          duration: 1500\r\n        })\r\n        return\r\n      }\r\n      if (!this.currentPosition || !this.currentPosition.longitude) {\r\n        Toast({\r\n          message: '当前GPS信号弱，无法开始任务',\r\n          duration: 1000,\r\n        })\r\n        return\r\n      }\r\n      this.ifRecording = true\r\n      this.clearBufferTrack()\r\n      this.addMapImg()\r\n      this.drawStartPoint()\r\n        .then((res) => {\r\n          if (res) {\r\n            Toast({\r\n              message: '开始记录',\r\n              duration: 1000,\r\n            })\r\n            this.pollingFlag = true\r\n            this.ifRecording = true\r\n            this.startLocation()\r\n            localStorage.setItem('startRecordLines', 'start')\r\n            // 开始轮询\r\n            this.polling()\r\n            // 记录当前时间\r\n            this.startRecordTimer = new Date()\r\n          } else {\r\n            Toast({\r\n              message: '网络状态异常，无法开始任务',\r\n              duration: 3000,\r\n            })\r\n          }\r\n        })\r\n        .catch((err) => {\r\n          console.log(err)\r\n          // Toast({\r\n          //   message: `${err}`,\r\n          //   duration: 3000\r\n          // });\r\n        })\r\n    },\r\n    // 结束记录\r\n    endRecord(type = null) {\r\n      let diff = Math.floor((new Date() - this.startRecordTimer) / 1000)\r\n\r\n      if (diff <= 10) {\r\n        Toast({\r\n          message: `结束太快了,请${10 - diff}秒后再试`,\r\n          duration: 1000,\r\n        })\r\n        return\r\n      }\r\n      Dialog.confirm({\r\n        title: '标题',\r\n        message: '确定结束本次巡检？',\r\n      })\r\n        .then(() => {\r\n          this.endRecordConfirm(type)\r\n        })\r\n        .catch(() => {\r\n          this.endRecordCancel()\r\n        })\r\n    },\r\n    // uploadInspRoute() {\r\n    //   try {\r\n    //     const that = this;\r\n    //     // 定时器\r\n    //     let timer = setInterval(function () {\r\n    //       // 清除定时器\r\n    //       // clearInterval(timer);\r\n    //       let tempTrackPolntList = JSON.parse(JSON.stringify(this.trackPointList))\r\n    //       if (tempTrackPolntList.length > 0) {\r\n\r\n    //       }\r\n    //     }, 1000 * 60 * 60 * 24 * 1)\r\n    //   } catch (e) {\r\n    //     console.log(e)\r\n    //   }\r\n    // },\r\n    // 结束记录取消\r\n    endRecordCancel() {\r\n      this.endRecordShow = false\r\n    },\r\n    // 结束记录确认\r\n    async endRecordConfirm(type = null) {\r\n      this.endRecordShow = false\r\n      this.pollingFlag = false\r\n      yuanchu.locationAMap.stopRequestLocations()\r\n      await this.drawEndPoint(type)\r\n      this.ifRecording = false\r\n      localStorage.setItem('startRecordLines', 'end')\r\n      if (type != 'leave') {\r\n        this.refreshTask()\r\n      }\r\n      Toast({\r\n        message: '结束成功',\r\n        duration: 2000\r\n      })\r\n      /** 2021/9/22 取消上报已巡检管线\r\n      // 上报巡检记录\r\n      // 需过滤出已巡检管线\r\n      let sourceData = await this.$refs.mymap.findHadInspFeature();\r\n      let recordData = sourceData.map((item) => {\r\n        return {\r\n          caliber:  item.properties.caliber,\r\n          guid: item.properties.guid,\r\n          length: item.properties.length,\r\n          taskId: this.taskDetail.taskId,\r\n        };\r\n      });\r\n      recordData = recordData.filter(x => this.lines.every(y => y.guid != x.guid));\r\n      if (recordData.length <= 0) {\r\n        uni.showToast({\r\n          title: \"结束记录\",\r\n          duration: 3000,\r\n        });\r\n        let t = setTimeout(()=>{\r\n          this.recordButtonLoading = false;\r\n        }, 1000);\r\n        return;\r\n      }\r\n      this.$api.postAction(\"/ops-inspection/api/inspectionRecordMultiple\", recordData)\r\n        .then((res) => {\r\n          if (res && res.status) {\r\n            console.log(\"新增巡检记录成功\");\r\n            // 结束记录后就删除本地缓存\r\n            uniWebView.postMessage({\r\n              data: {\r\n                action: \"removeInspRecord\",\r\n                taskId: this.taskDetail.taskId\r\n              }\r\n            })\r\n          } else {\r\n            if (recordData.length > 0) {\r\n              uniWebView.postMessage({\r\n                data: {\r\n                  action: \"saveInspRecord\",\r\n                  inspRecordData: JSON.stringify(recordData),\r\n                  taskId: this.taskDetail.taskId,\r\n                },\r\n              });\r\n            }\r\n          }\r\n        })\r\n        .finally(()=>{\r\n          uni.showToast({\r\n            title: \"结束记录\",\r\n            duration: 3000,\r\n          });\r\n          let t = setTimeout(()=>{\r\n            this.recordButtonLoading = false;\r\n          }, 1000);\r\n        })\r\n      */\r\n    },\r\n\r\n    // 定时向本机发送存储信息\r\n    async setLocalStorage() {\r\n      let that = this\r\n      if (this.pollingFlag) {\r\n        /* let storageTrackData = {\r\n          trackPointList: that.trackPointList,\r\n          trackPointTimeList: that.trackPointTimeList,\r\n          overSpeedTrackLineList: that.overSpeedTrackLineList,\r\n        };\r\n\r\n        uniWebView.postMessage({\r\n          data: {\r\n            action: \"saveInspTrack\",\r\n            inspTrackData: JSON.stringify(storageTrackData),\r\n            taskId: that.taskDetail.taskId,\r\n          },\r\n        }); */\r\n\r\n        // 上报巡检记录\r\n        let sourceData = await this.$refs.mymap.findHadInspFeature()\r\n        let recordData = sourceData.map((item) => {\r\n          return {\r\n            caliber: item.properties.caliber,\r\n            guid: item.properties.guid,\r\n            length: item.properties.length,\r\n            taskId: this.taskDetail.taskId,\r\n          }\r\n        })\r\n        recordData = recordData.filter((x) => this.lines.every((y) => y.guid != x.guid))\r\n        if (recordData.length > 0) {\r\n          this.$api\r\n            .postAction('/ops-inspection/api/inspectionRecordMultiple', recordData)\r\n            .then((res) => {\r\n              if (res && res.status) {\r\n                console.log('新增巡检记录成功')\r\n              } else {\r\n                uniWebView.postMessage({\r\n                  data: {\r\n                    action: 'saveInspRecord',\r\n                    inspRecordData: JSON.stringify(recordData),\r\n                    taskId: this.taskDetail.taskId,\r\n                  },\r\n                })\r\n              }\r\n            })\r\n        }\r\n        let timer = setTimeout(() => {\r\n          this.setLocalStorage()\r\n        }, 15000)\r\n      }\r\n    },\r\n    // 查询app端存储的该任务的巡检记录和轨迹点位数据\r\n    getAppInspData(id) {\r\n      return new Promise(function (resolve) {\r\n        /** 2021/9/22 取消获取app端缓存的数据\r\n        uniWebView.postMessage({\r\n          data: {\r\n            action: \"getInspRecord\",\r\n            taskId: id,\r\n          },\r\n        });\r\n        */\r\n        // uniWebView.postMessage({\r\n        //   data: {\r\n        //     action: \"getTrackPoints\",\r\n        //     taskId: id\r\n        //   }\r\n        // })\r\n        resolve()\r\n      })\r\n    },\r\n    // 开始定位\r\n    startLocation() {\r\n      if (!this.currentPosition || !this.currentPosition.longitude || !this.currentPosition.latitude) {\r\n        Toast({\r\n          message: '获取位置失败!',\r\n          duration: 2000\r\n        })\r\n        return\r\n      } else {\r\n        const coord = [parseFloat(this.currentPosition.longitude), parseFloat(this.currentPosition.latitude)]\r\n        this.flyToPoint(coord)\r\n      }\r\n    },\r\n    /**\r\n     * 超图坐标转换为feature\r\n     */\r\n    superMapParamsToFeature(geometry) {\r\n      let coord\r\n      let type\r\n      switch (geometry.type) {\r\n        case 'POINT':\r\n          type = 'Point'\r\n          coord = [geometry.points[0].x, geometry.points[0].y]\r\n          break\r\n        case 'LINE':\r\n          type = 'LineString'\r\n          coord = geometry.points.map((point) => [point.x, point.y])\r\n          break\r\n        case 'REGION':\r\n          type = 'Polygon'\r\n          coord = [geometry.points.map((point) => [point.x, point.y])]\r\n          break\r\n      }\r\n      return {\r\n        type: 'Feature',\r\n        geometry: {\r\n          type,\r\n          coordinates: coord,\r\n        },\r\n      }\r\n    },\r\n    featureToObject(names, values) {\r\n      let obj = {}\r\n      names.forEach((name, index) => {\r\n        obj[name] = values[index]\r\n      })\r\n      return obj\r\n    },\r\n    goEventOrFlawDetail(feature, type) {\r\n      let currentPoint = feature\r\n      currentPoint = feature\r\n      currentPoint.code = feature.deviceId || ''\r\n      currentPoint.bigType = feature.bizType || ''\r\n      currentPoint.lng = feature.startLongitude\r\n      currentPoint.lat = feature.startLatitude\r\n      // 要素所在图层ID和属性信息\r\n      // currentPoint.layerID = feature.layer.id || ''\r\n      // currentPoint.layerType = feature.layer.type || ''\r\n      // currentPoint.properties = feature.properties || ''\r\n      // 底图要素name_local或设施要素road_name,id\r\n      currentPoint.road_name = feature.road\r\n      // currentPoint.id = feature.properties.id\r\n      if (type == 'event') {\r\n        // this.$router.push({\r\n        //   name: 'addProblemIndex',\r\n        //   query: { msg: currentPoint, token: this.formToken, taskId: this.$route.query.taskId },\r\n        //   params: { type: 'add' }\r\n        // })\r\n        this.$router.push({\r\n          name: 'addProblemIndex',\r\n          query: { msg: currentPoint, token: this.formToken, taskId: this.$route.query.taskId },\r\n          params: { type: 'add' },\r\n        })\r\n      } else {\r\n        this.$router.push({\r\n          name: 'addFlaws',\r\n          query: { msg: currentPoint, token: this.formToken, taskId: this.$route.query.taskId },\r\n          params: { type: 'add' }\r\n        })\r\n      }\r\n    },\r\n    // 确认\r\n    onConfirm() {\r\n      if (true) {\r\n        let feature = this.signForm.feature\r\n        let copySignForm = this.deepClone(this.signForm)\r\n        copySignForm.inspDate = dayjs().format('YYYY-MM-DD HH:mm:ss')\r\n        copySignForm.ext1 = copySignForm.remark // 备注\r\n        delete copySignForm.feature\r\n        api.signIn(copySignForm).then((res) => {\r\n          if (res && res.status) {\r\n            Toast({\r\n              message: '此关键点签到成功',\r\n              duration: 2000,\r\n            })\r\n            // 巡检事件上报\r\n            if (copySignForm.isReport == '问题上报') {\r\n              this.goEventOrFlawDetail(feature, 'event');\r\n            } else if (copySignForm.isReport == '新增缺陷') {\r\n              this.goEventOrFlawDetail(feature, 'flaw');\r\n            }\r\n          } else {\r\n            Toast({\r\n              message: '此关键点签到失败',\r\n              duration: 2000,\r\n            })\r\n          }\r\n        })\r\n        this.signShow = false\r\n        this.signForm.remark = ''\r\n        this.signForm.deviceStatus = '0'\r\n        this.signForm.isReport = ''\r\n        this.signForm.inspImagesList = []\r\n        this.attachment = ''\r\n        mapObj.mapInstance.setSourceData('buffered', {\r\n          type: 'FeatureCollection',\r\n          features: [],\r\n        })\r\n        // localStorage.setItem(\"isReportEvent\", false);\r\n        this.refreshTask()\r\n      } else {\r\n        console.log('验证失败')\r\n      }\r\n    },\r\n    // 取消\r\n    onCancel() {\r\n      console.log('click cancel')\r\n      // localStorage.setItem(\"isReportEvent\", false);\r\n      this.signShow = false\r\n      mapObj.mapInstance.setSourceData('buffered', {\r\n        type: 'FeatureCollection',\r\n        features: [],\r\n      })\r\n    },\r\n    // 签到\r\n    async startSignIn(feature) {\r\n      // 利用feature来判断是否处于35m范围内，如果处于，可以进行签到，否则不能进行签到\r\n      const position = this.currentPosition\r\n      if (!position) {\r\n        Toast.warning({\r\n          message: '获取不到巡检人位置',\r\n          duration: 2000,\r\n        })\r\n        return\r\n      }\r\n      const coord = [\r\n        parseFloat(position.longitude),\r\n        parseFloat(position.latitude),\r\n      ]\r\n      const point = turf.point(coord)\r\n      const engGeom = feature.geom\r\n      const buffered = turf.buffer(engGeom, 0.035, { unit: 'kilometers' })\r\n      const isInBuffer = turf.inside(point, buffered)\r\n      if (!isInBuffer) {\r\n        Toast({\r\n          message: '未处于该关键点范围内',\r\n          duration: 2000,\r\n        })\r\n        return\r\n      }\r\n      Toast.loading({\r\n        message: '正在加载',\r\n        forbidClick: true,\r\n      })\r\n      this.signShow = true\r\n      this.pointListShow = false\r\n      this.attachment = ''\r\n      this.isReport = ''\r\n      this.deviceName = feature.deviceType + (feature.deviceId || '')\r\n      if (!feature.deviceStatus || feature.deviceStatus == '2') {\r\n        // 未巡检\r\n        this.hasSignIn = false\r\n        this.signForm.remark = ''\r\n        this.signForm.deviceStatus = '0'\r\n        this.signForm.inspImagesList = []\r\n        this.signForm.pointId = feature.id\r\n        this.signForm.taskId = this.$route.query.taskId,\r\n        this.signForm.feature = feature\r\n      } else {\r\n        this.hasSignIn = true\r\n        let params = {\r\n          page: 1,\r\n          size: 999,\r\n          deviceStatus: feature.deviceStatus,\r\n          pointId: feature.id,\r\n          taskId: this.$route.query.taskId,\r\n        }\r\n        const res = await request({\r\n          url: '/xasw-pipe-operation/inspPointRecord/page',\r\n          method: 'get',\r\n          params: params,\r\n        })\r\n        if (res && res.status) {\r\n          let result = res.data.records[0]\r\n          this.signForm.deviceStatus = result.deviceStatus\r\n          this.signForm.remark = result.ext1\r\n          this.signForm.isReport = result.isReport\r\n          const att = await request({\r\n            url: '/xasw-pipe-operation/inspPointRecord',\r\n            method: 'get',\r\n            params: { id: result.id }\r\n          })\r\n          if (att && att.status) {\r\n            this.signForm.inspImagesList = att.data.inspImagesList\r\n            this.attachment = att.data.inspImagesList[0].fileId\r\n          }\r\n        }\r\n      }\r\n      console.log('signForm', this.signForm)\r\n    },\r\n    // 事件类型选择确认\r\n    eventTypeConfirm(event) {\r\n      this.$set(this.signForm, 'eventType', event[1].label)\r\n      this.signForm.inspItemId = event[1].value\r\n    },\r\n    // 深拷贝\r\n    deepClone(data) {\r\n      return JSON.parse(JSON.stringify(data))\r\n    },\r\n    // 计算中心点\r\n    computeCenter(feature) {\r\n      let position\r\n      if (feature.type === 'Polygon' || feature.type === 'MultiPolygon') {\r\n        const center = turf.center(feature)\r\n        position = center.geometry\r\n      } else if (feature.type === 'LineString') {\r\n        const center = turf.center(feature)\r\n        position = center.geometry\r\n      } else if (feature.type === 'Point') {\r\n        position = feature\r\n      }\r\n      return position\r\n    },\r\n    reportEvent(feature) {\r\n      this.reportFooterShow = false\r\n      this.$router.push({\r\n        path: '/pages/inspectionManage/add-event',\r\n        query: {\r\n          taskId: this.taskDetail.taskId,\r\n          feature: feature,\r\n          rangeList: this.rangeList,\r\n          taskDetail: this.taskDetail,\r\n        },\r\n      })\r\n    },\r\n    GetDistance(coordArray1, coordArray2) {\r\n      let lng1 = coordArray1[0]\r\n      let lat1 = coordArray1[1]\r\n      let lng2 = coordArray2[0]\r\n      let lat2 = coordArray2[1]\r\n      let radLat1 = (lat1 * Math.PI) / 180.0\r\n      let radLat2 = (lat2 * Math.PI) / 180.0\r\n      let a = radLat1 - radLat2\r\n      let b = (lng1 * Math.PI) / 180.0 - (lng2 * Math.PI) / 180.0\r\n      let s =\r\n        2 *\r\n        Math.asin(\r\n          Math.sqrt(\r\n            Math.pow(Math.sin(a / 2), 2) +\r\n              Math.cos(radLat1) * Math.cos(radLat2) * Math.pow(Math.sin(b / 2), 2)\r\n          )\r\n        )\r\n      s = s * 6378.137 // EARTH_RADIUS;\r\n      s = Math.round(s * 10000) / 10000\r\n      return s\r\n    },\r\n    showRoute() {\r\n      this.isShowRoute = !this.isShowRoute\r\n      if (mapObj.map.getLayoutProperty('trackLineLayer_now', 'visibility') === 'visible') {\r\n        mapObj.map.setLayoutProperty('trackLineLayer_now', 'visibility', 'none')\r\n      } else {\r\n        mapObj.map.setLayoutProperty('trackLineLayer_now', 'visibility', 'visible')\r\n      }\r\n      if (mapObj.map.getLayoutProperty('trackLineLayer_arrow', 'visibility') === 'visible') {\r\n        mapObj.map.setLayoutProperty('trackLineLayer_arrow', 'visibility', 'none')\r\n      } else {\r\n        mapObj.map.setLayoutProperty('trackLineLayer_arrow', 'visibility', 'visible')\r\n      }\r\n      if (mapObj.map.getLayoutProperty('trackLineLayer_overSpeed', 'visibility') === 'visible') {\r\n        mapObj.map.setLayoutProperty('trackLineLayer_overSpeed', 'visibility', 'none')\r\n      } else {\r\n        mapObj.map.setLayoutProperty('trackLineLayer_overSpeed', 'visibility', 'visible')\r\n      }\r\n      if (mapObj.map.getLayoutProperty('startPointLayer_now', 'visibility') === 'visible') {\r\n        mapObj.map.setLayoutProperty('startPointLayer_now', 'visibility', 'none')\r\n      } else {\r\n        mapObj.map.setLayoutProperty('startPointLayer_now', 'visibility', 'visible')\r\n      }\r\n      if (mapObj.map.getLayoutProperty('endPointLayer_now', 'visibility') === 'visible') {\r\n        mapObj.map.setLayoutProperty('endPointLayer_now', 'visibility', 'none')\r\n      } else {\r\n        mapObj.map.setLayoutProperty('endPointLayer_now', 'visibility', 'visible')\r\n      }\r\n      if (mapObj.map.getLayoutProperty('startPoint_label', 'visibility') === 'visible') {\r\n        mapObj.map.setLayoutProperty('startPoint_label', 'visibility', 'none')\r\n      } else {\r\n        mapObj.map.setLayoutProperty('startPoint_label', 'visibility', 'visible')\r\n      }\r\n      if (mapObj.map.getLayoutProperty('endPoint_label', 'visibility') === 'visible') {\r\n        mapObj.map.setLayoutProperty('endPoint_label', 'visibility', 'none')\r\n      } else {\r\n        mapObj.map.setLayoutProperty('endPoint_label', 'visibility', 'visible')\r\n      }\r\n    },\r\n    resetMapView() {\r\n      this.$refs.mymap && mapObj.map.resetNorthPitch()\r\n    },\r\n    clickReportEvent() {\r\n      console.log('click the clickReportEvent')\r\n      let position = []\r\n      if (!this.currentPosition) {\r\n        let pos = undefined\r\n        if (this.rangeList.length > 0) {\r\n          let feature = JSON.parse(this.rangeList[0].taskRangerGeom)\r\n          if (feature.geometry.type === 'Polygon' || feature.geometry.type === 'MultiPolygon') {\r\n            const center = turf.center(feature.geometry)\r\n            pos = center.geometry\r\n          } else if (feature.geometry.type === 'LineString') {\r\n            const center = turf.center(feature.geometry)\r\n\r\n            pos = center.geometry\r\n          } else if (feature.geometry.type === 'Point') {\r\n            pos = feature.geometry\r\n          }\r\n          if (pos) {\r\n            position = pos.coordinates\r\n          } else {\r\n            position = [119.96123559772968, 30.27094691991806]\r\n          }\r\n        }\r\n      } else {\r\n        position = [\r\n          parseFloat(this.currentPosition.longitude),\r\n          parseFloat(this.currentPosition.latitude),\r\n        ]\r\n      }\r\n      this.signShow = false\r\n      this.$router.push({\r\n        name: 'addEvent',\r\n        query: {\r\n          taskId: this.taskDetail.taskId,\r\n          rangeList: this.rangeList,\r\n          taskDetail: this.taskDetail,\r\n          position: position,\r\n        },\r\n      })\r\n    },\r\n    // 系统提示音\r\n    // speech() {\r\n    //   // 私有变量timer\r\n    //   let timer = new Date();\r\n    //   // 第一次进入\r\n    //   let isFirstIn = true;\r\n    //   return {\r\n    //     publicSpeech: function () {\r\n    //       if (isFirstIn || (new Date() - timer)/1000 > 20) {\r\n    //         const innerAudioContext = uni.createInnerAudioContext();\r\n    //         innerAudioContext.autoplay = true;\r\n    //         innerAudioContext.src = require(\"@static/audio/tips.mp3\");\r\n    //         innerAudioContext.onPlay(() => {\r\n    //           console.log(\"开始播放\");\r\n    //         });\r\n    //         innerAudioContext.onError((res) => {\r\n    //           console.log(res?.errMsg);\r\n    //           console.log(res?.errCode);\r\n    //         })\r\n    //         innerAudioContext.play();\r\n    //         // 对私有变量进行赋值\r\n    //         isFirstIn = false;\r\n    //         timer = new Date();\r\n    //       }\r\n    //     },\r\n    //     resetFirstIn: function () {\r\n    //       isFirstIn = true;\r\n    //     }\r\n    //   };\r\n    // },\r\n    // 判断是否在关键点范围内\r\n    isInKeyPointBuffer() {\r\n      const position = this.currentPosition\r\n      this.keyDetailList.forEach((item) => {\r\n        let detail = item?.inspectionTaskDetailDTO?.inspectionTaskDetail\r\n        if (true) {\r\n          const coord = [parseFloat(position.longitude), parseFloat(position.latitude)]\r\n          const point = turf.point(coord)\r\n          const engGeom =\r\n            typeof item.engInfoDTO.engGeom !== 'object'\r\n              ? JSON.parse(item.engInfoDTO.engGeom)\r\n              : item.engInfoDTO.engGeom\r\n          const buffered = turf.buffer(engGeom, 0.035, 'kilometers')\r\n          const isInBuffer = turf.inside(point, buffered)\r\n        }\r\n      })\r\n    },\r\n  },\r\n  watch: {\r\n    // $route: {\r\n    //   handler(to, from, next) {\r\n    //     if (from.path === '/preview-image') {\r\n    //       this.showVisible = true\r\n    //     } else {\r\n    //       this.showVisible = false\r\n    //     }\r\n    //   },\r\n    // },\r\n  },\r\n  beforeRouteLeave(to, from, next) {\r\n    if (to.name == 'Inspection' && from.name == 'InspectionManage') {\r\n      if (this.ifRecording) {\r\n        this.endRecord('leave')\r\n      } else {\r\n        next()\r\n      }\r\n    } else {\r\n      next()\r\n    }\r\n  },\r\n  beforeDestroy() {\r\n    localStorage.removeItem('startRecordLines')\r\n    bus.$off('startSignIn')\r\n    // bus.$off(\"reportInspEvent\");\r\n  },\r\n  // 返回到列表页面\r\n  onBackPress() {\r\n    // uni.redirectTo(\"/pages/projectManagement/projectListPage\");\r\n    return true\r\n  },\r\n  onNavigationBarButtonTap: function (e) {},\r\n}\r\n</script>\r\n<style lang=\"less\" scoped>\r\n/deep/.mapboxgl-popup-content {\r\n  width: auto;\r\n  min-width: 280px;\r\n  height: 50px;\r\n  padding: 24px 36px;\r\n  border-radius: 18px;\r\n  box-shadow: 10px 10px 30px rgba(0, 0, 0, 0.1);\r\n}\r\n.task-map {\r\n  width: 100%;\r\n  height: 100%;\r\n  overflow: hidden;\r\n\r\n  .tip-tools {\r\n    position: fixed;\r\n    display: flex;\r\n    top: 140px;\r\n    left: 200px;\r\n    border-radius: 16px;\r\n    padding: 24px;\r\n    background: #FFFFFF;\r\n    box-shadow: 0px 10px 18px 0px rgba(0,0,0,0.06);\r\n    border: 2px solid rgba(23,144,254,0.6);\r\n    .tipImg {\r\n      width: 32px;\r\n      height: 32px;\r\n      margin-right: 16px;\r\n    }\r\n    .context {\r\n      font-size: 24px;\r\n      font-family: MicrosoftYaHei;\r\n      color: #1B67D8;\r\n      line-height: 31px;\r\n    }\r\n  }\r\n\r\n  .alert {\r\n    top: 2.22rem;\r\n    position: fixed;\r\n    width: 100%;\r\n    z-index: 4;\r\n    background-color: #62707c;\r\n    opacity: 0.5;\r\n    font-size: 1rem;\r\n\r\n    .u-alert-content {\r\n      width: 100%;\r\n    }\r\n  }\r\n\r\n  .progress {\r\n    width: 80%;\r\n    height: 1rem;\r\n    background-color: #fff;\r\n    box-shadow: 0 0.4rem 0.6rem 0 rgba(0, 0, 0, 0.2);\r\n    border-radius: 0.1rem;\r\n    margin: 0 0.3rem;\r\n    padding: 0.1rem 0.15rem;\r\n    position: fixed;\r\n    top: 2.5rem;\r\n\r\n    &-box {\r\n      width: 100%;\r\n      margin: 0.3rem 0;\r\n      display: flex;\r\n\r\n      .pro-dot {\r\n        width: 0.3rem;\r\n        height: 0.3rem;\r\n        border-radius: 50%;\r\n        float: left;\r\n        margin: auto 0.3rem;\r\n      }\r\n\r\n      .pro-text {\r\n        line-height: 0.5rem;\r\n        display: flex;\r\n        font-size: 12px;\r\n        float: left;\r\n      }\r\n    }\r\n  }\r\n\r\n  .pro-circle {\r\n    position: fixed;\r\n    width: 1rem;\r\n    height: 1rem;\r\n    right: 0.1rem;\r\n    padding: 0.1rem;\r\n    top: 2.5rem;\r\n    // margin: 0.27rem 0rem;\r\n    background-color: #fff;\r\n    z-index: 3;\r\n    box-shadow: 0rem 0.22rem 0.61rem 0rem rgba(0, 0, 0, 0.2);\r\n    border-radius: 0.1rem;\r\n\r\n    .progress-text-view {\r\n      font-size: 0.4rem;\r\n      z-index: 4;\r\n\r\n      .progress-text-up {\r\n        color: #306cc8;\r\n      }\r\n\r\n      .progress-text-down {\r\n        border-top: 0.05rem solid #555555;\r\n      }\r\n    }\r\n  }\r\n\r\n  .point-list {\r\n    position: fixed;\r\n    width: 1.2rem;\r\n    height: 1.2rem;\r\n    left: 0.3rem;\r\n    bottom: 2rem;\r\n    background-color: #fff;\r\n    z-index: 3;\r\n    box-shadow: 0rem 0.22rem 0.61rem 0rem rgba(0, 0, 0, 0.2);\r\n    border-radius: 0.27rem;\r\n\r\n    .list-image {\r\n      margin: 0.18rem;\r\n      width: 0.82rem;\r\n      height: 0.82rem;\r\n    }\r\n  }\r\n\r\n  .footer {\r\n    width: inherit;\r\n    padding: 1.11rem 0.83rem;\r\n    color: #333333;\r\n    background-color: #ffffff;\r\n    height: 3.55rem;\r\n    z-index: 4;\r\n    position: fixed;\r\n    bottom: 0rem;\r\n\r\n    &-content {\r\n      float: left;\r\n    }\r\n\r\n    &-btn {\r\n      float: right;\r\n      width: 4.44rem;\r\n      height: 1.77rem;\r\n      line-height: 1.77rem;\r\n      border-radius: 0.88rem;\r\n    }\r\n  }\r\n\r\n  .start-record {\r\n    position: absolute;\r\n    z-index: 3;\r\n    left: 50%;\r\n    bottom: 235px;\r\n    transform: translate(-50%, 0);\r\n\r\n    img {\r\n      width: 140px;\r\n      height: 140px;\r\n    }\r\n  }\r\n\r\n  .controlCard {\r\n    width: 100%;\r\n    height: 328px;\r\n    position: absolute;\r\n    bottom: 0;\r\n    background-image: url('~@/assets/img/inspection/controlBg.png');\r\n    background-repeat: no-repeat;\r\n    background-size: 100%;\r\n\r\n    .controlContent {\r\n      margin: 60px 30px 0;\r\n      display: flex;\r\n      flex-direction: column;\r\n\r\n      .infoContent {\r\n        display: flex;\r\n        flex-direction: column;\r\n        justify-content: space-around;\r\n        margin-bottom: 24px;\r\n\r\n        .block {\r\n          text-align: center;\r\n          width: 210px;\r\n          height: 160px;\r\n          display: flex;\r\n          flex-direction: column;\r\n          align-items: center;\r\n          background: rgba(27, 103, 216, 0.05);\r\n          border-radius: 16px;\r\n          // margin: 0 20px;\r\n\r\n          .rate {\r\n            width: 100%;\r\n            height: 50%;\r\n            display: flex;\r\n            align-items: center;\r\n            margin: auto;\r\n            font-size: 48px;\r\n            font-family: Helvetica-Bold, Helvetica;\r\n            font-weight: bold;\r\n            color: #306cc8;\r\n\r\n            .centerStyle {\r\n              margin: auto;\r\n              display: flex;\r\n              align-items: center;\r\n              font-size: 38px;\r\n              font-family: Helvetica-Bold, Helvetica;\r\n              font-weight: bold;\r\n\r\n              .inspKp {\r\n                padding-bottom: 3px;\r\n                padding-right: 3px;\r\n                color: #306cc8;\r\n              }\r\n\r\n              .uninspKp {\r\n                color: #191919;\r\n                letter-spacing: 3px;\r\n              }\r\n            }\r\n          }\r\n\r\n          .name {\r\n            font-size: 14px;\r\n            font-family: PingFangSC-Regular, PingFang SC;\r\n            font-weight: 400;\r\n            color: #555555;\r\n            width: 100%;\r\n            height: 33%;\r\n          }\r\n        }\r\n      }\r\n\r\n      .bottomSide {\r\n        width: 100%;\r\n        display: flex;\r\n        margin-top: 24px;\r\n        justify-content: space-around;\r\n      }\r\n\r\n      .endControl {\r\n        display: flex;\r\n        justify-content: space-between;\r\n        align-items: center;\r\n\r\n        .leftText {\r\n          width: 27%;\r\n          display: flex;\r\n          justify-content: space-around;\r\n          align-items: center;\r\n\r\n          img {\r\n            width: 32px;\r\n            height: 32px;\r\n            margin: auto;\r\n          }\r\n\r\n          /deep/.fm-count-down {\r\n            font-size: 24px;\r\n            color: #306cc8;\r\n          }\r\n        }\r\n\r\n        .rightButton {\r\n          display: flex;\r\n\r\n          .endBtn {\r\n            font-size: 24px;\r\n            width: 120px;\r\n            height: 60px;\r\n            background: #ffffff;\r\n            color: #306cc8;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  .tool-box {\r\n    position: fixed;\r\n    width: 1.2rem;\r\n    height: auto;\r\n    right: 0.3rem;\r\n    bottom: 350px;\r\n\r\n    .refresh {\r\n      width: 1.2rem;\r\n      height: 1.2rem;\r\n      margin-bottom: 0.55rem;\r\n      background-color: #fff;\r\n      z-index: 3;\r\n      box-shadow: 0rem 0.22rem 0.61rem 0rem rgba(0, 0, 0, 0.2);\r\n      border-radius: 0.27rem;\r\n\r\n      &-image {\r\n        margin: 0.18rem;\r\n        width: 0.82rem;\r\n        height: 0.82rem;\r\n      }\r\n    }\r\n\r\n    .route {\r\n      width: 1.2rem;\r\n      height: 1.2rem;\r\n      margin-bottom: 0.55rem;\r\n      background-color: #fff;\r\n      z-index: 3;\r\n      box-shadow: 0rem 0.22rem 0.61rem 0rem rgba(0, 0, 0, 0.2);\r\n      border-radius: 0.27rem;\r\n\r\n      &-image {\r\n        margin: 0.18rem;\r\n        width: 0.82rem;\r\n        height: 0.82rem;\r\n      }\r\n    }\r\n\r\n    .location {\r\n      width: 1.2rem;\r\n      height: 1.2rem;\r\n      background-color: #fff;\r\n      z-index: 3;\r\n      box-shadow: 0rem 0.22rem 0.61rem 0rem rgba(0, 0, 0, 0.2);\r\n      border-radius: 60px;\r\n\r\n      &-image {\r\n        margin: 0.18rem;\r\n        width: 0.82rem;\r\n        height: 0.82rem;\r\n      }\r\n    }\r\n  }\r\n\r\n  /deep/.fm-popup {\r\n    background: #f5f7f9;\r\n  }\r\n\r\n  .popup-view {\r\n    height: auto;\r\n    width: auto;\r\n    margin: 32px;\r\n    overflow: scroll;\r\n    border-radius: 32px;\r\n    background-color: #fff;\r\n\r\n    /deep/.fm-radio--horizontal {\r\n      margin-right: 20px;\r\n    }\r\n\r\n    .title {\r\n      display: flex;\r\n      margin-top: 32px;\r\n      padding-bottom: 32px;\r\n      border-bottom: 1px #f5f5f5 solid;\r\n\r\n      img {\r\n        width: 6px;\r\n        height: 40px;\r\n      }\r\n\r\n      .deviceId {\r\n        margin-left: 32px;\r\n        font-size: 36px;\r\n        font-family: PingFangSC-Semibold, PingFang SC;\r\n        font-weight: 600;\r\n        color: #191919;\r\n        line-height: 50px;\r\n      }\r\n    }\r\n\r\n    /deep/.fm-uploader__wrapper {\r\n      margin-left: 16px;\r\n    }\r\n\r\n    .preview-cover {\r\n      position: absolute;\r\n      bottom: 0;\r\n      box-sizing: border-box;\r\n      width: 100%;\r\n      padding: 4px;\r\n      color: #fff;\r\n      font-size: 12px;\r\n      text-align: center;\r\n      background: rgba(0, 0, 0, 0.3);\r\n    }\r\n  }\r\n\r\n  .btnArea {\r\n    display: flex;\r\n\r\n    .btn {\r\n      width: 94%;\r\n      margin: 0 auto;\r\n    }\r\n\r\n    .btn1 {\r\n      width: 44%;\r\n      margin: 0 12px 0 30px;\r\n    }\r\n\r\n    .btn2 {\r\n      width: 44%;\r\n      margin: 0 30px 0 12px;\r\n    }\r\n  }\r\n\r\n  .confirm-pop {\r\n    .title {\r\n      border-left: 0.22rem solid #306cc8;\r\n      margin: 0.27rem;\r\n      padding-left: 0.55rem;\r\n    }\r\n\r\n    .content {\r\n      border-top: 0.027rem solid rgba(128, 128, 128, 0.322);\r\n      width: 11.66rem;\r\n      padding: 1.33rem;\r\n      text-align: center;\r\n      background-color: #fff;\r\n\r\n      &-view {\r\n        font-size: 0.88rem;\r\n      }\r\n\r\n      .confirm-btn {\r\n        margin-top: 2.22rem;\r\n        justify-items: center;\r\n\r\n        .popup-btn {\r\n          float: left;\r\n          width: 3.33rem;\r\n          height: 1.77rem;\r\n          border-radius: 0.27rem;\r\n\r\n          &-l {\r\n            margin-left: 0.55rem;\r\n            margin-right: 0.55rem;\r\n          }\r\n\r\n          &-r {\r\n            margin-left: 0.55rem;\r\n            margin-right: 0.55rem;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n"],"mappings":";AAwOA,OAAAA,GAAA;AACA,OAAAC,KAAA;AACA,OAAAC,KAAA;AACA,OAAAC,OAAA;AACA,OAAAC,YAAA;AACA,OAAAC,OAAA;AACA,YAAAC,GAAA;AACA,SAAAC,KAAA,EAAAC,MAAA;AACA,YAAAC,IAAA;AACA,OAAAC,QAAA;AACA,OAAAC,eAAA;AACA,OAAAC,GAAA;AACA,MAAAC,MAAA;EACAC,GAAA;EACAC,WAAA;AACA;AACA;EACAC,IAAA;EACAC,UAAA;IACAd,OAAA;IACAC,YAAA;IACAM,QAAA;IACAC;EACA;EACAO,KAAA;IACA;MACAC,MAAA;MACAC,kBAAA;MACA;MACAC,YAAA;MACAC,MAAA;MACAC,MAAA;MACAC,UAAA;MACAC,SAAA;MACAC,WAAA;MACAC,OAAA,GACA;QACAC,IAAA;MACA,GACA;QACAA,IAAA;MACA,EACA;MACAC,WAAA;MACA;MACAC,aAAA;MACA;MACA;MACAC,gBAAA;MACAC,WAAA;MACA;MACAC,qBAAA;MACAC,WAAA;MACAC,gBAAA;MACAC,UAAA;MACA;MACAC,eAAA;MACAC,KAAA;MACA;MACAC,QAAA;MACAC,WAAA;MACAC,aAAA;MACAC,eAAA;MACAC,aAAA;MACAC,QAAA;MACAC,UAAA;MACAC,QAAA;QACAC,YAAA;QACAC,cAAA;QACAC,MAAA;QACAC,QAAA;QACAC,MAAA;QACAC,OAAA;MACA;MACAC,UAAA;QACAC,QAAA;QACAC,UAAA;QACAC,WAAA;MACA;MACAC,UAAA;MACAC,YAAA;MACAC,gBAAA;MACAC,OAAA;MACAC,UAAA;MACA;MACAC,aAAA;MACAC,SAAA;MACAC,aAAA;MACAC,SAAA,GACA;QACAjD,IAAA;QACAkD,KAAA;MACA,GACA;QACAlD,IAAA;QACAkD,KAAA;MACA,EACA;MACAC,WAAA,GACA;QACAnD,IAAA;QACAkD,KAAA;MACA,GACA;QACAlD,IAAA;QACAkD,KAAA;MACA,GACA;QACAlD,IAAA;QACAkD,KAAA;MACA,EACA;MACAE,KAAA,GACA;MACAC,UAAA;MACAC,YAAA;MACAC,OAAA;MACAC,GAAA;QACA;Q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IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA;UACAvH,KAAA;YACAwL,OAAA;YACAC,QAAA;UACA;UACA,KAAArH,WAAA;UACA,KAAAnC,WAAA;UACA,KAAAgV,aAAA;UACAnR,YAAA,CAAAC,OAAA;UACA;UACA,KAAA0N,OAAA;UACA;UACA,KAAAjS,gBAAA,OAAAmF,IAAA;QACA;UACA3G,KAAA;YACAwL,OAAA;YACAC,QAAA;UACA;QACA;MACA,GACAgB,KAAA,CAAAqC,GAAA;QACAnJ,OAAA,CAAAC,GAAA,CAAAkJ,GAAA;QACA;QACA;QACA;QACA;MACA;IACA;IACA;IACAoI,UAAAtO,IAAA;MACA,IAAAuO,IAAA,GAAAC,IAAA,CAAAC,KAAA,MAAA1Q,IAAA,UAAAnF,gBAAA;MAEA,IAAA2V,IAAA;QACAnX,KAAA;UACAwL,OAAA,iBAAA2L,IAAA;UACA1L,QAAA;QACA;QACA;MACA;MACAxL,MAAA,CAAAsM,OAAA;QACAtD,KAAA;QACAuC,OAAA;MACA,GACAlE,IAAA;QACA,KAAAkF,gBAAA,CAAA5D,IAAA;MACA,GACA6D,KAAA;QACA,KAAAC,eAAA;MACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;;IAEA;IACA;IACA;IACA;IACA;IACA;IACA;IACAA,gBAAA;MACA,KAAAxK,aAAA;IACA;IACA;IACA,MAAAsK,iBAAA5D,IAAA;MACA,KAAA1G,aAAA;MACA,KAAAkC,WAAA;MACAkK,OAAA,CAAAC,YAAA,CAAA0H,oBAAA;MACA,WAAAD,YAAA,CAAApN,IAAA;MACA,KAAA3G,WAAA;MACA6D,YAAA,CAAAC,OAAA;MACA,IAAA6C,IAAA;QACA,KAAAsH,WAAA;MACA;MACAlQ,KAAA;QACAwL,OAAA;QACAC,QAAA;MACA;MACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA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"}]}