{"remainingRequest":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\babel-loader\\lib\\index.js!E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\eslint-loader\\index.js??ref--14-0!E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\src\\components\\map\\utils\\distance\\distance.js","dependencies":[{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\src\\components\\map\\utils\\distance\\distance.js","mtime":1708928163328},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\babel.config.js","mtime":1705912799600},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9kZWZpbmVQcm9wZXJ0eSBmcm9tICJFOi90eV9wcm9qZWN0L3hhc3cteXkvcmV2ZW51ZS94YXN3LW1vYmlsZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vZGVmaW5lUHJvcGVydHkuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5wdXNoLmpzIjsKaW1wb3J0IHN3YW5Ub29sIGZyb20gIi4uL3N3YW5Ub29sIjsKaW1wb3J0IG1hcGJveGdsIGZyb20gJ21hcGJveC1nbCc7CmltcG9ydCAnbWFwYm94LWdsL2Rpc3QvbWFwYm94LWdsLmNzcyc7CmltcG9ydCAqIGFzIHR1cmYgZnJvbSAnQHR1cmYvdHVyZic7CmltcG9ydCBwb3B1cCBmcm9tICIuLi9jb21tb24vcG9wdXAvcHVwb3AudnVlIjsKaW1wb3J0IGNsb3NlQnV0dG9uIGZyb20gIi4uL2NvbW1vbi9wb3B1cC9jbG9zZUJ1dHRvbiI7CmltcG9ydCBWdWUgZnJvbSAidnVlIjsKCi8qKg0KICog6Led56a75rWL6YePDQogKi8KZXhwb3J0IGRlZmF1bHQgY2xhc3Mgc3dhbkRpc3RhbmNlIGV4dGVuZHMgc3dhblRvb2wgewogIGNvbnN0cnVjdG9yKG1hcCkgewogICAgc3VwZXIobWFwKTsKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiYWRkTGluZSIsIGUgPT4gewogICAgICB0aGlzLnN0YXJ0RHJhdyA9IHRydWU7CiAgICAgIHRoaXMubGluZURhdGFbMF0uZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF0ucHVzaChbZS5sbmdMYXQubG5nLCBlLmxuZ0xhdC5sYXRdKTsKICAgICAgbGV0IGFyciA9IHRoaXMubGluZURhdGFbMF0uZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF07CiAgICAgIGlmIChhcnIubGVuZ3RoID4gMSkgewogICAgICAgIGxldCBkaXN0YW5jZSA9IHRoaXMuZ2V0RGlzdGFuY2UoW2FyclthcnIubGVuZ3RoIC0gMV0sIGFyclthcnIubGVuZ3RoIC0gMl1dKTsKICAgICAgICBsZXQgZGlzcGxheVRleHQgPSBbewogICAgICAgICAga2V5OiAi6ZW/5bqmOiIsCiAgICAgICAgICB2YWx1ZTogZGlzdGFuY2UKICAgICAgICB9XTsKICAgICAgICBsZXQgcG9wdXBWID0gVnVlLmV4dGVuZChwb3B1cCk7CiAgICAgICAgbGV0IHBvcHVwRG9tID0gbmV3IHBvcHVwVih7CiAgICAgICAgICBwcm9wc0RhdGE6IHsKICAgICAgICAgICAgZGlzcGxheVRleHQKICAgICAgICAgIH0KICAgICAgICB9KS4kbW91bnQoKTsKICAgICAgICB0aGlzLnZtTGlzdC5wdXNoKHBvcHVwRG9tKTsKICAgICAgICB0aGlzLnBvcHVwTGlzdC5wdXNoKG5ldyBtYXBib3hnbC5Qb3B1cCh7CiAgICAgICAgICBvZmZzZXQ6IHsKICAgICAgICAgICAgJ3RvcCc6IFswLCAyMl0KICAgICAgICAgIH0sCiAgICAgICAgICBjbG9zZUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAvL+WmguaenOS4uiB0cnVlIO+8jOW8ueeql+WPs+S4iuinkuWwhuWHuueOsOWFs+mXreaMiemSruOAggogICAgICAgICAgY2xvc2VPbkNsaWNrOiBmYWxzZSwKICAgICAgICAgIC8v5aaC5p6c5Li6IHRydWUg77yM54K55Ye75Zyw5Zu+5pe25by556qX5bCG5YWz6Zet44CCCiAgICAgICAgICBjbGFzc05hbWU6ICdzd2FuLXBvcHVwJwogICAgICAgIH0pLnNldExuZ0xhdChlLmxuZ0xhdCkuc2V0RE9NQ29udGVudChwb3B1cERvbS4kZWwpLmFkZFRvKHRoaXMubWFwKSk7CiAgICAgIH0KICAgICAgbGV0IGdlb2pzb24gPSB7CiAgICAgICAgInR5cGUiOiAiRmVhdHVyZUNvbGxlY3Rpb24iLAogICAgICAgICJmZWF0dXJlcyI6IHRoaXMubGluZURhdGEKICAgICAgfTsKICAgICAgdGhpcy5tYXAuZ2V0U291cmNlKCJkaXN0YW5jZSIpLnNldERhdGEoZ2VvanNvbik7CiAgICB9KTsKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAiYWRkTW92ZUxpbmUiLCBlID0+IHsKICAgICAgaWYgKCF0aGlzLnN0YXJ0RHJhdykgcmV0dXJuOwogICAgICB0aGlzLm1vdmVEYXRhID0gW3sKICAgICAgICAidHlwZSI6ICJGZWF0dXJlIiwKICAgICAgICAiZ2VvbWV0cnkiOiB7CiAgICAgICAgICAidHlwZSI6ICJNdWx0aUxpbmVTdHJpbmciLAogICAgICAgICAgImNvb3JkaW5hdGVzIjogW1tdXQogICAgICAgIH0KICAgICAgfV07CiAgICAgIHRoaXMubW92ZURhdGFbMF0uZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF0gPSBbLi4udGhpcy5saW5lRGF0YVswXS5nZW9tZXRyeS5jb29yZGluYXRlc1swXSwgW2UubG5nTGF0LmxuZywgZS5sbmdMYXQubGF0XV07CiAgICAgIGxldCBnZW9qc29uID0gewogICAgICAgICJ0eXBlIjogIkZlYXR1cmVDb2xsZWN0aW9uIiwKICAgICAgICAiZmVhdHVyZXMiOiB0aGlzLm1vdmVEYXRhCiAgICAgIH07CiAgICAgIHRoaXMubWFwLmdldFNvdXJjZSgiZGlzdGFuY2UiKS5zZXREYXRhKGdlb2pzb24pOwogICAgICB0aGlzLmxhc3RQb3B1cCAmJiB0aGlzLmxhc3RQb3B1cC5yZW1vdmUoKTsKICAgICAgbGV0IGRpc3RhbmNlID0gdGhpcy5nZXREaXN0YW5jZSh0aGlzLm1vdmVEYXRhWzBdLmdlb21ldHJ5LmNvb3JkaW5hdGVzWzBdKTsKICAgICAgbGV0IGRpc3BsYXlUZXh0ID0gW3sKICAgICAgICBrZXk6ICLmgLvplb/luqY6IiwKICAgICAgICB2YWx1ZTogZGlzdGFuY2UKICAgICAgfV07CiAgICAgIGxldCBwb3B1cFYgPSBWdWUuZXh0ZW5kKHBvcHVwKTsKICAgICAgbGV0IHBvcHVwRG9tID0gbmV3IHBvcHVwVih7CiAgICAgICAgcHJvcHNEYXRhOiB7CiAgICAgICAgICBkaXNwbGF5VGV4dAogICAgICAgIH0KICAgICAgfSkuJG1vdW50KCk7CiAgICAgIHRoaXMudm1MaXN0LnB1c2gocG9wdXBEb20pOwogICAgICB0aGlzLmxhc3RQb3B1cCA9IG5ldyBtYXBib3hnbC5Qb3B1cCh7CiAgICAgICAgb2Zmc2V0OiB7CiAgICAgICAgICAndG9wJzogWzAsIDIyXQogICAgICAgIH0sCiAgICAgICAgY2xvc2VCdXR0b246IGZhbHNlLAogICAgICAgIC8v5aaC5p6c5Li6IHRydWUg77yM5by556qX5Y+z5LiK6KeS5bCG5Ye6546w5YWz6Zet5oyJ6ZKu44CCCiAgICAgICAgY2xvc2VPbkNsaWNrOiBmYWxzZSwKICAgICAgICAvL+WmguaenOS4uiB0cnVlIO+8jOeCueWHu+WcsOWbvuaXtuW8ueeql+WwhuWFs+mXreOAggogICAgICAgIGNsYXNzTmFtZTogJ3N3YW4tcG9wdXAnCiAgICAgIH0pLnNldExuZ0xhdChlLmxuZ0xhdCkuc2V0RE9NQ29udGVudChwb3B1cERvbS4kZWwpLmFkZFRvKHRoaXMubWFwKTsKICAgIH0pOwogICAgX2RlZmluZVByb3BlcnR5KHRoaXMsICJzdG9wQWRkIiwgKCkgPT4gewogICAgICBpZiAoIXRoaXMuc3RhcnREcmF3KSByZXR1cm47CiAgICAgIHRoaXMuY2xlYXJMaXN0ZW5lcigpOwogICAgICBpZiAodGhpcy5tb3ZlRGF0YVswXS5nZW9tZXRyeS5jb29yZGluYXRlc1swXS5sZW5ndGggLSAxID09IHRoaXMucG9wdXBMaXN0Lmxlbmd0aCkgewogICAgICAgIHRoaXMucG9wdXBMaXN0W3RoaXMucG9wdXBMaXN0Lmxlbmd0aCAtIDFdLnJlbW92ZSgpOwogICAgICB9CiAgICAgIC8vIGNsb3NlQnV0dG9uCiAgICAgIC8v5re75Yqg5YWz6Zet5oyJ6ZKuCiAgICAgIGxldCBwb3B1cENsb3NlID0gVnVlLmV4dGVuZChjbG9zZUJ1dHRvbik7CiAgICAgIGxldCBwb3B1cENsb3NlRG9tID0gbmV3IHBvcHVwQ2xvc2Uoe30pLiRtb3VudCgpOwogICAgICBwb3B1cENsb3NlRG9tLiRvbigiY2xvc2UiLCAoKSA9PiB7CiAgICAgICAgdGhpcy5vbkNhbmNlbCgpOwogICAgICB9KTsKICAgICAgdGhpcy52bUxpc3QucHVzaChwb3B1cENsb3NlRG9tKTsKICAgICAgbGV0IGdlb20gPSB0aGlzLm1vdmVEYXRhWzBdLmdlb21ldHJ5LmNvb3JkaW5hdGVzWzBdOwogICAgICB0aGlzLnBvcHVwTGlzdC5wdXNoKG5ldyBtYXBib3hnbC5Qb3B1cCh7CiAgICAgICAgb2Zmc2V0OiB7CiAgICAgICAgICAnYm90dG9tJzogWzAsIDQwXQogICAgICAgIH0sCiAgICAgICAgY2xvc2VCdXR0b246IGZhbHNlLAogICAgICAgIC8v5aaC5p6c5Li6IHRydWUg77yM5by556qX5Y+z5LiK6KeS5bCG5Ye6546w5YWz6Zet5oyJ6ZKu44CCCiAgICAgICAgY2xvc2VPbkNsaWNrOiBmYWxzZSwKICAgICAgICAvL+WmguaenOS4uiB0cnVlIO+8jOeCueWHu+WcsOWbvuaXtuW8ueeql+WwhuWFs+mXreOAggogICAgICAgIGNsYXNzTmFtZTogJ3N3YW4tcG9wdXAtY2xvc2UnCiAgICAgIH0pLnNldExuZ0xhdChnZW9tW2dlb20ubGVuZ3RoIC0gMV0pLnNldERPTUNvbnRlbnQocG9wdXBDbG9zZURvbS4kZWwpLmFkZFRvKHRoaXMubWFwKSk7CiAgICB9KTsKICAgIHRoaXMubGluZURhdGEgPSBbXTsKICAgIHRoaXMubW92ZURhdGEgPSBbXTsKICAgIHRoaXMuc3RhcnREcmF3ID0gZmFsc2U7CiAgICB0aGlzLnBvcHVwTGlzdCA9IFtdOwogICAgdGhpcy52bUxpc3QgPSBbXTsKICAgIHRoaXMubGFzdFBvcHVwID0gbnVsbDsKICB9CiAgb25BZGQoKSB7CiAgICB0aGlzLmluaXRNZWFzdXJlKCk7CiAgICB0aGlzLm1hcC5vbigiY2xpY2siLCB0aGlzLmFkZExpbmUpOwogICAgdGhpcy5tYXAub24oIm1vdXNlbW92ZSIsIHRoaXMuYWRkTW92ZUxpbmUpOwogICAgdGhpcy5tYXAub24oImRibGNsaWNrIiwgdGhpcy5zdG9wQWRkKTsKICB9CiAgaW5pdE1lYXN1cmUoKSB7CiAgICB0aGlzLnBvcHVwTGlzdC5mb3JFYWNoKGl0ZW0gPT4gewogICAgICBpdGVtLnJlbW92ZSgpOwogICAgfSk7CiAgICB0aGlzLmxhc3RQb3B1cCAmJiB0aGlzLmxhc3RQb3B1cC5yZW1vdmUoKTsKICAgIHRoaXMubGluZURhdGEgPSBbewogICAgICAidHlwZSI6ICJGZWF0dXJlIiwKICAgICAgImdlb21ldHJ5IjogewogICAgICAgICJ0eXBlIjogIk11bHRpTGluZVN0cmluZyIsCiAgICAgICAgImNvb3JkaW5hdGVzIjogW1tdXQogICAgICB9CiAgICB9XTsKICAgIHRoaXMubWFwLmdldENhbnZhcygpLnN0eWxlLmN1cnNvciA9ICJjcm9zc2hhaXIiOwogICAgIXRoaXMubWFwLmdldFNvdXJjZSgiZGlzdGFuY2UiKSAmJiB0aGlzLm1hcC5hZGRTb3VyY2UoImRpc3RhbmNlIiwgewogICAgICAidHlwZSI6ICJnZW9qc29uIiwKICAgICAgImRhdGEiOiB7CiAgICAgICAgInR5cGUiOiAiRmVhdHVyZUNvbGxlY3Rpb24iLAogICAgICAgICJmZWF0dXJlcyI6IFtdCiAgICAgIH0KICAgIH0pOwogICAgIXRoaXMubWFwLmdldExheWVyKCJkaXN0YW5jZSIpICYmIHRoaXMubWFwLmFkZExheWVyKHsKICAgICAgImlkIjogImRpc3RhbmNlIiwKICAgICAgInNvdXJjZSI6ICJkaXN0YW5jZSIsCiAgICAgICJ0eXBlIjogImxpbmUiLAogICAgICAicGFpbnQiOiB7CiAgICAgICAgLy8g57uY5Yi257G75bGe5oCnCiAgICAgICAgImxpbmUtb3BhY2l0eSI6IDEsCiAgICAgICAgLy8g57q/55qE5LiN6YCP5piO5bqm77yI5Y+v6YCJ77yM5Y+W5YC86IyD5Zu05Li6IDAgfiAx77yM6buY6K6k5YC85Li6IDHvvIkKICAgICAgICAibGluZS1jb2xvciI6ICIjMDZDRUFFIiwKICAgICAgICAvLyDnur/nmoTpopzoibLvvIjlj6/pgInvvIzpu5jorqTlgLzkuLogIzAwMDAwMOOAguWmguaenOiuvue9ruS6hiBsaW5lLXBhdHRlcm7vvIzliJkgbGluZS1jb2xvciDlsIbml6DmlYjvvIkKICAgICAgICAibGluZS13aWR0aCI6IDIgLy8g57q/55qE5a695bqm77yI5Y+v6YCJ77yM5YC8ID49IDDvvIzpu5jorqTlgLzkuLogMe+8jOWNleS9je+8muWDj+e0oO+8iQogICAgICB9CiAgICB9KTsKICAgICF0aGlzLm1hcC5nZXRMYXllcigiZGlzdGFuY2VfY2FwIikgJiYgdGhpcy5tYXAuYWRkTGF5ZXIoewogICAgICAiaWQiOiAiZGlzdGFuY2VfY2FwIiwKICAgICAgInNvdXJjZSI6ICJkaXN0YW5jZSIsCiAgICAgICJ0eXBlIjogImNpcmNsZSIsCiAgICAgICJwYWludCI6IHsKICAgICAgICAvLyDnu5jliLbnsbvlsZ7mgKcKICAgICAgICAiY2lyY2xlLW9wYWNpdHkiOiAxLAogICAgICAgIC8vIOWchueCueeahOS4jemAj+aYjuW6pu+8iOWPr+mAie+8jOWPluWAvOiMg+WbtOS4uiAwIH4gMe+8jOm7mOiupOWAvOS4uiAx77yJCiAgICAgICAgImNpcmNsZS1yYWRpdXMiOiA2LAogICAgICAgIC8vIOWchueCueeahOWNiuW+hO+8iOWPr+mAie+8jOWAvCA+PSAw77yM6buY6K6k5YC85Li6IDXvvIzljZXkvY3vvJrlg4/ntKDvvIkKICAgICAgICAiY2lyY2xlLWNvbG9yIjogIiNGRkZGMDAiIC8vIOWchueCueeahOminOiJsu+8iOWPr+mAie+8jOm7mOiupOWAvOS4uiAjMDAwMDAw77yJCiAgICAgIH0KICAgIH0pOwogIH0KICBnZXREaXN0YW5jZShsaW5lTGlzdCkgewogICAgbGV0IGxpbmUgPSB0dXJmLmxpbmVTdHJpbmcobGluZUxpc3QpOwogICAgbGV0IGxlbmd0aCA9IHR1cmYubGVuZ3RoKGxpbmUsIHsKICAgICAgdW5pdHM6ICdraWxvbWV0ZXJzJwogICAgfSk7CiAgICBpZiAobGVuZ3RoIDwgMSkgewogICAgICByZXR1cm4gYCR7KGxlbmd0aCAqIDEwMDApLnRvRml4ZWQoMSl9TWA7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gYCR7bGVuZ3RoLnRvRml4ZWQoMil9S01gOwogICAgfQogIH0KICBjbGVhckxpc3RlbmVyKCkgewogICAgdGhpcy5zdGFydERyYXcgPSBmYWxzZTsKICAgIHRoaXMubWFwLmdldENhbnZhcygpLnN0eWxlLmN1cnNvciA9ICIiOwogICAgdGhpcy5tYXAub2ZmKCJjbGljayIsIHRoaXMuYWRkTGluZSk7CiAgICB0aGlzLm1hcC5vZmYoIm1vdXNlbW92ZSIsIHRoaXMuYWRkTGFzdFBvaW50KTsKICAgIHRoaXMubWFwLm9mZigiZGJsY2xpY2siLCB0aGlzLnN0b3BBZGQpOwogIH0KICBvbkNhbmNlbCgpIHsKICAgIHRoaXMuY2xlYXJMaXN0ZW5lcigpOwogICAgdGhpcy5wb3B1cExpc3QuZm9yRWFjaChpdGVtID0+IHsKICAgICAgaXRlbS5yZW1vdmUoKTsKICAgIH0pOwogICAgdGhpcy52bUxpc3QuZm9yRWFjaChpdGVtID0+IHsKICAgICAgaXRlbS4kZGVzdHJveSgpOwogICAgfSk7CiAgICB0aGlzLmxhc3RQb3B1cCAmJiB0aGlzLmxhc3RQb3B1cC5yZW1vdmUoKTsKICAgIHRoaXMubWFwLmdldExheWVyKCJkaXN0YW5jZSIpICYmIHRoaXMubWFwLnJlbW92ZUxheWVyKCJkaXN0YW5jZSIpOwogICAgdGhpcy5tYXAuZ2V0TGF5ZXIoImRpc3RhbmNlX2NhcCIpICYmIHRoaXMubWFwLnJlbW92ZUxheWVyKCJkaXN0YW5jZV9jYXAiKTsKICAgIHRoaXMubWFwLmdldFNvdXJjZSgiZGlzdGFuY2UiKSAmJiB0aGlzLm1hcC5yZW1vdmVTb3VyY2UoImRpc3RhbmNlIik7CiAgfQp9"},{"version":3,"names":["swanTool","mapboxgl","turf","popup","closeButton","Vue","swanDistance","constructor","map","_defineProperty","e","startDraw","lineData","geometry","coordinates","push","lngLat","lng","lat","arr","length","distance","getDistance","displayText","key","value","popupV","extend","popupDom","propsData","$mount","vmList","popupList","Popup","offset","closeOnClick","className","setLngLat","setDOMContent","$el","addTo","geojson","getSource","setData","moveData","lastPopup","remove","clearListener","popupClose","popupCloseDom","$on","onCancel","geom","onAdd","initMeasure","on","addLine","addMoveLine","stopAdd","forEach","item","getCanvas","style","cursor","addSource","getLayer","addLayer","lineList","line","lineString","units","toFixed","off","addLastPoint","$destroy","removeLayer","removeSource"],"sources":["E:/ty_project/xasw-yy/revenue/xasw-mobile/src/components/map/utils/distance/distance.js"],"sourcesContent":["import swanTool from \"../swanTool\";\r\nimport mapboxgl from 'mapbox-gl';\r\nimport 'mapbox-gl/dist/mapbox-gl.css';\r\nimport * as turf from '@turf/turf';\r\nimport popup from \"../common/popup/pupop.vue\";\r\nimport closeButton from \"../common/popup/closeButton\";\r\nimport Vue from \"vue\";\r\n\r\n/**\r\n * 距离测量\r\n */\r\nexport default class swanDistance extends swanTool {\r\n  constructor(map) {\r\n    super(map);\r\n    this.lineData = [];\r\n    this.moveData = [];\r\n    this.startDraw = false;\r\n    this.popupList = [];\r\n    this.vmList = [];\r\n    this.lastPopup = null;\r\n  }\r\n\r\n  onAdd() {\r\n    this.initMeasure();\r\n    this.map.on(\"click\", this.addLine)\r\n    this.map.on(\"mousemove\", this.addMoveLine)\r\n    this.map.on(\"dblclick\", this.stopAdd)\r\n  }\r\n\r\n  initMeasure() {\r\n    this.popupList.forEach(item => {\r\n      item.remove()\r\n    })\r\n    this.lastPopup && this.lastPopup.remove()\r\n    this.lineData = [{\r\n      \"type\": \"Feature\",\r\n      \"geometry\": {\r\n        \"type\": \"MultiLineString\",\r\n        \"coordinates\": [[]]\r\n      }\r\n    }]\r\n    this.map.getCanvas().style.cursor = \"crosshair\";\r\n    !this.map.getSource(\"distance\") && this.map.addSource(\"distance\", {\r\n      \"type\": \"geojson\",\r\n      \"data\": {\r\n        \"type\": \"FeatureCollection\",\r\n        \"features\": []\r\n      },\r\n    })\r\n    !this.map.getLayer(\"distance\") && this.map.addLayer({\r\n      \"id\": \"distance\",\r\n      \"source\": \"distance\",\r\n      \"type\": \"line\",\r\n      \"paint\": { // 绘制类属性\r\n        \"line-opacity\": 1, // 线的不透明度（可选，取值范围为 0 ~ 1，默认值为 1）\r\n        \"line-color\": \"#06CEAE\", // 线的颜色（可选，默认值为 #000000。如果设置了 line-pattern，则 line-color 将无效）\r\n        \"line-width\": 2, // 线的宽度（可选，值 >= 0，默认值为 1，单位：像素）\r\n      }\r\n    })\r\n    !this.map.getLayer(\"distance_cap\") && this.map.addLayer({\r\n      \"id\": \"distance_cap\",\r\n      \"source\": \"distance\",\r\n      \"type\": \"circle\",\r\n      \"paint\": { // 绘制类属性\r\n        \"circle-opacity\": 1, // 圆点的不透明度（可选，取值范围为 0 ~ 1，默认值为 1）\r\n        \"circle-radius\": 6, // 圆点的半径（可选，值 >= 0，默认值为 5，单位：像素）\r\n        \"circle-color\": \"#FFFF00\", // 圆点的颜色（可选，默认值为 #000000）\r\n      }\r\n    })\r\n  }\r\n\r\n  addLine = (e) => {\r\n    this.startDraw = true\r\n    this.lineData[0].geometry.coordinates[0].push([e.lngLat.lng, e.lngLat.lat]);\r\n    let arr = this.lineData[0].geometry.coordinates[0]\r\n    if (arr.length > 1) {\r\n      let distance = this.getDistance([arr[arr.length - 1], arr[arr.length - 2]])\r\n      let displayText = [{\r\n        key: \"长度:\",\r\n        value: distance\r\n      }]\r\n      let popupV = Vue.extend(popup);\r\n      let popupDom = new popupV({\r\n        propsData: { displayText }\r\n      }).$mount();\r\n      this.vmList.push(popupDom);\r\n      this.popupList.push(\r\n        new mapboxgl.Popup({\r\n          offset: {\r\n            'top': [0, 22],\r\n          },\r\n          closeButton: false,//如果为 true ，弹窗右上角将出现关闭按钮。\r\n          closeOnClick: false, //如果为 true ，点击地图时弹窗将关闭。\r\n          className: 'swan-popup'\r\n        })\r\n          .setLngLat(e.lngLat)\r\n          .setDOMContent(popupDom.$el)\r\n          .addTo(this.map)\r\n      )\r\n    }\r\n    let geojson = {\r\n      \"type\": \"FeatureCollection\",\r\n      \"features\": this.lineData\r\n    };\r\n    this.map.getSource(\"distance\").setData(geojson);\r\n  }\r\n\r\n  addMoveLine = (e) => {\r\n    if (!this.startDraw)\r\n      return\r\n    this.moveData = [{\r\n      \"type\": \"Feature\",\r\n      \"geometry\": {\r\n        \"type\": \"MultiLineString\",\r\n        \"coordinates\": [[]]\r\n      }\r\n    }]\r\n    this.moveData[0].geometry.coordinates[0] = [\r\n      ...this.lineData[0].geometry.coordinates[0],\r\n      [e.lngLat.lng, e.lngLat.lat]\r\n    ]\r\n    let geojson = {\r\n      \"type\": \"FeatureCollection\",\r\n      \"features\": this.moveData\r\n    };\r\n    this.map.getSource(\"distance\").setData(geojson);\r\n\r\n    this.lastPopup && this.lastPopup.remove()\r\n    let distance = this.getDistance(this.moveData[0].geometry.coordinates[0])\r\n    let displayText = [{\r\n      key: \"总长度:\",\r\n      value: distance\r\n    }]\r\n    let popupV = Vue.extend(popup);\r\n    let popupDom = new popupV({\r\n      propsData: { displayText }\r\n    }).$mount();\r\n    this.vmList.push(popupDom);\r\n    this.lastPopup = new mapboxgl.Popup({\r\n      offset: {\r\n        'top': [0, 22],\r\n      },\r\n      closeButton: false,//如果为 true ，弹窗右上角将出现关闭按钮。\r\n      closeOnClick: false, //如果为 true ，点击地图时弹窗将关闭。\r\n      className: 'swan-popup'\r\n    })\r\n      .setLngLat(e.lngLat)\r\n      .setDOMContent(popupDom.$el)\r\n      .addTo(this.map)\r\n  }\r\n\r\n  getDistance(lineList) {\r\n    let line = turf.lineString(lineList);\r\n    let length = turf.length(line, { units: 'kilometers' });\r\n    if (length < 1) {\r\n      return `${(length * 1000).toFixed(1)}M`\r\n    } else {\r\n      return `${length.toFixed(2)}KM`\r\n    }\r\n  }\r\n\r\n  stopAdd = () => {\r\n    if (!this.startDraw)\r\n      return\r\n    this.clearListener()\r\n    if (this.moveData[0].geometry.coordinates[0].length - 1 == this.popupList.length) {\r\n      this.popupList[this.popupList.length - 1].remove()\r\n    }\r\n    // closeButton\r\n    //添加关闭按钮\r\n    let popupClose = Vue.extend(closeButton);\r\n    let popupCloseDom = new popupClose({}).$mount();\r\n    popupCloseDom.$on(\"close\", () => {\r\n      this.onCancel();\r\n    })\r\n    this.vmList.push(popupCloseDom);\r\n    let geom = this.moveData[0].geometry.coordinates[0]\r\n    this.popupList.push(\r\n      new mapboxgl.Popup({\r\n        offset: {\r\n          'bottom': [0, 40],\r\n        },\r\n        closeButton: false,//如果为 true ，弹窗右上角将出现关闭按钮。\r\n        closeOnClick: false, //如果为 true ，点击地图时弹窗将关闭。\r\n        className: 'swan-popup-close'\r\n      })\r\n        .setLngLat(geom[geom.length - 1])\r\n        .setDOMContent(popupCloseDom.$el)\r\n        .addTo(this.map)\r\n    )\r\n  }\r\n\r\n  clearListener() {\r\n    this.startDraw = false\r\n    this.map.getCanvas().style.cursor = \"\";\r\n    this.map.off(\"click\", this.addLine)\r\n    this.map.off(\"mousemove\", this.addLastPoint)\r\n    this.map.off(\"dblclick\", this.stopAdd)\r\n  }\r\n\r\n  onCancel() {\r\n    this.clearListener()\r\n    this.popupList.forEach(item => {\r\n      item.remove()\r\n    })\r\n    this.vmList.forEach(item => {\r\n      item.$destroy();\r\n    })\r\n    this.lastPopup && this.lastPopup.remove()\r\n    this.map.getLayer(\"distance\") && this.map.removeLayer(\"distance\");\r\n    this.map.getLayer(\"distance_cap\") && this.map.removeLayer(\"distance_cap\");\r\n    this.map.getSource(\"distance\") && this.map.removeSource(\"distance\");\r\n  }\r\n}"],"mappings":";;AAAA,OAAOA,QAAQ,MAAM,aAAa;AAClC,OAAOC,QAAQ,MAAM,WAAW;AAChC,OAAO,8BAA8B;AACrC,OAAO,KAAKC,IAAI,MAAM,YAAY;AAClC,OAAOC,KAAK,MAAM,2BAA2B;AAC7C,OAAOC,WAAW,MAAM,6BAA6B;AACrD,OAAOC,GAAG,MAAM,KAAK;;AAErB;AACA;AACA;AACA,eAAe,MAAMC,YAAY,SAASN,QAAQ,CAAC;EACjDO,WAAWA,CAACC,GAAG,EAAE;IACf,KAAK,CAACA,GAAG,CAAC;IAACC,eAAA,kBA0DFC,CAAC,IAAK;MACf,IAAI,CAACC,SAAS,GAAG,IAAI;MACrB,IAAI,CAACC,QAAQ,CAAC,CAAC,CAAC,CAACC,QAAQ,CAACC,WAAW,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,CAACL,CAAC,CAACM,MAAM,CAACC,GAAG,EAAEP,CAAC,CAACM,MAAM,CAACE,GAAG,CAAC,CAAC;MAC3E,IAAIC,GAAG,GAAG,IAAI,CAACP,QAAQ,CAAC,CAAC,CAAC,CAACC,QAAQ,CAACC,WAAW,CAAC,CAAC,CAAC;MAClD,IAAIK,GAAG,CAACC,MAAM,GAAG,CAAC,EAAE;QAClB,IAAIC,QAAQ,GAAG,IAAI,CAACC,WAAW,CAAC,CAACH,GAAG,CAACA,GAAG,CAACC,MAAM,GAAG,CAAC,CAAC,EAAED,GAAG,CAACA,GAAG,CAACC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;QAC3E,IAAIG,WAAW,GAAG,CAAC;UACjBC,GAAG,EAAE,KAAK;UACVC,KAAK,EAAEJ;QACT,CAAC,CAAC;QACF,IAAIK,MAAM,GAAGrB,GAAG,CAACsB,MAAM,CAACxB,KAAK,CAAC;QAC9B,IAAIyB,QAAQ,GAAG,IAAIF,MAAM,CAAC;UACxBG,SAAS,EAAE;YAAEN;UAAY;QAC3B,CAAC,CAAC,CAACO,MAAM,CAAC,CAAC;QACX,IAAI,CAACC,MAAM,CAAChB,IAAI,CAACa,QAAQ,CAAC;QAC1B,IAAI,CAACI,SAAS,CAACjB,IAAI,CACjB,IAAId,QAAQ,CAACgC,KAAK,CAAC;UACjBC,MAAM,EAAE;YACN,KAAK,EAAE,CAAC,CAAC,EAAE,EAAE;UACf,CAAC;UACD9B,WAAW,EAAE,KAAK;UAAC;UACnB+B,YAAY,EAAE,KAAK;UAAE;UACrBC,SAAS,EAAE;QACb,CAAC,CAAC,CACCC,SAAS,CAAC3B,CAAC,CAACM,MAAM,CAAC,CACnBsB,aAAa,CAACV,QAAQ,CAACW,GAAG,CAAC,CAC3BC,KAAK,CAAC,IAAI,CAAChC,GAAG,CACnB,CAAC;MACH;MACA,IAAIiC,OAAO,GAAG;QACZ,MAAM,EAAE,mBAAmB;QAC3B,UAAU,EAAE,IAAI,CAAC7B;MACnB,CAAC;MACD,IAAI,CAACJ,GAAG,CAACkC,SAAS,CAAC,UAAU,CAAC,CAACC,OAAO,CAACF,OAAO,CAAC;IACjD,CAAC;IAAAhC,eAAA,sBAEcC,CAAC,IAAK;MACnB,IAAI,CAAC,IAAI,CAACC,SAAS,EACjB;MACF,IAAI,CAACiC,QAAQ,GAAG,CAAC;QACf,MAAM,EAAE,SAAS;QACjB,UAAU,EAAE;UACV,MAAM,EAAE,iBAAiB;UACzB,aAAa,EAAE,CAAC,EAAE;QACpB;MACF,CAAC,CAAC;MACF,IAAI,CAACA,QAAQ,CAAC,CAAC,CAAC,CAAC/B,QAAQ,CAACC,WAAW,CAAC,CAAC,CAAC,GAAG,CACzC,GAAG,IAAI,CAACF,QAAQ,CAAC,CAAC,CAAC,CAACC,QAAQ,CAACC,WAAW,CAAC,CAAC,CAAC,EAC3C,CAACJ,CAAC,CAACM,MAAM,CAACC,GAAG,EAAEP,CAAC,CAACM,MAAM,CAACE,GAAG,CAAC,CAC7B;MACD,IAAIuB,OAAO,GAAG;QACZ,MAAM,EAAE,mBAAmB;QAC3B,UAAU,EAAE,IAAI,CAACG;MACnB,CAAC;MACD,IAAI,CAACpC,GAAG,CAACkC,SAAS,CAAC,UAAU,CAAC,CAACC,OAAO,CAACF,OAAO,CAAC;MAE/C,IAAI,CAACI,SAAS,IAAI,IAAI,CAACA,SAAS,CAACC,MAAM,CAAC,CAAC;MACzC,IAAIzB,QAAQ,GAAG,IAAI,CAACC,WAAW,CAAC,IAAI,CAACsB,QAAQ,CAAC,CAAC,CAAC,CAAC/B,QAAQ,CAACC,WAAW,CAAC,CAAC,CAAC,CAAC;MACzE,IAAIS,WAAW,GAAG,CAAC;QACjBC,GAAG,EAAE,MAAM;QACXC,KAAK,EAAEJ;MACT,CAAC,CAAC;MACF,IAAIK,MAAM,GAAGrB,GAAG,CAACsB,MAAM,CAACxB,KAAK,CAAC;MAC9B,IAAIyB,QAAQ,GAAG,IAAIF,MAAM,CAAC;QACxBG,SAAS,EAAE;UAAEN;QAAY;MAC3B,CAAC,CAAC,CAACO,MAAM,CAAC,CAAC;MACX,IAAI,CAACC,MAAM,CAAChB,IAAI,CAACa,QAAQ,CAAC;MAC1B,IAAI,CAACiB,SAAS,GAAG,IAAI5C,QAAQ,CAACgC,KAAK,CAAC;QAClCC,MAAM,EAAE;UACN,KAAK,EAAE,CAAC,CAAC,EAAE,EAAE;QACf,CAAC;QACD9B,WAAW,EAAE,KAAK;QAAC;QACnB+B,YAAY,EAAE,KAAK;QAAE;QACrBC,SAAS,EAAE;MACb,CAAC,CAAC,CACCC,SAAS,CAAC3B,CAAC,CAACM,MAAM,CAAC,CACnBsB,aAAa,CAACV,QAAQ,CAACW,GAAG,CAAC,CAC3BC,KAAK,CAAC,IAAI,CAAChC,GAAG,CAAC;IACpB,CAAC;IAAAC,eAAA,kBAYS,MAAM;MACd,IAAI,CAAC,IAAI,CAACE,SAAS,EACjB;MACF,IAAI,CAACoC,aAAa,CAAC,CAAC;MACpB,IAAI,IAAI,CAACH,QAAQ,CAAC,CAAC,CAAC,CAAC/B,QAAQ,CAACC,WAAW,CAAC,CAAC,CAAC,CAACM,MAAM,GAAG,CAAC,IAAI,IAAI,CAACY,SAAS,CAACZ,MAAM,EAAE;QAChF,IAAI,CAACY,SAAS,CAAC,IAAI,CAACA,SAAS,CAACZ,MAAM,GAAG,CAAC,CAAC,CAAC0B,MAAM,CAAC,CAAC;MACpD;MACA;MACA;MACA,IAAIE,UAAU,GAAG3C,GAAG,CAACsB,MAAM,CAACvB,WAAW,CAAC;MACxC,IAAI6C,aAAa,GAAG,IAAID,UAAU,CAAC,CAAC,CAAC,CAAC,CAAClB,MAAM,CAAC,CAAC;MAC/CmB,aAAa,CAACC,GAAG,CAAC,OAAO,EAAE,MAAM;QAC/B,IAAI,CAACC,QAAQ,CAAC,CAAC;MACjB,CAAC,CAAC;MACF,IAAI,CAACpB,MAAM,CAAChB,IAAI,CAACkC,aAAa,CAAC;MAC/B,IAAIG,IAAI,GAAG,IAAI,CAACR,QAAQ,CAAC,CAAC,CAAC,CAAC/B,QAAQ,CAACC,WAAW,CAAC,CAAC,CAAC;MACnD,IAAI,CAACkB,SAAS,CAACjB,IAAI,CACjB,IAAId,QAAQ,CAACgC,KAAK,CAAC;QACjBC,MAAM,EAAE;UACN,QAAQ,EAAE,CAAC,CAAC,EAAE,EAAE;QAClB,CAAC;QACD9B,WAAW,EAAE,KAAK;QAAC;QACnB+B,YAAY,EAAE,KAAK;QAAE;QACrBC,SAAS,EAAE;MACb,CAAC,CAAC,CACCC,SAAS,CAACe,IAAI,CAACA,IAAI,CAAChC,MAAM,GAAG,CAAC,CAAC,CAAC,CAChCkB,aAAa,CAACW,aAAa,CAACV,GAAG,CAAC,CAChCC,KAAK,CAAC,IAAI,CAAChC,GAAG,CACnB,CAAC;IACH,CAAC;IAhLC,IAAI,CAACI,QAAQ,GAAG,EAAE;IAClB,IAAI,CAACgC,QAAQ,GAAG,EAAE;IAClB,IAAI,CAACjC,SAAS,GAAG,KAAK;IACtB,IAAI,CAACqB,SAAS,GAAG,EAAE;IACnB,IAAI,CAACD,MAAM,GAAG,EAAE;IAChB,IAAI,CAACc,SAAS,GAAG,IAAI;EACvB;EAEAQ,KAAKA,CAAA,EAAG;IACN,IAAI,CAACC,WAAW,CAAC,CAAC;IAClB,IAAI,CAAC9C,GAAG,CAAC+C,EAAE,CAAC,OAAO,EAAE,IAAI,CAACC,OAAO,CAAC;IAClC,IAAI,CAAChD,GAAG,CAAC+C,EAAE,CAAC,WAAW,EAAE,IAAI,CAACE,WAAW,CAAC;IAC1C,IAAI,CAACjD,GAAG,CAAC+C,EAAE,CAAC,UAAU,EAAE,IAAI,CAACG,OAAO,CAAC;EACvC;EAEAJ,WAAWA,CAAA,EAAG;IACZ,IAAI,CAACtB,SAAS,CAAC2B,OAAO,CAACC,IAAI,IAAI;MAC7BA,IAAI,CAACd,MAAM,CAAC,CAAC;IACf,CAAC,CAAC;IACF,IAAI,CAACD,SAAS,IAAI,IAAI,CAACA,SAAS,CAACC,MAAM,CAAC,CAAC;IACzC,IAAI,CAAClC,QAAQ,GAAG,CAAC;MACf,MAAM,EAAE,SAAS;MACjB,UAAU,EAAE;QACV,MAAM,EAAE,iBAAiB;QACzB,aAAa,EAAE,CAAC,EAAE;MACpB;IACF,CAAC,CAAC;IACF,IAAI,CAACJ,GAAG,CAACqD,SAAS,CAAC,CAAC,CAACC,KAAK,CAACC,MAAM,GAAG,WAAW;IAC/C,CAAC,IAAI,CAACvD,GAAG,CAACkC,SAAS,CAAC,UAAU,CAAC,IAAI,IAAI,CAAClC,GAAG,CAACwD,SAAS,CAAC,UAAU,EAAE;MAChE,MAAM,EAAE,SAAS;MACjB,MAAM,EAAE;QACN,MAAM,EAAE,mBAAmB;QAC3B,UAAU,EAAE;MACd;IACF,CAAC,CAAC;IACF,CAAC,IAAI,CAACxD,GAAG,CAACyD,QAAQ,CAAC,UAAU,CAAC,IAAI,IAAI,CAACzD,GAAG,CAAC0D,QAAQ,CAAC;MAClD,IAAI,EAAE,UAAU;MAChB,QAAQ,EAAE,UAAU;MACpB,MAAM,EAAE,MAAM;MACd,OAAO,EAAE;QAAE;QACT,cAAc,EAAE,CAAC;QAAE;QACnB,YAAY,EAAE,SAAS;QAAE;QACzB,YAAY,EAAE,CAAC,CAAE;MACnB;IACF,CAAC,CAAC;IACF,CAAC,IAAI,CAAC1D,GAAG,CAACyD,QAAQ,CAAC,cAAc,CAAC,IAAI,IAAI,CAACzD,GAAG,CAAC0D,QAAQ,CAAC;MACtD,IAAI,EAAE,cAAc;MACpB,QAAQ,EAAE,UAAU;MACpB,MAAM,EAAE,QAAQ;MAChB,OAAO,EAAE;QAAE;QACT,gBAAgB,EAAE,CAAC;QAAE;QACrB,eAAe,EAAE,CAAC;QAAE;QACpB,cAAc,EAAE,SAAS,CAAE;MAC7B;IACF,CAAC,CAAC;EACJ;EAkFA5C,WAAWA,CAAC6C,QAAQ,EAAE;IACpB,IAAIC,IAAI,GAAGlE,IAAI,CAACmE,UAAU,CAACF,QAAQ,CAAC;IACpC,IAAI/C,MAAM,GAAGlB,IAAI,CAACkB,MAAM,CAACgD,IAAI,EAAE;MAAEE,KAAK,EAAE;IAAa,CAAC,CAAC;IACvD,IAAIlD,MAAM,GAAG,CAAC,EAAE;MACd,OAAQ,GAAE,CAACA,MAAM,GAAG,IAAI,EAAEmD,OAAO,CAAC,CAAC,CAAE,GAAE;IACzC,CAAC,MAAM;MACL,OAAQ,GAAEnD,MAAM,CAACmD,OAAO,CAAC,CAAC,CAAE,IAAG;IACjC;EACF;EAiCAxB,aAAaA,CAAA,EAAG;IACd,IAAI,CAACpC,SAAS,GAAG,KAAK;IACtB,IAAI,CAACH,GAAG,CAACqD,SAAS,CAAC,CAAC,CAACC,KAAK,CAACC,MAAM,GAAG,EAAE;IACtC,IAAI,CAACvD,GAAG,CAACgE,GAAG,CAAC,OAAO,EAAE,IAAI,CAAChB,OAAO,CAAC;IACnC,IAAI,CAAChD,GAAG,CAACgE,GAAG,CAAC,WAAW,EAAE,IAAI,CAACC,YAAY,CAAC;IAC5C,IAAI,CAACjE,GAAG,CAACgE,GAAG,CAAC,UAAU,EAAE,IAAI,CAACd,OAAO,CAAC;EACxC;EAEAP,QAAQA,CAAA,EAAG;IACT,IAAI,CAACJ,aAAa,CAAC,CAAC;IACpB,IAAI,CAACf,SAAS,CAAC2B,OAAO,CAACC,IAAI,IAAI;MAC7BA,IAAI,CAACd,MAAM,CAAC,CAAC;IACf,CAAC,CAAC;IACF,IAAI,CAACf,MAAM,CAAC4B,OAAO,CAACC,IAAI,IAAI;MAC1BA,IAAI,CAACc,QAAQ,CAAC,CAAC;IACjB,CAAC,CAAC;IACF,IAAI,CAAC7B,SAAS,IAAI,IAAI,CAACA,SAAS,CAACC,MAAM,CAAC,CAAC;IACzC,IAAI,CAACtC,GAAG,CAACyD,QAAQ,CAAC,UAAU,CAAC,IAAI,IAAI,CAACzD,GAAG,CAACmE,WAAW,CAAC,UAAU,CAAC;IACjE,IAAI,CAACnE,GAAG,CAACyD,QAAQ,CAAC,cAAc,CAAC,IAAI,IAAI,CAACzD,GAAG,CAACmE,WAAW,CAAC,cAAc,CAAC;IACzE,IAAI,CAACnE,GAAG,CAACkC,SAAS,CAAC,UAAU,CAAC,IAAI,IAAI,CAAClC,GAAG,CAACoE,YAAY,CAAC,UAAU,CAAC;EACrE;AACF"}]}