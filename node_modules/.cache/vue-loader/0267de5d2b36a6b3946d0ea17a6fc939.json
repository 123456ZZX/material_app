{"remainingRequest":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Code\\Project\\WL\\xasw-mobile\\src\\views\\inspectMap\\index.vue?vue&type=script&lang=js","dependencies":[{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\src\\views\\inspectMap\\index.vue","mtime":1708928163423},{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgbWFwSW5pdCBmcm9tICIuL2luZGV4LmpzIjsNCmltcG9ydCBhZGRJbWdUb01hcCBmcm9tICIuL3V0aWxzL3NldEljb24uanMiOw0KaW1wb3J0IG1peGlucyBmcm9tICIuL21peGlucy9taXhpbnMiOw0KaW1wb3J0IGxheWVyQ29udHJvbCBmcm9tICIuL3V0aWxzL2xheWVyQ29udHJvbC5qcyI7DQppbXBvcnQgQVBJIGZyb20gJ0AvY29tbW9uL2NvbmZpZy5qcyc7DQppbXBvcnQgKiBhcyB0dXJmIGZyb20gJ0B0dXJmL3R1cmYnOw0KaW1wb3J0IHsgbGVnZW5kTGlzdEltcG9ydCB9IGZyb20gIkAvY29tcG9uZW50cy94YS1tYXAvbGVnZW5kTGlzdC5qcyI7DQppbXBvcnQgeyBUb2FzdCB9IGZyb20gJ2Zhd2tlcy1tb2JpbGUtbGliJw0KY29uc3QgbWFwT2JqID0gew0KICBtYXA6IG51bGwsDQogIG1hcEluc3RhbmNlOiBudWxsDQp9DQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6Im15TWFwIiwNCiAgbWl4aW5zOlttaXhpbnNdLA0KICBwcm9wczogew0KICAgIGlmSW5zcGVjdGlvbjogew0KICAgICAgdHlwZTogQm9vbGVhbiwNCiAgICAgIGRlZmF1bHQ6IGZhbHNlDQogICAgfSwNCiAgICBpZkRldGFpbDogew0KICAgICAgdHlwZTogQm9vbGVhbiwNCiAgICAgIGRlZmF1bHQ6IGZhbHNlDQogICAgfSwNCiAgICBpbnNwQnVzaW5lc3NUeXBlOiB7DQogICAgICB0eXBlOiBTdHJpbmcsDQogICAgICBkZWZhdWx0OiAiIg0KICAgIH0sDQogICAgY3VycmVudFBvc2l0aW9uOiB7DQogICAgICB0eXBlOiBPYmplY3QsDQogICAgICBkZWZhdWx0OiAoKSA9PiB7fQ0KICAgIH0sDQogICAgdGFza0luc3BUeXBlOiB7DQogICAgICB0eXBlOiBTdHJpbmcsDQogICAgICBkZWZhdWx0OiAiIg0KICAgIH0sDQogICAgdHJpcGxlVmlzaWJsZTogew0KICAgICAgdHlwZTogQm9vbGVhbiwNCiAgICAgIGRlZmF1bHQ6IGZhbHNlDQogICAgfSwNCiAgICB0b2dnbGVOYXZpZ2F0b3I6IHsNCiAgICAgIHR5cGU6IEJvb2xlYW4sDQogICAgICBkZWZhdWx0OiBmYWxzZQ0KICAgIH0sDQogICAgbGluZU5hdmlnYXRvcjogew0KICAgICAgdHlwZTogQm9vbGVhbiwNCiAgICAgIGRlZmF1bHQ6IGZhbHNlDQogICAgfSwNCiAgICBhcmVhTmF2aWdhdG9yOiB7DQogICAgICB0eXBlOiBCb29sZWFuLA0KICAgICAgZGVmYXVsdDogZmFsc2UNCiAgICB9LA0KICAgIGxlZ2VuZENvbmZpZzogew0KICAgICAgdHlwZTogQXJyYXksDQogICAgICBkZWZhdWx0KCkgew0KICAgICAgICByZXR1cm4gW107DQogICAgICB9LA0KICAgIH0sDQogICAgbGVnZW5kTGlzdDogew0KICAgICAgdHlwZTogQXJyYXksDQogICAgICBkZWZhdWx0KCkgew0KICAgICAgICByZXR1cm4gbGVnZW5kTGlzdEltcG9ydA0KICAgICAgfQ0KICAgIH0NCiAgfSwNCiAgd2F0Y2g6IHsNCiAgICBsZWdlbmRDb25maWc6IHsNCiAgICAgIGhhbmRsZXIobmV3VmFsKSB7DQogICAgICAgIHRoaXMuY2hhbmdlTGVnZW5kKCkNCiAgICAgIH0sDQogICAgICBkZWVwOiB0cnVlDQogICAgfQ0KICB9LCAgDQogIGRhdGEoKXsNCiAgICByZXR1cm4gew0KICAgIH0NCiAgfSwNCiAgbWV0aG9kczp7DQogICAgaW5pdE1hcCgpew0KICAgICAgbGV0IG9wdGlvbnMgPSB7DQogICAgICAgIHN0eWxlOiB7DQogICAgICAgICAgdmVyc2lvbjogOCwNCiAgICAgICAgICBwaXRjaDogMCwNCiAgICAgICAgICB6b29tOiAxMy41NzA1MzIzNjA1Nzc2NTUsDQogICAgICAgICAgY2VudGVyOiBbMTE1LjkyNDg2MTAxMzY5NDI4LCAzOS4wNjA3NTU0OTU4OTA3M10sDQogICAgICAgICAgZ2x5cGhzOg0KICAgICAgICAgICAgQVBJLlZVRV9BUFBfTUFQX1VSTCArICIvbWFwYm94U291cmNlL2ZvbnRzL3tmb250c3RhY2t9L3tyYW5nZX0ucGJmIiwNCiAgICAgICAgICBzcHJpdGU6IEFQSS5WVUVfQVBQX01BUF9VUkwgKyAiL21hcGJveFNvdXJjZS9zcHJpdGVzL3Nwcml0ZSIsDQogICAgICAgICAgc291cmNlczogbGF5ZXJDb250cm9sLmRlZmF1bHRTb3VyY2UsDQogICAgICAgICAgbGF5ZXJzOiBsYXllckNvbnRyb2wuZGVmYXVsdExheWVycywNCiAgICAgICAgfQ0KICAgICAgfTsNCiAgICAgIG5ldyBtYXBJbml0KHsNCiAgICAgICAgY29udGFpbmVyOiAibXltYXAiLA0KICAgICAgICBvcHRpb25zOiB0aGlzLmlmSW5zcGVjdGlvbiA/IG9wdGlvbnMgOiB7fSwNCiAgICAgICAgY2VudGVyOiBbMTE1LjkyNDg2MTAxMzY5NDI4LCAzOS4wNjA3NTU0OTU4OTA3M10sDQogICAgICAgIGJ1czogdGhpcw0KICAgICAgfSwNCiAgICAgIGFzeW5jIChtYXBJbnN0YW5jZSkgPT4gew0KICAgICAgICBtYXBPYmoubWFwSW5zdGFuY2UgPSBtYXBJbnN0YW5jZTsNCiAgICAgICAgbWFwT2JqLm1hcCA9IG1hcEluc3RhbmNlLm1hcDsNCiAgICAgICAgd2luZG93Lm1hcCA9IG1hcEluc3RhbmNlLm1hcDsNCiAgICAgICAgd2luZG93Lm1hcEluc3RhbmNlID0gbWFwSW5zdGFuY2UNCiAgICAgICAgdGhpcy5tYXBMb2FkKG1hcEluc3RhbmNlKQ0KICAgICAgICBhZGRJbWdUb01hcChtYXBPYmoubWFwKTsNCiAgICAgICAgYXdhaXQgdGhpcy5hZGRQaXBlTGF5ZXIoKTsNCiAgICAgICAgdGhpcy5hZGRCdWZmZXJMYXllcigpOw0KICAgICAgICB0aGlzLmFkZEluc3BVc2VyTGF5ZXIoKTsNCiAgICAgICAgdGhpcy5hZGRVc2VyKCk7DQogICAgICAgIHRoaXMuaXNPbkxvYWQgPSB0cnVlOw0KICAgICAgICB0aGlzLiRlbWl0KCdtYXBMb2FkZWQnLCBtYXBJbnN0YW5jZSkNCiAgICAgICAgLy8gaWYgKCF0aGlzLmlmSW5zcGVjdGlvbikgew0KICAgICAgICAvLyAgIG1hcE9iai5tYXAub24oJ2NsaWNrJywgKGUpPT4gew0KICAgICAgICAvLyAgICAgaWYodGhpcy50b2dnbGVOYXZpZ2F0b3Ipew0KICAgICAgICAvLyAgICAgICB0aGlzLmFkZE5hdmlnYXRvclBvaW50KFtlLmxuZ0xhdC5sbmcsZS5sbmdMYXQubGF0XSk7DQogICAgICAgIC8vICAgICB9IGVsc2UgaWYodGhpcy5saW5lTmF2aWdhdG9yKXsNCiAgICAgICAgLy8gICAgICAgdGhpcy5hZGROYXZpZ2F0b3JQb2ludHNMaW5lKFtlLmxuZ0xhdC5sbmcsZS5sbmdMYXQubGF0XSk7DQogICAgICAgIC8vICAgICB9ZWxzZSBpZih0aGlzLmFyZWFOYXZpZ2F0b3Ipew0KICAgICAgICAvLyAgICAgICB0aGlzLmFkZE5hdmlnYXRvclBvaW50c0FyZWEoW2UubG5nTGF0LmxuZyxlLmxuZ0xhdC5sYXRdKTsNCiAgICAgICAgLy8gICAgIH0NCiAgICAgICAgLy8gICB9KQ0KICAgICAgICAgIC8vIG1hcE9iai5tYXAub24oJ2RibGNsaWNrJywgKGUpPT4gew0KICAgICAgICAgIC8vICAgY29uc29sZS5sb2coJ2UyIDo+PiAnLCBlKTsNCiAgICAgICAgICAvLyB9KQ0KICAgICAgICAgIC8v5a6a5L2NDQogICAgICAgICAgLy8gbGV0IHBvc2l0aW9uID0gYXdhaXQgdGhpcy5nZXRVc2VyUG9zaXRpb24oKTsNCiAgICAgICAgICAvLyB0aGlzLnNldFVzZXJQb3NpdGlvbihwb3NpdGlvbiB8fCBbMTE5LjksMzAuM10pOw0KICAgICAgICAgIC8vIHdpbmRvdy5tYXBJbml0LmZseVRvKHBvc2l0aW9uIHx8IFsxMTkuOSwzMC4zXSwxNik7DQogICAgICAgIC8vIH0NCg0KDQogICAgICAgIC8vIHRoaXMuYWRkRGV2aWNlTGF5ZXJzQ2xpY2tFdmVudCgpOw0KICAgICAgICAvLyB0aGlzLmFkZE9yZ2FuaXplck1hcmtlcih7cG9zaXRpb246WzEyMCwzMF0sZGlzdGFuY2U6IjExMSJ9KTsNCiAgICAgICAgDQogICAgICAgIC8vIOa3u+WKoOWcsOWbvueCueWHu+S6i+S7tuebkeWQrA0KICAgICAgICANCiAgICAgICAgICAvLyAvLyBsZXQgdGhhdCA9IHRoaXM7DQogICAgICAgICAgLy8gbWFwSW5zdGFuY2UubWFwLm9uKCJjbGljayIsIGZ1bmN0aW9uKGUpIHsNCiAgICAgICAgICAvLyAgIGNvbnNvbGUubG9nKGUpDQogICAgICAgICAgLy8gICBjb25zdCBmZWF0dXJlcyA9IG1hcEluc3RhbmNlLm1hcC5xdWVyeVJlbmRlcmVkRmVhdHVyZXMoZS5wb2ludCk7DQogICAgICAgICAgLy8gICBjb25zb2xlLmxvZygiZmVhdHVyZXM9PT4iLCBmZWF0dXJlcyk7DQogICAgICAgICAgICAvLyAvLyAvLyDlsIbliJ3lp4vlm77lsYLnmoRmZWF0dXJl5Yqg5YWl5Yiw5b2T5YmN566h57q/5Zu+5bGC5LitDQogICAgICAgICAgICAvLyAvLyBpZiAoZmVhdHVyZXMubGVuZ3RoID4gMCAmJiBmZWF0dXJlc1swXS5zb3VyY2UgPT0gImluaXRJbnNwTGluZVNvdXJjZSIpIHsNCiAgICAgICAgICAgIC8vIC8vICAgLy8gY29uc29sZS5sb2coImZlYXR1cmVzWzBdPT0+IiwgZmVhdHVyZXNbMF0pOw0KICAgICAgICAgICAgLy8gLy8gICB0aGF0LnNldExpbmVHZW9Tb3VyY2UoW2ZlYXR1cmVzWzBdXSwgImN1ckluc3BMaW5lU291cmNlIik7DQogICAgICAgICAgICAvLyAvLyAgIC8vIOmcgOimgeWvueWFtua3u+WKoOS4iuaKpeS6i+S7tueahOWKn+iDvQ0KICAgICAgICAgICAgLy8gLy8gfSBlbHNlIGlmIChmZWF0dXJlcy5sZW5ndGggPiAxICYmIGZlYXR1cmVzWzFdLnNvdXJjZSA9PSAiaW5pdEluc3BMaW5lU291cmNlIikgew0KICAgICAgICAgICAgLy8gLy8gICB0aGF0LnNldExpbmVHZW9Tb3VyY2UoW2ZlYXR1cmVzWzFdXSwgImN1ckluc3BMaW5lU291cmNlIik7DQogICAgICAgICAgICAvLyAvLyB9IGVsc2UgaWYgKGZlYXR1cmVzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgIC8vIC8vICAgdGhhdC5zZXRMaW5lR2VvU291cmNlKFtdLCAiY3VySW5zcExpbmVTb3VyY2UiKTsNCiAgICAgICAgICAgIC8vIC8vIH0NCiAgICAgICAgICAgIC8vIC8vIOWvueWPr+mAieS4reWbvuagh+eahOWinuWKoG1hcmtlciAgfHwgZmVhdHVyZXNbMV0uZ2VvbWV0cnkudHlwZSA9PT0gIkxpbmVTdHJpbmciDQogICAgICAgICAgICAvLyBpZiAoZmVhdHVyZXMubGVuZ3RoID4gMCANCiAgICAgICAgICAgIC8vICAgJiYgZmVhdHVyZXNbMF0uc291cmNlICE9ImV2ZW50UG9pbnRzIiANCiAgICAgICAgICAgIC8vICAgJiYgZmVhdHVyZXNbMF0uc291cmNlICE9ICJpbnNwVXNlciIgDQogICAgICAgICAgICAvLyAgICYmIGZlYXR1cmVzWzBdLnNvdXJjZSAhPSAiaW5pdEluc3BMaW5lU291cmNlIiANCiAgICAgICAgICAgIC8vICAgJiYgZmVhdHVyZXNbMF0uc291cmNlICE9ICJrZXlwb2ludHMiIA0KICAgICAgICAgICAgLy8gICAmJihmZWF0dXJlc1swXS5nZW9tZXRyeS50eXBlID09PSAiUG9pbnQiKQ0KICAgICAgICAgICAgLy8gICApIHsNCiAgICAgICAgICAgIC8vICAgdGhhdC5hZGRFdmVudE9iak1hcmtlcihmZWF0dXJlc1swXSk7DQogICAgICAgICAgICAvLyB9IGVsc2UgaWYgKGZlYXR1cmVzLmxlbmd0aCA+IDEgDQogICAgICAgICAgICAvLyAgICYmIGZlYXR1cmVzWzFdLnNvdXJjZSAhPSJldmVudFBvaW50cyIgDQogICAgICAgICAgICAvLyAgICYmIGZlYXR1cmVzWzFdLnNvdXJjZSAhPSAiaW5zcFVzZXIiIA0KICAgICAgICAgICAgLy8gICAmJiBmZWF0dXJlc1sxXS5zb3VyY2UgIT0gImtleXBvaW50cyIgDQogICAgICAgICAgICAvLyAgICYmIChmZWF0dXJlc1sxXS5nZW9tZXRyeS50eXBlID09PSAiUG9pbnQiKQ0KICAgICAgICAgICAgLy8gICApIHsNCiAgICAgICAgICAgIC8vICAgdGhhdC5hZGRFdmVudE9iak1hcmtlcihmZWF0dXJlc1sxXSk7DQogICAgICAgICAgICAvLyB9IGVsc2Ugew0KICAgICAgICAgICAgLy8gICAvLyDnp7vpmaTlhajlsYDkuovku7bngrkNCiAgICAgICAgICAgIC8vICAgdGhhdC5yZW1vdmVFdmVudE9iak1hcmtlcigpOw0KICAgICAgICAgICAgLy8gfQ0KICAgICAgICAgIC8vIH0pDQogICAgICB9KQ0KICAgIH0sDQogICAgY2hhbmdlTGVnZW5kKCkgew0KICAgICAgaWYodGhpcy5sZWdlbmRDb25maWcgJiYgdGhpcy5sZWdlbmRDb25maWcubGVuZ3RoID4gMCkgew0KICAgICAgICB0aGlzLmxlZ2VuZENvbmZpZy5mb3JFYWNoKChpdGVtKSA9PiB7DQogICAgICAgICAgdGhpcy5sZWdlbmRMaXN0LmZvckVhY2goKGxlZ2VuZCkgPT4gew0KICAgICAgICAgICAgLy/mjqfliLbkuIDnuqflm77lsYINCiAgICAgICAgICAgIGlmIChpdGVtLmxhYmVsID09IGxlZ2VuZC5sYWJlbCkgew0KICAgICAgICAgICAgICBsZWdlbmQudGl0bGVTdGF0dXMgPSBpdGVtLmNsaWNrRmxhZzsNCiAgICAgICAgICAgICAgLy8gDQogICAgICAgICAgICAgIGxlZ2VuZC5vcHRpb25zLmZvckVhY2goKHNtYWxsSXRlbSkgPT4gew0KICAgICAgICAgICAgICAgIC8vIOW9k+ivpeagh+mimOS4i+WbvuWxguWGheWuueS4uuaYvuekuueKtuaAgeaXtuaJjei/m+WFpeWIpOaWrQ0KICAgICAgICAgICAgICAgIGlmICgNCiAgICAgICAgICAgICAgICAgIGxlZ2VuZC50aXRsZVN0YXR1cyA9PT0gdHJ1ZSAmJg0KICAgICAgICAgICAgICAgICAgdHlwZW9mIHNtYWxsSXRlbS5pZCA9PSAibnVtYmVyIg0KICAgICAgICAgICAgICAgICkgew0KICAgICAgICAgICAgICAgICAgVG9hc3QuYWxsb3dNdWx0aXBsZSgpOw0KICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgICAgICAgICAgICAgIFRvYXN0KHsNCiAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBzbWFsbEl0ZW0ubGFiZWwgKyAi5Zu+5bGC5pqC5peg5pWw5o2u77yBIiwNCiAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogJ3RvcCcNCiAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICB9LCAwKTsNCiAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKGxlZ2VuZC50aXRsZVN0YXR1cyA9PT0gdHJ1ZSkgew0KICAgICAgICAgICAgICAgICAgLy8g5qCH6aKY54q25oCB54K55Lqu5pe2DQogICAgICAgICAgICAgICAgICBzbWFsbEl0ZW0uY2xpY2tGbGFnID0gZmFsc2U7IC8vIOWbvuWxguWdh+aYvuekug0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICBzbWFsbEl0ZW0uY2xpY2tGbGFnID0gdHJ1ZTsgLy8g5Zu+5bGC5Z2H6ZqQ6JePDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHRoaXMubGVnZW5kQ29udHJvbExheWVyKHNtYWxsSXRlbSk7DQogICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgfWVsc2Ugew0KICAgICAgICAgICAgICBsZWdlbmQub3B0aW9ucy5mb3JFYWNoKHNtYWxsSXRlbSA9PiB7DQogICAgICAgICAgICAgICAgaWYoaXRlbS5sYWJlbCA9PSBzbWFsbEl0ZW0ubGFiZWwpIHsNCiAgICAgICAgICAgICAgICAgIHRoaXMuJHNldChzbWFsbEl0ZW0sICdjbGlja0ZsYWcnLCBpdGVtLmNsaWNrRmxhZykNCiAgICAgICAgICAgICAgICAgIHRoaXMubGVnZW5kQ29udHJvbExheWVyKHNtYWxsSXRlbSkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgIH0pDQogICAgICAgICAgICB9DQogICAgICAgICAgICANCiAgICAgICAgICB9KTsNCiAgICAgICAgfSk7DQogICAgICB9DQogICAgfSwNCiAgICBsZWdlbmRDb250cm9sTGF5ZXIoaXRlbSkgew0KICAgICAgbGV0IHRpbWVyID0gc2V0SW50ZXJ2YWwoKCkgPT4gew0KICAgICAgICBpZiAodGhpcy5pc09uTG9hZGVkICYmIHdpbmRvdy5tYXApIHsNCiAgICAgICAgICBjbGVhckludGVydmFsKHRpbWVyKQ0KICAgICAgICAgIGxldCBtYXAgPSB3aW5kb3cubWFwDQogICAgICAgICAgaWYgKG1hcC5nZXRMYXllcihpdGVtLmlkKSkgew0KICAgICAgICAgICAgaWYgKGl0ZW0uY2xpY2tGbGFnKSB7DQogICAgICAgICAgICAgIG1hcC5zZXRMYXlvdXRQcm9wZXJ0eShpdGVtLmlkLCAidmlzaWJpbGl0eSIsICJub25lIik7DQogICAgICAgICAgICAgIGlmIChpdGVtLmlkID09ICJyZF9tYXBfZHJhaW5waXBlX3lzX2JpZyIpIHsNCiAgICAgICAgICAgICAgICBsZXQgZmlsdGVyID0gbWFwLmdldEZpbHRlcigicmRfbWFwX21hbmhvbGUiKQ0KICAgICAgICAgICAgICAgIGlmKGZpbHRlci50b1N0cmluZygpID09IFsnYWxsJ10udG9TdHJpbmcoKSB8fCBmaWx0ZXIudG9TdHJpbmcoKSA9PSBbJ2luJywgJ21hbmhvbGVfdHlwZScsICfpm6jmsLQnXS50b1N0cmluZygpKXsNCiAgICAgICAgICAgICAgICAgIGlmKG1hcC5nZXRMYXlvdXRQcm9wZXJ0eSgncmRfbWFwX2RyYWlucGlwZV93c19iaWcnLCAndmlzaWJpbGl0eScpID09ICdub25lJyl7DQogICAgICAgICAgICAgICAgICAgIGZpbHRlciA9IFsnaW4nLCAnbWFuaG9sZV90eXBlJywgJyddDQogICAgICAgICAgICAgICAgICB9ZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIGZpbHRlciA9IFsnaW4nLCAnbWFuaG9sZV90eXBlJywgJ+axoeawtCddDQogICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIC8v6Zuo5rC0566h57q/5Zu+5bGC5o6n5Yi26Zuo5rC05LqV44CB6Zuo5rC0566t5aS044CB6Zuo5rC06L6D5bCP5bGC57qn5Zu+5bGC5pi+56S6DQogICAgICAgICAgICAgICAgbWFwLnNldExheW91dFByb3BlcnR5KCJyZF9tYXBfY29tYiIsICJ2aXNpYmlsaXR5IiwgIm5vbmUiKTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBtYXAuc2V0RmlsdGVyKCJyZF9tYXBfbWFuaG9sZSIsIGZpbHRlcik7DQogICAgICAgICAgICAgICAgbWFwLnNldExheW91dFByb3BlcnR5KA0KICAgICAgICAgICAgICAgICAgInJkX21hcF9kcmFpbnBpcGVfeXNfYmlnX2RpcmVjdGlvbiIsDQogICAgICAgICAgICAgICAgICAidmlzaWJpbGl0eSIsDQogICAgICAgICAgICAgICAgICAibm9uZSINCiAgICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgICAgIG1hcC5zZXRMYXlvdXRQcm9wZXJ0eSgNCiAgICAgICAgICAgICAgICAgICJyZF9tYXBfZHJhaW5waXBlX3lzX3NtYWxsIiwNCiAgICAgICAgICAgICAgICAgICJ2aXNpYmlsaXR5IiwNCiAgICAgICAgICAgICAgICAgICJub25lIg0KICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgICAgbWFwLnNldExheW91dFByb3BlcnR5KA0KICAgICAgICAgICAgICAgICAgInJkX21hcF9kcmFpbnBpcGVfeXNfc21hbGxfZGlyZWN0aW9uIiwNCiAgICAgICAgICAgICAgICAgICJ2aXNpYmlsaXR5IiwNCiAgICAgICAgICAgICAgICAgICJub25lIg0KICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgIH0gZWxzZSBpZiAoaXRlbS5pZCA9PSAibWFwX3N1cHBseV9waXBlX2NpcmN1bGF0aW5nIikgew0KICAgICAgICAgICAgICAgIC8v5b6q546v5rC077yI5Zue5rC077yJ566h57q/5o6n5Yi25b6q546v5rC077yI5Zue5rC077yJ6IqC54K55pi+56S6DQogICAgICAgICAgICAgICAgbWFwLnNldExheW91dFByb3BlcnR5KA0KICAgICAgICAgICAgICAgICAgIm1hcF9zdXBwbHlfbm9kZV9jaXJjdWxhdGluZyIsDQogICAgICAgICAgICAgICAgICAidmlzaWJpbGl0eSIsDQogICAgICAgICAgICAgICAgICAibm9uZSINCiAgICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgICB9IGVsc2UgaWYgKGl0ZW0uaWQgPT0gIm1hcF9zdXBwbHlfcGlwZV9kaXN0cmlidXRlIikgew0KICAgICAgICAgICAgICAgIC8v6YWN5rC0566h57q/5o6n5Yi26YWN5rC06IqC54K55pi+56S6DQogICAgICAgICAgICAgICAgbWFwLnNldExheW91dFByb3BlcnR5KA0KICAgICAgICAgICAgICAgICAgIm1hcF9zdXBwbHlfbm9kZV9kaXN0cmlidXRlIiwNCiAgICAgICAgICAgICAgICAgICJ2aXNpYmlsaXR5IiwNCiAgICAgICAgICAgICAgICAgICJub25lIg0KICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgIH0gZWxzZSBpZiAoaXRlbS5pZCA9PSAibWFwX3N1cHBseV9waXBlX2RlbGl2ZXJ5Iikgew0KICAgICAgICAgICAgICAgIC8v6L6T5rC0566h57q/5o6n5Yi26L6T5rC06IqC54K55pi+56S6DQogICAgICAgICAgICAgICAgbWFwLnNldExheW91dFByb3BlcnR5KA0KICAgICAgICAgICAgICAgICAgIm1hcF9zdXBwbHlfbm9kZV9kZWxpdmVyeSIsDQogICAgICAgICAgICAgICAgICAidmlzaWJpbGl0eSIsDQogICAgICAgICAgICAgICAgICAibm9uZSINCiAgICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgICB9IGVsc2UgaWYgKGl0ZW0uaWQgPT0gIm1hcF9yZWN5Y2xlX3BpcGUiKSB7DQogICAgICAgICAgICAgICAgLy/lho3nlJ/msLTnrqHnur/mjqfliLblho3nlJ/msLToioLngrnmmL7npLoNCiAgICAgICAgICAgICAgICBtYXAuc2V0TGF5b3V0UHJvcGVydHkoDQogICAgICAgICAgICAgICAgICAibWFwX3JlY3ljbGVfbm9kZSIsDQogICAgICAgICAgICAgICAgICAidmlzaWJpbGl0eSIsDQogICAgICAgICAgICAgICAgICAibm9uZSINCiAgICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgICB9IGVsc2UgaWYgKGl0ZW0uaWQgPT0gInJkX21hcF9kcmFpbnBpcGVfd3NfYmlnIikgew0KICAgICAgICAgICAgICAgIC8v5rGh5rC0566h57q/5Zu+5bGC5o6n5Yi25rGh5rC05LqV44CB5rGh5rC0566t5aS044CB5rGh5rC06L6D5bCP5bGC57qn5Zu+5bGC5pi+56S6DQogICAgICAgICAgICAgICAgbGV0IGZpbHRlciA9IG1hcC5nZXRGaWx0ZXIoInJkX21hcF9tYW5ob2xlIikNCiAgICAgICAgICAgICAgICBpZihmaWx0ZXIudG9TdHJpbmcoKSA9PSBbJ2FsbCddLnRvU3RyaW5nKCkgfHwgZmlsdGVyLnRvU3RyaW5nKCkgPT0gWydpbicsICdtYW5ob2xlX3R5cGUnLCAn5rGh5rC0J10udG9TdHJpbmcoKSl7DQogICAgICAgICAgICAgICAgICBpZihtYXAuZ2V0TGF5b3V0UHJvcGVydHkoJ3JkX21hcF9kcmFpbnBpcGVfeXNfYmlnJywgJ3Zpc2liaWxpdHknKSA9PSAnbm9uZScpew0KICAgICAgICAgICAgICAgICAgICBmaWx0ZXIgPSBbJ2luJywgJ21hbmhvbGVfdHlwZScsICcnXQ0KICAgICAgICAgICAgICAgICAgfWVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBmaWx0ZXIgPSBbJ2luJywgJ21hbmhvbGVfdHlwZScsICfpm6jmsLQnXQ0KICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0gICAgICAgICAgICANCiAgICAgICAgICAgICAgICBtYXAuc2V0RmlsdGVyKCJyZF9tYXBfbWFuaG9sZSIsIGZpbHRlcik7DQogICAgICAgICAgICAgICAgbWFwLnNldExheW91dFByb3BlcnR5KA0KICAgICAgICAgICAgICAgICAgInJkX21hcF9kcmFpbnBpcGVfd3NfYmlnX2RpcmVjdGlvbiIsDQogICAgICAgICAgICAgICAgICAidmlzaWJpbGl0eSIsDQogICAgICAgICAgICAgICAgICAibm9uZSINCiAgICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgICAgIG1hcC5zZXRMYXlvdXRQcm9wZXJ0eSgNCiAgICAgICAgICAgICAgICAgICJyZF9tYXBfZHJhaW5waXBlX3dzX3NtYWxsIiwNCiAgICAgICAgICAgICAgICAgICJ2aXNpYmlsaXR5IiwNCiAgICAgICAgICAgICAgICAgICJub25lIg0KICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgICAgbWFwLnNldExheW91dFByb3BlcnR5KA0KICAgICAgICAgICAgICAgICAgInJkX21hcF9kcmFpbnBpcGVfd3Nfc21hbGxfZGlyZWN0aW9uIiwNCiAgICAgICAgICAgICAgICAgICJ2aXNpYmlsaXR5IiwNCiAgICAgICAgICAgICAgICAgICJub25lIg0KICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0gZWxzZSB7ICAgICAgICAgIA0KICAgICAgICAgICAgICBtYXAuc2V0TGF5b3V0UHJvcGVydHkoaXRlbS5pZCwgInZpc2liaWxpdHkiLCAidmlzaWJsZSIpOw0KICAgICAgICAgICAgICBpZiAoaXRlbS5pZCA9PSAicmRfbWFwX2RyYWlucGlwZV95c19iaWciKSB7DQogICAgICAgICAgICAgICAgbGV0IGZpbHRlciA9IG1hcC5nZXRGaWx0ZXIoInJkX21hcF9tYW5ob2xlIikNCiAgICAgICAgICAgICAgICBpZihmaWx0ZXIudG9TdHJpbmcoKSA9PSBbJ2luJywgJ21hbmhvbGVfdHlwZScsICcnXS50b1N0cmluZygpIHx8IGZpbHRlci50b1N0cmluZygpID09IFsnaW4nLCAnbWFuaG9sZV90eXBlJywgJ+axoeawtCddLnRvU3RyaW5nKCkpew0KICAgICAgICAgICAgICAgICAgaWYobWFwLmdldExheW91dFByb3BlcnR5KCdyZF9tYXBfZHJhaW5waXBlX3dzX2JpZycsICd2aXNpYmlsaXR5JykgIT0gJ25vbmUnKXsNCiAgICAgICAgICAgICAgICAgICAgZmlsdGVyID0gWydhbGwnXQ0KICAgICAgICAgICAgICAgICAgfWVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBmaWx0ZXIgPSBbJ2luJywgJ21hbmhvbGVfdHlwZScsICfpm6jmsLQnXQ0KICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBtYXAuc2V0RmlsdGVyKCJyZF9tYXBfbWFuaG9sZSIsIGZpbHRlcik7DQogICAgICAgICAgICAgICAgbWFwLnNldExheW91dFByb3BlcnR5KA0KICAgICAgICAgICAgICAgICAgInJkX21hcF9jb21iIiwNCiAgICAgICAgICAgICAgICAgICJ2aXNpYmlsaXR5IiwNCiAgICAgICAgICAgICAgICAgICJ2aXNpYmxlIg0KICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgICAgbWFwLnNldExheW91dFByb3BlcnR5KA0KICAgICAgICAgICAgICAgICAgInJkX21hcF9kcmFpbnBpcGVfeXNfYmlnX2RpcmVjdGlvbiIsDQogICAgICAgICAgICAgICAgICAidmlzaWJpbGl0eSIsDQogICAgICAgICAgICAgICAgICAidmlzaWJsZSINCiAgICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgICAgIG1hcC5zZXRMYXlvdXRQcm9wZXJ0eSgNCiAgICAgICAgICAgICAgICAgICJyZF9tYXBfZHJhaW5waXBlX3lzX3NtYWxsIiwNCiAgICAgICAgICAgICAgICAgICJ2aXNpYmlsaXR5IiwNCiAgICAgICAgICAgICAgICAgICJ2aXNpYmxlIg0KICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgICAgbWFwLnNldExheW91dFByb3BlcnR5KA0KICAgICAgICAgICAgICAgICAgInJkX21hcF9kcmFpbnBpcGVfeXNfc21hbGxfZGlyZWN0aW9uIiwNCiAgICAgICAgICAgICAgICAgICJ2aXNpYmlsaXR5IiwNCiAgICAgICAgICAgICAgICAgICJ2aXNpYmxlIg0KICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgIH0gZWxzZSBpZiAoaXRlbS5pZCA9PSAibWFwX3N1cHBseV9waXBlX2NpcmN1bGF0aW5nIikgew0KICAgICAgICAgICAgICAgIG1hcC5zZXRMYXlvdXRQcm9wZXJ0eSgNCiAgICAgICAgICAgICAgICAgICJtYXBfc3VwcGx5X25vZGVfY2lyY3VsYXRpbmciLA0KICAgICAgICAgICAgICAgICAgInZpc2liaWxpdHkiLA0KICAgICAgICAgICAgICAgICAgInZpc2libGUiDQogICAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgICAgfSBlbHNlIGlmIChpdGVtLmlkID09ICJtYXBfc3VwcGx5X3BpcGVfZGlzdHJpYnV0ZSIpIHsNCiAgICAgICAgICAgICAgICBtYXAuc2V0TGF5b3V0UHJvcGVydHkoDQogICAgICAgICAgICAgICAgICAibWFwX3N1cHBseV9ub2RlX2Rpc3RyaWJ1dGUiLA0KICAgICAgICAgICAgICAgICAgInZpc2liaWxpdHkiLA0KICAgICAgICAgICAgICAgICAgInZpc2libGUiDQogICAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgICAgfSBlbHNlIGlmIChpdGVtLmlkID09ICJtYXBfc3VwcGx5X3BpcGVfZGVsaXZlcnkiKSB7DQogICAgICAgICAgICAgICAgbWFwLnNldExheW91dFByb3BlcnR5KA0KICAgICAgICAgICAgICAgICAgIm1hcF9zdXBwbHlfbm9kZV9kZWxpdmVyeSIsDQogICAgICAgICAgICAgICAgICAidmlzaWJpbGl0eSIsDQogICAgICAgICAgICAgICAgICAidmlzaWJsZSINCiAgICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgICB9IGVsc2UgaWYgKGl0ZW0uaWQgPT0gIm1hcF9yZWN5Y2xlX3BpcGUiKSB7DQogICAgICAgICAgICAgICAgbWFwLnNldExheW91dFByb3BlcnR5KA0KICAgICAgICAgICAgICAgICAgIm1hcF9yZWN5Y2xlX25vZGUiLA0KICAgICAgICAgICAgICAgICAgInZpc2liaWxpdHkiLA0KICAgICAgICAgICAgICAgICAgInZpc2libGUiDQogICAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgICAgfSBlbHNlIGlmIChpdGVtLmlkID09ICJyZF9tYXBfZHJhaW5waXBlX3dzX2JpZyIpIHsNCiAgICAgICAgICAgICAgICBsZXQgZmlsdGVyID0gbWFwLmdldEZpbHRlcigicmRfbWFwX21hbmhvbGUiKQ0KICAgICAgICAgICAgICAgIGlmKGZpbHRlci50b1N0cmluZygpID09IFsnaW4nLCAnbWFuaG9sZV90eXBlJywgJyddLnRvU3RyaW5nKCkgfHwgZmlsdGVyLnRvU3RyaW5nKCkgPT0gWydpbicsICdtYW5ob2xlX3R5cGUnLCAn6Zuo5rC0J10udG9TdHJpbmcoKSl7DQogICAgICAgICAgICAgICAgICBpZihtYXAuZ2V0TGF5b3V0UHJvcGVydHkoJ3JkX21hcF9kcmFpbnBpcGVfeXNfYmlnJywgJ3Zpc2liaWxpdHknKSAhPSAnbm9uZScpew0KICAgICAgICAgICAgICAgICAgICBmaWx0ZXIgPSBbJ2FsbCddDQogICAgICAgICAgICAgICAgICB9ZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIGZpbHRlciA9IFsnaW4nLCAnbWFuaG9sZV90eXBlJywgJ+axoeawtCddDQogICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIG1hcC5zZXRMYXlvdXRQcm9wZXJ0eSgNCiAgICAgICAgICAgICAgICAgICJyZF9tYXBfZHJhaW5waXBlX3dzX2JpZ19kaXJlY3Rpb24iLA0KICAgICAgICAgICAgICAgICAgInZpc2liaWxpdHkiLA0KICAgICAgICAgICAgICAgICAgInZpc2libGUiDQogICAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgICAgICBtYXAuc2V0RmlsdGVyKCJyZF9tYXBfbWFuaG9sZSIsIGZpbHRlcik7DQogICAgICAgICAgICAgICAgbWFwLnNldExheW91dFByb3BlcnR5KA0KICAgICAgICAgICAgICAgICAgInJkX21hcF9tYW5ob2xlIiwNCiAgICAgICAgICAgICAgICAgICJ2aXNpYmlsaXR5IiwNCiAgICAgICAgICAgICAgICAgICJ2aXNpYmxlIg0KICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgICAgbWFwLnNldExheW91dFByb3BlcnR5KA0KICAgICAgICAgICAgICAgICAgInJkX21hcF9kcmFpbnBpcGVfd3Nfc21hbGxfZGlyZWN0aW9uIiwNCiAgICAgICAgICAgICAgICAgICJ2aXNpYmlsaXR5IiwNCiAgICAgICAgICAgICAgICAgICJ2aXNpYmxlIg0KICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgICAgbWFwLnNldExheW91dFByb3BlcnR5KA0KICAgICAgICAgICAgICAgICAgInJkX21hcF9kcmFpbnBpcGVfd3Nfc21hbGwiLA0KICAgICAgICAgICAgICAgICAgInZpc2liaWxpdHkiLA0KICAgICAgICAgICAgICAgICAgInZpc2libGUiDQogICAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgfSwgNTAwKQ0KICAgIH0sDQogICAgICAvLyDliqDovb3lrp7ml7blm77lsYLliIfniYcNCiAgICBsb2FkTWFwTGF5ZXIodHlwZSkgew0KICAgICAgY29uc29sZS5sb2coJ3R5cGUgOj4+ICcsIHR5cGUpOw0KICAgICAgICB0aGlzLmlzT25Mb2FkID0gdHJ1ZTsNCiAgICAgICAgbGV0IGluc3BUeXBlID0gJ+axoeawtCc7DQogICAgICAvLyBsZXQgaW5zcFR5cGUgPSB0eXBlID09PSAiUE9MTFVURURfV0FURVIiID8gJ+axoeawtCcgOiB0eXBlID09PSAiUkFJX1dBVEVSIiA/ICfpm6jmsLQnIDogJ+S+m+awtCc7DQogICAgICBtYXBPYmoubWFwSW5zdGFuY2UuYWRkVGltZXJTb3VyY2UoKTsNCiAgICAgIHRoaXMuc3dMYXllcltpbnNwVHlwZV0gPSBtYXBPYmoubWFwSW5zdGFuY2UuYWRkVGltZXJMYXllcihpbnNwVHlwZSk7DQogICAgICAgIC8vIHRoaXMuc3dMYXllclsn5rGh5rC0J10gPSBtYXBPYmoubWFwSW5zdGFuY2UuYWRkVGltZXJMYXllcihpbnNwVHlwZSk7DQogICAgfSwNCiAgICAgIC8vIOWKoOi9veWunuaXtuWbvuWxguWIh+eJhw0KICAgIGxvYWRNYXBMYXllckluc3AodHlwZSkgew0KICAgICAgbGV0IGluc3BUeXBlID0gdHlwZSA9PT0gIlBPTExVVEVEX1dBVEVSIiA/ICfmsaHmsLQnIDogdHlwZSA9PT0gIlJBSV9XQVRFUiIgPyAn6Zuo5rC0JyA6ICfkvpvmsLQnOw0KICAgICAgbWFwT2JqLm1hcEluc3RhbmNlLmFkZFRpbWVyU291cmNlKCk7DQogICAgICB0aGlzLnN3TGF5ZXJbaW5zcFR5cGVdID0gbWFwT2JqLm1hcEluc3RhbmNlLmFkZFRpbWVyTGF5ZXIoaW5zcFR5cGUpOw0KICAgIH0sDQogICAgLy8g5re75Yqg5beh5qOA6IyD5Zu0DQogICAgYWRkUmFuZ2VMaXN0KHJhbmdlTGlzdCkgew0KICAgICAgLy8gcmFuZ2Vz5Li6UG9seWdvbuexu+Wei+eahOiMg+WbtO+8jGVtZU1hcmtlcnPkuLrlupTmgKXku7vliqHnmoRtYXJrZXINCiAgICAgIGxldCByYW5nZXMgPSBbXTsNCiAgICAgIHJhbmdlTGlzdC5mb3JFYWNoKChyYW5nZSwgaWR4KSA9PiB7DQogICAgICAgIGlmIChyYW5nZS5ncmlkR2VvbSkgew0KICAgICAgICAgIGxldCBnZW9tID0gSlNPTi5wYXJzZShyYW5nZS5ncmlkR2VvbSk7DQogICAgICAgICAgaWYgKGdlb20udHlwZSA9PT0gIlBvbHlnb24iKSB7DQogICAgICAgICAgICByYW5nZXMucHVzaChnZW9tKTsNCiAgICAgICAgICAgIC8vIHRoaXMuYWRkUmFuZ2VMYXllcihnZW9tLCBpZHgpDQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICB9KTsNCiAgICAgIHRyeSB7DQogICAgICAgIGlmIChyYW5nZXMubGVuZ3RoID4gMCkgew0KICAgICAgICAgIGxldCBmZWF0dXJlID0gcmFuZ2VzWzBdOw0KICAgICAgICAgIGxldCBwb2x5Z29uID0gdHVyZi5wb2x5Z29uKGZlYXR1cmUuY29vcmRpbmF0ZXMpDQogICAgICAgICAgbGV0IGJib3ggPSB0dXJmLmJib3goew0KICAgICAgICAgICAgdHlwZToiRmVhdHVyZUNvbGxlY3Rpb24iLA0KICAgICAgICAgICAgZmVhdHVyZXM6IFtwb2x5Z29uXQ0KICAgICAgICAgIH0pOw0KICAgICAgICAgIG1hcE9iai5tYXAuZml0Qm91bmRzKGJib3gsIHsNCiAgICAgICAgICAgIHBhZGRpbmc6IHt0b3A6IDEwLCBib3R0b206MjUsIGxlZnQ6IDE1LCByaWdodDogNX0NCiAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIGNvbnN0IHRoYXQgPSB0aGlzOw0KICAgICAgICAvLyB2YXIgdGltZXIgPSBzZXRJbnRlcnZhbChmdW5jdGlvbigpIHsNCiAgICAgICAgLy8gICBpZiAodGhhdC5pc09uTG9hZGVkKCkgJiYgdGhhdC5tYXAuZ2V0U291cmNlKCJyYW5nZVNvdXJjZSIpKSB7DQogICAgICAgIC8vICAgICBjbGVhckludGVydmFsKHRpbWVyKTsNCiAgICAgICAgLy8gICAgIHRoYXQuc2V0UmFuZ2VMYXllcihyYW5nZXMsIGlmRW1lcmdlbmN5KTsNCiAgICAgICAgLy8gICB9DQogICAgICAgIC8vIH0sIDUwMCk7DQogICAgICB9IGNhdGNoIChlKSB7DQogICAgICAgIGNvbnNvbGUubG9nKGUpOw0KICAgICAgfQ0KDQogICAgICAvLyBpZiAoaWZFbWVyZ2VuY3kpIHsNCiAgICAgIC8vICAgZW1lTWFya2Vycy5mb3JFYWNoKGVtZSA9PiB7DQogICAgICAvLyAgICAgdGhpcy5hZGRJbnNwRW1lTWFya2VyKGVtZSwgaWZEZXRhaWwpOw0KICAgICAgLy8gICAgIC8vIHRoaXMuYWRkSW5zcEV2ZW50TWFya2VyKGVtZSk7DQogICAgICAvLyAgIH0pDQogICAgICAvLyB9DQogICAgfSwNCiAgICAvLyDmt7vliqDlhbPplK7ngrltYXJrZXINCiAgICBhZGRLZXlQb2ludHMoa2V5UG9pbnRMaXN0KSB7DQogICAgICAvLyDmuIXnqbrkuIrmrKHnmoTmlbDmja4NCiAgICAgIHRoaXMuc2V0S2V5UG9pbnRMYXllcihbXSk7DQogICAgICBjb25zdCBmZWF0dXJlcyA9IGtleVBvaW50TGlzdC5tYXAoa2V5UG9pbnQgPT4gew0KICAgICAgICAvLyBpZiAoa2V5UG9pbnQuZGV2aWNlVHlwZSAhPSAn566h57q/Jykgew0KICAgICAgICAgIGxldCBwb2ludCA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoa2V5UG9pbnQpKTsNCiAgICAgICAgICBwb2ludC5nZW9tID0gSlNPTi5wYXJzZShwb2ludC5nZW9tKTsNCiAgICAgICAgICAvKg0KICAgICAgICAgICAg5Yqg6L295YWz6ZSu54K555qE5pe25YCZ77yM5aaC5p6c5bey57uP5LiK5oql5YWz6ZSu54K555qE5beh5qOA57uT5p6c5bm2562+5Yiw77yM5LiU5q2j5bi477yM5pi+56S65Li657u/6Imy77yM5byC5bi45pi+56S65Li657qi6Imy77yM5pyq5beh5qOA5pi+56S65Li65q2j5bi4aWNvbu+8jOW3sumAgOWbnuaYvuekuuS4uuapmeiJsg0KICAgICAgICAgICovDQogICAgICAgICAgbGV0IGlzR3JlZW4gPSBmYWxzZTsNCiAgICAgICAgICBsZXQgaXNSZWQgPSBmYWxzZQ0KICAgICAgICAgIGxldCBpc0JsdWUgPSBmYWxzZQ0KICAgICAgICAgIGxldCBpc09yYW5nZSA9IGZhbHNlIC8vIOW3sumAgOWbng0KICAgICAgICAgIGlmIChwb2ludC5leHQyID09ICIzIikgeyAvLyDlt6Hmo4DorrDlvZXnmoRleHQy5a2X5q6177yM6buY6K6k5Li6Me+8iOW+heWkjeaguO+8ie+8jOW3sumAmui/h+S4ujLvvIzlt7LpgIDlm57kuLozDQogICAgICAgICAgICBpc09yYW5nZSA9IHRydWUNCiAgICAgICAgICB9IGVsc2UgaWYgKHBvaW50LmRldmljZVN0YXR1cyA9PSAnMCcpIHsgLy8g5YWz6ZSu54K55beh5qOA5q2j5bi4DQogICAgICAgICAgICBpc0dyZWVuID0gdHJ1ZTsNCiAgICAgICAgICB9IGVsc2UgaWYgKHBvaW50LmRldmljZVN0YXR1cyA9PSAnMScpIHsNCiAgICAgICAgICAgIGlzUmVkID0gdHJ1ZQ0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBpc0JsdWUgPSB0cnVlDQogICAgICAgICAgfQ0KICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICB0eXBlOiAnRmVhdHVyZScsDQogICAgICAgICAgICBpZDogcG9pbnQuaWQsDQogICAgICAgICAgICBnZW9tZXRyeTogcG9pbnQuZ2VvbSwNCiAgICAgICAgICAgIHByb3BlcnRpZXM6IHsNCiAgICAgICAgICAgICAgaWQ6IHBvaW50LmlkLA0KICAgICAgICAgICAgICBmZWF0dXJlOiBwb2ludCwNCiAgICAgICAgICAgICAgaXNPcmFuZ2U6IGlzT3JhbmdlLC8vIOW3sumAgOWbng0KICAgICAgICAgICAgICBpc0dyZWVuOiBpc0dyZWVuLA0KICAgICAgICAgICAgICBpc1JlZDogaXNSZWQsDQogICAgICAgICAgICAgIGlzQmx1ZTogaXNCbHVlDQogICAgICAgICAgICB9DQogICAgICAgICAgfQ0KICAgICAgICAvLyB9DQogICAgICB9KTsNCiAgICAgIC8vIOiuvue9ruWFs+mUrueCueaVsOaNrg0KICAgICAgdGhpcy5zZXRLZXlQb2ludExheWVyKGZlYXR1cmVzKTsNCiAgICB9LA0KICAgIC8vIOWkmuS7u+WKoea3u+WKoOWFs+mUrueCuW1hcmtlcg0KICAgIGFkZEtleVBvaW50c0luTXVsVGFzayhrZXlQb2ludExpc3QpIHsNCiAgICAgIC8vIOWvuemHjeWkjeWFs+mUrueCuei/m+ihjOi/h+a7pA0KICAgICAgbGV0IGtleVBvaW50RGF0YSA9IFtdOw0KICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBrZXlQb2ludExpc3QubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgbGV0IGVsZW1lbnQgPUpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoa2V5UG9pbnRMaXN0W2ldKSk7DQogICAgICAgIGxldCBmaWx0ZXJEYXRhID0ga2V5UG9pbnRMaXN0LmZpbHRlcih4ID0+IHguZW5nSW5mb0RUTy5lbmdJZCA9PT0gZWxlbWVudC5lbmdJbmZvRFRPLmVuZ0lkKTsNCiAgICAgICAga2V5UG9pbnRMaXN0ID0ga2V5UG9pbnRMaXN0LmZpbHRlcih4ID0+IGZpbHRlckRhdGEuZXZlcnkoIHk9PiB4LmVuZ0luZm9EVE8uZW5nSWQgIT09IHkuZW5nSW5mb0RUTy5lbmdJZCkpOw0KICAgICAgICAvLyBlbGVtZW50LmV2ZW50VHlwZSA9ICcnOw0KICAgICAgICAvLyBmaWx0ZXJEYXRhLmZvckVhY2goaXQgPT4gew0KICAgICAgICAvLyAgIGVsZW1lbnQuZXZlbnRUeXBlICs9IGl0LmV2ZW50VHlwZSArICcgJw0KICAgICAgICAvLyB9KQ0KICAgICAgICBrZXlQb2ludERhdGEucHVzaChlbGVtZW50KTsNCiAgICAgIH0NCiAgICAgIGtleVBvaW50RGF0YS5mb3JFYWNoKGtleVBvaW50ID0+IHsNCiAgICAgICAgaWYgKGtleVBvaW50LmVuZ0luZm9EVE8gJiYga2V5UG9pbnQuZW5nSW5mb0RUTy5lbmdHZW9tKSB7DQogICAgICAgICAgbGV0IHBvaW50ID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShrZXlQb2ludC5lbmdJbmZvRFRPKSk7DQogICAgICAgICAgcG9pbnQuZW5nR2VvbSA9IEpTT04ucGFyc2UocG9pbnQuZW5nR2VvbSk7DQogICAgICAgICAgdGhpcy5hZGRLZXlQb2ludE1hcmtlcihwb2ludCwgaWZEZXRhaWwpOw0KICAgICAgICAgIGxldCB0YXNrRGV0YWlsID0ga2V5UG9pbnQuaW5zcGVjdGlvblRhc2tEZXRhaWxEVE8uaW5zcGVjdGlvblRhc2tEZXRhaWw7DQogICAgICAgICAgLyoNCiAgICAgICAgICAgIOWKoOi9veWFs+mUrueCueeahOaXtuWAme+8jOWmguaenOW3sue7j+S4iuaKpeWFs+mUrueCueeahOW3oeajgOe7k+aenOW5tuetvuWIsO+8jOS4lOacquiiq+mAgOWbnu+8iOW+heWkjeaguO+8ie+8jOaYvuekuuS4uue7v+iJsg0KICAgICAgICAgICovDQogICAgICAgICAgaWYgKHRhc2tEZXRhaWwuaW5zcEl0ZW1SZXN1bHQgJiYgdGFza0RldGFpbC5pc0NvbXBsZXRlID09IDEgJiYgdGFza0RldGFpbC5pbnNwSXRlbVJldmlldyAhPSAzKSB7DQogICAgICAgICAgICB0aGlzLmNoYW5nZUtleVBvaW50TWFya2VyKHBvaW50LmVuZ0lkLCB0cnVlKTsNCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgIH0pDQogICAgfSwNCiAgICAvLyDnp7vpmaTlupTmgKXlt6Hmo4BtYXJrZXINCiAgICByZW1vdmVJbnNwRW1lTWFya2VycyhyYW5nZUxpc3QpIHsNCiAgICAgIGxldCBlbWVNYXJrZXJzID0gW107DQogICAgICByYW5nZUxpc3QuZm9yRWFjaChyYW5nZSA9PiB7DQogICAgICAgIGlmIChyYW5nZS50YXNrUmFuZ2VyR2VvbSkgew0KICAgICAgICAgIGxldCBnZW9tID0gSlNPTi5wYXJzZShyYW5nZS50YXNrUmFuZ2VyR2VvbSk7DQogICAgICAgICAgLy8g5aaC5p6c5piv5bqU5oCl5Lu75Yqh77yM5YiZ6ZyA6KaB5re75YqgbWFya2VyDQogICAgICAgICAgZW1lTWFya2Vycy5wdXNoKGdlb20uaWQpOw0KICAgICAgICB9DQogICAgICB9KTsNCiAgICAgIGlmIChlbWVNYXJrZXJzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgdGhpcy5yZW1vdmVJbnNwRW1lTWFya2VyKGVtZU1hcmtlcnMpDQogICAgICB9DQogICAgfQ0KICB9LA0KICBtb3VudGVkKCkgew0KICAgIHRoaXMuaW5pdE1hcCgpOw0KICB9LA0KICAvLyBhY3RpdmF0ZWQoKSB7DQogIC8vICAgICB0aGlzLmluaXRNYXAoKTsNCiAgLy8gfSwNCiAgLy8gZGVhY3RpdmF0ZWQoKSB7DQogIC8vICAgICBtYXBPYmoubWFwSW5zdGFuY2UuZGVzdG9yeU1hcCgpOw0KICAvLyAgICAgbWFwT2JqLm1hcEluc3RhbmNlID0gbnVsbDsNCiAgLy8gfSwNCiAgYmVmb3JlRGVzdHJveSgpIHsNCiAgICBtYXBPYmoubWFwSW5zdGFuY2UgJiYgbWFwT2JqLm1hcEluc3RhbmNlLmRlc3RvcnlNYXAoKTsNCiAgICBtYXBPYmoubWFwSW5zdGFuY2UgPSBudWxsOw0KICAgIHRoaXMuaGFzTGlzdGVuID0gZmFsc2UNCiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignZGV2aWNlb3JpZW50YXRpb25hYnNvbHV0ZScsIHRoaXMuc2V0Um90YXRlKQ0KICB9LA0KfTsNCg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/inspectMap","sourcesContent":["<template>\r\n  <div class=\"mymap\" id=\"mymap\" ref=\"mymap\"></div>\r\n</template>\r\n<script>\r\nimport mapInit from \"./index.js\";\r\nimport addImgToMap from \"./utils/setIcon.js\";\r\nimport mixins from \"./mixins/mixins\";\r\nimport layerControl from \"./utils/layerControl.js\";\r\nimport API from '@/common/config.js';\r\nimport * as turf from '@turf/turf';\r\nimport { legendListImport } from \"@/components/xa-map/legendList.js\";\r\nimport { Toast } from 'fawkes-mobile-lib'\r\nconst mapObj = {\r\n  map: null,\r\n  mapInstance: null\r\n}\r\nexport default {\r\n  name:\"myMap\",\r\n  mixins:[mixins],\r\n  props: {\r\n    ifInspection: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    ifDetail: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    inspBusinessType: {\r\n      type: String,\r\n      default: \"\"\r\n    },\r\n    currentPosition: {\r\n      type: Object,\r\n      default: () => {}\r\n    },\r\n    taskInspType: {\r\n      type: String,\r\n      default: \"\"\r\n    },\r\n    tripleVisible: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    toggleNavigator: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    lineNavigator: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    areaNavigator: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    legendConfig: {\r\n      type: Array,\r\n      default() {\r\n        return [];\r\n      },\r\n    },\r\n    legendList: {\r\n      type: Array,\r\n      default() {\r\n        return legendListImport\r\n      }\r\n    }\r\n  },\r\n  watch: {\r\n    legendConfig: {\r\n      handler(newVal) {\r\n        this.changeLegend()\r\n      },\r\n      deep: true\r\n    }\r\n  },  \r\n  data(){\r\n    return {\r\n    }\r\n  },\r\n  methods:{\r\n    initMap(){\r\n      let options = {\r\n        style: {\r\n          version: 8,\r\n          pitch: 0,\r\n          zoom: 13.570532360577655,\r\n          center: [115.92486101369428, 39.06075549589073],\r\n          glyphs:\r\n            API.VUE_APP_MAP_URL + \"/mapboxSource/fonts/{fontstack}/{range}.pbf\",\r\n          sprite: API.VUE_APP_MAP_URL + \"/mapboxSource/sprites/sprite\",\r\n          sources: layerControl.defaultSource,\r\n          layers: layerControl.defaultLayers,\r\n        }\r\n      };\r\n      new mapInit({\r\n        container: \"mymap\",\r\n        options: this.ifInspection ? options : {},\r\n        center: [115.92486101369428, 39.06075549589073],\r\n        bus: this\r\n      },\r\n      async (mapInstance) => {\r\n        mapObj.mapInstance = mapInstance;\r\n        mapObj.map = mapInstance.map;\r\n        window.map = mapInstance.map;\r\n        window.mapInstance = mapInstance\r\n        this.mapLoad(mapInstance)\r\n        addImgToMap(mapObj.map);\r\n        await this.addPipeLayer();\r\n        this.addBufferLayer();\r\n        this.addInspUserLayer();\r\n        this.addUser();\r\n        this.isOnLoad = true;\r\n        this.$emit('mapLoaded', mapInstance)\r\n        // if (!this.ifInspection) {\r\n        //   mapObj.map.on('click', (e)=> {\r\n        //     if(this.toggleNavigator){\r\n        //       this.addNavigatorPoint([e.lngLat.lng,e.lngLat.lat]);\r\n        //     } else if(this.lineNavigator){\r\n        //       this.addNavigatorPointsLine([e.lngLat.lng,e.lngLat.lat]);\r\n        //     }else if(this.areaNavigator){\r\n        //       this.addNavigatorPointsArea([e.lngLat.lng,e.lngLat.lat]);\r\n        //     }\r\n        //   })\r\n          // mapObj.map.on('dblclick', (e)=> {\r\n          //   console.log('e2 :>> ', e);\r\n          // })\r\n          //定位\r\n          // let position = await this.getUserPosition();\r\n          // this.setUserPosition(position || [119.9,30.3]);\r\n          // window.mapInit.flyTo(position || [119.9,30.3],16);\r\n        // }\r\n\r\n\r\n        // this.addDeviceLayersClickEvent();\r\n        // this.addOrganizerMarker({position:[120,30],distance:\"111\"});\r\n        \r\n        // 添加地图点击事件监听\r\n        \r\n          // // let that = this;\r\n          // mapInstance.map.on(\"click\", function(e) {\r\n          //   console.log(e)\r\n          //   const features = mapInstance.map.queryRenderedFeatures(e.point);\r\n          //   console.log(\"features==>\", features);\r\n            // // // 将初始图层的feature加入到当前管线图层中\r\n            // // if (features.length > 0 && features[0].source == \"initInspLineSource\") {\r\n            // //   // console.log(\"features[0]==>\", features[0]);\r\n            // //   that.setLineGeoSource([features[0]], \"curInspLineSource\");\r\n            // //   // 需要对其添加上报事件的功能\r\n            // // } else if (features.length > 1 && features[1].source == \"initInspLineSource\") {\r\n            // //   that.setLineGeoSource([features[1]], \"curInspLineSource\");\r\n            // // } else if (features.length > 0) {\r\n            // //   that.setLineGeoSource([], \"curInspLineSource\");\r\n            // // }\r\n            // // 对可选中图标的增加marker  || features[1].geometry.type === \"LineString\"\r\n            // if (features.length > 0 \r\n            //   && features[0].source !=\"eventPoints\" \r\n            //   && features[0].source != \"inspUser\" \r\n            //   && features[0].source != \"initInspLineSource\" \r\n            //   && features[0].source != \"keypoints\" \r\n            //   &&(features[0].geometry.type === \"Point\")\r\n            //   ) {\r\n            //   that.addEventObjMarker(features[0]);\r\n            // } else if (features.length > 1 \r\n            //   && features[1].source !=\"eventPoints\" \r\n            //   && features[1].source != \"inspUser\" \r\n            //   && features[1].source != \"keypoints\" \r\n            //   && (features[1].geometry.type === \"Point\")\r\n            //   ) {\r\n            //   that.addEventObjMarker(features[1]);\r\n            // } else {\r\n            //   // 移除全局事件点\r\n            //   that.removeEventObjMarker();\r\n            // }\r\n          // })\r\n      })\r\n    },\r\n    changeLegend() {\r\n      if(this.legendConfig && this.legendConfig.length > 0) {\r\n        this.legendConfig.forEach((item) => {\r\n          this.legendList.forEach((legend) => {\r\n            //控制一级图层\r\n            if (item.label == legend.label) {\r\n              legend.titleStatus = item.clickFlag;\r\n              // \r\n              legend.options.forEach((smallItem) => {\r\n                // 当该标题下图层内容为显示状态时才进入判断\r\n                if (\r\n                  legend.titleStatus === true &&\r\n                  typeof smallItem.id == \"number\"\r\n                ) {\r\n                  Toast.allowMultiple();\r\n                  setTimeout(() => {\r\n                    Toast({\r\n                      message: smallItem.label + \"图层暂无数据！\",\r\n                      position: 'top'\r\n                    });\r\n                  }, 0);\r\n                  return;\r\n                }\r\n                if (legend.titleStatus === true) {\r\n                  // 标题状态点亮时\r\n                  smallItem.clickFlag = false; // 图层均显示\r\n                } else {\r\n                  smallItem.clickFlag = true; // 图层均隐藏\r\n                }\r\n                this.legendControlLayer(smallItem);\r\n              });\r\n            }else {\r\n              legend.options.forEach(smallItem => {\r\n                if(item.label == smallItem.label) {\r\n                  this.$set(smallItem, 'clickFlag', item.clickFlag)\r\n                  this.legendControlLayer(smallItem)\r\n                }\r\n              })\r\n            }\r\n            \r\n          });\r\n        });\r\n      }\r\n    },\r\n    legendControlLayer(item) {\r\n      let timer = setInterval(() => {\r\n        if (this.isOnLoaded && window.map) {\r\n          clearInterval(timer)\r\n          let map = window.map\r\n          if (map.getLayer(item.id)) {\r\n            if (item.clickFlag) {\r\n              map.setLayoutProperty(item.id, \"visibility\", \"none\");\r\n              if (item.id == \"rd_map_drainpipe_ys_big\") {\r\n                let filter = map.getFilter(\"rd_map_manhole\")\r\n                if(filter.toString() == ['all'].toString() || filter.toString() == ['in', 'manhole_type', '雨水'].toString()){\r\n                  if(map.getLayoutProperty('rd_map_drainpipe_ws_big', 'visibility') == 'none'){\r\n                    filter = ['in', 'manhole_type', '']\r\n                  }else {\r\n                    filter = ['in', 'manhole_type', '污水']\r\n                  }\r\n                }\r\n                //雨水管线图层控制雨水井、雨水箭头、雨水较小层级图层显示\r\n                map.setLayoutProperty(\"rd_map_comb\", \"visibility\", \"none\");\r\n                \r\n                map.setFilter(\"rd_map_manhole\", filter);\r\n                map.setLayoutProperty(\r\n                  \"rd_map_drainpipe_ys_big_direction\",\r\n                  \"visibility\",\r\n                  \"none\"\r\n                );\r\n                map.setLayoutProperty(\r\n                  \"rd_map_drainpipe_ys_small\",\r\n                  \"visibility\",\r\n                  \"none\"\r\n                );\r\n                map.setLayoutProperty(\r\n                  \"rd_map_drainpipe_ys_small_direction\",\r\n                  \"visibility\",\r\n                  \"none\"\r\n                );\r\n              } else if (item.id == \"map_supply_pipe_circulating\") {\r\n                //循环水（回水）管线控制循环水（回水）节点显示\r\n                map.setLayoutProperty(\r\n                  \"map_supply_node_circulating\",\r\n                  \"visibility\",\r\n                  \"none\"\r\n                );\r\n              } else if (item.id == \"map_supply_pipe_distribute\") {\r\n                //配水管线控制配水节点显示\r\n                map.setLayoutProperty(\r\n                  \"map_supply_node_distribute\",\r\n                  \"visibility\",\r\n                  \"none\"\r\n                );\r\n              } else if (item.id == \"map_supply_pipe_delivery\") {\r\n                //输水管线控制输水节点显示\r\n                map.setLayoutProperty(\r\n                  \"map_supply_node_delivery\",\r\n                  \"visibility\",\r\n                  \"none\"\r\n                );\r\n              } else if (item.id == \"map_recycle_pipe\") {\r\n                //再生水管线控制再生水节点显示\r\n                map.setLayoutProperty(\r\n                  \"map_recycle_node\",\r\n                  \"visibility\",\r\n                  \"none\"\r\n                );\r\n              } else if (item.id == \"rd_map_drainpipe_ws_big\") {\r\n                //污水管线图层控制污水井、污水箭头、污水较小层级图层显示\r\n                let filter = map.getFilter(\"rd_map_manhole\")\r\n                if(filter.toString() == ['all'].toString() || filter.toString() == ['in', 'manhole_type', '污水'].toString()){\r\n                  if(map.getLayoutProperty('rd_map_drainpipe_ys_big', 'visibility') == 'none'){\r\n                    filter = ['in', 'manhole_type', '']\r\n                  }else {\r\n                    filter = ['in', 'manhole_type', '雨水']\r\n                  }\r\n                }            \r\n                map.setFilter(\"rd_map_manhole\", filter);\r\n                map.setLayoutProperty(\r\n                  \"rd_map_drainpipe_ws_big_direction\",\r\n                  \"visibility\",\r\n                  \"none\"\r\n                );\r\n                map.setLayoutProperty(\r\n                  \"rd_map_drainpipe_ws_small\",\r\n                  \"visibility\",\r\n                  \"none\"\r\n                );\r\n                map.setLayoutProperty(\r\n                  \"rd_map_drainpipe_ws_small_direction\",\r\n                  \"visibility\",\r\n                  \"none\"\r\n                );\r\n              }\r\n            } else {          \r\n              map.setLayoutProperty(item.id, \"visibility\", \"visible\");\r\n              if (item.id == \"rd_map_drainpipe_ys_big\") {\r\n                let filter = map.getFilter(\"rd_map_manhole\")\r\n                if(filter.toString() == ['in', 'manhole_type', ''].toString() || filter.toString() == ['in', 'manhole_type', '污水'].toString()){\r\n                  if(map.getLayoutProperty('rd_map_drainpipe_ws_big', 'visibility') != 'none'){\r\n                    filter = ['all']\r\n                  }else {\r\n                    filter = ['in', 'manhole_type', '雨水']\r\n                  }\r\n                }\r\n                map.setFilter(\"rd_map_manhole\", filter);\r\n                map.setLayoutProperty(\r\n                  \"rd_map_comb\",\r\n                  \"visibility\",\r\n                  \"visible\"\r\n                );\r\n                map.setLayoutProperty(\r\n                  \"rd_map_drainpipe_ys_big_direction\",\r\n                  \"visibility\",\r\n                  \"visible\"\r\n                );\r\n                map.setLayoutProperty(\r\n                  \"rd_map_drainpipe_ys_small\",\r\n                  \"visibility\",\r\n                  \"visible\"\r\n                );\r\n                map.setLayoutProperty(\r\n                  \"rd_map_drainpipe_ys_small_direction\",\r\n                  \"visibility\",\r\n                  \"visible\"\r\n                );\r\n              } else if (item.id == \"map_supply_pipe_circulating\") {\r\n                map.setLayoutProperty(\r\n                  \"map_supply_node_circulating\",\r\n                  \"visibility\",\r\n                  \"visible\"\r\n                );\r\n              } else if (item.id == \"map_supply_pipe_distribute\") {\r\n                map.setLayoutProperty(\r\n                  \"map_supply_node_distribute\",\r\n                  \"visibility\",\r\n                  \"visible\"\r\n                );\r\n              } else if (item.id == \"map_supply_pipe_delivery\") {\r\n                map.setLayoutProperty(\r\n                  \"map_supply_node_delivery\",\r\n                  \"visibility\",\r\n                  \"visible\"\r\n                );\r\n              } else if (item.id == \"map_recycle_pipe\") {\r\n                map.setLayoutProperty(\r\n                  \"map_recycle_node\",\r\n                  \"visibility\",\r\n                  \"visible\"\r\n                );\r\n              } else if (item.id == \"rd_map_drainpipe_ws_big\") {\r\n                let filter = map.getFilter(\"rd_map_manhole\")\r\n                if(filter.toString() == ['in', 'manhole_type', ''].toString() || filter.toString() == ['in', 'manhole_type', '雨水'].toString()){\r\n                  if(map.getLayoutProperty('rd_map_drainpipe_ys_big', 'visibility') != 'none'){\r\n                    filter = ['all']\r\n                  }else {\r\n                    filter = ['in', 'manhole_type', '污水']\r\n                  }\r\n                }            \r\n                map.setLayoutProperty(\r\n                  \"rd_map_drainpipe_ws_big_direction\",\r\n                  \"visibility\",\r\n                  \"visible\"\r\n                );\r\n                map.setFilter(\"rd_map_manhole\", filter);\r\n                map.setLayoutProperty(\r\n                  \"rd_map_manhole\",\r\n                  \"visibility\",\r\n                  \"visible\"\r\n                );\r\n                map.setLayoutProperty(\r\n                  \"rd_map_drainpipe_ws_small_direction\",\r\n                  \"visibility\",\r\n                  \"visible\"\r\n                );\r\n                map.setLayoutProperty(\r\n                  \"rd_map_drainpipe_ws_small\",\r\n                  \"visibility\",\r\n                  \"visible\"\r\n                );\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }, 500)\r\n    },\r\n      // 加载实时图层切片\r\n    loadMapLayer(type) {\r\n      console.log('type :>> ', type);\r\n        this.isOnLoad = true;\r\n        let inspType = '污水';\r\n      // let inspType = type === \"POLLUTED_WATER\" ? '污水' : type === \"RAI_WATER\" ? '雨水' : '供水';\r\n      mapObj.mapInstance.addTimerSource();\r\n      this.swLayer[inspType] = mapObj.mapInstance.addTimerLayer(inspType);\r\n        // this.swLayer['污水'] = mapObj.mapInstance.addTimerLayer(inspType);\r\n    },\r\n      // 加载实时图层切片\r\n    loadMapLayerInsp(type) {\r\n      let inspType = type === \"POLLUTED_WATER\" ? '污水' : type === \"RAI_WATER\" ? '雨水' : '供水';\r\n      mapObj.mapInstance.addTimerSource();\r\n      this.swLayer[inspType] = mapObj.mapInstance.addTimerLayer(inspType);\r\n    },\r\n    // 添加巡检范围\r\n    addRangeList(rangeList) {\r\n      // ranges为Polygon类型的范围，emeMarkers为应急任务的marker\r\n      let ranges = [];\r\n      rangeList.forEach((range, idx) => {\r\n        if (range.gridGeom) {\r\n          let geom = JSON.parse(range.gridGeom);\r\n          if (geom.type === \"Polygon\") {\r\n            ranges.push(geom);\r\n            // this.addRangeLayer(geom, idx)\r\n          }\r\n        }\r\n      });\r\n      try {\r\n        if (ranges.length > 0) {\r\n          let feature = ranges[0];\r\n          let polygon = turf.polygon(feature.coordinates)\r\n          let bbox = turf.bbox({\r\n            type:\"FeatureCollection\",\r\n            features: [polygon]\r\n          });\r\n          mapObj.map.fitBounds(bbox, {\r\n            padding: {top: 10, bottom:25, left: 15, right: 5}\r\n          });\r\n        }\r\n\r\n        // const that = this;\r\n        // var timer = setInterval(function() {\r\n        //   if (that.isOnLoaded() && that.map.getSource(\"rangeSource\")) {\r\n        //     clearInterval(timer);\r\n        //     that.setRangeLayer(ranges, ifEmergency);\r\n        //   }\r\n        // }, 500);\r\n      } catch (e) {\r\n        console.log(e);\r\n      }\r\n\r\n      // if (ifEmergency) {\r\n      //   emeMarkers.forEach(eme => {\r\n      //     this.addInspEmeMarker(eme, ifDetail);\r\n      //     // this.addInspEventMarker(eme);\r\n      //   })\r\n      // }\r\n    },\r\n    // 添加关键点marker\r\n    addKeyPoints(keyPointList) {\r\n      // 清空上次的数据\r\n      this.setKeyPointLayer([]);\r\n      const features = keyPointList.map(keyPoint => {\r\n        // if (keyPoint.deviceType != '管线') {\r\n          let point = JSON.parse(JSON.stringify(keyPoint));\r\n          point.geom = JSON.parse(point.geom);\r\n          /*\r\n            加载关键点的时候，如果已经上报关键点的巡检结果并签到，且正常，显示为绿色，异常显示为红色，未巡检显示为正常icon，已退回显示为橙色\r\n          */\r\n          let isGreen = false;\r\n          let isRed = false\r\n          let isBlue = false\r\n          let isOrange = false // 已退回\r\n          if (point.ext2 == \"3\") { // 巡检记录的ext2字段，默认为1（待复核），已通过为2，已退回为3\r\n            isOrange = true\r\n          } else if (point.deviceStatus == '0') { // 关键点巡检正常\r\n            isGreen = true;\r\n          } else if (point.deviceStatus == '1') {\r\n            isRed = true\r\n          } else {\r\n            isBlue = true\r\n          }\r\n          return {\r\n            type: 'Feature',\r\n            id: point.id,\r\n            geometry: point.geom,\r\n            properties: {\r\n              id: point.id,\r\n              feature: point,\r\n              isOrange: isOrange,// 已退回\r\n              isGreen: isGreen,\r\n              isRed: isRed,\r\n              isBlue: isBlue\r\n            }\r\n          }\r\n        // }\r\n      });\r\n      // 设置关键点数据\r\n      this.setKeyPointLayer(features);\r\n    },\r\n    // 多任务添加关键点marker\r\n    addKeyPointsInMulTask(keyPointList) {\r\n      // 对重复关键点进行过滤\r\n      let keyPointData = [];\r\n      for (let i = 0; i < keyPointList.length; i++) {\r\n        let element =JSON.parse(JSON.stringify(keyPointList[i]));\r\n        let filterData = keyPointList.filter(x => x.engInfoDTO.engId === element.engInfoDTO.engId);\r\n        keyPointList = keyPointList.filter(x => filterData.every( y=> x.engInfoDTO.engId !== y.engInfoDTO.engId));\r\n        // element.eventType = '';\r\n        // filterData.forEach(it => {\r\n        //   element.eventType += it.eventType + ' '\r\n        // })\r\n        keyPointData.push(element);\r\n      }\r\n      keyPointData.forEach(keyPoint => {\r\n        if (keyPoint.engInfoDTO && keyPoint.engInfoDTO.engGeom) {\r\n          let point = JSON.parse(JSON.stringify(keyPoint.engInfoDTO));\r\n          point.engGeom = JSON.parse(point.engGeom);\r\n          this.addKeyPointMarker(point, ifDetail);\r\n          let taskDetail = keyPoint.inspectionTaskDetailDTO.inspectionTaskDetail;\r\n          /*\r\n            加载关键点的时候，如果已经上报关键点的巡检结果并签到，且未被退回（待复核），显示为绿色\r\n          */\r\n          if (taskDetail.inspItemResult && taskDetail.isComplete == 1 && taskDetail.inspItemReview != 3) {\r\n            this.changeKeyPointMarker(point.engId, true);\r\n          }\r\n        }\r\n      })\r\n    },\r\n    // 移除应急巡检marker\r\n    removeInspEmeMarkers(rangeList) {\r\n      let emeMarkers = [];\r\n      rangeList.forEach(range => {\r\n        if (range.taskRangerGeom) {\r\n          let geom = JSON.parse(range.taskRangerGeom);\r\n          // 如果是应急任务，则需要添加marker\r\n          emeMarkers.push(geom.id);\r\n        }\r\n      });\r\n      if (emeMarkers.length > 0) {\r\n        this.removeInspEmeMarker(emeMarkers)\r\n      }\r\n    }\r\n  },\r\n  mounted() {\r\n    this.initMap();\r\n  },\r\n  // activated() {\r\n  //     this.initMap();\r\n  // },\r\n  // deactivated() {\r\n  //     mapObj.mapInstance.destoryMap();\r\n  //     mapObj.mapInstance = null;\r\n  // },\r\n  beforeDestroy() {\r\n    mapObj.mapInstance && mapObj.mapInstance.destoryMap();\r\n    mapObj.mapInstance = null;\r\n    this.hasListen = false\r\n    window.removeEventListener('deviceorientationabsolute', this.setRotate)\r\n  },\r\n};\r\n</script>\r\n<style lang=\"less\" scoped>\r\n@import url('~@/components/map/css/mapbox-gl-enhance.css');\r\n#mymap {\r\n  width: 100%;\r\n  min-height: 100%;\r\n}\r\n</style>"]}]}