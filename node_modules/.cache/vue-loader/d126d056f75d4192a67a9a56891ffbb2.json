{"remainingRequest":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Code\\Project\\WL\\xasw-mobile\\src\\views\\inspectionManage\\SingleGalleryDetail.vue?vue&type=style&index=0&id=70cca03f&lang=less&scoped=true","dependencies":[{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\src\\views\\inspectionManage\\SingleGalleryDetail.vue","mtime":1708928163426},{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\less-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQouR2FsbGVyeUluc3BlY3Rpb25TdHlsZSB7DQogIGJhY2tncm91bmQtY29sb3I6ICNmZmZmZmYgIWltcG9ydGFudDsNCiAgaGVpZ2h0OiAxMDAlOw0KDQogIC8vIOmhtumDqOagh+mimOiDjOaZr+iJsg0KICAvZGVlcC8uZm0tbmF2LWJhcl9fY29udGVudCB7DQogICAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZmZmZjsNCiAgfQ0KDQogIC9kZWVwLy5mbS1uYXYtYmFyX190aXRsZSB7DQogICAgY29sb3I6ICMxOTE5MTkgIWltcG9ydGFudDsNCiAgfQ0KDQogIC9kZWVwLyAuZm0tbmF2LWJhciAuZm0taWNvbiB7DQogICAgY29sb3I6ICMxOTE5MTkgIWltcG9ydGFudDsNCiAgfQ0KDQogIC5tYXBDb250YWluZXIgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgIGhlaWdodDogY2FsYygxMDAlIC0gNzJweCk7DQogICAgd2lkdGg6IDEwMCU7DQogICAgYmFja2dyb3VuZDogbGluZWFyLWdyYWRpZW50KDBkZWcsDQogICAgICAgIHJnYmEoMjExLCAyMzEsIDI1NCwgMCkgMCUsDQogICAgICAgIHJnYmEoMjExLCAyMzEsIDI1NCwgMC4wNSkgNTAlLA0KICAgICAgICByZ2JhKDIxMSwgMjMxLCAyNTQsIDAuNCkgMTAwJSk7DQoNCiAgICAudG9wQ2FyZCB7DQogICAgICBwb3NpdGlvbjogcmVsYXRpdmU7DQogICAgICBkaXNwbGF5OiBmbGV4Ow0KICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsNCiAgICAgIHdpZHRoOiA2OTBweDsNCiAgICAgIGhlaWdodDogMTAwcHg7DQogICAgICBtYXJnaW46IDQ4cHggMHB4IDEycHggMHB4Ow0KICAgICAgYmFja2dyb3VuZDogI2ZmZmZmZjsNCiAgICAgIGJveC1zaGFkb3c6IDBweCA0cHggMTZweCAwcHggcmdiYSgxMDQsIDExNSwgMTI3LCAwLjA2KTsNCiAgICAgIGJvcmRlci1yYWRpdXM6IDE2cHg7DQoNCiAgICAgIGltZyB7DQogICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgICAgICAgd2lkdGg6IDZweDsNCiAgICAgICAgdG9wOiA1MCU7DQogICAgICAgIGxlZnQ6IDA7DQogICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtNTAlKTsNCiAgICAgIH0NCg0KICAgICAgLmJpZ3RleHQgew0KICAgICAgICBtYXJnaW4tbGVmdDogMzBweDsNCiAgICAgICAgZm9udC1zaXplOiAzMnB4Ow0KICAgICAgICBmb250LWZhbWlseTogUGluZ0ZhbmdTQy1TZW1pYm9sZCwgUGluZ0ZhbmcgU0M7DQogICAgICAgIGZvbnQtd2VpZ2h0OiA2MDA7DQogICAgICAgIGNvbG9yOiAjMTkxOTE5Ow0KICAgICAgfQ0KDQogICAgICAudGFnU3R5bGUgew0KICAgICAgICBtYXJnaW4tcmlnaHQ6IDMwcHg7DQogICAgICAgIGRpc3BsYXk6IGZsZXg7DQogICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOw0KICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgICAgICB3aWR0aDogOTlweDsNCiAgICAgICAgaGVpZ2h0OiA0MnB4Ow0KICAgICAgICBib3JkZXItcmFkaXVzOiA0cHg7DQoNCiAgICAgICAgZm9udC1zaXplOiAyNHB4Ow0KICAgICAgICBmb250LWZhbWlseTogUGluZ0ZhbmdTQy1SZWd1bGFyLCBQaW5nRmFuZyBTQzsNCiAgICAgICAgZm9udC13ZWlnaHQ6IDQwMDsNCiAgICAgIH0NCg0KICAgICAgLmlwc0luZyB7DQogICAgICAgIGJhY2tncm91bmQ6ICNmZmYzZTg7DQogICAgICAgIGNvbG9yOiAjZmY5NDI5Ow0KICAgICAgfQ0KDQogICAgICAuaXBzRWQgew0KICAgICAgICBiYWNrZ3JvdW5kOiAjZWNmNWZmOw0KICAgICAgICBjb2xvcjogIzQwOWVmZjsNCiAgICAgIH0NCiAgICB9DQoNCiAgICAuYm90dG9tQ2FyZCB7DQogICAgICAvLyBtYXJnaW4tdG9wOiAyNHB4Ow0KICAgICAgd2lkdGg6IDY5MHB4Ow0KICAgICAgLy8gaGVpZ2h0OiBjYWxjKDEwMCUgLSAzMDBweCk7DQogICAgICBkaXNwbGF5OiBmbGV4Ow0KICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgICBvdmVyZmxvdy15OiBzY3JvbGw7DQogICAgICAvLyBiYWNrZ3JvdW5kOiAjZmYwMDAwOw0KICAgICAgYm94LXNoYWRvdzogMHB4IDRweCAxNnB4IDBweCByZ2JhKDEwNCwgMTE1LCAxMjcsIDAuMDYpOw0KICAgICAgYm9yZGVyLXJhZGl1czogMTZweDsNCg0KICAgICAgLnRleHRMaW5lIHsNCiAgICAgICAgZGlzcGxheTogZmxleDsNCiAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOw0KICAgICAgICB3aWR0aDogOTIlOw0KICAgICAgICBtaW4taGVpZ2h0OiAxNDZweDsNCiAgICAgICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICNlZWVlZWU7DQogICAgICAgIC8vIGJhY2tncm91bmQtY29sb3I6ICM2ZGY4NWE7DQogICAgICB9DQoNCiAgICAgIC5pbWdMaW5lIHsNCiAgICAgICAgZGlzcGxheTogZmxleDsNCiAgICAgICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOw0KICAgICAgICB3aWR0aDogOTIlOw0KICAgICAgICAvLyBtaW4taGVpZ2h0OiAyNjdweDsNCiAgICAgICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICNlZWVlZWU7DQoNCiAgICAgICAgLmltZ1N0eWxlIHsNCiAgICAgICAgICB3aWR0aDogMTAwJTsNCiAgICAgICAgICAvLyBoZWlnaHQ6IGNhbGMoMTAwJSAtIDcwcHgpOw0KICAgICAgICAgIG1hcmdpbi10b3A6IDE2cHg7DQogICAgICAgIH0NCiAgICAgIH0NCg0KICAgICAgLmlucHV0TGluZSB7DQogICAgICAgIGRpc3BsYXk6IGZsZXg7DQogICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsNCiAgICAgICAgd2lkdGg6IDkyJTsNCiAgICAgICAgbWluLWhlaWdodDogMTYwcHg7DQogICAgICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjZWVlZWVlOw0KDQogICAgICAgIC5pbnB1dFN0eWxlIHsNCiAgICAgICAgICBoZWlnaHQ6IGNhbGMoMTAwJSAtIDYwcHgpOw0KICAgICAgICB9DQogICAgICB9DQoNCiAgICAgIC50b3BUZXh0IHsNCiAgICAgICAgbWFyZ2luLXRvcDogMjZweDsNCiAgICAgICAgZGlzcGxheTogaW5saW5lLWJsb2NrOw0KICAgICAgICB3aWR0aDogMTAwJTsNCiAgICAgICAgd2hpdGUtc3BhY2U6IG5vd3JhcDsNCiAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsNCiAgICAgICAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7DQogICAgICAgIGZvbnQtc2l6ZTogMzJweDsNCiAgICAgICAgZm9udC1mYW1pbHk6IFBpbmdGYW5nU0MtUmVndWxhciwgUGluZ0ZhbmcgU0M7DQogICAgICAgIGZvbnQtd2VpZ2h0OiA0MDA7DQogICAgICAgIGNvbG9yOiAjNTU1NTU1Ow0KICAgICAgfQ0KICAgIH0NCg0KICAgIC5zdWJtaXRTdHlsZSB7DQogICAgICBtYXJnaW4tdG9wOiAyNHB4Ow0KICAgICAgZGlzcGxheTogZmxleDsNCiAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOw0KICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICAgIHdpZHRoOiA2OTBweDsNCiAgICAgIGhlaWdodDogNzJweDsNCiAgICAgIGJhY2tncm91bmQ6ICMxYjY3ZDg7DQogICAgICBib3gtc2hhZG93OiAwcHggOHB4IDE2cHggMHB4IHJnYmEoMjcsIDEwMywgMjE2LCAwLjIpOw0KICAgICAgYm9yZGVyLXJhZGl1czogNDRweDsNCg0KICAgICAgZm9udC1zaXplOiAzMnB4Ow0KICAgICAgZm9udC1mYW1pbHk6IFBpbmdGYW5nU0MtUmVndWxhciwgUGluZ0ZhbmcgU0M7DQogICAgICBmb250LXdlaWdodDogNDAwOw0KICAgICAgY29sb3I6ICNmZmZmZmY7DQogICAgfQ0KICB9DQp9DQo="},{"version":3,"sources":["SingleGalleryDetail.vue"],"names":[],"mappings":";AAkTA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"SingleGalleryDetail.vue","sourceRoot":"src/views/inspectionManage","sourcesContent":["<template>\r\n  <div class=\"GalleryInspectionStyle\">\r\n    <fm-nav-bar left-arrow :title=\"taskDetail.taskName\" @click-left=\"goBackToTask\" @click-right=\"onSelect\">\r\n      <template #right>\r\n        <template>\r\n          <i class=\"fm-icon fm-icon-plus\" style=\"font-size: 18px\" v-if='isEdit'></i>\r\n        </template>\r\n      </template>\r\n    </fm-nav-bar>\r\n    <div class=\"mapContainer\" :style=\"isEdit ? 'height: calc(100% - 72px);' : 'height: calc(100% - 2px);'\">\r\n      <div class=\"topCard\">\r\n        <img src=\"@/assets/img/inspection/侧边蓝条.png\" alt=\"\" />\r\n        <div class=\"bigtext\">{{ objectName }}</div>\r\n        <div class=\"tagStyle\" :class=\"isEdit ? 'ipsIng' : 'ipsEd'\">{{ isEdit ? '待巡检' : '已巡检' }}</div>\r\n      </div>\r\n      <div class=\"bottomCard\">\r\n        <div v-for=\"(item, index) in  mainPointInfo\" :key=\"index\" class=\"textLine\">\r\n          <span class=\"topText\">{{ index + 1 }}.\r\n            {{ item.mainPoint }}\r\n          </span>\r\n          <fm-radio-group v-if=\"item.inputType != '数值'\" v-model=\"item.mainValue\" direction=\"horizontal\"\r\n            style=\"margin: 0 0 5px 5px; font-size: 16px\" :disabled=\"!isEdit\">\r\n            <fm-radio name=\"正常\" icon-size=\"16px\">正常</fm-radio>\r\n            <fm-radio name=\"异常\" icon-size=\"16px\">异常</fm-radio>\r\n          </fm-radio-group>\r\n          <fm-field v-else v-model=\"item.mainValue\" type='number' placeholder=\"请输入数值\" :disabled=\"!isEdit\"\r\n            style=\"height: 45px;;background-color: rgba(255,255,255,0);\">\r\n            <template #extra>\r\n              {{ item.unit }}\r\n            </template>\r\n          </fm-field>\r\n        </div>\r\n        <div class=\"imgLine\">\r\n          <span class=\"topText\">现场照片<span style=\"color:red\">*</span></span>\r\n          <div class=\"imgStyle\">\r\n            <fm-image width=\"100\" height=\"100\" v-for=\"(item, index) in fileUrlList\" :key=\"index\" :src=\"item\"\r\n              @click=\"preview(item)\" />\r\n            <fm-popup :visible.sync=\"imgPreviewShow\">\r\n              <fm-image width=\"400\" height=\"300\" :src=\"imgPreview\"></fm-image>\r\n            </fm-popup>\r\n            <Uploader v-if='isEdit' value=\"\" label=\"\" @fileChangeGallery=\"fileChange\" />\r\n          </div>\r\n        </div>\r\n        <div class=\"inputLine\">\r\n          <span class=\"topText\">现场描述</span>\r\n          <div class=\"inputStyle\">\r\n            <fm-field v-model=\"message\" v-if='isEdit' rows=\"2\" autosize label=\"\" type=\"textarea\" maxlength=\"300\"\r\n              placeholder=\"请输入\" show-word-limit />\r\n            <fm-field style=\"padding:0px 10px\" v-model=\"message\" v-else rows=\"2\" autosize label=\"\" type=\"textarea\"\r\n              disabled />\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"submitStyle\" v-if=\"isEdit\" @click=\"newSubmit\">提交</div>\r\n      <!-- <div class=\"submitStyle\" v-else @click=\"goBackToTask\">返回</div> -->\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Vue from 'vue'\r\nimport axios from 'axios'\r\nimport * as Api from './api'\r\nimport bus from '@/utils/bus'\r\nimport { ENUM } from '@/store/State/stateTypes'\r\nimport * as turf from '@turf/turf'\r\nimport { bbox, center as getCenter } from '@turf/turf'\r\nimport _cloneDeep from 'lodash/cloneDeep'\r\nimport { addIconToMap } from '@/utils/mapUtils'\r\nimport mapboxgl from 'mapbox-gl'\r\nimport { Toast, Dialog, Notify, ImagePreview } from 'fawkes-mobile-lib'\r\nimport mixins from '@/views/inspectMap/mixins/mixins.js'\r\nimport dayjs from 'dayjs'\r\nimport request from '@/utils/request'\r\nimport Uploader from '@/components/upload/Uploader.vue'\r\nimport _ from \"lodash\";\r\n\r\n\r\nexport default {\r\n  name: '',\r\n  mixins: [mixins],\r\n  components: { Uploader, ImagePreview },\r\n  data() {\r\n    return {\r\n      galleryRouteParams: {}, // 路由参数\r\n      objectName: '',\r\n      taskDetail: {},\r\n      mainPointInfo: [],\r\n      message: \"\",\r\n      fileList: [],\r\n      fileUrlList: [],\r\n      imgPreviewShow: false,\r\n      imgPreview: ''\r\n    }\r\n  },\r\n  computed: {\r\n    isEdit() {\r\n      if (Object.keys(this.galleryRouteParams).length > 0) {\r\n        return this.galleryRouteParams.mode == 'edit'\r\n      } else {\r\n        return true\r\n      }\r\n    }\r\n  },\r\n  created() {\r\n    // 当前点击的任务，从本地中获取\r\n    this.taskDetail = JSON.parse(localStorage.getItem('galleryTaskData'))\r\n    console.log('this.taskDetail: ', this.taskDetail);\r\n    // 如果当前跳转过来的路由中有params参数，将params参数存入本地，如果没有，则使用本地存储的数据\r\n    if (Object.keys(this.$route.params).length > 0) {\r\n      this.galleryRouteParams = this.$route.params\r\n      localStorage.setItem('galleryRouteParams', JSON.stringify(this.galleryRouteParams))\r\n    } else {\r\n      this.galleryRouteParams = JSON.parse(localStorage.getItem('galleryRouteParams'))\r\n    }\r\n  },\r\n  mounted() {\r\n    console.log('this.$route.query: ', this.$route.query);\r\n    console.log('this.galleryRouteParams: ', this.galleryRouteParams);\r\n    this.objectName = this.$route.query.objectName\r\n    if (this.isEdit) {\r\n      this.inspMainPoint()\r\n    } else {\r\n      this.inspMainPoint()\r\n      this.inspMainPointReult()\r\n    }\r\n  },\r\n  methods: {\r\n    preview(item) {\r\n      console.log(\"preview\");\r\n      this.imgPreview = item\r\n      this.imgPreviewShow = true\r\n    },\r\n    // 返回任务页\r\n    goBackToTask() {\r\n      this.$router.go(-1)\r\n    },\r\n    // 点击上报漏点加号\r\n    onSelect(val) {\r\n      if (this.isEdit) {\r\n        // this.taskDetail = {\r\n        //   \"id\": \"1635672135967145986\",\r\n        //   \"createBy\": \"wang_xu wei\",\r\n        //   \"createDate\": \"2023-03-15 00:00:01\",\r\n        //   \"updateBy\": null,\r\n        //   \"updateDate\": null,\r\n        //   \"deleteFlag\": 0,\r\n        //   \"taskName\": \"DEG管廊巡检-1\",\r\n        //   \"planId\": \"1631099024635125762\",\r\n        //   \"taskCode\": \"PLAN230315000001\",\r\n        //   \"taskStatus\": 1,\r\n        //   \"planStartTime\": \"2023-03-06 00:00:00\",\r\n        //   \"taskType\": \"管廊巡检\",\r\n        //   \"planEndTime\": \"2023-12-31 00:00:00\",\r\n        //   \"taskStartTime\": \"2023-03-15 00:00:00\",\r\n        //   \"taskEndTime\": \"2023-03-19 23:59:59\",\r\n        //   \"inspector\": \"wang_xu wei\",\r\n        //   \"inspectorFullName\": \"王旭伟\",\r\n        //   \"taskResult\": \"0\",\r\n        //   \"remarks\": null,\r\n        //   \"bizType\": \"再生水,供水\",\r\n        //   \"completion\": null,\r\n        //   \"inspectionType\": \"1630780848805486594,1630780817876688898,1630780788256514050,1630780759089324034,1630780731914428418,1630780703862923265,1630780668781764610,1630780641388765186,1630780607154855937,1630780582244884481,1630780549474787329,1630780518743121922,1630780415902982145,1630780381224476674,1630780347821039618,1630780280494071810,1630780250777427969,1630780310001000450\",\r\n        //   \"coverage\": \"0.00\",\r\n        //   \"reportRate\": \"1/18\",\r\n        //   \"pipeLength\": null,\r\n        //   \"gridManager\": \"梁宗涛\",\r\n        //   \"pointNumber\": null,\r\n        //   \"ext3\": \"支廊\",\r\n        // }\r\n\r\n        // this.$route.query = {\r\n        //   \"id\": \"1630780817876688898\",\r\n        //   \"createBy\": \"lin_w\",\r\n        //   \"createDate\": \"2023-03-01 12:03:40\",\r\n        //   \"updateBy\": null,\r\n        //   \"updateDate\": null,\r\n        //   \"deleteFlag\": 0,\r\n        //   \"objectType\": \"支廊\",\r\n        //   \"objectName\": \"N6E17东支廊\",\r\n        //   \"gridName\": \"综合二班（DEG）\",\r\n        //   \"gridId\": \"1590537206429511681\",\r\n        //   \"buildUnit\": \"\",\r\n        //   \"material\": \"\",\r\n        //   \"objectStatus\": \"启用中\",\r\n        //   \"mainId\": \"1630370705350893570,1628232356279066626,1628232356279066625,1628232356279066627,1628232356279066628,1627841154576785410,1627841154576785414,1627841154576785413\",\r\n        //   \"remarks\": null,\r\n        //   \"tenantId\": 100000,\r\n        //   \"portalId\": \"1539806397064622081\",\r\n        //   \"ext1\": null,\r\n        //   \"ext2\": null,\r\n        //   \"ext3\": null,\r\n        //   \"recordStatus\": null,\r\n        //   \"lon\": null,\r\n        //   \"lat\": null\r\n        // }\r\n\r\n        console.log(\"this.taskDetail\", _cloneDeep(this.taskDetail));\r\n        let currentPoint = {}\r\n        currentPoint.taskId = this.taskDetail.id\r\n        currentPoint.gridManager = { fullName: this.taskDetail.gridManager || '', username: this.taskDetail.userName || '' }\r\n        currentPoint.bigType = '管廊'\r\n        currentPoint.smallType = this.$route.query.objectType || ''\r\n        currentPoint.road_name = ''\r\n        currentPoint.gridId = this.$route.query.gridId || ''\r\n        currentPoint.gridName = this.$route.query.gridName || ''\r\n        currentPoint.code = this.$route.query.objectName || ''\r\n        currentPoint.lng = this.$route.query.lon || ''\r\n        currentPoint.lat = this.$route.query.lat || ''\r\n        // 跳转问题上报   对应不上，例如没有地图点选，回填字段对不上\r\n        this.$router.push({\r\n          name: 'addProblemIndex',\r\n          query: { msg: currentPoint, token: this.galleryRouteParams.formToken, taskId: this.taskDetail.id, from: 'insp' },\r\n          params: { type: 'add' },\r\n        })\r\n      } else {\r\n        Toast({\r\n          message: '该巡检任务已结束',\r\n          duration: '1500',\r\n        })\r\n      }\r\n    },\r\n\r\n    // view模式下，根据taskId和objectId，查提交的‘表单’\r\n    async inspMainPointReult() {\r\n      let res = await Api.inspMainPointReult({ taskId: this.galleryRouteParams.taskId, objectId: this.$route.query.id })\r\n      console.log('inspMainPointReult-res: ', res);\r\n      let mainPointInfoResult = []\r\n      if (res.status) {\r\n        res.data.mainPointResult.forEach(element => {\r\n          this.mainPointInfo.map((item, index) => {\r\n            item.id == element.mainId ? mainPointInfoResult.push(Object.assign(item, { mainValue: element.mainValue })) : ''\r\n          })\r\n        });\r\n        this.mainPointInfo = mainPointInfoResult\r\n        this.message = res.data.remarks\r\n        res.data.imagesList.forEach((element) => {\r\n          this.fileUrlList.push(`${process.env.VUE_APP_BASE_URL}/sys-storage/download_image?f8s=${element.imagesToken}`)\r\n        })\r\n        console.log('fileUrlList: ', this.fileUrlList);\r\n      }\r\n      console.log('mainPointInfoResult: ', mainPointInfoResult);\r\n    },\r\n\r\n    // 查 该巡检对象的要点\r\n    async inspMainPoint() {\r\n      let res = await Api.inspMainPoint({ mainId: this.$route.query.mainId })\r\n      if (res.status) {\r\n        this.mainPointInfo = res.data\r\n        for (var i = 0; i < this.mainPointInfo.length; i++) {\r\n          this.mainPointInfo[i].inputType == '数值' ? this.$set(this.mainPointInfo[i], 'mainValue', \"\") : this.$set(this.mainPointInfo[i], 'mainValue', \"正常\");\r\n        }\r\n      }\r\n    },\r\n    // 文件上传成功或删除后调用\r\n    fileChange(file) {\r\n      console.log('file: ', file);\r\n      // file.file是当前变化(增减)的图片；fileList是当前所有可用的图片\r\n      this.fileList = file.fileList\r\n    },\r\n    newSubmit: _.debounce(function () {\r\n      console.log('Debounce: ');\r\n      this.submit()\r\n    }, 1000),\r\n    async submit() {\r\n      console.log('submit: ');\r\n      let mainPointResult = this.mainPointInfo.map(({ id, mainValue }) => { return { mainId: id, mainValue } })\r\n      let imagesList = this.fileList.map(({ file, fileToken }) => { return { imagesName: file.name, imagesToken: fileToken } })\r\n      if (this.fileList.length == 0) {\r\n        Toast({\r\n          message: '至少上传一张照片',\r\n          position: 'top',\r\n        });\r\n        return false;\r\n      }\r\n      // console.log('提交前检查完毕，可以提交');\r\n\r\n      let inspObjectRecord = {\r\n        taskId: this.taskDetail.id,\r\n        objectId: this.$route.query.id,\r\n        remarks: this.message,\r\n        // \"inspDate\": \"\",\r\n        // \"inspector\": \"\",\r\n        imagesList: imagesList,\r\n        mainPointResult: mainPointResult\r\n      }\r\n      console.log('inspObjectRecord: ', inspObjectRecord);\r\n      let res = await Api.inspObjectRecord(inspObjectRecord)\r\n      console.log('submit-res: ', res);\r\n      if (res.status) {\r\n        Toast({\r\n          message: '提交成功',\r\n          position: 'top',\r\n        });\r\n        // setTimeout(() => { this.$router.push('/inspectionManage/StartGalleryInspection'); }, 1000);\r\n        setTimeout(() => { this.$router.go(-1); }, 1000);\r\n      }\r\n    },\r\n\r\n\r\n  },\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.GalleryInspectionStyle {\r\n  background-color: #ffffff !important;\r\n  height: 100%;\r\n\r\n  // 顶部标题背景色\r\n  /deep/.fm-nav-bar__content {\r\n    background-color: #ffffff;\r\n  }\r\n\r\n  /deep/.fm-nav-bar__title {\r\n    color: #191919 !important;\r\n  }\r\n\r\n  /deep/ .fm-nav-bar .fm-icon {\r\n    color: #191919 !important;\r\n  }\r\n\r\n  .mapContainer {\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    height: calc(100% - 72px);\r\n    width: 100%;\r\n    background: linear-gradient(0deg,\r\n        rgba(211, 231, 254, 0) 0%,\r\n        rgba(211, 231, 254, 0.05) 50%,\r\n        rgba(211, 231, 254, 0.4) 100%);\r\n\r\n    .topCard {\r\n      position: relative;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: space-between;\r\n      width: 690px;\r\n      height: 100px;\r\n      margin: 48px 0px 12px 0px;\r\n      background: #ffffff;\r\n      box-shadow: 0px 4px 16px 0px rgba(104, 115, 127, 0.06);\r\n      border-radius: 16px;\r\n\r\n      img {\r\n        position: absolute;\r\n        width: 6px;\r\n        top: 50%;\r\n        left: 0;\r\n        transform: translateY(-50%);\r\n      }\r\n\r\n      .bigtext {\r\n        margin-left: 30px;\r\n        font-size: 32px;\r\n        font-family: PingFangSC-Semibold, PingFang SC;\r\n        font-weight: 600;\r\n        color: #191919;\r\n      }\r\n\r\n      .tagStyle {\r\n        margin-right: 30px;\r\n        display: flex;\r\n        justify-content: center;\r\n        align-items: center;\r\n        width: 99px;\r\n        height: 42px;\r\n        border-radius: 4px;\r\n\r\n        font-size: 24px;\r\n        font-family: PingFangSC-Regular, PingFang SC;\r\n        font-weight: 400;\r\n      }\r\n\r\n      .ipsIng {\r\n        background: #fff3e8;\r\n        color: #ff9429;\r\n      }\r\n\r\n      .ipsEd {\r\n        background: #ecf5ff;\r\n        color: #409eff;\r\n      }\r\n    }\r\n\r\n    .bottomCard {\r\n      // margin-top: 24px;\r\n      width: 690px;\r\n      // height: calc(100% - 300px);\r\n      display: flex;\r\n      flex-direction: column;\r\n      align-items: center;\r\n      overflow-y: scroll;\r\n      // background: #ff0000;\r\n      box-shadow: 0px 4px 16px 0px rgba(104, 115, 127, 0.06);\r\n      border-radius: 16px;\r\n\r\n      .textLine {\r\n        display: flex;\r\n        flex-direction: column;\r\n        justify-content: space-between;\r\n        width: 92%;\r\n        min-height: 146px;\r\n        border-bottom: 1px solid #eeeeee;\r\n        // background-color: #6df85a;\r\n      }\r\n\r\n      .imgLine {\r\n        display: flex;\r\n        flex-direction: column;\r\n        justify-content: space-between;\r\n        width: 92%;\r\n        // min-height: 267px;\r\n        border-bottom: 1px solid #eeeeee;\r\n\r\n        .imgStyle {\r\n          width: 100%;\r\n          // height: calc(100% - 70px);\r\n          margin-top: 16px;\r\n        }\r\n      }\r\n\r\n      .inputLine {\r\n        display: flex;\r\n        flex-direction: column;\r\n        justify-content: space-between;\r\n        width: 92%;\r\n        min-height: 160px;\r\n        border-bottom: 1px solid #eeeeee;\r\n\r\n        .inputStyle {\r\n          height: calc(100% - 60px);\r\n        }\r\n      }\r\n\r\n      .topText {\r\n        margin-top: 26px;\r\n        display: inline-block;\r\n        width: 100%;\r\n        white-space: nowrap;\r\n        overflow: hidden;\r\n        text-overflow: ellipsis;\r\n        font-size: 32px;\r\n        font-family: PingFangSC-Regular, PingFang SC;\r\n        font-weight: 400;\r\n        color: #555555;\r\n      }\r\n    }\r\n\r\n    .submitStyle {\r\n      margin-top: 24px;\r\n      display: flex;\r\n      justify-content: center;\r\n      align-items: center;\r\n      width: 690px;\r\n      height: 72px;\r\n      background: #1b67d8;\r\n      box-shadow: 0px 8px 16px 0px rgba(27, 103, 216, 0.2);\r\n      border-radius: 44px;\r\n\r\n      font-size: 32px;\r\n      font-family: PingFangSC-Regular, PingFang SC;\r\n      font-weight: 400;\r\n      color: #ffffff;\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}