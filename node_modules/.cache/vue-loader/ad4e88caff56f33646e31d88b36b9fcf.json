{"remainingRequest":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\src\\views\\MaintenManagement\\TaskDetail\\index.vue?vue&type=script&lang=js","dependencies":[{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\src\\views\\MaintenManagement\\TaskDetail\\index.vue","mtime":1705912915799},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgYnVzIGZyb20gJ0Avdmlld3MvaW5zcGVjdE1hcC91dGlscy9CdXMuanMnDQppbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnDQppbXBvcnQgZGF5anMgZnJvbSAnZGF5anMnDQppbXBvcnQgTWFwQ29tcCBmcm9tICdAL3ZpZXdzL2luc3BlY3RNYXAvaW5kZXgudnVlJw0KaW1wb3J0IHJlcXVlc3QgZnJvbSAnQC91dGlscy9yZXF1ZXN0Jw0KaW1wb3J0ICogYXMgYXBpIGZyb20gJy4uL2FwaScNCmltcG9ydCB7IFRvYXN0LCBEaWFsb2cgfSBmcm9tICdmYXdrZXMtbW9iaWxlLWxpYicNCmltcG9ydCAqIGFzIHR1cmYgZnJvbSAnQHR1cmYvdHVyZicNCmltcG9ydCBVcGxvYWRlciBmcm9tICdAL2NvbXBvbmVudHMvdXBsb2FkL1VwbG9hZGVyLnZ1ZScNCmltcG9ydCBhZGRJbWdUb01hcCBmcm9tICcuLi91dGlscy9zZXRJY29uLmpzJw0KLy8gaW1wb3J0IHByb2JsZW1DYXJkSW5mbyBmcm9tICcuL3Byb2JsZW1DYXJkSW5mbyc7DQppbXBvcnQgQVBJIGZyb20gJ0AvY29tbW9uL2NvbmZpZy5qcycNCmltcG9ydCBWdWUgZnJvbSAndnVlJzsNCmltcG9ydCBQb3B1cCBmcm9tICcuLi8uLi9pbnNwZWN0TWFwL2NvbXBvbmVudHMvcG9wdXAudnVlJw0KY29uc3QgUG9wdXBJdGVtID0gVnVlLmV4dGVuZChQb3B1cCkNCmNvbnN0IG1hcE9iaiA9IHsNCiAgbWFwOiBudWxsLA0KICBtYXBJbnN0YW5jZTogbnVsbCwNCn0NCmNvbnN0IGN1cnJlbnRNYWluUG9pbnQgPSB7DQogIGlzTWFpbjogW10sDQogIGlzTm90TWFpbjogW10sDQp9DQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICdtYWludGVuLXRhc2snLA0KICBjb21wb25lbnRzOiB7DQogICAgTWFwQ29tcCwNCiAgICBVcGxvYWRlciwNCiAgICAvLyBwcm9ibGVtQ2FyZEluZm8sDQogIH0sDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIG1haW50ZW5SYW5nZUxpc3Q6IFtdLA0KICAgICAgdGFza0RhdGE6IG51bGwsDQogICAgICBwcm9ncmVzczogJycsDQogICAgICBoYXNLbm93OiBmYWxzZSwNCiAgICAgIGNvbnRpbnVlVGltZTogMTAsDQogICAgICBub3RpY2VTaG93OiBmYWxzZSwNCiAgICAgIG1haW50YWluQmVmb3JlSW1hZ2U6IFtdLA0KICAgICAgbWFpbnRhaW5BZnRlckltYWdlOiBbXSwNCiAgICAgIGN1cnJlbnRTZWxlY3REZXY6IG51bGwsDQogICAgICBtYWludGVuQ29udGVudHNMaXN0OiBbXSwNCiAgICAgIGN1cnJlbnRTZWxlSXNNYWluVHlwZTogJ+WFqOmDqCcsDQogICAgICBjdXJyZW50U2VsZUlzTm90TWFpblR5cGU6ICflhajpg6gnLA0KICAgICAgbWFpbnRlbk9iajogew0KICAgICAgICBpc01haW46IFtdLA0KICAgICAgICBpc05vdE1haW46IFtdLA0KICAgICAgfSwNCiAgICAgIGxvYWRpbmc6IGZhbHNlLA0KICAgICAgZmluaXNoZWQ6IGZhbHNlLA0KICAgICAgLy8gYnV0dG9uTGlzdDogWyflhajpg6gnLCAn6Zuo5rC05Y+jJ10sDQogICAgICBtYWluTGlzdFN0eWxlOiB7DQogICAgICAgICctLXRvcCc6IGRvY3VtZW50LmJvZHkuY2xpZW50SGVpZ2h0IC0gMjQgKyAncHgnLA0KICAgICAgICAnLS1oZWlndGgnOiAnMjRweCcsDQogICAgICB9LA0KICAgICAgY2hlY2tib3hHcm91cDogW10sDQogICAgICBkZWFsQmVmb3JlOiB0cnVlLA0KICAgICAgdGVtcDogJycsDQogICAgICBtYXBMb2FkOiBmYWxzZSwNCiAgICAgIGhhc01haW46IDAsDQogICAgICBhbGxNYWluOiAwLA0KICAgICAgaWZTdGFydDogZmFsc2UsDQogICAgICBzdHlsZVZhcjogew0KICAgICAgICAnLS10b3RhbFdpZHRoJzogJzE0OHB4JywNCiAgICAgICAgJy0tYmFyV2lkdGgnOiAnMTAwcHgnLA0KICAgICAgICAnLS1jb2xvckJsdWUnOiAnYmx1ZScsDQogICAgICB9LA0KICAgICAgb2JqTGlzdDogW10sDQogICAgICB0YXNrQml6VHlwZTogJycsDQogICAgICBpZlRpcHM6IGZhbHNlLA0KICAgICAgcmVwb3J0RGF0YUlzTG9hZGVkOiBmYWxzZSwNCiAgICAgIC8vIOW3oeajgOS7u+WKoeS4i+aJgOacieW3oeajgOeuoee6vw0KICAgICAgYWxsVGFza0xpbmVzOiBbXSwNCiAgICAgIGlzVmlldzogdHJ1ZSwNCiAgICAgIGFjdGl2ZTogMCwNCiAgICAgIGRldmljZU5hbWU6ICcnLA0KICAgICAgaGFzU2lnbkluOiBmYWxzZSwNCiAgICAgIHNob3dQb3BvdmVyOiBmYWxzZSwNCiAgICAgIGFjdGlvbnM6IFsNCiAgICAgICAgew0KICAgICAgICAgIHRleHQ6ICfpl67popjkuIrmiqUnLA0KICAgICAgICB9LA0KICAgICAgICAvLyB7DQogICAgICAgIC8vICAgdGV4dDogJ+iuvuaWvee8uumZtycsDQogICAgICAgIC8vIH0sDQogICAgICBdLA0KICAgICAgY3VycmVudFJhdGU6IDAsDQogICAgICAvLyDmjqfliLblhbPplK7ngrnliJfooajmmL7pmpANCiAgICAgIHBvaW50TGlzdFNob3c6IGZhbHNlLA0KICAgICAgLy8g5YWo5bGA5Y+R5aOw5Ye95pWwDQogICAgICAvLyDorrDlvZXlvIDlp4vlt6Hmo4DnmoTml7bpl7TvvIznlKjkuo7liKTmlq3mmK/lkKblnKjlvIDlp4vlt6Hmo4DnmoQxMHPlhoUNCiAgICAgIHN0YXJ0UmVjb3JkVGltZXI6ICcnLA0KICAgICAgcmVjb3JkQnV0dG9uTG9hZGluZzogZmFsc2UsDQogICAgICBuYXZiYXJUaXRsZTogJ+aXpeW4uOS7u+WKoScsDQogICAgICAvLyDkuIrmiqXlpLHotKXnmoTlt6Hmo4Dovajov7nngrnkvY3mlbDnu4QNCiAgICAgIHJlcG9ydEZhaWxUcmFja1BvaW50czogW10sDQogICAgICBpc1Nob3dSb3V0ZTogdHJ1ZSwNCiAgICAgIGluc3BCdXNpbmVzc1R5cGU6ICcnLA0KICAgICAgcmVjb3JkRGF0YTogW10sDQogICAgICAvLyDlvZPliY3lt6Hmo4DlkZjmiYDlpITkvY3nva4NCiAgICAgIGN1cnJlbnRQb3NpdGlvbjogbnVsbCwNCiAgICAgIGxpbmVzOiBbXSwNCiAgICAgIGlmUmVjb3JkaW5nOiBmYWxzZSwNCiAgICAgIGVuZFJlY29yZFNob3c6IGZhbHNlLA0KICAgICAgc2VsZWN0RXZlbnRUeXBlOiBmYWxzZSwNCiAgICAgIGV2ZW50VHlwZUxpc3Q6IFtdLA0KICAgICAgc2lnblNob3c6IGZhbHNlLA0KICAgICAgYXR0YWNobWVudDogJycsDQogICAgICBhdHRhY2htZW50MTogJycsDQogICAgICBzaWduRm9ybTogew0KICAgICAgICBtYWludGFpbkltYWdlc0xpc3Q6IFtdLA0KICAgICAgICByZW1hcmtzOiAnJywNCiAgICAgICAgbWFpbnRhaW5UeXBlOiAnJywNCiAgICAgICAgY29udGVudDogJycNCiAgICAgIH0sDQogICAgICB0YXNrRGV0YWlsOiB7DQogICAgICAgIGNvdmVyYWdlOiAnMC8wJywNCiAgICAgICAgcmVwb3J0UmF0ZTogJzAvMCcsDQogICAgICAgIHBsYW5FbmRUaW1lOiAnJywNCiAgICAgIH0sDQogICAgICBlbmdJbmZvRFRPOiB7fSwNCiAgICAgIHRhc2tSZXN0VGltZTogMCwNCiAgICAgIHJlcG9ydEZvb3RlclNob3c6IGZhbHNlLA0KICAgICAgZmVhdHVyZToge30sDQogICAgICBwbGFuRGV0YWlsOiB7fSwNCiAgICAgIC8vIOeUqOS6juWcsOWbvuS4reaYvuekuuiMg+WbtOWSjOWFs+mUrueCuQ0KICAgICAgaW5zcFJhbmdlTGlzdDogW10sDQogICAgICByYW5nZUxpc3Q6IFtdLA0KICAgICAga2V5RGV0YWlsTGlzdDogW10sDQogICAgICBpc1J1bkxpc3Q6IFsNCiAgICAgICAgew0KICAgICAgICAgIG5hbWU6ICfmraPluLgnLA0KICAgICAgICAgIHZhbHVlOiAnMScsDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICBuYW1lOiAn5byC5bi4JywNCiAgICAgICAgICB2YWx1ZTogJzAnLA0KICAgICAgICB9LA0KICAgICAgXSwNCiAgICAgIHJlcG9ydENob3NlOiBbDQogICAgICAgIHsNCiAgICAgICAgICBuYW1lOiAn6Zeu6aKY5LiK5oqlJywNCiAgICAgICAgICB2YWx1ZTogJ+mXrumimOS4iuaKpScsDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICBuYW1lOiAn5paw5aKe57y66Zm3JywNCiAgICAgICAgICB2YWx1ZTogJ+aWsOWinue8uumZtycsDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICBuYW1lOiAn5peg6ZyA5LiK5oqlJywNCiAgICAgICAgICB2YWx1ZTogJ+aXoOmcgOS4iuaKpScsDQogICAgICAgIH0sDQogICAgICBdLA0KICAgICAgcnVsZXM6IHt9LA0KICAgICAgcHJldmlld1VSTDogJy9zeXMtc3RvcmFnZS9kb3dubG9hZF9pbWFnZT9mOHM9JywNCiAgICAgIHVwaW1nUHJldmlldzogW10sDQogICAgICBoZWFkZXJzOiB7fSwNCiAgICAgIHVybDogew0KICAgICAgICAvLyDmnKzpobXpnaLkvb/nlKjliLDnmoR1cmwNCiAgICAgICAgdXBsb2FkRmlsZTogJ3N5cy1zdG9yYWdlL3VwbG9hZCcsDQogICAgICAgIGZpbmRGaWxlOiAnZWNpZGktY21wL2ZpbGUvY21wRmlsZUdyb3VwL2ZpbmRGaWxlc0J5R3JvdXBJZCcsDQogICAgICB9LA0KICAgICAgcG9sbGluZ0ZsYWc6IGZhbHNlLA0KICAgICAgcG9sbGluZ0dhcFRpbWU6IDMsDQogICAgICB0cmFja1BvaW50TGlzdDogW10sDQogICAgICB0cmFja1BvaW50VGltZUxpc3Q6IFtdLA0KICAgICAgb3ZlclNwZWVkVHJhY2tMaW5lTGlzdDogW10sDQogICAgICB0cmFja0xvY2F0aW9uX3N0YXJ0OiAnJywNCiAgICAgIHRyYWNrTG9jYXRpb25fZW5kOiAnJywNCiAgICAgIHNob3dWaXNpYmxlOiBmYWxzZSwNCiAgICAgIGlzTWFzazogZmFsc2UsIC8v5piv5ZCm5pi+56S66YGu572p5bGCDQogICAgICByZXBvcnRTaG93OiBmYWxzZSwgLy8g6Zeu6aKY5LiK5oql6Z2i5p2/5pi+56S6DQogICAgICBhY2Nlc3NUb2tlbjogdGhpcy4kc3RvcmFnZS5nZXQoJ2FjY2Vzc190b2tlbicpLA0KICAgICAgaGVhZGVyOiB7fSwNCiAgICAgIGZvcm1Ub2tlbjogJycsDQogICAgICAvLyDpl67popjkuIrmiqVsaXN0DQogICAgICBwcm9ibGVtRGF0YUxpc3QxOiBbXSwNCiAgICAgIC8vIOiuvuaWvee8uumZt2xpc3QNCiAgICAgIHByb2JsZW1EYXRhTGlzdDI6IFtdLA0KICAgIH0NCiAgfSwNCiAgY29tcHV0ZWQ6IHsNCiAgICBtYWludGVuQ29udGVudHMoKSB7DQogICAgICBjb25zb2xlLmxvZyh0aGlzLiRzdG9yZS5zdGF0ZS5lbnVtWydtYWluQ29udGVudHMnXSkNCiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS5lbnVtWydtYWluQ29udGVudHMnXQ0KICAgIH0sDQogICAgYnV0dG9uTGlzdCgpIHsNCiAgICAgIHJldHVybiBbJ+WFqOmDqCddLmNvbmNhdChKU09OLnBhcnNlKHRoaXMuJHJvdXRlLnF1ZXJ5LmRhdGEpLm1haW50YWluQ29udGVudC5zcGxpdCgnLCcpKQ0KICAgIH0sDQogICAgYnV0dG9uQXJlYVN0eWxlKCkgew0KICAgICAgcmV0dXJuIHsNCiAgICAgICAgJy0td2lkdGgnOiB0aGlzLmJ1dHRvbkxpc3QubGVuZ3RoICogKDgwICsgMTApICsgJ3B4JywNCiAgICAgIH0NCiAgICB9LA0KICAgIGNsaWVudFkoKSB7DQogICAgICByZXR1cm4gZG9jdW1lbnQuYm9keS5jbGllbnRIZWlnaHQNCiAgICB9DQogIH0sDQogIHdhdGNoOiB7DQogICAgcHJvZ3Jlc3ModmFsKSB7DQogICAgICB0aGlzLmhhc01haW4gPSB2YWwuc3BsaXQoJy8nKVswXQ0KICAgICAgdGhpcy5hbGxNYWluID0gdmFsLnNwbGl0KCcvJylbMV0NCiAgICAgIHRoaXMuc3R5bGVWYXJbJy0tYmFyV2lkdGgnXSA9IHBhcnNlSW50KDE0OCAqICh0aGlzLmhhc01haW4gLyB0aGlzLmFsbE1haW4pKSArICdweCcNCiAgICB9DQogIH0sDQogIG1vdW50ZWQoKSB7DQogICAgY29uc29sZS5sb2codGhpcy4kc3RvcmUuc3RhdGUpDQogICAgdGhpcy50YXNrRGF0YSA9IEpTT04ucGFyc2UodGhpcy4kcm91dGUucXVlcnkuZGF0YSkNCiAgICB0aGlzLmlzVmlldyA9IHRoaXMuJHJvdXRlLnF1ZXJ5LmlzVmlldw0KICAgIHRoaXMucHJvZ3Jlc3MgPSB0aGlzLnRhc2tEYXRhLnByb2dyZXNzDQogICAgdGhpcy5uYXZiYXJUaXRsZSA9ICflhbvmiqTku7vliqEnDQogICAgdGhpcy5nZXRNYWluVGFza09iaigpDQogICAgdGhpcy5nZXRNYWluRGV2UG9pbnQoKQ0KICAgIGxldCB0aGF0ID0gdGhpcw0KICAgIGxldCBlbGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2Fycm93VXAnKQ0KICAgIGVsZW0uYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIChlKSA9PiB7DQogICAgICBsZXQgZXZ0ID0gZSB8fCB3aW5kb3cuZXZlbnQNCiAgICAgIGxldCB0b3VjaCA9IGV2dC50YXJnZXRUb3VjaGVzWzBdDQogICAgICBsZXQgY2xpZW50SGVpZ2h0ID0gZG9jdW1lbnQuYm9keS5jbGllbnRIZWlnaHQNCiAgICAgIGxldCBjbGllbnRZID0gdG91Y2guY2xpZW50WQ0KICAgICAgaWYgKGNsaWVudFkgPj0gY2xpZW50SGVpZ2h0ICogMC40ICYmIGNsaWVudFkgPD0gY2xpZW50SGVpZ2h0IC0gMjQpIHsNCiAgICAgICAgdGhhdC5tYWluTGlzdFN0eWxlWyctLXRvcCddID0gY2xpZW50WSArICdweCcNCiAgICAgICAgdGhhdC5tYWluTGlzdFN0eWxlWyctLWhlaWdodCddID0gY2xpZW50SGVpZ2h0IC0gY2xpZW50WSAtIDI0ICsgJ3B4Jw0KICAgICAgfQ0KICAgICAgLy8gZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgZSA9PiB7IGUucHJldmVudERlZmF1bHQoKSB9LCBmYWxzZSkNCiAgICB9KQ0KICAgIGVsZW0uYWRkRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgKGUpID0+IHsNCiAgICAgIGxldCBldnQgPSBlIHx8IHdpbmRvdy5ldmVudA0KICAgICAgbGV0IHRvdWNoID0gZXZ0LnRhcmdldFRvdWNoZXNbMF0NCiAgICAgIGxldCBjbGllbnRIZWlnaHQgPSBkb2N1bWVudC5ib2R5LmNsaWVudEhlaWdodA0KICAgICAgbGV0IGNsaWVudFkgPSB0b3VjaC5jbGllbnRZDQogICAgICBpZiAoY2xpZW50WSA+PSBjbGllbnRIZWlnaHQgKiAwLjQgJiYgY2xpZW50WSA8PSBjbGllbnRIZWlnaHQgLSAyNCkgew0KICAgICAgICB0aGF0Lm1haW5MaXN0U3R5bGVbJy0tdG9wJ10gPSBjbGllbnRZICsgJ3B4Jw0KICAgICAgICB0aGF0Lm1haW5MaXN0U3R5bGVbJy0taGVpZ2h0J10gPSBjbGllbnRIZWlnaHQgLSBjbGllbnRZIC0gMjQgKyAncHgnDQogICAgICB9DQogICAgfSkNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIGdldEdyaWRSYW5nZSgpIHsNCiAgICAgIGFwaS5nZXRHcmlkUmFuZ2Uoew0KICAgICAgICBwYWdlTnVtOiAxLA0KICAgICAgICBwYWdlU2l6ZTogOTk5DQogICAgICB9KS50aGVuKHJlcyA9PiB7DQogICAgICAgIGlmIChyZXMuc3RhdHVzKSB7DQogICAgICAgICAgbGV0IGZlYXRzID0gW10NCiAgICAgICAgICB0aGlzLm1haW50ZW5SYW5nZUxpc3QgPSByZXMuZGF0YS5saXN0LmZpbHRlcihpdCA9PiBpdC5pbnNwR3JpZC5pZCA9PSB0aGlzLnRhc2tEYXRhLmdyaWRJZCkNCiAgICAgICAgICBsZXQgY29vcmRMaXN0ID0gW10NCiAgICAgICAgICB0aGlzLm1haW50ZW5SYW5nZUxpc3QubGVuZ3RoID4gMCAmJiB0aGlzLm1haW50ZW5SYW5nZUxpc3RbMF0uZGV0YWlsTGlzdC5mb3JFYWNoKGl0ID0+IHsNCiAgICAgICAgICAgIGNvb3JkTGlzdC5wdXNoKEpTT04ucGFyc2UoaXQuZ3JpZEdlb20pLmNvb3JkaW5hdGVzKQ0KICAgICAgICAgIH0pDQogICAgICAgICAgdGhpcy50b01haW5SYW5nZShjb29yZExpc3QpDQogICAgICAgICAgdGhpcy5tYWludGVuUmFuZ2VMaXN0Lmxlbmd0aCA+IDAgJiYgdGhpcy5tYWludGVuUmFuZ2VMaXN0WzBdLmRldGFpbExpc3QuZm9yRWFjaChpdCA9PiB7DQogICAgICAgICAgICBmZWF0cy5wdXNoKHsNCiAgICAgICAgICAgICAgdHlwZTogJ0ZlYXR1cmUnLA0KICAgICAgICAgICAgICBnZW9tZXRyeTogSlNPTi5wYXJzZShpdC5ncmlkR2VvbSkNCiAgICAgICAgICAgIH0pDQogICAgICAgICAgfSkNCiAgICAgICAgICB0aGlzLnNldFNvdXJjZURhdGEoJ21haW5SYW5nZVNvdXJjZScsIHsNCiAgICAgICAgICAgIHR5cGU6ICdGZWF0dXJlQ29sbGVjdGlvbicsDQogICAgICAgICAgICBmZWF0dXJlczogZmVhdHMNCiAgICAgICAgICB9KQ0KICAgICAgICB9DQogICAgICB9KQ0KICAgIH0sDQogICAgZ2V0TWFpblJhbmdlQnlJZChpZHMpIHsNCiAgICAgIHRoaXMubWFpbnRlblJhbmdlTGlzdCA9IFtdDQogICAgICBQcm9taXNlLmFsbChpZHMuc3BsaXQoJywnKS5tYXAoaWQgPT4gYXBpLmdldE1haW5SYW5nZUJ5SWQoeyBpZCB9KSkpLnRoZW4ocmVzZXMgPT4gew0KICAgICAgICByZXNlcy5mb3JFYWNoKHJlcyA9PiB7DQogICAgICAgICAgaWYgKHJlcy5zdGF0dXMpIHsNCiAgICAgICAgICAgIHRoaXMubWFpbnRlblJhbmdlTGlzdC5wdXNoKC4uLnJlcy5kYXRhLm1haW50YWluUmFuZ2VDaGlsZExpc3QpDQogICAgICAgICAgfQ0KICAgICAgICB9KQ0KICAgICAgICBsZXQgY29vcmRMaXN0ID0gW10NCiAgICAgICAgdGhpcy5tYWludGVuUmFuZ2VMaXN0Lmxlbmd0aCA+IDAgJiYgdGhpcy5tYWludGVuUmFuZ2VMaXN0LmZvckVhY2goaXQgPT4gew0KICAgICAgICAgIGNvb3JkTGlzdC5wdXNoKEpTT04ucGFyc2UoaXQuZ2VvbSkuY29vcmRpbmF0ZXMpDQogICAgICAgIH0pDQogICAgICAgIHRoaXMudG9NYWluUmFuZ2UoY29vcmRMaXN0KQ0KICAgICAgICBsZXQgZmVhdHMgPSBbXQ0KICAgICAgICB0aGlzLm1haW50ZW5SYW5nZUxpc3QubGVuZ3RoID4gMCAmJiB0aGlzLm1haW50ZW5SYW5nZUxpc3QuZm9yRWFjaChpdCA9PiB7DQogICAgICAgICAgZmVhdHMucHVzaCh7DQogICAgICAgICAgICB0eXBlOiAnRmVhdHVyZScsDQogICAgICAgICAgICBnZW9tZXRyeTogSlNPTi5wYXJzZShpdC5nZW9tKQ0KICAgICAgICAgIH0pDQogICAgICAgIH0pDQogICAgICAgIHRoaXMuc2V0U291cmNlRGF0YSgnbWFpblJhbmdlU291cmNlJywgew0KICAgICAgICAgIHR5cGU6ICdGZWF0dXJlQ29sbGVjdGlvbicsDQogICAgICAgICAgZmVhdHVyZXM6IGZlYXRzDQogICAgICAgIH0pDQogICAgICB9KQ0KICAgIH0sDQogICAgdG9NYWluUmFuZ2UoY29vcmRMaXN0KSB7DQogICAgICBsZXQgcG9seWdvbkxpc3QgPSBjb29yZExpc3QubWFwKGl0ID0+IHR1cmYucG9seWdvbihpdCkpDQogICAgICBsZXQgYmJveCA9IHR1cmYuYmJveCh7DQogICAgICAgIHR5cGU6IkZlYXR1cmVDb2xsZWN0aW9uIiwNCiAgICAgICAgZmVhdHVyZXM6IHBvbHlnb25MaXN0DQogICAgICB9KTsNCiAgICAgIGxldCB0aW1lciA9IHNldEludGVydmFsKCgpID0+IHsNCiAgICAgICAgaWYgKG1hcE9iai5tYXApIHsNCiAgICAgICAgICBjbGVhckludGVydmFsKHRpbWVyKQ0KICAgICAgICAgIG1hcE9iai5tYXAuZml0Qm91bmRzKGJib3gsIHsNCiAgICAgICAgICAgIHBhZGRpbmc6IHt0b3A6IDEwLCBib3R0b206MjUsIGxlZnQ6IDE1LCByaWdodDogNX0NCiAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgICAgfSwgNTAwKQ0KICAgIH0sDQogICAgY2hhbmdlQ2hlY2tCb3godmFsKSB7DQogICAgICB0aGlzLnNpZ25Gb3JtLmNvbnRlbnQgPSB2YWwuam9pbignLCcpDQogICAgfSwNCiAgICBnb1RvRGVhbChvYmopIHsNCiAgICAgIGlmIChvYmouc3RhcnRMb25naXR1ZGUgJiYgb2JqLnN0YXJ0TGF0aXR1ZGUpIHsNCiAgICAgICAgdGhpcy5tYWluTGlzdFN0eWxlWyctLXRvcCddID0gZG9jdW1lbnQuYm9keS5jbGllbnRIZWlnaHQgLSAyNCArICdweCcNCiAgICAgICAgdGhpcy5tYWluTGlzdFN0eWxlWyctLWhlaWdodCddID0gJzI0cHgnDQogICAgICAgIGlmIChvYmouZGV2aWNlVHlwZSA9PSAn566h57q/Jykgew0KICAgICAgICAgIGxldCBwb2ludDEgPSB0dXJmLnBvaW50KFtvYmouc3RhcnRMb25naXR1ZGUsIG9iai5zdGFydExhdGl0dWRlXSkNCiAgICAgICAgICBsZXQgcG9pbnQyID0gdHVyZi5wb2ludChbb2JqLmVuZExvbmdpdHVkZSwgb2JqLmVuZExhdGl0dWRlXSkNCiAgICAgICAgICBsZXQgbWlkcG9pbnQgPSB0dXJmLm1pZHBvaW50KHBvaW50MSwgcG9pbnQyKQ0KICAgICAgICAgIHRoaXMuZmx5VG9Qb2ludChtaWRwb2ludC5nZW9tZXRyeS5jb29yZGluYXRlcykNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICB0aGlzLmZseVRvUG9pbnQoW29iai5zdGFydExvbmdpdHVkZSwgb2JqLnN0YXJ0TGF0aXR1ZGVdKQ0KICAgICAgICB9DQogICAgICB9IGVsc2Ugew0KICAgICAgICBUb2FzdC53YXJuaW5nKHsNCiAgICAgICAgICBtZXNzYWdlOiAn5b2T5YmN6K6+5pa95peg5Zyw55CG5Z2Q5qCH5L+h5oGvJywNCiAgICAgICAgICBkdXJhdGlvbjogMjAwMA0KICAgICAgICB9KQ0KICAgICAgICByZXR1cm4NCiAgICAgIH0NCiAgICB9LA0KICAgIGZpbHRlcklzTWFpbkxpc3QoaXQpIHsNCiAgICAgIHRoaXMuY3VycmVudFNlbGVJc01haW5UeXBlID0gaXQNCiAgICAgIGlmIChpdCA9PSAn5YWo6YOoJykgew0KICAgICAgICB0aGlzLm1haW50ZW5PYmouaXNNYWluID0gY3VycmVudE1haW5Qb2ludC5pc01haW4NCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHRoaXMubWFpbnRlbk9iai5pc01haW4gPSBjdXJyZW50TWFpblBvaW50LmlzTWFpbi5maWx0ZXIoDQogICAgICAgICAgKGl0ZW0pID0+IGl0ZW0uZGV2aWNlVHlwZSA9PSBpdA0KICAgICAgICApDQogICAgICB9DQogICAgfSwNCiAgICBmaWx0ZXJJc05vdE1haW5MaXN0KGl0KSB7DQogICAgICB0aGlzLmN1cnJlbnRTZWxlSXNOb3RNYWluVHlwZSA9IGl0DQogICAgICBpZiAoaXQgPT0gJ+WFqOmDqCcpIHsNCiAgICAgICAgdGhpcy5tYWludGVuT2JqLmlzTm90TWFpbiA9IGN1cnJlbnRNYWluUG9pbnQuaXNOb3RNYWluDQogICAgICB9IGVsc2Ugew0KICAgICAgICB0aGlzLm1haW50ZW5PYmouaXNOb3RNYWluID0gY3VycmVudE1haW5Qb2ludC5pc05vdE1haW4uZmlsdGVyKA0KICAgICAgICAgIChpdGVtKSA9PiBpdGVtLmRldmljZVR5cGUgPT0gaXQNCiAgICAgICAgKQ0KICAgICAgfQ0KICAgIH0sDQogICAgb25Mb2FkKCkge30sDQogICAgYWRkTWFpblNvdXJjZUxheWVyKCkgew0KICAgICAgbWFwT2JqLm1hcC5hZGRTb3VyY2UoJ21haW5SYW5nZVNvdXJjZScsIHsNCiAgICAgICAgdHlwZTogJ2dlb2pzb24nLA0KICAgICAgICBkYXRhOiB7DQogICAgICAgICAgdHlwZTogJ0ZlYXR1cmVDb2xsZWN0aW9uJywNCiAgICAgICAgICBmZWF0dXJlczogW10sDQogICAgICAgIH0sDQogICAgICB9KQ0KICAgICAgbWFwT2JqLm1hcC5hZGRTb3VyY2UoJ21haW5EZXZQb2ludFNvdXJjZScsIHsNCiAgICAgICAgdHlwZTogJ2dlb2pzb24nLA0KICAgICAgICBkYXRhOiB7DQogICAgICAgICAgdHlwZTogJ0ZlYXR1cmVDb2xsZWN0aW9uJywNCiAgICAgICAgICBmZWF0dXJlczogW10sDQogICAgICAgIH0sDQogICAgICB9KQ0KICAgICAgbWFwT2JqLm1hcC5hZGRTb3VyY2UoJ21haW5EZXZMaW5lU291cmNlJywgew0KICAgICAgICB0eXBlOiAnZ2VvanNvbicsDQogICAgICAgIGRhdGE6IHsNCiAgICAgICAgICB0eXBlOiAnRmVhdHVyZUNvbGxlY3Rpb24nLA0KICAgICAgICAgIGZlYXR1cmVzOiBbXSwNCiAgICAgICAgfSwNCiAgICAgIH0pDQogICAgICBtYXBPYmoubWFwLmFkZFNvdXJjZSgncGlja01haW5EZXZMaW5lU291cmNlJywgew0KICAgICAgICB0eXBlOiAnZ2VvanNvbicsDQogICAgICAgIGRhdGE6IHsNCiAgICAgICAgICB0eXBlOiAnRmVhdHVyZUNvbGxlY3Rpb24nLA0KICAgICAgICAgIGZlYXR1cmVzOiBbXSwNCiAgICAgICAgfSwNCiAgICAgIH0pDQogICAgICBtYXBPYmoubWFwLmFkZFNvdXJjZSgncGlja01haW5EZXZQb2ludFNvdXJjZScsIHsNCiAgICAgICAgdHlwZTogJ2dlb2pzb24nLA0KICAgICAgICBkYXRhOiB7DQogICAgICAgICAgdHlwZTogJ0ZlYXR1cmVDb2xsZWN0aW9uJywNCiAgICAgICAgICBmZWF0dXJlczogW10sDQogICAgICAgIH0sDQogICAgICB9KQ0KICAgICAgLy8gbWFwT2JqLm1hcC5hZGRMYXllcih7DQogICAgICAvLyAgIGlkOiAnbWFpblJhbmdlRmlsbExheWVyJywNCiAgICAgIC8vICAgdHlwZTogJ2ZpbGwnLA0KICAgICAgLy8gICBzb3VyY2U6ICdtYWluUmFuZ2VTb3VyY2UnLA0KICAgICAgLy8gICBwYWludDogew0KICAgICAgLy8gICAgICdmaWxsLWNvbG9yJzogJyMzMkM1RkYnLA0KICAgICAgLy8gICAgICdmaWxsLW9wYWNpdHknOiAwLjMsDQogICAgICAvLyAgIH0sDQogICAgICAvLyB9KQ0KICAgICAgbWFwT2JqLm1hcC5hZGRMYXllcih7DQogICAgICAgIGlkOiAnbWFpblJhbmdlTGluZUxheWVyJywNCiAgICAgICAgdHlwZTogJ2xpbmUnLA0KICAgICAgICBzb3VyY2U6ICdtYWluUmFuZ2VTb3VyY2UnLA0KICAgICAgICBwYWludDogew0KICAgICAgICAgICdsaW5lLW9wYWNpdHknOiAxLA0KICAgICAgICAgICdsaW5lLXdpZHRoJzogMS41LA0KICAgICAgICAgICdsaW5lLWNvbG9yJzogJyMzMkM1RkYnLA0KICAgICAgICAgICdsaW5lLWRhc2hhcnJheSc6IFs0LCA0XSwNCiAgICAgICAgfSwNCiAgICAgIH0pDQogICAgICBtYXBPYmoubWFwLmFkZExheWVyKA0KICAgICAgICB7DQogICAgICAgICAgaWQ6ICdtYWluRGV2UGlwZUxheWVyJywNCiAgICAgICAgICB0eXBlOiAnbGluZScsDQogICAgICAgICAgc291cmNlOiAnbWFpbkRldkxpbmVTb3VyY2UnLA0KICAgICAgICAgIHBhaW50OiB7DQogICAgICAgICAgICAnbGluZS1vcGFjaXR5JzogMSwNCiAgICAgICAgICAgICdsaW5lLXdpZHRoJzogNCwNCiAgICAgICAgICAgICdsaW5lLWNvbG9yJzogWw0KICAgICAgICAgICAgICAnbWF0Y2gnLA0KICAgICAgICAgICAgICBbJ2dldCcsICdpc01haW4nXSwNCiAgICAgICAgICAgICAgJ3RydWUnLA0KICAgICAgICAgICAgICAnIzJkYzM0ZCcsDQogICAgICAgICAgICAgICdmYWxzZScsDQogICAgICAgICAgICAgICcjZmZkMTQxJywNCiAgICAgICAgICAgICAgJyNmZmQxNDEnDQogICAgICAgICAgICBdDQogICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICAncmRfbWFwX291dGZhbGwnDQogICAgICApDQogICAgICBtYXBPYmoubWFwLmFkZExheWVyKA0KICAgICAgICB7DQogICAgICAgICAgaWQ6ICdwaWNrTWFpbkRldlBpcGVMYXllcicsDQogICAgICAgICAgdHlwZTogJ2xpbmUnLA0KICAgICAgICAgIHNvdXJjZTogJ3BpY2tNYWluRGV2TGluZVNvdXJjZScsDQogICAgICAgICAgcGFpbnQ6IHsNCiAgICAgICAgICAgICdsaW5lLW9wYWNpdHknOiAxLA0KICAgICAgICAgICAgJ2xpbmUtd2lkdGgnOiA2LA0KICAgICAgICAgICAgJ2xpbmUtY29sb3InOiBbDQogICAgICAgICAgICAgICdtYXRjaCcsDQogICAgICAgICAgICAgIFsnZ2V0JywgJ2lzTWFpbiddLA0KICAgICAgICAgICAgICAndHJ1ZScsDQogICAgICAgICAgICAgICcjMmRjMzRkJywNCiAgICAgICAgICAgICAgJ2ZhbHNlJywNCiAgICAgICAgICAgICAgJyNmZmQxNDEnLA0KICAgICAgICAgICAgICAnI2ZmZDE0MScNCiAgICAgICAgICAgIF0NCiAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgICdyZF9tYXBfb3V0ZmFsbCcNCiAgICAgICkNCiAgICAgIG1hcE9iai5tYXAuYWRkTGF5ZXIoDQogICAgICAgIHsNCiAgICAgICAgICBpZDogJ21haW5EZXZQb2ludExheWVyJywNCiAgICAgICAgICB0eXBlOiAnY2lyY2xlJywNCiAgICAgICAgICBzb3VyY2U6ICdtYWluRGV2UG9pbnRTb3VyY2UnLA0KICAgICAgICAgIHBhaW50OiB7DQogICAgICAgICAgICAnY2lyY2xlLW9wYWNpdHknOiAxLA0KICAgICAgICAgICAgJ2NpcmNsZS1yYWRpdXMnOiBbDQogICAgICAgICAgICAgICdpbnRlcnBvbGF0ZScsDQogICAgICAgICAgICAgIFsnbGluZWFyJ10sDQogICAgICAgICAgICAgIFsnem9vbSddLA0KICAgICAgICAgICAgICAxMi41LA0KICAgICAgICAgICAgICA1LA0KICAgICAgICAgICAgICAxNywNCiAgICAgICAgICAgICAgMTAsDQogICAgICAgICAgICBdLA0KICAgICAgICAgICAgJ2NpcmNsZS1jb2xvcic6IFsNCiAgICAgICAgICAgICAgJ21hdGNoJywNCiAgICAgICAgICAgICAgWydnZXQnLCAnaXNNYWluJ10sDQogICAgICAgICAgICAgICd0cnVlJywNCiAgICAgICAgICAgICAgJyMyZGMzNGQnLA0KICAgICAgICAgICAgICAnZmFsc2UnLA0KICAgICAgICAgICAgICAnI2ZmZDE0MScsDQogICAgICAgICAgICAgICcjZmZkMTQxJw0KICAgICAgICAgICAgXQ0KICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgJ21hcF9zdXBwbHlfcGlwZV9kaXN0cmlidXRlJw0KICAgICAgKQ0KICAgICAgbWFwT2JqLm1hcC5hZGRMYXllcigNCiAgICAgICAgew0KICAgICAgICAgIGlkOiAncGlja01haW5EZXZQb2ludExheWVyJywNCiAgICAgICAgICB0eXBlOiAnY2lyY2xlJywNCiAgICAgICAgICBzb3VyY2U6ICdwaWNrTWFpbkRldlBvaW50U291cmNlJywNCiAgICAgICAgICBwYWludDogew0KICAgICAgICAgICAgJ2NpcmNsZS1vcGFjaXR5JzogMSwNCiAgICAgICAgICAgICdjaXJjbGUtcmFkaXVzJzogWw0KICAgICAgICAgICAgICAnaW50ZXJwb2xhdGUnLA0KICAgICAgICAgICAgICBbJ2xpbmVhciddLA0KICAgICAgICAgICAgICBbJ3pvb20nXSwNCiAgICAgICAgICAgICAgMTIuNSwNCiAgICAgICAgICAgICAgMTAsDQogICAgICAgICAgICAgIDE3LA0KICAgICAgICAgICAgICAxNSwNCiAgICAgICAgICAgIF0sDQogICAgICAgICAgICAnY2lyY2xlLWNvbG9yJzogWw0KICAgICAgICAgICAgICAnbWF0Y2gnLA0KICAgICAgICAgICAgICBbJ2dldCcsICdpc01haW4nXSwNCiAgICAgICAgICAgICAgJ3RydWUnLA0KICAgICAgICAgICAgICAnIzJkYzM0ZCcsDQogICAgICAgICAgICAgICdmYWxzZScsDQogICAgICAgICAgICAgICcjZmZkMTQxJywNCiAgICAgICAgICAgICAgJyNmZmQxNDEnDQogICAgICAgICAgICBdDQogICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICAnbWFwX3N1cHBseV9waXBlX2Rpc3RyaWJ1dGUnDQogICAgICApDQogICAgICBtYXBPYmoubWFwLm9uKCdtb3VzZW92ZXInLCAnbWFpbkRldlBpcGVMYXllcicsICgpID0+IHsNCiAgICAgICAgbWFwT2JqLm1hcC5nZXRDYW52YXMoKS5zdHlsZS5jdXJzb3IgPSAncG9pbnRlcicNCiAgICAgIH0pDQogICAgICBtYXBPYmoubWFwLm9uKCdtb3VzZW92ZXInLCAnbWFpbkRldlBvaW50TGF5ZXInLCAoKSA9PiB7DQogICAgICAgIG1hcE9iai5tYXAuZ2V0Q2FudmFzKCkuc3R5bGUuY3Vyc29yID0gJ3BvaW50ZXInDQogICAgICB9KQ0KICAgICAgbWFwT2JqLm1hcC5vbignbW91c2VvdXQnLCAnbWFpbkRldlBpcGVMYXllcicsICgpID0+IHsNCiAgICAgICAgbWFwT2JqLm1hcC5nZXRDYW52YXMoKS5zdHlsZS5jdXJzb3IgPSAnJw0KICAgICAgfSkNCiAgICAgIG1hcE9iai5tYXAub24oJ21vdXNlb3V0JywgJ21haW5EZXZQb2ludExheWVyJywgKCkgPT4gew0KICAgICAgICBtYXBPYmoubWFwLmdldENhbnZhcygpLnN0eWxlLmN1cnNvciA9ICcnDQogICAgICB9KQ0KICAgICAgbWFwT2JqLm1hcC5vbignY2xpY2snLCAnbWFpbkRldlBpcGVMYXllcicsIHRoaXMubWFpbkRldGFpbEluZm8pDQogICAgICBtYXBPYmoubWFwLm9uKCdjbGljaycsICdtYWluRGV2UG9pbnRMYXllcicsIHRoaXMubWFpbkRldGFpbEluZm8pDQogICAgfSwNCiAgICBhZGRNYWluVXNlclNvdXJjZUxheWVyKCkgew0KICAgICAgbWFwT2JqLm1hcC5hZGRTb3VyY2UoIm1haW5Vc2VyIiwgew0KICAgICAgICB0eXBlOiAiZ2VvanNvbiIsDQogICAgICAgIGRhdGE6IHsNCiAgICAgICAgICB0eXBlOiAiRmVhdHVyZUNvbGxlY3Rpb24iLA0KICAgICAgICAgIGZlYXR1cmVzOiBbXQ0KICAgICAgICB9DQogICAgICB9KTsNCiAgICAgIG1hcE9iai5tYXAuYWRkTGF5ZXIoew0KICAgICAgICBpZDogIm1haW5Vc2VyTGF5ZXIiLA0KICAgICAgICB0eXBlOiAic3ltYm9sIiwNCiAgICAgICAgc291cmNlOiAibWFpblVzZXIiLA0KICAgICAgICBsYXlvdXQ6IHsNCiAgICAgICAgICAiaWNvbi1pbWFnZSI6ICJ1c2VySW5zcCIsDQogICAgICAgICAgImljb24tc2l6ZSI6IDAuMiwNCiAgICAgICAgICAiaWNvbi1hbGxvdy1vdmVybGFwIjogdHJ1ZSwgLy/oh6rliqjpgb/orqnlsZ7mgKcNCiAgICAgICAgICAiaWNvbi1pZ25vcmUtcGxhY2VtZW50IjogdHJ1ZQ0KICAgICAgICB9DQogICAgICB9KTsNCiAgICB9LA0KICAgIC8vIOa3u+WKoOe8k+WGsuWMuueahOWbvuWxgg0KICAgIGFkZEJ1ZmZlckxheWVyKCkgew0KICAgICAgbWFwT2JqLm1hcC5hZGRTb3VyY2UoJ2J1ZmZlcmVkJywgew0KICAgICAgICB0eXBlOiAnZ2VvanNvbicsDQogICAgICAgIGRhdGE6IHsNCiAgICAgICAgICB0eXBlOiAnRmVhdHVyZUNvbGxlY3Rpb24nLA0KICAgICAgICAgIGZlYXR1cmVzOiBbXSwNCiAgICAgICAgfSwNCiAgICAgIH0pDQogICAgICBtYXBPYmoubWFwLmFkZExheWVyKA0KICAgICAgICB7DQogICAgICAgICAgaWQ6ICdidWZmZXJMYXllcicsDQogICAgICAgICAgdHlwZTogJ2ZpbGwnLA0KICAgICAgICAgIHNvdXJjZTogJ2J1ZmZlcmVkJywNCiAgICAgICAgICBwYWludDogew0KICAgICAgICAgICAgJ2ZpbGwtY29sb3InOiAnI0ZGQjZDMScsDQogICAgICAgICAgICAnZmlsbC1vcGFjaXR5JzogMC41LA0KICAgICAgICAgIH0sDQogICAgICAgIH0sDQogICAgICAgICdyZF9tYXBfZHJhaW5waXBlX3lzX2JpZ19kaXJlY3Rpb24nDQogICAgICApDQogICAgfSwNCiAgICAvLyDnlLvljYrlvoTkuLpyYWRpdXPnmoTlnIbojIPlm7QNCiAgICBkcmF3QnVmZmVyKHBvaW50LCByYWRpdXMgPSAwLjAzNSkgew0KICAgICAgbGV0IGJ1ZmZlcmVkID0gdHVyZi5idWZmZXIocG9pbnQsIHJhZGl1cywgeyB1bml0OiAna2lsb21ldGVycycgfSkNCiAgICAgIHRoaXMuc2V0U291cmNlRGF0YSgnYnVmZmVyZWQnLCB7DQogICAgICAgIHR5cGU6ICdGZWF0dXJlQ29sbGVjdGlvbicsDQogICAgICAgIGZlYXR1cmVzOiBbYnVmZmVyZWRdLA0KICAgICAgfSkNCiAgICB9LA0KICAgIG1haW5EZXRhaWxJbmZvKGUpIHsNCiAgICAgIGxldCBmZWF0cyA9IG1hcE9iai5tYXAucXVlcnlSZW5kZXJlZEZlYXR1cmVzKGUucG9pbnQsIHsNCiAgICAgICAgbGF5ZXJzOiBbJ21haW5EZXZQaXBlTGF5ZXInLCAnbWFpbkRldlBvaW50TGF5ZXInXQ0KICAgICAgfSkNCiAgICAgIGlmICghdGhpcy5pZlN0YXJ0ICYmIGZlYXRzWzBdLnByb3BlcnRpZXMuaXNNYWluID09ICd0cnVlJykgew0KICAgICAgfSBlbHNlIGlmKCF0aGlzLmlmU3RhcnQpIHsNCiAgICAgICAgVG9hc3Qud2FybmluZyh7DQogICAgICAgICAgbWVzc2FnZTogJ+S7u+WKoeacquW8gOWni++8jOaXoOazleWFu+aKpCcsDQogICAgICAgICAgZHVyYXRpb246IDIwMDANCiAgICAgICAgfSkNCiAgICAgICAgcmV0dXJuDQogICAgICB9DQogICAgICAvLyDliKnnlKhmZWF0dXJl5p2l5Yik5pat5piv5ZCm5aSE5LqOMzVt6IyD5Zu05YaF77yM5aaC5p6c5aSE5LqO77yM5Y+v5Lul6L+b6KGM562+5Yiw77yM5ZCm5YiZ5LiN6IO96L+b6KGM562+5YiwDQogICAgICAvLyBjb25zdCBwb3NpdGlvbiA9IHRoaXMuY3VycmVudFBvc2l0aW9uDQogICAgICAvLyBpZiAoIXBvc2l0aW9uKSB7DQogICAgICAvLyAgIFRvYXN0Lndhcm5pbmcoew0KICAgICAgLy8gICAgIG1lc3NhZ2U6ICfojrflj5bkuI3liLDlt6Hmo4DkurrkvY3nva4nLA0KICAgICAgLy8gICAgIGR1cmF0aW9uOiAyMDAwLA0KICAgICAgLy8gICB9KQ0KICAgICAgLy8gICByZXR1cm4NCiAgICAgIC8vIH0NCiAgICAgIC8vIGNvbnN0IGNvb3JkID0gWw0KICAgICAgLy8gICBwYXJzZUZsb2F0KHBvc2l0aW9uLmxvbmdpdHVkZSksDQogICAgICAvLyAgIHBhcnNlRmxvYXQocG9zaXRpb24ubGF0aXR1ZGUpLA0KICAgICAgLy8gXQ0KICAgICAgLy8gY29uc3QgcG9pbnQgPSB0dXJmLnBvaW50KGNvb3JkKQ0KICAgICAgLy8gY29uc3QgZW5nR2VvbSA9IGZlYXR1cmUuZ2VvbQ0KICAgICAgLy8gY29uc3QgYnVmZmVyZWQgPSB0dXJmLmJ1ZmZlcihlbmdHZW9tLCAwLjAzNSwgeyB1bml0OiAna2lsb21ldGVycycgfSkNCiAgICAgIC8vIGNvbnN0IGlzSW5CdWZmZXIgPSB0dXJmLmluc2lkZShwb2ludCwgYnVmZmVyZWQpDQogICAgICAvLyBpZiAoIWlzSW5CdWZmZXIpIHsNCiAgICAgIC8vICAgVG9hc3Qoew0KICAgICAgLy8gICAgIG1lc3NhZ2U6ICfmnKrlpITkuo7or6XlhbPplK7ngrnojIPlm7TlhoUnLA0KICAgICAgLy8gICAgIGR1cmF0aW9uOiAyMDAwLA0KICAgICAgLy8gICB9KQ0KICAgICAgLy8gICByZXR1cm4NCiAgICAgIC8vIH0NCiAgICAgIGNvbnNvbGUubG9nKHRoaXMuJHN0b3JlLnN0YXRlLmVudW1bJ21haW5Db250ZW50cyddKQ0KICAgICAgdGhpcy5tYWludGVuQ29udGVudHNMaXN0ID0gW10NCiAgICAgIHRoaXMuY3VycmVudFNlbGVjdERldiA9IGZlYXRzWzBdDQogICAgICBpZiAoZmVhdHNbMF0ucHJvcGVydGllcy5kZXZpY2VUeXBlID09ICfmo4Dmn6XkupUnICYmIChmZWF0c1swXS5wcm9wZXJ0aWVzLmJpelR5cGUgPT0gJ+axoeawtCcgfHwgZmVhdHNbMF0ucHJvcGVydGllcy5iaXpUeXBlID09ICfpm6jmsLQnKSkgew0KICAgICAgICBsZXQgYXJyID0gdGhpcy5tYWludGVuQ29udGVudHMuZmlsdGVyKGl0ID0+IGl0Wyd6aC1DTiddID09ICfmsaHmsLTmo4Dmn6XkupUnKQ0KICAgICAgICBhcnJbMF0uY2hpbGQuZm9yRWFjaChpdGVtID0+IHsNCiAgICAgICAgICB0aGlzLm1haW50ZW5Db250ZW50c0xpc3QucHVzaCh7DQogICAgICAgICAgICBuYW1lOiBpdGVtWyd6aC1DTiddLA0KICAgICAgICAgICAgdmFsdWU6IGl0ZW0uY29kZQ0KICAgICAgICAgIH0pDQogICAgICAgIH0pDQogICAgICB9IGVsc2UgaWYgKGZlYXRzWzBdLnByb3BlcnRpZXMuZGV2aWNlVHlwZSA9PSAn566h57q/JyAmJiAoZmVhdHNbMF0ucHJvcGVydGllcy5iaXpUeXBlID09ICfmsaHmsLQnIHx8IGZlYXRzWzBdLnByb3BlcnRpZXMuYml6VHlwZSA9PSAn6Zuo5rC0JykpIHsNCiAgICAgICAgbGV0IGFyciA9IHRoaXMubWFpbnRlbkNvbnRlbnRzLmZpbHRlcihpdCA9PiBpdFsnemgtQ04nXSA9PSAn5o6S5rC0566h6YGTJykNCiAgICAgICAgYXJyWzBdLmNoaWxkLmZvckVhY2goaXRlbSA9PiB7DQogICAgICAgICAgdGhpcy5tYWludGVuQ29udGVudHNMaXN0LnB1c2goew0KICAgICAgICAgICAgbmFtZTogaXRlbVsnemgtQ04nXSwNCiAgICAgICAgICAgIHZhbHVlOiBpdGVtLmNvZGUNCiAgICAgICAgICB9KQ0KICAgICAgICB9KQ0KICAgICAgfSBlbHNlIGlmIChmZWF0c1swXS5wcm9wZXJ0aWVzLmRldmljZVR5cGUgPT0gJ+mbqOawtOWPoycpIHsNCiAgICAgICAgbGV0IGFyciA9IHRoaXMubWFpbnRlbkNvbnRlbnRzLmZpbHRlcihpdCA9PiBpdFsnemgtQ04nXSA9PSAn6Zuo5rC05Y+jJykNCiAgICAgICAgYXJyWzBdLmNoaWxkLmZvckVhY2goaXRlbSA9PiB7DQogICAgICAgICAgdGhpcy5tYWludGVuQ29udGVudHNMaXN0LnB1c2goew0KICAgICAgICAgICAgbmFtZTogaXRlbVsnemgtQ04nXSwNCiAgICAgICAgICAgIHZhbHVlOiBpdGVtLmNvZGUNCiAgICAgICAgICB9KQ0KICAgICAgICB9KQ0KICAgICAgfSBlbHNlIGlmIChmZWF0c1swXS5wcm9wZXJ0aWVzLmRldmljZVR5cGUgPT0gJ+euoee6vycgJiYgKGZlYXRzWzBdLnByb3BlcnRpZXMuYml6VHlwZSA9PSAn6YWN5rC0JyB8fCBmZWF0c1swXS5wcm9wZXJ0aWVzLmJpelR5cGUgPT0gJ+WOn+awtCcgfHwgZmVhdHNbMF0ucHJvcGVydGllcy5iaXpUeXBlID09ICfovpPmsLQnKSkgew0KICAgICAgICBsZXQgYXJyID0gdGhpcy5tYWludGVuQ29udGVudHMuZmlsdGVyKGl0ID0+IGl0Wyd6aC1DTiddID09ICfkvpvmsLTnrqHpgZMnKQ0KICAgICAgICBhcnJbMF0uY2hpbGQuZm9yRWFjaChpdGVtID0+IHsNCiAgICAgICAgICB0aGlzLm1haW50ZW5Db250ZW50c0xpc3QucHVzaCh7DQogICAgICAgICAgICBuYW1lOiBpdGVtWyd6aC1DTiddLA0KICAgICAgICAgICAgdmFsdWU6IGl0ZW0uY29kZQ0KICAgICAgICAgIH0pDQogICAgICAgIH0pDQogICAgICB9IGVsc2UgaWYgKGZlYXRzWzBdLnByb3BlcnRpZXMuZGV2aWNlVHlwZSA9PSAn6ZiA6ZeoJykgew0KICAgICAgICBsZXQgYXJyID0gdGhpcy5tYWludGVuQ29udGVudHMuZmlsdGVyKGl0ID0+IGl0Wyd6aC1DTiddID09ICfpmIDpl6gnKQ0KICAgICAgICBhcnJbMF0uY2hpbGQuZm9yRWFjaChpdGVtID0+IHsNCiAgICAgICAgICB0aGlzLm1haW50ZW5Db250ZW50c0xpc3QucHVzaCh7DQogICAgICAgICAgICBuYW1lOiBpdGVtWyd6aC1DTiddLA0KICAgICAgICAgICAgdmFsdWU6IGl0ZW0uY29kZQ0KICAgICAgICAgIH0pDQogICAgICAgIH0pDQogICAgICB9IGVsc2UgaWYgKGZlYXRzWzBdLnByb3BlcnRpZXMuZGV2aWNlVHlwZSA9PSAn5raI6Ziy5qCTJykgew0KICAgICAgICBsZXQgYXJyID0gdGhpcy5tYWludGVuQ29udGVudHMuZmlsdGVyKGl0ID0+IGl0Wyd6aC1DTiddID09ICfmtojpmLLmoJMnKQ0KICAgICAgICBhcnJbMF0uY2hpbGQuZm9yRWFjaChpdGVtID0+IHsNCiAgICAgICAgICB0aGlzLm1haW50ZW5Db250ZW50c0xpc3QucHVzaCh7DQogICAgICAgICAgICBuYW1lOiBpdGVtWyd6aC1DTiddLA0KICAgICAgICAgICAgdmFsdWU6IGl0ZW0uY29kZQ0KICAgICAgICAgIH0pDQogICAgICAgIH0pDQogICAgICB9IGVsc2Ugew0KICAgICAgICB0aGlzLm1haW50ZW5Db250ZW50c0xpc3QgPSBbXQ0KICAgICAgfQ0KICAgICAgdGhpcy5kcmF3QnVmZmVyKGZlYXRzWzBdLmdlb21ldHJ5KQ0KICAgICAgdGhpcy5zaWduU2hvdyA9IHRydWUNCiAgICAgIGlmIChmZWF0c1swXS5wcm9wZXJ0aWVzLmlzTWFpbiA9PSAndHJ1ZScpIHsNCiAgICAgICAgdGhpcy5oYXNTaWduSW4gPSB0cnVlDQogICAgICAgIGFwaS5nZXRNYWluRGV0YWlsSW5mbyh7DQogICAgICAgICAgZGV2VHlwZTogZmVhdHNbMF0ucHJvcGVydGllcy5kZXZpY2VUeXBlLA0KICAgICAgICAgIGRldklkOiBmZWF0c1swXS5wcm9wZXJ0aWVzLmlkLA0KICAgICAgICAgIHRhc2tJZDogdGhpcy4kcm91dGUucXVlcnkudGFza0lkDQogICAgICAgIH0pLnRoZW4ocmVzID0+IHsNCiAgICAgICAgICBpZiAocmVzLnN0YXR1cyAmJiByZXMuZGF0YSkgew0KICAgICAgICAgICAgdGhpcy5zaWduRm9ybS5yZW1hcmtzID0gcmVzLmRhdGEucmVtYXJrcw0KICAgICAgICAgICAgdGhpcy5zaWduRm9ybS5tYWludGFpblR5cGUgPSByZXMuZGF0YS5tYWludGFpblR5cGUNCiAgICAgICAgICAgIHRoaXMuc2lnbkZvcm0uY29udGVudCA9IHJlcy5kYXRhLmNvbnRlbnQNCiAgICAgICAgICAgIHRoaXMuY2hlY2tib3hHcm91cCA9IHJlcy5kYXRhLmNvbnRlbnQuc3BsaXQoJywnKQ0KICAgICAgICAgICAgdGhpcy5tYWludGFpbkJlZm9yZUltYWdlID0gcmVzLmRhdGEubWFpbnRhaW5JbWFnZXNMaXN0LmZpbHRlcihpdCA9PiBpdC5zdGFnZSA9PSAwKQ0KICAgICAgICAgICAgdGhpcy5hdHRhY2htZW50ID0gdGhpcy5tYWludGFpbkJlZm9yZUltYWdlWzBdPy5pbWFnZXNUb2tlbg0KICAgICAgICAgICAgdGhpcy5tYWludGFpbkFmdGVySW1hZ2UgPSByZXMuZGF0YS5tYWludGFpbkltYWdlc0xpc3QuZmlsdGVyKGl0ID0+IGl0LnN0YWdlID09IDEpDQogICAgICAgICAgICB0aGlzLmF0dGFjaG1lbnQxID0gdGhpcy5tYWludGFpbkFmdGVySW1hZ2VbMF0/LmltYWdlc1Rva2VuDQogICAgICAgICAgfQ0KICAgICAgICB9KQ0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgdGhpcy5oYXNTaWduSW4gPSBmYWxzZQ0KICAgICAgICB0aGlzLnNpZ25Gb3JtLnJlbWFya3MgPSAnJw0KICAgICAgICB0aGlzLnNpZ25Gb3JtLm1haW50YWluVHlwZSA9ICcnDQogICAgICAgIHRoaXMuc2lnbkZvcm0uY29udGVudCA9ICcnDQogICAgICAgIHRoaXMuY2hlY2tib3hHcm91cCA9IFtdDQogICAgICAgIHRoaXMubWFpbnRhaW5CZWZvcmVJbWFnZSA9IFtdDQogICAgICAgIHRoaXMuYXR0YWNobWVudCA9ICcnDQogICAgICAgIHRoaXMubWFpbnRhaW5BZnRlckltYWdlID0gW10NCiAgICAgICAgdGhpcy5hdHRhY2htZW50MSA9ICcnDQogICAgICB9DQogICAgfSwNCiAgICAvLyDmt7Hmi7fotJ0NCiAgICBkZWVwQ2xvbmUoZGF0YSkgew0KICAgICAgcmV0dXJuIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoZGF0YSkpDQogICAgfSwNCiAgICBnZXRNYWluRGV2UG9pbnQoKSB7DQogICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlDQogICAgICBhcGkNCiAgICAgICAgLmdldE1haW5EZXZQb2ludCh7IHRhc2tJZDogdGhpcy4kcm91dGUucXVlcnkudGFza0lkIH0pDQogICAgICAgIC50aGVuKChyZXMpID0+IHsNCiAgICAgICAgICBpZiAocmVzLnN0YXR1cykgew0KICAgICAgICAgICAgbGV0IG1haW5QaXBlRmVhdHVyZXMgPSBbXQ0KICAgICAgICAgICAgbGV0IG1haW5EZXZGZWF0dXJlcyA9IFtdDQogICAgICAgICAgICBjdXJyZW50TWFpblBvaW50LmlzTWFpbiA9IHJlcy5kYXRhLmNoZWNrDQogICAgICAgICAgICBjdXJyZW50TWFpblBvaW50LmlzTm90TWFpbiA9IHJlcy5kYXRhLnVuQ2hlY2sNCiAgICAgICAgICAgIHRoaXMubWFpbnRlbk9iaiA9IHRoaXMuZGVlcENsb25lKGN1cnJlbnRNYWluUG9pbnQpDQogICAgICAgICAgICBjdXJyZW50TWFpblBvaW50LmlzTWFpbi5mb3JFYWNoKChpdCkgPT4gew0KICAgICAgICAgICAgICBpZiAoaXQuZGV2aWNlVHlwZSA9PSAn566h57q/Jykgew0KICAgICAgICAgICAgICAgIG1haW5QaXBlRmVhdHVyZXMucHVzaCh7DQogICAgICAgICAgICAgICAgICBpZDogaXQuaWQsDQogICAgICAgICAgICAgICAgICB0eXBlOiAnRmVhdHVyZScsDQogICAgICAgICAgICAgICAgICBnZW9tZXRyeTogew0KICAgICAgICAgICAgICAgICAgICB0eXBlOiAnTGluZVN0cmluZycsDQogICAgICAgICAgICAgICAgICAgIGNvb3JkaW5hdGVzOiBbDQogICAgICAgICAgICAgICAgICAgICAgW2l0LnN0YXJ0TG9uZ2l0dWRlLCBpdC5zdGFydExhdGl0dWRlXSwNCiAgICAgICAgICAgICAgICAgICAgICBbaXQuZW5kTG9uZ2l0dWRlLCBpdC5lbmRMYXRpdHVkZV0sDQogICAgICAgICAgICAgICAgICAgIF0sDQogICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgcHJvcGVydGllczogT2JqZWN0LmFzc2lnbih7IGlzTWFpbjogJ3RydWUnIH0sIGl0KSwNCiAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIG1haW5EZXZGZWF0dXJlcy5wdXNoKHsNCiAgICAgICAgICAgICAgICAgIGlkOiBpdC5pZCwNCiAgICAgICAgICAgICAgICAgIHR5cGU6ICdGZWF0dXJlJywNCiAgICAgICAgICAgICAgICAgIGdlb21ldHJ5OiB7DQogICAgICAgICAgICAgICAgICAgIHR5cGU6ICdQb2ludCcsDQogICAgICAgICAgICAgICAgICAgIGNvb3JkaW5hdGVzOiBbaXQuc3RhcnRMb25naXR1ZGUsIGl0LnN0YXJ0TGF0aXR1ZGVdLA0KICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IE9iamVjdC5hc3NpZ24oeyBpc01haW46ICd0cnVlJyB9LCBpdCksDQogICAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIGN1cnJlbnRNYWluUG9pbnQuaXNOb3RNYWluLmZvckVhY2goKGl0KSA9PiB7DQogICAgICAgICAgICAgIGlmIChpdC5kZXZpY2VUeXBlID09ICfnrqHnur8nKSB7DQogICAgICAgICAgICAgICAgbWFpblBpcGVGZWF0dXJlcy5wdXNoKHsNCiAgICAgICAgICAgICAgICAgIGlkOiBpdC5pZCwNCiAgICAgICAgICAgICAgICAgIHR5cGU6ICdGZWF0dXJlJywNCiAgICAgICAgICAgICAgICAgIGdlb21ldHJ5OiB7DQogICAgICAgICAgICAgICAgICAgIHR5cGU6ICdMaW5lU3RyaW5nJywNCiAgICAgICAgICAgICAgICAgICAgY29vcmRpbmF0ZXM6IFsNCiAgICAgICAgICAgICAgICAgICAgICBbaXQuc3RhcnRMb25naXR1ZGUsIGl0LnN0YXJ0TGF0aXR1ZGVdLA0KICAgICAgICAgICAgICAgICAgICAgIFtpdC5lbmRMb25naXR1ZGUsIGl0LmVuZExhdGl0dWRlXSwNCiAgICAgICAgICAgICAgICAgICAgXSwNCiAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiBPYmplY3QuYXNzaWduKHsgaXNNYWluOiAnZmFsc2UnIH0sIGl0KSwNCiAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgIG1haW5EZXZGZWF0dXJlcy5wdXNoKHsNCiAgICAgICAgICAgICAgICAgIGlkOiBpdC5pZCwNCiAgICAgICAgICAgICAgICAgIHR5cGU6ICdGZWF0dXJlJywNCiAgICAgICAgICAgICAgICAgIGdlb21ldHJ5OiB7DQogICAgICAgICAgICAgICAgICAgIHR5cGU6ICdQb2ludCcsDQogICAgICAgICAgICAgICAgICAgIGNvb3JkaW5hdGVzOiBbaXQuc3RhcnRMb25naXR1ZGUsIGl0LnN0YXJ0TGF0aXR1ZGVdLA0KICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IE9iamVjdC5hc3NpZ24oeyBpc01haW46ICdmYWxzZScgfSwgaXQpLA0KICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pDQogICAgICAgICAgICB0aGlzLnNldE1haW5EZXZMYXllckZlYXR1cmVzKG1haW5EZXZGZWF0dXJlcywgbWFpblBpcGVGZWF0dXJlcykNCiAgICAgICAgICB9DQogICAgICAgIH0pDQogICAgICAgIC5maW5hbGx5KCgpID0+IHsNCiAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQ0KICAgICAgICAgIHRoaXMuZmluaXNoZWQgPSB0cnVlDQogICAgICAgIH0pDQogICAgfSwNCiAgICBzZXRNYWluUmFuZ2VEYXRhKGRhdGEpIHsNCiAgICAgIGxldCB0aGF0ID0gdGhpcw0KICAgICAgbGV0IHJhbmdlRGF0YSA9IFtdDQogICAgICBkYXRhLmZvckVhY2goKGl0KSA9PiB7DQogICAgICAgIHJhbmdlRGF0YS5wdXNoKHsNCiAgICAgICAgICB0eXBlOiAnRmVhdHVyZScsDQogICAgICAgICAgZ2VvbWV0cnk6IEpTT04ucGFyc2UoaXQuZ2VvbSksDQogICAgICAgIH0pDQogICAgICB9KQ0KICAgICAgbGV0IHRpbWVyID0gc2V0SW50ZXJ2YWwoKCkgPT4gew0KICAgICAgICBpZiAodGhhdC5tYXBMb2FkICYmIG1hcE9iai5tYXAuZ2V0U291cmNlKCdtYWluUmFuZ2VTb3VyY2UnKSkgew0KICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGltZXIpDQogICAgICAgICAgdGhhdC5zZXRTb3VyY2VEYXRhKCdtYWluUmFuZ2VTb3VyY2UnLCB7DQogICAgICAgICAgICB0eXBlOiAnRmVhdHVyZUNvbGxlY3Rpb24nLA0KICAgICAgICAgICAgZmVhdHVyZXM6IHJhbmdlRGF0YSwNCiAgICAgICAgICB9KQ0KICAgICAgICB9DQogICAgICB9LCAxMDApDQogICAgfSwNCiAgICBzZXRNYWluRGV2TGF5ZXJGZWF0dXJlcyhkZXZGZWF0cywgcGlwZUZlYXRzKSB7DQogICAgICBsZXQgdGhhdCA9IHRoaXMNCiAgICAgIGxldCB0aW1lciA9IHNldEludGVydmFsKCgpID0+IHsNCiAgICAgICAgaWYgKHRoYXQubWFwTG9hZCAmJiBtYXBPYmoubWFwLmdldFNvdXJjZSgnbWFpbkRldlBvaW50U291cmNlJykpIHsNCiAgICAgICAgICBjbGVhckludGVydmFsKHRpbWVyKQ0KICAgICAgICAgIHRoYXQuc2V0U291cmNlRGF0YSgnbWFpbkRldlBvaW50U291cmNlJywgew0KICAgICAgICAgICAgdHlwZTogJ0ZlYXR1cmVDb2xsZWN0aW9uJywNCiAgICAgICAgICAgIGZlYXR1cmVzOiBkZXZGZWF0cywNCiAgICAgICAgICB9KQ0KICAgICAgICB9DQogICAgICAgIGlmICh0aGF0Lm1hcExvYWQgJiYgbWFwT2JqLm1hcC5nZXRTb3VyY2UoJ21haW5EZXZMaW5lU291cmNlJykpIHsNCiAgICAgICAgICBjbGVhckludGVydmFsKHRpbWVyKQ0KICAgICAgICAgIHRoYXQuc2V0U291cmNlRGF0YSgnbWFpbkRldkxpbmVTb3VyY2UnLCB7DQogICAgICAgICAgICB0eXBlOiAnRmVhdHVyZUNvbGxlY3Rpb24nLA0KICAgICAgICAgICAgZmVhdHVyZXM6IHBpcGVGZWF0cywNCiAgICAgICAgICB9KQ0KICAgICAgICB9DQogICAgICB9LCAxMDApDQogICAgfSwNCiAgICBzZXRTb3VyY2VEYXRhKHNvdXJjZUlkLCBkYXRhKSB7DQogICAgICBpZiAobWFwT2JqLm1hcC5nZXRTb3VyY2Uoc291cmNlSWQpKSB7DQogICAgICAgIG1hcE9iai5tYXAuZ2V0U291cmNlKHNvdXJjZUlkKS5zZXREYXRhKGRhdGEpDQogICAgICB9DQogICAgfSwNCiAgICBnZXRNYWluVGFza09iaigpIHsNCiAgICAgIGFwaQ0KICAgICAgICAuZ2V0TWFpblRhc2soeyBpZDogdGhpcy4kcm91dGUucXVlcnkudGFza0lkIH0pDQogICAgICAgIC50aGVuKChyZXMpID0+IHsNCiAgICAgICAgICBpZiAocmVzLnN0YXR1cykgew0KICAgICAgICAgICAgdGhpcy50YXNrQml6VHlwZSA9IHJlcy5kYXRhLmJpelR5cGUNCiAgICAgICAgICAgIHJlcy5kYXRhLm1haW50YWluUGxhbkNvbnRlbnQucmVjb3Jkcy5mb3JFYWNoKChpdCkgPT4gew0KICAgICAgICAgICAgICB0aGlzLm9iakxpc3QucHVzaCh7DQogICAgICAgICAgICAgICAgbmFtZTogaXQuZGV2aWNlVHlwZSwNCiAgICAgICAgICAgICAgICBudW06IGl0Lm51bSB8fCAwLA0KICAgICAgICAgICAgICAgIHVuaXQ6IGl0LnVuaXQgfHwgJycsDQogICAgICAgICAgICAgIH0pDQogICAgICAgICAgICB9KQ0KICAgICAgICAgIH0NCiAgICAgICAgfSkNCiAgICAgICAgLmZpbmFsbHkoKCkgPT4ge30pDQogICAgfSwNCiAgICAvLyDojrflj5bpl67popjkuIrmiqXlkozorr7mlr3nvLrpmbfmlbDmja4NCiAgICBnZXRDYXJkTGlzdERhdGEoKSB7DQogICAgICAvLyDojrflj5ZoZWFkZXLvvIzmn6Xor6Llt6XljZXnlKgNCiAgICAgIGF4aW9zKHsNCiAgICAgICAgdXJsOiBBUEkuVlVFX0FQUF9XUEdfVVJMICsgJy9tYWluL3VzZXJDZW50ZXJBcGkvc3NvL3Rva2VuQnlUb2tlbicsDQogICAgICAgIG1ldGhvZDogJ3Bvc3QnLA0KICAgICAgICBwYXJhbXM6IHsNCiAgICAgICAgICB0b2tlbjogdGhpcy5hY2Nlc3NUb2tlbiwNCiAgICAgICAgfSwNCiAgICAgICAgaGVhZGVyczogew0KICAgICAgICAgIEF1dGhvcml6YXRpb246ICdCYXNpYyBiM1YwZDI5eWF6cDNjR2N5TURJdycsDQogICAgICAgIH0sDQogICAgICB9KS50aGVuKChyZXMpID0+IHsNCiAgICAgICAgaWYgKHJlcy5zdGF0dXMgPT0gMjAwKSB7DQogICAgICAgICAgdGhpcy5mb3JtVG9rZW4gPSByZXMuZGF0YS5yZXN1bHREYXRhLnRva2VuDQogICAgICAgICAgdGhpcy5oZWFkZXIgPSB7DQogICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLA0KICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogJ0JlYXJlciAnICsgdGhpcy5mb3JtVG9rZW4sDQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICB9KQ0KICAgIH0sDQogICAgLy8g6Zeu6aKY5LiK5oqlKHNtYWxsVHlwZTogJ2Fibm9ybWFsX2luZm9ybScp44CB6K6+5pa957y66Zm3KHNtYWxsVHlwZTogImRlZmVjdCIp5L2/55So5ZCM5LiA5o6l5Y+jDQogICAgYXN5bmMgZ2V0UHJvYmxlbURhdGFMaXN0KHBhcmFtcykgew0KICAgICAgdGhpcy5wcm9ibGVtRGF0YUxpc3QxID0gW10NCiAgICAgIHRoaXMucHJvYmxlbURhdGFMaXN0MiA9IFtdDQoNCiAgICAgIGxldCBjb21tb25QYXJhbXMgPSBPYmplY3QuYXNzaWduKA0KICAgICAgICB7DQogICAgICAgICAgc3lzQ29kZTogJ291dHdvcmsnLA0KICAgICAgICAgIHRva2VuOiB0aGlzLmFjY2Vzc1Rva2VuLA0KICAgICAgICAgIHBhZ2U6IHsNCiAgICAgICAgICAgIGN1cnJlbnQ6IDEsDQogICAgICAgICAgICBzaXplOiA5OTk5OSwgLy8g5p+l5YWo6YOoDQogICAgICAgICAgfSwNCiAgICAgICAgfSwNCiAgICAgICAgcGFyYW1zDQogICAgICApDQogICAgICAvLyDpl67popjkuIrmiqUNCiAgICAgIGxldCBwYXJhbXMxID0gew0KICAgICAgICAuLi5jb21tb25QYXJhbXMsDQogICAgICAgIHNtYWxsVHlwZTogJ2Fibm9ybWFsX2luZm9ybScsDQogICAgICB9DQogICAgICAvLyDorr7mlr3nvLrpmbcNCiAgICAgIGxldCBwYXJhbXMyID0gew0KICAgICAgICAuLi5jb21tb25QYXJhbXMsDQogICAgICAgIHNtYWxsVHlwZTogJ2RlZmVjdCcsDQogICAgICB9DQogICAgICBsZXQgcHJvYmxlbVBvaW50RmVhdHVyZXMgPSBbXQ0KICAgICAgLy8g6Zeu6aKY5LiK5oqlDQogICAgICBhd2FpdCB0aGlzLmdldEF4aW9zRGF0YShwYXJhbXMxLCB0aGlzLnByb2JsZW1EYXRhTGlzdDEpDQogICAgICAvLyDorr7mlr3nvLrpmbcNCiAgICAgIGF3YWl0IHRoaXMuZ2V0QXhpb3NEYXRhKHBhcmFtczIsIHRoaXMucHJvYmxlbURhdGFMaXN0MikNCiAgICAgIGxldCBhbGxQcm9ibGVtID0gdGhpcy5wcm9ibGVtRGF0YUxpc3QxLmNvbmNhdCh0aGlzLnByb2JsZW1EYXRhTGlzdDIpDQogICAgICBhbGxQcm9ibGVtLmZvckVhY2goKGl0KSA9PiB7DQogICAgICAgIHByb2JsZW1Qb2ludEZlYXR1cmVzLnB1c2goew0KICAgICAgICAgIHR5cGU6ICdGZWF0dXJlJywNCiAgICAgICAgICBnZW9tZXRyeTogew0KICAgICAgICAgICAgdHlwZTogJ1BvaW50JywNCiAgICAgICAgICAgIGNvb3JkaW5hdGVzOiBpdC5sbmdsYXQsDQogICAgICAgICAgfSwNCiAgICAgICAgICBwcm9wZXJ0aWVzOiB7DQogICAgICAgICAgICBpZDogaXQuaWQsDQogICAgICAgICAgICB0aXRsZTogaXQudGl0bGUsDQogICAgICAgICAgfSwNCiAgICAgICAgfSkNCiAgICAgIH0pDQogICAgICB0aGlzLiRyZWZzLm15bWFwLmFkZEluc3BFdmVudExheWVyKHByb2JsZW1Qb2ludEZlYXR1cmVzKQ0KICAgICAgdGhpcy5yZXBvcnREYXRhSXNMb2FkZWQgPSB0cnVlDQogICAgfSwNCiAgICBnZXRBeGlvc0RhdGEocGFyYW1zLCBwcm9ibGVtRGF0YUxpc3QpIHsNCiAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7DQogICAgICAgIGF4aW9zKHsNCiAgICAgICAgICB1cmw6DQogICAgICAgICAgICBBUEkuVlVFX0FQUF9XUEdfVVJMICsNCiAgICAgICAgICAgICcvbWFpbi9vdXR3b3JrYXBpL3RpY2tldFN0YXRpc3RpY0NsaWVudC9nZXRUaWNrZXRMaXN0JywNCiAgICAgICAgICBtZXRob2Q6ICdwb3N0JywNCiAgICAgICAgICBkYXRhOiBwYXJhbXMsDQogICAgICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXIsDQogICAgICAgIH0pLnRoZW4oKHJlcykgPT4gew0KICAgICAgICAgIGlmIChyZXMuc3RhdHVzID09IDIwMCkgew0KICAgICAgICAgICAgcmVzLmRhdGEucmVzdWx0RGF0YS5yZWNvcmRzLmZvckVhY2goKGl0ZW0pID0+IHsNCiAgICAgICAgICAgICAgcHJvYmxlbURhdGFMaXN0LnB1c2goew0KICAgICAgICAgICAgICAgIGlkOiBpdGVtLmlkLCAvLyDlt6XljZVJRA0KICAgICAgICAgICAgICAgIHRpdGxlOiBpdGVtLnRpdGxlLCAvLyDlt6XljZXmoIfpopgNCiAgICAgICAgICAgICAgICB0aWNrZXRTdGF0dXNOYW1lOiBpdGVtLnRpY2tldFN0YXR1c05hbWUsDQogICAgICAgICAgICAgICAgaGFuZGxlVHlwZTogaXRlbS5mb3JtVmFsdWUuaGFuZGxlVHlwZSwgLy8g5o+P6L+wDQogICAgICAgICAgICAgICAgY3JlYXRlQnlOYW1lOiBpdGVtLmNyZWF0ZUJ5TmFtZSwgLy8g5Yib5bu65Lq6DQogICAgICAgICAgICAgICAgY3JlYXRlVGltZTogaXRlbS5jcmVhdGVUaW1lLnN1YnN0cmluZygwLCAxMCksIC8vIOWIm+W7uuaXtumXtA0KICAgICAgICAgICAgICAgIGRlZmVjdEZyb206IGl0ZW0uZm9ybVZhbHVlLmRlZmVjdEZyb20sDQogICAgICAgICAgICAgICAgZmF1bHRUeXBlczogaXRlbS5mb3JtVmFsdWUuZmF1bHRUeXBlcywNCiAgICAgICAgICAgICAgICBmaWxlVXJsOiBpdGVtLmZvcm1WYWx1ZT8uaGFuZGxlSW1ncz8uWzBdPy5maWxlVXJsLA0KICAgICAgICAgICAgICAgIC8vIOWbvueJh+WcsOWdgA0KICAgICAgICAgICAgICAgIHVybDogaXRlbS5mb3JtVmFsdWU/LmhhbmRsZUltZ3M/LlswXT8udXJsLA0KICAgICAgICAgICAgICAgIC8vIOWPkeeUn+e7j+e6rOW6pg0KICAgICAgICAgICAgICAgIGxuZ2xhdDogW2l0ZW0uYXBwZWFsTG5nLCBpdGVtLmFwcGVhbExhdF0sDQogICAgICAgICAgICAgICAgZGV2aWNlX3R5cGU6IGl0ZW0uZm9ybVZhbHVlPy5kZXZpY2VfdHlwZSB8fCBbXSwNCiAgICAgICAgICAgICAgICBxdWVzdGlvbkRlc2NyaWJlOiBpdGVtLmZvcm1WYWx1ZS5xdWVzdGlvbkRlc2NyaWJlLA0KICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIHJlc29sdmUoKQ0KICAgICAgICAgIH0NCiAgICAgICAgICAvLyBwcm9ibGVtRGF0YUxpc3QuZm9yRWFjaCgoaXRlbSkgPT4gew0KICAgICAgICAgIC8vICAgLy8gY29uc29sZS5sb2coJ+WbvueJh+WcsOWdgCcsIGl0ZW0udXJsKQ0KICAgICAgICAgIC8vIH0pDQogICAgICAgIH0pDQogICAgICB9KQ0KICAgIH0sDQogICAgLy8g6Zeu6aKY5LiK5oql54K55Ye75qCH6aKY44CB6K6+5pa957y66Zm354K55Ye75Y2h54mH6L+b5YWl6K+m5oOF6aG1DQogICAgdG9EZXRhaWxQYW5lbChjYXJkRGV0YWlsKSB7DQogICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9DQogICAgICAgICdodHRwOi8vMTcyLjIwLjc5LjcwL291dHdvcmtBcHAvIy9wYWdlcy90aWNrZXQvZGV0YWlsL2luZGV4P2lkPScgKw0KICAgICAgICBjYXJkRGV0YWlsLmlkICsNCiAgICAgICAgJyZzeXNDb2RlPW91dHdvcmsnICsNCiAgICAgICAgJyZ0b2tlbj0nICsNCiAgICAgICAgdGhpcy5mb3JtVG9rZW4NCiAgICB9LA0KICAgIC8vIOWNoeeJh+WumuS9jQ0KICAgIGZseVRvUG9pbnQobG5nbGF0KSB7DQogICAgICBtYXBPYmoubWFwLmZseVRvKHsgY2VudGVyOiBsbmdsYXQsIHpvb206IDE4LjUgfSkNCiAgICB9LA0KICAgIC8vIOS4iuaKpQ0KICAgIHJlcG9ydENsaWNrKCkgew0KICAgICAgaWYgKHRoaXMucmVwb3J0RGF0YUlzTG9hZGVkKSB7DQogICAgICAgIHRoaXMucmVwb3J0U2hvdyA9IHRydWUNCiAgICAgICAgbWFwT2JqLm1hcC5zZXRMYXlvdXRQcm9wZXJ0eSgNCiAgICAgICAgICAnZXZlbnRQb2ludHNMYXllcicsDQogICAgICAgICAgJ3Zpc2liaWxpdHknLA0KICAgICAgICAgICd2aXNpYmxlJw0KICAgICAgICApDQogICAgICB9IGVsc2Ugew0KICAgICAgICBUb2FzdCh7DQogICAgICAgICAgbWVzc2FnZTogJ+S4iuaKpeaVsOaNruWKoOi9veS4reOAguOAguOAgicsDQogICAgICAgICAgZHVyYXRpb246IDE1MDAsDQogICAgICAgIH0pDQogICAgICAgIHJldHVybg0KICAgICAgfQ0KICAgIH0sDQogICAgZmlsZUNoYW5nZUFmdGVyKGZpbGUpIHsNCiAgICAgIHRoaXMubWFpbnRhaW5BZnRlckltYWdlID0gW10NCiAgICAgIGZpbGUuZmlsZUxpc3QuZm9yRWFjaCgoaXQpID0+IHsNCiAgICAgICAgdGhpcy5tYWludGFpbkFmdGVySW1hZ2UucHVzaCh7DQogICAgICAgICAgaW1hZ2VzVG9rZW46IGl0LnJlc3BvbnNlLmdyb3VwVG9rZW4sDQogICAgICAgICAgaW1hZ2VzTmFtZTogaXQudXJsLA0KICAgICAgICAgIHN0YWdlOiAxDQogICAgICAgIH0pDQogICAgICB9KQ0KICAgICAgY29uc29sZS5sb2codGhpcy5tYWludGFpbkFmdGVySW1hZ2UpDQogICAgfSwNCiAgICBmaWxlQ2hhbmdlQmVmb3JlKGZpbGUpIHsNCiAgICAgIHRoaXMubWFpbnRhaW5CZWZvcmVJbWFnZSA9IFtdDQogICAgICBmaWxlLmZpbGVMaXN0LmZvckVhY2goKGl0KSA9PiB7DQogICAgICAgIHRoaXMubWFpbnRhaW5CZWZvcmVJbWFnZS5wdXNoKHsNCiAgICAgICAgICBpbWFnZXNUb2tlbjogaXQucmVzcG9uc2UuZ3JvdXBUb2tlbiwNCiAgICAgICAgICBpbWFnZXNOYW1lOiBpdC51cmwsDQogICAgICAgICAgc3RhZ2U6IDANCiAgICAgICAgfSkNCiAgICAgIH0pDQogICAgICBjb25zb2xlLmxvZyh0aGlzLm1haW50YWluQmVmb3JlSW1hZ2UpDQogICAgfSwNCiAgICBvcGVuUG9wdXAoKSB7DQogICAgICB0aGlzLnNob3dQb3BvdmVyID0gdHJ1ZQ0KICAgIH0sDQogICAgb25TZWxlY3QodmFsKSB7DQogICAgICBpZiAodGhpcy5pc1ZpZXcpIHsNCiAgICAgICAgVG9hc3Qoew0KICAgICAgICAgIG1lc3NhZ2U6ICfor6XlhbvmiqTku7vliqHlt7Lnu5PmnZ8nLA0KICAgICAgICAgIGR1cmF0aW9uOiAnMTUwMCcsDQogICAgICAgIH0pDQogICAgICAgIHJldHVybg0KICAgICAgfQ0KICAgICAgdGhpcy5pZlRpcHMgPSB0cnVlDQogICAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgdGhpcy5pZlRpcHMgPSBmYWxzZQ0KICAgICAgfSwgMjUwMCkNCiAgICAgIG1hcE9iai5tYXAub2ZmKCdjbGljaycsICdtYWluRGV2UGlwZUxheWVyJywgdGhpcy5tYWluRGV0YWlsSW5mbykNCiAgICAgIG1hcE9iai5tYXAub2ZmKCdjbGljaycsICdtYWluRGV2UG9pbnRMYXllcicsIHRoaXMubWFpbkRldGFpbEluZm8pDQogICAgICB2YWwudGV4dCA9PSAn6Zeu6aKY5LiK5oqlJw0KICAgICAgICA/IG1hcE9iai5tYXAub24oJ2NsaWNrJywgdGhpcy5zZWxlY3RSZXBvcnRQb2ludCkNCiAgICAgICAgOiBtYXBPYmoubWFwLm9uKCdjbGljaycsIHRoaXMuc2VsZWN0Rmxhd1BvaW50KQ0KICAgIH0sDQogICAgc2VsZWN0UmVwb3J0UG9pbnQoZSkgew0KICAgICAgbGV0IGZlYXR1cmVzID0gbWFwT2JqLm1hcC5xdWVyeVJlbmRlcmVkRmVhdHVyZXMoZS5wb2ludCkNCiAgICAgIGNvbnNvbGUubG9nKGZlYXR1cmVzKQ0KICAgICAgaWYgKGZlYXR1cmVzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgaWYgKGZlYXR1cmVzWzBdLmxheWVyLmlkID09ICdtYWluRGV2UG9pbnRMYXllcicgfHwgZmVhdHVyZXNbMF0ubGF5ZXIuaWQgPT0gJ21haW5EZXZQaXBlTGF5ZXInKSB7DQogICAgICAgICAgdGhpcy5hZGRFdmVudE9iak1hcmtlcihmZWF0dXJlc1sxXSwgJ2V2ZW50JykNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICB0aGlzLmFkZEV2ZW50T2JqTWFya2VyKGZlYXR1cmVzWzBdLCAnZXZlbnQnKQ0KICAgICAgICB9DQogICAgICB9DQogICAgICBtYXBPYmoubWFwLm9uKCdjbGljaycsICdtYWluRGV2UGlwZUxheWVyJywgdGhpcy5tYWluRGV0YWlsSW5mbykNCiAgICAgIG1hcE9iai5tYXAub24oJ2NsaWNrJywgJ21haW5EZXZQb2ludExheWVyJywgdGhpcy5tYWluRGV0YWlsSW5mbykNCiAgICAgIG1hcE9iai5tYXAub2ZmKCdjbGljaycsIHRoaXMuc2VsZWN0UmVwb3J0UG9pbnQpDQogICAgfSwNCiAgICBzZWxlY3RGbGF3UG9pbnQoZSkgew0KICAgICAgbGV0IGZlYXR1cmVzID0gbWFwT2JqLm1hcC5xdWVyeVJlbmRlcmVkRmVhdHVyZXMoZS5wb2ludCkNCiAgICAgIGNvbnNvbGUubG9nKGZlYXR1cmVzKQ0KICAgICAgaWYgKGZlYXR1cmVzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgaWYgKA0KICAgICAgICAgIGZlYXR1cmVzWzBdLnNvdXJjZSAhPSAnZXZlbnRQb2ludHMnICYmDQogICAgICAgICAgZmVhdHVyZXNbMF0uc291cmNlICE9ICdtYWluVXNlcicgJiYNCiAgICAgICAgICBmZWF0dXJlc1swXS5zb3VyY2UgIT0gJ2luaXRJbnNwTGluZVNvdXJjZScgJiYNCiAgICAgICAgICBmZWF0dXJlc1swXS5zb3VyY2UgIT0gJ2tleXBvaW50cycgJiYNCiAgICAgICAgICBmZWF0dXJlc1swXS5nZW9tZXRyeS50eXBlID09PSAnUG9pbnQnDQogICAgICAgICkgew0KICAgICAgICAgIHRoaXMuJHJlZnMubXltYXAuYWRkRXZlbnRPYmpNYXJrZXIoZmVhdHVyZXNbMF0sICdmbGF3JykNCiAgICAgICAgfSBlbHNlIGlmICgNCiAgICAgICAgICBmZWF0dXJlcy5sZW5ndGggPiAxICYmDQogICAgICAgICAgZmVhdHVyZXNbMV0uc291cmNlICE9ICdldmVudFBvaW50cycgJiYNCiAgICAgICAgICBmZWF0dXJlc1sxXS5zb3VyY2UgIT0gJ21haW5Vc2VyJyAmJg0KICAgICAgICAgIGZlYXR1cmVzWzFdLnNvdXJjZSAhPSAna2V5cG9pbnRzJyAmJg0KICAgICAgICAgIGZlYXR1cmVzWzFdLmdlb21ldHJ5LnR5cGUgPT09ICdQb2ludCcNCiAgICAgICAgKSB7DQogICAgICAgICAgdGhpcy4kcmVmcy5teW1hcC5hZGRFdmVudE9iak1hcmtlcihmZWF0dXJlc1sxXSwgJ2ZsYXcnKQ0KICAgICAgICB9DQogICAgICB9DQogICAgICBtYXBPYmoubWFwLm9uKCdjbGljaycsICdrZXlwb2ludHNMYXllcicsIHRoaXMuJHJlZnMubXltYXAuc2lnbkluQnVmZmVyKQ0KICAgICAgbWFwT2JqLm1hcC5vZmYoJ2NsaWNrJywgdGhpcy5zZWxlY3RGbGF3UG9pbnQpDQogICAgfSwNCiAgICAvLyDmt7vliqDkuIrmiqXlr7nosaHnmoRtYXJrZXINCiAgICBhZGRFdmVudE9iak1hcmtlcihmZWF0dXJlLCB0eXBlKSB7DQogICAgICBsZXQgcG9zaXRpb247DQogICAgICBpZiAoZmVhdHVyZS5nZW9tZXRyeS50eXBlID09PSAnUG9seWdvbicgfHwgZmVhdHVyZS5nZW9tZXRyeS50eXBlID09PSAnTXVsdGlQb2x5Z29uJykgew0KICAgICAgICBjb25zdCBjZW50ZXIgPSB0dXJmLmNlbnRlcihmZWF0dXJlLmdlb21ldHJ5KTsNCiAgICAgICAgcG9zaXRpb24gPSBjZW50ZXIuZ2VvbWV0cnkuY29vcmRpbmF0ZXM7DQogICAgICB9IGVsc2UgaWYgKGZlYXR1cmUuZ2VvbWV0cnkudHlwZSA9PT0gJ0xpbmVTdHJpbmcnKSB7DQogICAgICAgIGNvbnN0IGNlbnRlciA9IHR1cmYuY2VudGVyKGZlYXR1cmUuZ2VvbWV0cnkpOw0KICAgICAgICBwb3NpdGlvbiA9IGNlbnRlci5nZW9tZXRyeS5jb29yZGluYXRlczsNCiAgICAgIH0gZWxzZSBpZiAoZmVhdHVyZS5nZW9tZXRyeS50eXBlID09PSAnUG9pbnQnKSB7DQogICAgICAgIHBvc2l0aW9uID0gZmVhdHVyZS5nZW9tZXRyeS5jb29yZGluYXRlczsNCiAgICAgIH0NCiAgICAgIHRoaXMuY3VycmVudFBvaW50ID0gZmVhdHVyZQ0KICAgICAgdGhpcy5jdXJyZW50UG9pbnQuY29kZSA9IGZlYXR1cmUucHJvcGVydGllcy5tYW5ob2xlX2NvZGUgfHwgZmVhdHVyZS5wcm9wZXJ0aWVzLmNvbWJfY29kZSB8fCAnJw0KICAgICAgdGhpcy5jdXJyZW50UG9pbnQuYml6VHlwZSA9IGZlYXR1cmUucHJvcGVydGllcy5tYW5ob2xlX3R5cGUgfHwgJycNCiAgICAgIHRoaXMuY3VycmVudFBvaW50LmxuZyA9IGZlYXR1cmUuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF0NCiAgICAgIHRoaXMuY3VycmVudFBvaW50LmxhdCA9IGZlYXR1cmUuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMV0NCiAgICAgIC8vIOimgee0oOaJgOWcqOWbvuWxgklE5ZKM5bGe5oCn5L+h5oGvDQogICAgICB0aGlzLmN1cnJlbnRQb2ludC5sYXllcklEID0gZmVhdHVyZS5sYXllci5pZA0KICAgICAgdGhpcy5jdXJyZW50UG9pbnQubGF5ZXJUeXBlID0gZmVhdHVyZS5sYXllci50eXBlDQogICAgICB0aGlzLmN1cnJlbnRQb2ludC5wcm9wZXJ0aWVzID0gZmVhdHVyZS5wcm9wZXJ0aWVzDQogICAgICAvLyDlupXlm77opoHntKBuYW1lX2xvY2Fs5oiW6K6+5pa96KaB57Sgcm9hZF9uYW1lLGlkDQogICAgICB0aGlzLmN1cnJlbnRQb2ludC5yb2FkX25hbWUgPSBmZWF0dXJlLnByb3BlcnRpZXMucm9hZF9uYW1lDQogICAgICB0aGlzLmN1cnJlbnRQb2ludC5pZCA9IGZlYXR1cmUucHJvcGVydGllcy5pZA0KICAgICAgdGhpcy5jdXJyZW50UG9pbnQuY29kZSA9IGZlYXR1cmUucHJvcGVydGllcy5tYW5ob2xlX2NvZGUgfHwgZmVhdHVyZS5wcm9wZXJ0aWVzLmdhdGVfY29kZSB8fCBmZWF0dXJlLnByb3BlcnRpZXMub3V0bGV0X2NvZGUNCiAgICAgICAgfHwgZmVhdHVyZS5wcm9wZXJ0aWVzLmNvbWJfY29kZSB8fCBmZWF0dXJlLnByb3BlcnRpZXMudmFsdmVfY29kZSB8fCBmZWF0dXJlLnByb3BlcnRpZXMucHVtcF9zdGF0aW9uX2NvZGUNCiAgICAgICAgfHwgZmVhdHVyZS5wcm9wZXJ0aWVzLnBsYW50X2NvZGUgfHwgZmVhdHVyZS5wcm9wZXJ0aWVzLnB1bXBfY29kZSB8fCBmZWF0dXJlLnByb3BlcnRpZXMuZmlyZV9jb2NrX2NvZGUNCiAgICAgICAgfHwgZmVhdHVyZS5wcm9wZXJ0aWVzLnN0YXJ0X2NvZGUgKyAnLCcgKyBmZWF0dXJlLnByb3BlcnRpZXMuZW5kX2NvZGUgfHwgJycNCiAgICAgIC8vIOimgee0oOWvueixoeexu+Wei++8iOS4muWKoeexu+Weiy/orr7mlr3nsbvlnovvvIkNCiAgICAgIHN3aXRjaCAoZmVhdHVyZS5sYXllci5pZCkgew0KICAgICAgICAvLyDpm6jmsLQNCiAgICAgICAgY2FzZSAicmRfbWFwX2NvbWIiOi8vY29tYuS4gOWumuaYr+mbqOawtOWPow0KICAgICAgICAgIHRoaXMuY3VycmVudFBvaW50LmJpZ1R5cGUgPSAn6Zuo5rC0Jw0KICAgICAgICAgIHRoaXMuY3VycmVudFBvaW50LnNtYWxsVHlwZSA9ICfpm6jmsLTlj6MnDQogICAgICAgICAgYnJlYWsNCiAgICAgICAgY2FzZSAicmRfbWFwX291dGZhbGwiOi8v5o6S5pS+5Y+jIDEt6Zuo5rC077ybIDIt5rGh5rC077ybIDMt5ZCI5rWB77ybIDQt5YW25LuWDQogICAgICAgICAgdGhpcy5jdXJyZW50UG9pbnQuYmlnVHlwZSA9IGZlYXR1cmUucHJvcGVydGllcy5waXBlX3R5cGUNCiAgICAgICAgICB0aGlzLmN1cnJlbnRQb2ludC5zbWFsbFR5cGUgPSAn5o6S5pS+5Y+jJw0KICAgICAgICAgIGJyZWFrDQogICAgICAgIGNhc2UgInJkX21hcF9tYW5ob2xlIjovL+ajgOafpeS6lSAgMS3pm6jmsLTvvJsyLeaxoeawtA0KICAgICAgICAgIHRoaXMuY3VycmVudFBvaW50LmJpZ1R5cGUgPSBmZWF0dXJlLnByb3BlcnRpZXMubWFuaG9sZV90eXBlDQogICAgICAgICAgdGhpcy5jdXJyZW50UG9pbnQuc21hbGxUeXBlID0gJ+ajgOafpeS6lScNCiAgICAgICAgICBicmVhaw0KICAgICAgICBjYXNlICJyZF9tYXBfZ2F0ZSI6Ly/pl7jpl6ggMS3pm6jmsLTvvJsgMi3msaHmsLTvvJsgMy3lkIjmtYHvvJsgNC3lhbbku5YNCiAgICAgICAgICB0aGlzLmN1cnJlbnRQb2ludC5iaWdUeXBlID0gZmVhdHVyZS5wcm9wZXJ0aWVzLnBpcGVfdHlwZQ0KICAgICAgICAgIHRoaXMuY3VycmVudFBvaW50LnNtYWxsVHlwZSA9ICfpl7jpl6gnDQogICAgICAgICAgYnJlYWsNCiAgICAgICAgY2FzZSAicmRfbWFwX2RyYWlucGlwZV95c19iaWciOg0KICAgICAgICAgIHRoaXMuY3VycmVudFBvaW50LmJpZ1R5cGUgPSAn6Zuo5rC0Jw0KICAgICAgICAgIHRoaXMuY3VycmVudFBvaW50LnNtYWxsVHlwZSA9ICfpm6jmsLTnrqHnur8nDQogICAgICAgICAgYnJlYWsNCiAgICAgICAgY2FzZSAicmRfbWFwX2RyYWlucGlwZV95c19zbWFsbCI6DQogICAgICAgICAgdGhpcy5jdXJyZW50UG9pbnQuYmlnVHlwZSA9ICfpm6jmsLQnDQogICAgICAgICAgdGhpcy5jdXJyZW50UG9pbnQuc21hbGxUeXBlID0gJ+mbqOawtOeuoee6vycNCiAgICAgICAgICBicmVhaw0KICAgICAgICAvLyDmsaHmsLQNCiAgICAgICAgY2FzZSAicmRfbWFwX2RyYWlucGlwZV93c19iaWciOg0KICAgICAgICAgIHRoaXMuY3VycmVudFBvaW50LmJpZ1R5cGUgPSAn5rGh5rC0Jw0KICAgICAgICAgIHRoaXMuY3VycmVudFBvaW50LnNtYWxsVHlwZSA9ICfmsaHmsLTnrqHnur8nDQogICAgICAgICAgYnJlYWsNCiAgICAgICAgY2FzZSAicmRfbWFwX2RyYWlucGlwZV93c19zbWFsbCI6DQogICAgICAgICAgdGhpcy5jdXJyZW50UG9pbnQuYmlnVHlwZSA9ICfmsaHmsLQnDQogICAgICAgICAgdGhpcy5jdXJyZW50UG9pbnQuc21hbGxUeXBlID0gJ+axoeawtOeuoee6vycNCiAgICAgICAgICBicmVhaw0KICAgICAgICAvLyDnu5nmsLQNCiAgICAgICAgY2FzZSAibWFwX3N1cHBseV9maXJlaHlkcmFudCI6Ly/mtojngavmoJPkuIDlrprmmK/nu5nmsLQNCiAgICAgICAgICB0aGlzLmN1cnJlbnRQb2ludC5iaWdUeXBlID0gJ+e7meawtCcNCiAgICAgICAgICB0aGlzLmN1cnJlbnRQb2ludC5zbWFsbFR5cGUgPSAn5raI54Gr5qCTJw0KICAgICAgICAgIGJyZWFrDQogICAgICAgIGNhc2UgIm1hcF9zdXBwbHlfdmFsdmUiOi8v6ZiA6ZeodmFsdmXkuIDlrprmmK/nu5nmsLQNCiAgICAgICAgICB0aGlzLmN1cnJlbnRQb2ludC5iaWdUeXBlID0gJ+e7meawtCcNCiAgICAgICAgICB0aGlzLmN1cnJlbnRQb2ludC5zbWFsbFR5cGUgPSAn6ZiA6ZeoJw0KICAgICAgICAgIGJyZWFrDQogICAgICAgIGNhc2UgIm1hcF9zdXBwbHlfcGlwZV9kaXN0cmlidXRlIjovL+mFjeawtOeuoee6vw0KICAgICAgICAgIHRoaXMuY3VycmVudFBvaW50LmJpZ1R5cGUgPSAn57uZ5rC0Jw0KICAgICAgICAgIHRoaXMuY3VycmVudFBvaW50LnNtYWxsVHlwZSA9ICfphY3msLTnrqHnur8nDQogICAgICAgICAgYnJlYWsNCiAgICAgICAgY2FzZSAibWFwX3N1cHBseV9waXBlX2RlbGl2ZXJ5IjovL+i+k+awtOeuoee6vw0KICAgICAgICAgIHRoaXMuY3VycmVudFBvaW50LmJpZ1R5cGUgPSAnc3VwcGx5Jw0KICAgICAgICAgIHRoaXMuY3VycmVudFBvaW50LnNtYWxsVHlwZSA9ICfovpPmsLTnrqHnur8nDQogICAgICAgICAgYnJlYWsNCiAgICAgICAgY2FzZSAibWFwX3N1cHBseV9waXBlX2NpcmN1bGF0aW5nIjovL+WbnuawtOeuoee6vw0KICAgICAgICAgIHRoaXMuY3VycmVudFBvaW50LmJpZ1R5cGUgPSAn57uZ5rC0Jw0KICAgICAgICAgIHRoaXMuY3VycmVudFBvaW50LnNtYWxsVHlwZSA9ICflm57msLTnrqHnur8nDQogICAgICAgICAgYnJlYWsNCiAgICAgICAgY2FzZSAibWFwX3dhdGVyd29yayI6Ly/kvpvmsLTljoINCiAgICAgICAgICB0aGlzLmN1cnJlbnRQb2ludC5iaWdUeXBlID0gJ+e7meawtCcNCiAgICAgICAgICB0aGlzLmN1cnJlbnRQb2ludC5zbWFsbFR5cGUgPSAn5L6b5rC05Y6CJw0KICAgICAgICAgIGJyZWFrDQogICAgICAgIC8vIOWGjeeUn+awtA0KICAgICAgICBjYXNlICJtYXBfcmVjeWNsZV9waXBlIjovL+WGjeeUn+awtOeuoee6vw0KICAgICAgICAgIHRoaXMuY3VycmVudFBvaW50LmJpZ1R5cGUgPSAn5YaN55Sf5rC0Jw0KICAgICAgICAgIHRoaXMuY3VycmVudFBvaW50LnNtYWxsVHlwZSA9ICdwaXBlbGluZScNCiAgICAgICAgICBicmVhaw0KICAgICAgICBjYXNlICJtYXBfd2F0ZXJ3b3JrIjovL+WGjeeUn+awtOWOgg0KICAgICAgICAgIHRoaXMuY3VycmVudFBvaW50LmJpZ1R5cGUgPSAn5YaN55Sf5rC0Jw0KICAgICAgICAgIHRoaXMuY3VycmVudFBvaW50LnNtYWxsVHlwZSA9ICflho3nlJ/msLTljoInDQogICAgICAgICAgYnJlYWsNCiAgICAgIH0NCg0KICAgICAgY29uc3Qgc3JjID0gcmVxdWlyZShgQC9hc3NldHMvaW1nL2xlZ2VuZC/kuovku7bkuIrmiqUucG5nYCk7DQogICAgICAvLyDlpoLmnpzlrZjlnKhpZOS4umV2ZW50T2JqX29uZeeahOWFg+e0oO+8jOWImeWIoOmZpOatpOWFg+e0oOmHjeaWsOWIm+W7uu+8jOS/neaMgeWFqOWxgOWPquacieS4gOS4quatpOWFg+e0oA0KICAgICAgbGV0IGN1cnJlbnRFbGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZXZlbnRPYmpfb25lIik7DQogICAgICBpZiAoY3VycmVudEVsZSkgew0KICAgICAgICBjdXJyZW50RWxlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoY3VycmVudEVsZSk7DQogICAgICB9DQogICAgICBsZXQgZWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7DQogICAgICBlbGUuaW5uZXJIVE1MID0gYA0KICAgICAgICAgIDxpbWcgaWQ9ImV2ZW50T2JqX29uZSIgc3JjPSIke3NyY30iIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCI+DQogICAgICAgIGANCiAgICAgIGxldCBtYXJrZXIgPSBtYXBPYmoubWFwSW5zdGFuY2UubmV3TWFya2VyKHsNCiAgICAgICAgZWxlbWVudDogZWxlDQogICAgICB9KTsNCiAgICAgIG1hcmtlcg0KICAgICAgICAuc2V0TG5nTGF0KHBvc2l0aW9uKQ0KICAgICAgICAuc2V0UG9wdXAobWFwT2JqLm1hcEluc3RhbmNlLnBvcHVwDQogICAgICAgICAgLnNldEhUTUwoYDxkaXYgaWQ9ImRldmljZURldGFpbCI+PC9kaXY+YCkpDQogICAgICAgIC5hZGRUbyhtYXBPYmoubWFwKTsNCiAgICAgIGxldCBwb3AgPSBuZXcgUG9wdXBJdGVtKHsgcHJvcHNEYXRhOiB7IGRldmljZUNvZGU6IHRoaXMuY3VycmVudFBvaW50LmNvZGUsIHR5cGU6IHR5cGUsIGlzRGV2aWNlOiB0cnVlLCBmdW46IHRoaXMuZ29Ub0RldGFpbCB9IH0pDQogICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7DQogICAgICAgIHBvcC4kbW91bnQoJyNkZXZpY2VEZXRhaWwnKQ0KICAgICAgfSkNCiAgICAgIG1hcmtlci50b2dnbGVQb3B1cCgpOw0KDQogICAgfSwNCiAgICBnb1RvRGV0YWlsKHR5cGUpIHsNCiAgICAgIGlmICh0eXBlID09ICdldmVudCcpIHsNCiAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goew0KICAgICAgICAgIG5hbWU6ICdhZGRQcm9ibGVtSW5kZXgnLA0KICAgICAgICAgIHF1ZXJ5OiB7IG1zZzogdGhpcy5jdXJyZW50UG9pbnQsIHRva2VuOiB0aGlzLmZvcm1Ub2tlbiwgdGFza0lkOiB0aGlzLiRyb3V0ZS5xdWVyeS50YXNrSWQgfSwNCiAgICAgICAgICBwYXJhbXM6IHsgdHlwZTogJ2FkZCcgfQ0KICAgICAgICB9KQ0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goew0KICAgICAgICAgIG5hbWU6ICdhZGRGbGF3cycsDQogICAgICAgICAgcXVlcnk6IHsgbXNnOiB0aGlzLmN1cnJlbnRQb2ludCwgdG9rZW46IHRoaXMuZm9ybVRva2VuLCB0YXNrSWQ6IHRoaXMuJHJvdXRlLnF1ZXJ5LnRhc2tJZCB9LA0KICAgICAgICAgIHBhcmFtczogeyB0eXBlOiAnYWRkJyB9DQogICAgICAgIH0pDQogICAgICB9DQogICAgfSwNCiAgICBtYXBMb2FkZWQoKSB7DQogICAgICBsZXQgdGhhdCA9IHRoaXMNCiAgICAgIG1hcE9iai5tYXBJbnN0YW5jZSA9IHdpbmRvdy54YU1hcEJ1aWxkZXINCiAgICAgIG1hcE9iai5tYXAgPSB3aW5kb3cueGFNYXANCiAgICAgIHRoYXQubWFwTG9hZCA9IHRydWUNCiAgICAgIGFkZEltZ1RvTWFwKG1hcE9iai5tYXApDQogICAgICB0aGlzLmFkZE1haW5Tb3VyY2VMYXllcigpDQogICAgICB0aGlzLmFkZEJ1ZmZlckxheWVyKCkNCiAgICAgIHRoaXMuYWRkTWFpblVzZXJTb3VyY2VMYXllcigpDQogICAgICBpZiAodGhpcy50YXNrRGF0YS51c2VDaGlsZFJhbmdlID09IDAgfHwgIXRoaXMudGFza0RhdGEucmFuZ2VJZCkgew0KICAgICAgICB0aGlzLmdldEdyaWRSYW5nZSgpDQogICAgICB9IGVsc2UgaWYgKHRoaXMudGFza0RhdGEudXNlQ2hpbGRSYW5nZSA9PSAxICYmIHRoaXMudGFza0RhdGEucmFuZ2VJZCkgew0KICAgICAgICB0aGlzLmdldE1haW5SYW5nZUJ5SWQodGhpcy50YXNrRGF0YS5yYW5nZUlkKQ0KICAgICAgfQ0KICAgICAgKHR5cGVvZiB5dWFuY2h1ICE9ICd1bmRlZmluZWQnKSAmJiB5dWFuY2h1LmxvY2F0aW9uQU1hcC5yZXF1ZXN0U2luZ2xlTG9jYXRpb24oDQogICAgICAgIFsnMSddLA0KICAgICAgICAocmVzKSA9PiB7DQogICAgICAgICAgdGhhdC5jdXJyZW50UG9zaXRpb24gPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHJlcykpDQogICAgICAgICAgaWYgKCF0aGF0LmN1cnJlbnRQb3NpdGlvbikgew0KICAgICAgICAgICAgVG9hc3Qoew0KICAgICAgICAgICAgICBtZXNzYWdlOiAn5b2T5YmNR1BT5L+h5Y+35byxJywNCiAgICAgICAgICAgICAgZHVyYXRpb246IDE1MDAsDQogICAgICAgICAgICB9KQ0KICAgICAgICAgICAgcmV0dXJuDQogICAgICAgICAgfQ0KICAgICAgICAgIGNvbnN0IHBhcmFtID0gew0KICAgICAgICAgICAgLi4udGhhdC5jdXJyZW50UG9zaXRpb24sDQogICAgICAgICAgfQ0KICAgICAgICAgIHRoaXMuc2V0TWFpblVzZXJQb3NpdGlvbihwYXJhbSkNCiAgICAgICAgfSwNCiAgICAgICAgKGVycikgPT4gew0KICAgICAgICAgIGNvbnNvbGUubG9nKCdlcnI9JywgZXJyKQ0KICAgICAgICB9DQogICAgICApDQogICAgfSwNCiAgICBhZGRNYXBJbWcoKSB7DQogICAgICBsZXQgdGhhdCA9IHRoaXMNCiAgICAgIG1hcE9iai5tYXAubG9hZEltYWdlKA0KICAgICAgICByZXF1aXJlKCdAYXNzZXRzL2ltZy9pbnNwZWN0aW9uL3doaXRlX2Fycm93X3JpZ2h0LnBuZycpLA0KICAgICAgICBmdW5jdGlvbiAoZXJyb3IsIGltYWdlKSB7DQogICAgICAgICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvcg0KICAgICAgICAgIGlmICghbWFwT2JqLm1hcC5oYXNJbWFnZSgnYXJyb3dJY29uJykpIHsNCiAgICAgICAgICAgIG1hcE9iai5tYXAuYWRkSW1hZ2UoJ2Fycm93SWNvbicsIGltYWdlLCB7fSkNCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICkNCiAgICAgIG1hcE9iai5tYXAubG9hZEltYWdlKA0KICAgICAgICByZXF1aXJlKCdAYXNzZXRzL2ltZy9pbnNwZWN0aW9uL2ljb25fc3RhcnRpbmdfcG9pbnQucG5nJyksDQogICAgICAgIGZ1bmN0aW9uIChlcnJvciwgaW1hZ2UpIHsNCiAgICAgICAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yDQogICAgICAgICAgaWYgKCFtYXBPYmoubWFwLmhhc0ltYWdlKCdzdGFydF9wb2ludCcpKSB7DQogICAgICAgICAgICBtYXBPYmoubWFwLmFkZEltYWdlKCdzdGFydF9wb2ludCcsIGltYWdlLCB7fSkNCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICkNCiAgICAgIG1hcE9iai5tYXAubG9hZEltYWdlKA0KICAgICAgICByZXF1aXJlKCdAYXNzZXRzL2ltZy9pbnNwZWN0aW9uL2ljb25fYXRfZW5kLnBuZycpLA0KICAgICAgICBmdW5jdGlvbiAoZXJyb3IsIGltYWdlKSB7DQogICAgICAgICAgaWYgKGVycm9yKSB0aHJvdyBlcnJvcg0KICAgICAgICAgIGlmICghbWFwT2JqLm1hcC5oYXNJbWFnZSgnZW5kX3BvaW50JykpIHsNCiAgICAgICAgICAgIG1hcE9iai5tYXAuYWRkSW1hZ2UoJ2VuZF9wb2ludCcsIGltYWdlLCB7fSkNCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICkNCiAgICB9LA0KICAgIHN0YXJ0TWFpbldvcmsoKSB7DQogICAgICB0aGlzLm5vdGljZVNob3cgPSBmYWxzZQ0KICAgICAgdGhpcy5zdGFydFJlY29yZFRpbWVyID0gbmV3IERhdGUoKQ0KICAgICAgdGhpcy5pZlN0YXJ0ID0gdHJ1ZQ0KICAgIH0sDQogICAgc3RhcnRHZXRMb2NhdGlvbigpIHsNCiAgICAgIGxldCB0aGF0ID0gdGhpcw0KICAgICAgICB5dWFuY2h1LmxvY2F0aW9uQU1hcC5yZXF1ZXN0TG9jYXRpb25zKA0KICAgICAgICAgIFsnNScsICcxJywgJzEwJywgJzMwJywgJzAnLCB0cnVlXSwNCiAgICAgICAgICAocmVzKSA9PiB7DQogICAgICAgICAgICB0aGF0LmN1cnJlbnRQb3NpdGlvbiA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkocmVzKSkNCiAgICAgICAgICAgIHRoYXQuY3VycmVudFBvc2l0aW9uID0gT2JqZWN0LmFzc2lnbih0aGF0LmN1cnJlbnRQb3NpdGlvbiwgew0KICAgICAgICAgICAgICBkaXJlY3Rpb246IDANCiAgICAgICAgICAgIH0pDQogICAgICAgICAgICBpZiAoIXRoYXQuY3VycmVudFBvc2l0aW9uKSB7DQogICAgICAgICAgICAgIFRvYXN0KHsNCiAgICAgICAgICAgICAgICBtZXNzYWdlOiAn5b2T5YmNR1BT5L+h5Y+35byxJywNCiAgICAgICAgICAgICAgICBkdXJhdGlvbjogMTUwMCwNCiAgICAgICAgICAgICAgfSkNCiAgICAgICAgICAgICAgcmV0dXJuDQogICAgICAgICAgICB9DQogICAgICAgICAgICB0aGlzLnNldE1haW5Vc2VyUG9zaXRpb24odGhhdC5jdXJyZW50UG9zaXRpb24pDQogICAgICAgICAgfSwNCiAgICAgICAgICAoZXJyKSA9PiB7DQogICAgICAgICAgICBUb2FzdCh7DQogICAgICAgICAgICAgIG1lc3NhZ2U6ICdlcnInICsgZXJyLA0KICAgICAgICAgICAgICBkdXJhdGlvbjogMjAwMCwNCiAgICAgICAgICAgIH0pDQogICAgICAgICAgfQ0KICAgICAgICApDQogICAgfSwNCiAgICBnZXREaXJlY3Rpb24oKSB7DQogICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignZGV2aWNlb3JpZW50YXRpb25hYnNvbHV0ZScsIGUgPT4gew0KICAgICAgICBpZiAoZS5hbHBoYSkgew0KICAgICAgICAgIC8vIHRoaXMuYXBsaGEgPSBlLmFscGhhDQogICAgICAgICAgdGhpcy5zZXRSb3RhdGUoKGUuYWxwaGEgLSAxODApID49IDAgPyAoMTgwIC0gZS5hbHBoYSkgOiAoMTgwIC0gZS5hbHBoYSkpDQogICAgICAgIH0NCiAgICAgIH0pDQogICAgfSwNCiAgICAvLyDorr7nva7lhbvmiqTkurrlkZjkvY3nva4NCiAgICBzZXRNYWluVXNlclBvc2l0aW9uKHBvc2l0aW9uKSB7DQogICAgICAvLyB4Q29kZe+8jHlDb2Rl5Li657uP57qs5bqmDQogICAgICBjb25zdCBjb29yZCA9IFtwYXJzZUZsb2F0KHBvc2l0aW9uLmxvbmdpdHVkZSksIHBhcnNlRmxvYXQocG9zaXRpb24ubGF0aXR1ZGUpXTsNCiAgICAgIGNvbnN0IHBvaW50ID0gdHVyZi5wb2ludChjb29yZCk7DQogICAgICB0cnkgew0KICAgICAgICBjb25zdCB0aGF0ID0gdGhpczsNCiAgICAgICAgLy8g5a6a5pe25ZmoDQogICAgICAgIGxldCB0aW1lciA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAvLyDlpoLmnpzlnLDlm77lrp7kvovliJvlu7rjgIHlt6Hmo4DkurrlkZjlm77lsYLlrZjlnKjkuJTliqDovb3lrozmr5UNCiAgICAgICAgICBpZiAobWFwT2JqLm1hcC5nZXRTb3VyY2UoIm1haW5Vc2VyIikNCiAgICAgICAgICAgICYmIG1hcE9iai5tYXAuaXNTb3VyY2VMb2FkZWQoIm1haW5Vc2VyIikNCiAgICAgICAgICApIHsNCiAgICAgICAgICAgIC8vIOa4hemZpOWumuaXtuWZqA0KICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aW1lcik7DQogICAgICAgICAgICAvLyDlt6Hmo4DkurrlkZjlm77moIcNCiAgICAgICAgICAgIHRoYXQuc2V0U291cmNlRGF0YSgibWFpblVzZXIiLCB7DQogICAgICAgICAgICAgIHR5cGU6ICJGZWF0dXJlQ29sbGVjdGlvbiIsDQogICAgICAgICAgICAgIGZlYXR1cmVzOiBbcG9pbnRdDQogICAgICAgICAgICB9KQ0KICAgICAgICAgICAgdGhhdC5nZXREaXJlY3Rpb24oKQ0KICAgICAgICAgIH0NCiAgICAgICAgfSwgMTAwKQ0KICAgICAgfSBjYXRjaCAoZSkgew0KICAgICAgICBjb25zb2xlLmxvZyhlKTsNCiAgICAgIH0NCiAgICB9LA0KICAgIHNldFJvdGF0ZShiZWFyaW5nKSB7DQogICAgICAvLyDosIPmlbTnvZfnm5jmlrnlkJENCiAgICAgIG1hcE9iai5tYXAuc2V0TGF5b3V0UHJvcGVydHkoIm1haW5Vc2VyTGF5ZXIiLCAiaWNvbi1yb3RhdGUiLCBiZWFyaW5nKTsNCiAgICB9LA0KICAgIHN0YXJ0SW5zcFJlY29yZCgpIHsNCiAgICAgIGlmICh0aGlzLmlzVmlldykgew0KICAgICAgICBUb2FzdCh7DQogICAgICAgICAgbWVzc2FnZTogJ+ivpeW3oeajgOS7u+WKoeW3sue7k+adnycsDQogICAgICAgICAgZHVyYXRpb246IDE1MDAsDQogICAgICAgIH0pDQogICAgICAgIHJldHVybg0KICAgICAgfQ0KICAgICAgbGV0IHRoYXQgPSB0aGlzDQogICAgICBpZiAodGhpcy50YXNrRGF0YS5zdGF0dXMgPT0gMCkgew0KICAgICAgICB0aGlzLm5vdGljZVNob3cgPSB0cnVlDQogICAgICAgIGxldCB0aW1lciA9IHNldEludGVydmFsKCgpID0+IHsNCiAgICAgICAgICBpZiAodGhhdC5jb250aW51ZVRpbWUgPD0gMCkgew0KICAgICAgICAgICAgdGhhdC5oYXNLbm93ID0gdHJ1ZQ0KICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aW1lcikNCiAgICAgICAgICAgIHJldHVybg0KICAgICAgICAgIH0NCiAgICAgICAgICB0aGF0LmNvbnRpbnVlVGltZS0tDQogICAgICAgIH0sIDEwMDApDQogICAgICAgIHJldHVybg0KICAgICAgfQ0KICAgICAgdGhpcy5zdGFydEdldExvY2F0aW9uKCkNCiAgICAgIHRoaXMuc3RhcnRSZWNvcmRUaW1lciA9IG5ldyBEYXRlKCkNCiAgICAgIHRoaXMuaWZTdGFydCA9IHRydWUNCiAgICB9LA0KICAgIC8vIOe7k+adn+iusOW9lQ0KICAgIGVuZFJlY29yZCgpIHsNCiAgICAgIGxldCBkaWZmID0gTWF0aC5mbG9vcigobmV3IERhdGUoKSAtIHRoaXMuc3RhcnRSZWNvcmRUaW1lcikgLyAxMDAwKQ0KDQogICAgICBpZiAoZGlmZiA8PSAxMCkgew0KICAgICAgICBUb2FzdCh7DQogICAgICAgICAgbWVzc2FnZTogYOe7k+adn+WkquW/q+S6hizor7ckezEwIC0gZGlmZn3np5LlkI7lho3or5VgLA0KICAgICAgICAgIGR1cmF0aW9uOiAxMDAwLA0KICAgICAgICB9KQ0KICAgICAgICByZXR1cm4NCiAgICAgIH0NCiAgICAgIERpYWxvZy5jb25maXJtKHsNCiAgICAgICAgdGl0bGU6ICfmoIfpopgnLA0KICAgICAgICBtZXNzYWdlOiAn56Gu5a6a57uT5p2f5pys5qyh5YW75oqk77yfJywNCiAgICAgIH0pDQogICAgICAgIC50aGVuKCgpID0+IHsNCiAgICAgICAgICB0aGlzLmVuZFJlY29yZENvbmZpcm0oKQ0KICAgICAgICB9KQ0KICAgICAgICAuY2F0Y2goKCkgPT4gew0KICAgICAgICAgIHRoaXMuZW5kUmVjb3JkQ2FuY2VsKCkNCiAgICAgICAgfSkNCiAgICB9LA0KICAgIC8vIOe7k+adn+iusOW9leWPlua2iA0KICAgIGVuZFJlY29yZENhbmNlbCgpIHsNCiAgICAgIHRoaXMuZW5kUmVjb3JkU2hvdyA9IGZhbHNlDQogICAgfSwNCiAgICAvLyDnu5PmnZ/orrDlvZXnoa7orqQNCiAgICBhc3luYyBlbmRSZWNvcmRDb25maXJtKCkgew0KICAgICAgKHR5cGVvZiB5dWFuY2h1ICE9ICd1bmRlZmluZWQnKSAmJiB5dWFuY2h1LmxvY2F0aW9uQU1hcC5zdG9wUmVxdWVzdExvY2F0aW9ucygpDQogICAgICB0aGlzLmlmU3RhcnQgPSBmYWxzZQ0KICAgICAgdGhpcy51cGRhdGVQcm9ncmVzcygpDQogICAgICB0aGlzLmdldE1haW5EZXZQb2ludCgpDQogICAgICBUb2FzdCh7DQogICAgICAgIG1lc3NhZ2U6ICfnu5PmnZ/miJDlip8nLA0KICAgICAgICBkdXJhdGlvbjogMjAwMA0KICAgICAgfSkNCiAgICB9LA0KICAgIC8vIOW8gOWni+WumuS9jQ0KICAgIHN0YXJ0TG9jYXRpb24oKSB7DQogICAgICBpZiAoDQogICAgICAgICF0aGlzLmN1cnJlbnRQb3NpdGlvbiB8fA0KICAgICAgICAhdGhpcy5jdXJyZW50UG9zaXRpb24ubG9uZ2l0dWRlIHx8DQogICAgICAgICF0aGlzLmN1cnJlbnRQb3NpdGlvbi5sYXRpdHVkZQ0KICAgICAgKSB7DQogICAgICAgIFRvYXN0KHsNCiAgICAgICAgICBtZXNzYWdlOiAn6I635Y+W5L2N572u5aSx6LSlIScsDQogICAgICAgICAgZHVyYXRpb246IDIwMDAsDQogICAgICAgIH0pDQogICAgICAgIHJldHVybg0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgY29uc3QgY29vcmQgPSBbDQogICAgICAgICAgcGFyc2VGbG9hdCh0aGlzLmN1cnJlbnRQb3NpdGlvbi5sb25naXR1ZGUpLA0KICAgICAgICAgIHBhcnNlRmxvYXQodGhpcy5jdXJyZW50UG9zaXRpb24ubGF0aXR1ZGUpLA0KICAgICAgICBdDQogICAgICAgIHRoaXMuZmx5VG9Qb2ludChjb29yZCkNCiAgICAgIH0NCiAgICB9LA0KICAgIC8vIOehruiupA0KICAgIG9uQ29uZmlybSgpIHsNCiAgICAgIGlmICh0cnVlKSB7DQogICAgICAgIGxldCBjb3B5U2lnbkZvcm0gPSB0aGlzLmRlZXBDbG9uZSh0aGlzLnNpZ25Gb3JtKQ0KICAgICAgICBjb3B5U2lnbkZvcm0ubWFpbnRhaW5EYXRlID0gZGF5anMoKS5mb3JtYXQoJ1lZWVktTU0tREQnKQ0KICAgICAgICBjb3B5U2lnbkZvcm0udGFza0lkID0gdGhpcy4kcm91dGUucXVlcnkudGFza0lkDQogICAgICAgIGNvcHlTaWduRm9ybS5tYWludGFpbkltYWdlc0xpc3QgPSBbLi4udGhpcy5tYWludGFpbkJlZm9yZUltYWdlLCAuLi50aGlzLm1haW50YWluQWZ0ZXJJbWFnZV0NCiAgICAgICAgaWYgKHRoaXMuY3VycmVudFNlbGVjdERldi5wcm9wZXJ0aWVzLmRldmljZVR5cGUgPT0gJ+euoee6vycpIHsNCiAgICAgICAgICBjb3B5U2lnbkZvcm0ucGlwZUxlbmd0aCA9IHRoaXMuY3VycmVudFNlbGVjdERldi5wcm9wZXJ0aWVzWydsZW5ndGgnXQ0KICAgICAgICAgIGNvcHlTaWduRm9ybS5waXBlSWQgPSB0aGlzLmN1cnJlbnRTZWxlY3REZXYucHJvcGVydGllcy5pZA0KICAgICAgICAgIGFwaS51cGxvYWRNYWluTGluZVJlY29yZHMoY29weVNpZ25Gb3JtKS50aGVuKChyZXMpID0+IHsNCiAgICAgICAgICAgIGlmIChyZXMgJiYgcmVzLnN0YXR1cykgew0KICAgICAgICAgICAgICBUb2FzdCh7DQogICAgICAgICAgICAgICAgbWVzc2FnZTogJ+WFu+aKpOiusOW9leS4iuS8oOaIkOWKnycsDQogICAgICAgICAgICAgICAgZHVyYXRpb246IDIwMDAsDQogICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgIHRoaXMuZ2V0TWFpbkRldlBvaW50KCkNCiAgICAgICAgICAgICAgdGhpcy51cGRhdGVQcm9ncmVzcygpDQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICBUb2FzdCh7DQogICAgICAgICAgICAgICAgbWVzc2FnZTogJ+WFu+aKpOiusOW9leS4iuS8oOWksei0pScsDQogICAgICAgICAgICAgICAgZHVyYXRpb246IDIwMDAsDQogICAgICAgICAgICAgIH0pDQogICAgICAgICAgICB9DQogICAgICAgICAgfSkNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICBjb3B5U2lnbkZvcm0ucG9pbnRJZCA9IHRoaXMuY3VycmVudFNlbGVjdERldi5wcm9wZXJ0aWVzLmlkDQogICAgICAgICAgYXBpLnVwbG9hZE1haW5Qb2ludFJlY29yZHMoY29weVNpZ25Gb3JtKS50aGVuKChyZXMpID0+IHsNCiAgICAgICAgICAgIGlmIChyZXMgJiYgcmVzLnN0YXR1cykgew0KICAgICAgICAgICAgICBUb2FzdCh7DQogICAgICAgICAgICAgICAgbWVzc2FnZTogJ+WFu+aKpOiusOW9leS4iuS8oOaIkOWKnycsDQogICAgICAgICAgICAgICAgZHVyYXRpb246IDIwMDAsDQogICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgIHRoaXMuZ2V0TWFpbkRldlBvaW50KCkNCiAgICAgICAgICAgICAgdGhpcy51cGRhdGVQcm9ncmVzcygpDQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICBUb2FzdCh7DQogICAgICAgICAgICAgICAgbWVzc2FnZTogJ+WFu+aKpOiusOW9leS4iuS8oOWksei0pScsDQogICAgICAgICAgICAgICAgZHVyYXRpb246IDIwMDAsDQogICAgICAgICAgICAgIH0pDQogICAgICAgICAgICB9DQogICAgICAgICAgfSkNCiAgICAgICAgfQ0KICAgICAgICB0aGlzLnNpZ25TaG93ID0gZmFsc2UNCiAgICAgICAgdGhpcy5zaWduRm9ybS5yZW1hcmtzID0gJycNCiAgICAgICAgdGhpcy5zaWduRm9ybS5tYWludGFpblR5cGUgPSAnJw0KICAgICAgICB0aGlzLmF0dGFjaG1lbnQgPSAnJw0KICAgICAgICB0aGlzLmF0dGFjaG1lbnQxID0gJycNCiAgICAgICAgdGhpcy5tYWludGFpbkFmdGVySW1hZ2UgPSBbXQ0KICAgICAgICB0aGlzLm1haW50YWluQmVmb3JlSW1hZ2UgPSBbXQ0KICAgICAgICB0aGlzLnNldFNvdXJjZURhdGEoJ2J1ZmZlcmVkJywgew0KICAgICAgICAgIHR5cGU6ICdGZWF0dXJlQ29sbGVjdGlvbicsDQogICAgICAgICAgZmVhdHVyZXM6IFtdLA0KICAgICAgICB9KQ0KICAgICAgICAvLyB0aGlzLnJlZnJlc2hUYXNrKCkNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIGNvbnNvbGUubG9nKCfpqozor4HlpLHotKUnKQ0KICAgICAgfQ0KICAgIH0sDQogICAgdXBkYXRlUHJvZ3Jlc3MoKSB7DQogICAgICBhcGkudXBkYXRlUHJvZ3Jlc3MoeyB0YXNrSWQ6IHRoaXMuJHJvdXRlLnF1ZXJ5LnRhc2tJZCB9KS50aGVuKHJlcyA9PiB7DQogICAgICAgIGlmIChyZXMuc3RhdHVzKSB7DQogICAgICAgICAgdGhpcy5wcm9ncmVzcyA9IHJlcy5kYXRhDQogICAgICAgIH0NCiAgICAgIH0pDQogICAgfSwNCiAgICAvLyDlj5bmtogNCiAgICBvbkNhbmNlbCgpIHsNCiAgICAgIHRoaXMuc2lnblNob3cgPSBmYWxzZQ0KICAgICAgdGhpcy5zZXRTb3VyY2VEYXRhKCdidWZmZXJlZCcsIHsNCiAgICAgICAgdHlwZTogJ0ZlYXR1cmVDb2xsZWN0aW9uJywNCiAgICAgICAgZmVhdHVyZXM6IFtdLA0KICAgICAgfSkNCiAgICAgIHRoaXMuY3VycmVudFNlbGVjdERldiA9IG51bGwNCiAgICAgIHRoaXMuYXR0YWNobWVudCA9ICcnDQogICAgICB0aGlzLm1haW50YWluQmVmb3JlSW1hZ2UgPSBbXQ0KICAgICAgdGhpcy5hdHRhY2htZW50MSA9ICcnDQogICAgICB0aGlzLm1haW50YWluQWZ0ZXJJbWFnZSA9IFtdDQogICAgfQ0KICB9LA0KICBiZWZvcmVSb3V0ZUxlYXZlKHRvLCBmcm9tLCBuZXh0KSB7DQogICAgaWYgKHRvLm5hbWUgPT0gJ01haW50ZW5NYW5hZ2VtZW50JyAmJiBmcm9tLm5hbWUgPT0gJ1Rhc2tEZXRhaWwnKSB7DQogICAgICBpZiAodGhpcy5pZlN0YXJ0KSB7DQogICAgICAgIERpYWxvZy5jb25maXJtKHsNCiAgICAgICAgICB0aXRsZTogJ+agh+mimCcsDQogICAgICAgICAgbWVzc2FnZTogJ+mAgOWHuuWQjuS8muWBnOatouWumuS9jSznoa7lrprpgIDlh7rvvJ8nLA0KICAgICAgICB9KQ0KICAgICAgICAgIC50aGVuKCgpID0+IHsNCiAgICAgICAgICAgICh0eXBlb2YgeXVhbmNodSAhPSAndW5kZWZpbmVkJykgJiYgeXVhbmNodS5sb2NhdGlvbkFNYXAuc3RvcFJlcXVlc3RMb2NhdGlvbnMoKQ0KICAgICAgICAgICAgbmV4dCgpDQogICAgICAgICAgfSkNCiAgICAgICAgICAuY2F0Y2goKCkgPT4gew0KICAgICAgICAgICAgdGhpcy5lbmRSZWNvcmRDYW5jZWwoKQ0KICAgICAgICAgIH0pDQogICAgICB9IGVsc2Ugew0KICAgICAgICBuZXh0KCkNCiAgICAgIH0NCiAgICB9IGVsc2Ugew0KICAgICAgbmV4dCgpDQogICAgfQ0KICB9DQp9DQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AAoSA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/MaintenManagement/TaskDetail","sourcesContent":["<template>\r\n  <div class=\"task-map full-width\">\r\n    <!-- 导航栏 -->\r\n    <div class=\"navbar-box\">\r\n      <fm-nav-bar\r\n        :title=\"navbarTitle\"\r\n        left-arrow\r\n        @click-left=\"$router.go(-1)\"\r\n        @click-right=\"openPopup\"\r\n      >\r\n        <template #right>\r\n          <fm-popover\r\n            :visible.sync=\"showPopover\"\r\n            trigger=\"click\"\r\n            :actions=\"actions\"\r\n            @select=\"onSelect\"\r\n            placement=\"bottom-end\"\r\n          >\r\n            <template #reference>\r\n              <img style=\"width: 34px\" :src=\"require('@/assets/img/inspection/增加.png')\" />\r\n            </template>\r\n          </fm-popover>\r\n        </template>\r\n      </fm-nav-bar>\r\n    </div>\r\n    <!-- 地图 -->\r\n    <xa-map ref=\"mymap\" :create=\"mapLoaded\"></xa-map>\r\n    <!-- 开始记录与结束记录 -->\r\n    <div class=\"start-record\">\r\n    </div>\r\n    <!-- 数据面板 -->\r\n    <div class=\"controlCard\" v-if=\"!ifStart\">\r\n      <div class=\"mainContent\">\r\n        <div class=\"contentList\" v-for=\"item of objList\" :key=\"item.name\">\r\n          <div class=\"obj\">\r\n            <div class=\"point\"></div>\r\n            <div class=\"name\">{{ taskBizType + item.name }}:</div>\r\n            <div class=\"num\">{{ item.num }}</div>\r\n            <div class=\"unit\">{{ item.unit }}</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"startBtn\">\r\n        <div class=\"btnContent\" @click=\"startInspRecord\">开始</div>\r\n      </div>\r\n    </div>\r\n    <div v-else class=\"controlCard_start\">\r\n      <div class=\"progressControl\">\r\n        <img width=\"24\" height=\"24\" class=\"icon\" src=\"@/assets/img/inspection/管线覆盖率.png\" alt />\r\n        <div class=\"title\">进度</div>\r\n        <div :style=\"styleVar\" class=\"progressWidth\">\r\n          <!-- 第二层，计算得到的实际比率宽度 -->\r\n          <div :style=\"styleVar\" class=\"colorWidth\">\r\n            <!-- 第三层，动画 -->\r\n            <div :style=\"styleVar\" class=\"progressAnimate\"></div>\r\n          </div>\r\n        </div>\r\n        <div class=\"bluePercent\">{{ hasMain }}</div>\r\n        <div class=\"purPercent\">{{ '/' + allMain }}</div>\r\n      </div>\r\n      <img\r\n        class=\"controlBtn\"\r\n        :src=\"require('@/assets/img/maintenance/养护结束按钮.png')\"\r\n        @click=\"endRecord\"\r\n      />\r\n    </div>\r\n    <!-- 轨迹显示与定位功能 -->\r\n    <div class=\"tool-box\">\r\n      <div class=\"location\" @click=\"startLocation\">\r\n        <fm-image class=\"location-image\" :src=\"require('@/assets/img/inspection/location.png')\"></fm-image>\r\n      </div>\r\n    </div>\r\n    <!-- 签到框 -->\r\n    <fm-popup\r\n      :visible.sync=\"signShow\"\r\n      :modal=\"false\"\r\n      round\r\n      position=\"bottom\"\r\n      :style=\"{ height: '58%' }\"\r\n    >\r\n      <div class=\"tab\">\r\n        <div\r\n          class=\"dealName\"\r\n          :style=\"dealBefore ? { 'color': '#1B67D8', 'font-weight': '600' } : {}\"\r\n          @click=\"dealBefore=true\"\r\n        >处理前</div>\r\n        <img\r\n          :src=\"require('@/assets/img/maintenance/----箭头.png')\"\r\n          height=\"7\"\r\n          style=\"margin: auto 14px;\"\r\n        />\r\n        <div\r\n          class=\"dealName\"\r\n          :style=\"!dealBefore ? { 'color': '#1B67D8', 'font-weight': '600' } : {}\"\r\n          @click=\"dealBefore=false\"\r\n        >处理后</div>\r\n      </div>\r\n      <div class=\"popup-view\">\r\n        <fm-form ref=\"signForm\" :mode=\"signForm\">\r\n          <div v-show=\"dealBefore\">\r\n            <uploader\r\n              label=\"处理前照片\"\r\n              v-model=\"attachment\"\r\n              @fileChange=\"fileChangeBefore\"\r\n              multiple\r\n              :disabled=\"hasSignIn\"\r\n              :maxImagesCount=\"2\"\r\n              type=\"image\"\r\n              :rules=\"[{ require: true, message: '请上传照片' }]\"\r\n            />\r\n            <!-- <fm-field v-model=\"temp\" name=\"积泥深度\" label=\"积泥深度\" placeholder=\"请输入\" /> -->\r\n\r\n            <fm-field label=\"备注\" type=\"textarea\" :disabled=\"hasSignIn\" placehold=\"请输入\" v-model=\"signForm.remarks\"></fm-field>\r\n          </div>\r\n          <div v-show=\"!dealBefore\">\r\n            <fm-field label=\"请确认本次养护内容\" />\r\n            <fm-field name=\"checkboxGroup\">\r\n              <template #input>\r\n                <fm-checkbox-group v-model=\"checkboxGroup\" :disabled=\"hasSignIn\" direction=\"vertical\" @change=\"changeCheckBox\">\r\n                  <fm-checkbox :name=\"it.name\" v-for=\"it of maintenContentsList\" :key=\"it.code\" shape=\"square\">{{ it.name }}</fm-checkbox>\r\n                </fm-checkbox-group>\r\n              </template>\r\n            </fm-field>\r\n            <uploader\r\n              label=\"处理后照片\"\r\n              v-model=\"attachment1\"\r\n              @fileChange=\"fileChangeAfter\"\r\n              multiple\r\n              :disabled=\"hasSignIn\"\r\n              :maxImagesCount=\"2\"\r\n              type=\"image\"\r\n              :rules=\"[{ require: true, message: '请上传照片' }]\"\r\n            />\r\n\r\n            <fm-field type=\"textarea\" v-model=\"signForm.maintainType\" :disabled=\"hasSignIn\" name=\"养护方式\" label=\"养护方式\" autosize placeholder=\"请输入\" />\r\n          </div>\r\n        </fm-form>\r\n      </div>\r\n      <div class=\"btnArea\" v-show=\"!hasSignIn && dealBefore\">\r\n        <fm-button class=\"btn1\" @click=\"onCancel\" round type=\"default\">取消</fm-button>\r\n        <fm-button class=\"btn2\" @click=\"dealBefore=false\" round type=\"primary\">下一步</fm-button>\r\n      </div>\r\n      <div class=\"btnArea\" v-show=\"!hasSignIn && !dealBefore\">\r\n        <fm-button class=\"btn1\" @click=\"dealBefore=true\" round type=\"default\">上一步</fm-button>\r\n        <fm-button class=\"btn2\" @click=\"onConfirm\" round type=\"primary\">提交</fm-button>\r\n      </div>\r\n      <div class=\"btnArea\" v-show=\"hasSignIn\">\r\n        <fm-button class=\"btn\" @click=\"onCancel\" round type=\"default\">关闭</fm-button>\r\n      </div>\r\n    </fm-popup>\r\n    <!-- 养护列表 -->\r\n    <div class=\"arrow-up\" :style=\"mainListStyle\">\r\n      <i\r\n        class=\"fm-icon\"\r\n        id=\"arrowUp\"\r\n        :class=\"mainListStyle['--top'] == (clientY - 24) ? 'fm-icon-arrow-up' : 'fm-icon-minus'\"\r\n      ></i>\r\n      <div class=\"content\">\r\n        <fm-tabs v-model=\"active\" swipeable style=\"height: 100%\">\r\n          <fm-tab :label=\"'未完成' + '(' + maintenObj.isNotMain.length + ')'\">\r\n            <div class=\"contentArea\">\r\n              <div style=\"overflow-x: scroll;\">\r\n                <div class=\"buttonArea\" :style=\"buttonAreaStyle\">\r\n                  <fm-button\r\n                    round\r\n                    v-for=\"it of buttonList\"\r\n                    :key=\"it\"\r\n                    class=\"button\"\r\n                    :style=\"currentSeleIsNotMainType == it ? { 'color': '#1B67D8', 'background': '#DDE8F9' } : {}\"\r\n                    @click=\"filterIsNotMainList(it)\"\r\n                  >{{ it }}</fm-button>\r\n                </div>\r\n              </div>\r\n              <div class=\"listArea\">\r\n                <fm-list\r\n                  v-model=\"loading\"\r\n                  :finished=\"finished\"\r\n                  finished-text=\"没有更多了\"\r\n                  @load=\"onLoad\"\r\n                >\r\n                  <div v-for=\"(it, idx) of maintenObj.isNotMain\" :key=\"it.id\" class=\"list\">\r\n                    <div class=\"list_num\">{{ idx + 1 }}</div>\r\n                    <div class=\"list_type\">{{ it.deviceType || '' }}</div>\r\n                    <div class=\"list_id\">{{ it.deviceId || '' }}</div>\r\n                    <div class=\"list_deal\" @click=\"goToDeal(it)\">\r\n                      去处理\r\n                      <img\r\n                        width=\"24\"\r\n                        height=\"24\"\r\n                        style=\"margin: auto 0 auto 4px;\"\r\n                        :src=\"require('@/assets/img/maintenance/deal.png')\"\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                </fm-list>\r\n              </div>\r\n            </div>\r\n          </fm-tab>\r\n          <fm-tab label=\"已完成\">\r\n            <div class=\"contentArea\">\r\n              <div style=\"overflow-x: scroll;\">\r\n                <div class=\"buttonArea\" :style=\"buttonAreaStyle\">\r\n                  <fm-button\r\n                    round\r\n                    v-for=\"it of buttonList\"\r\n                    :key=\"it\"\r\n                    class=\"button\"\r\n                    :style=\"currentSeleIsMainType == it ? { 'color': '#1B67D8', 'background': '#DDE8F9' } : {}\"\r\n                    @click=\"filterIsMainList(it)\"\r\n                  >{{ it }}</fm-button>\r\n                </div>\r\n              </div>\r\n              <div class=\"listArea\">\r\n                <fm-list\r\n                  v-model=\"loading\"\r\n                  :finished=\"finished\"\r\n                  finished-text=\"没有更多了\"\r\n                  @load=\"onLoad\"\r\n                >\r\n                  <div v-for=\"(it, idx) of maintenObj.isMain\" :key=\"it.id\" class=\"list\">\r\n                    <div class=\"list_num\">{{ idx + 1 }}</div>\r\n                    <div class=\"list_type\">{{ it.deviceType || '' }}</div>\r\n                    <div class=\"list_id\">{{ it.deviceId || '' }}</div>\r\n                    <div class=\"list_deal\" @click=\"goToDeal(it)\">\r\n                      定位\r\n                      <!-- <img width=\"24\" height=\"24\" style=\"margin: auto 0 auto 4px;\" :src=\"require('@/assets/img/maintenance/deal.png')\" /> -->\r\n                    </div>\r\n                  </div>\r\n                </fm-list>\r\n              </div>\r\n            </div>\r\n          </fm-tab>\r\n        </fm-tabs>\r\n      </div>\r\n    </div>\r\n    <fm-popup\r\n      :visible.sync=\"noticeShow\"\r\n      :close-on-click-modal=\"false\"\r\n      round\r\n      position=\"bottom\"\r\n      :style=\"{ height: '68%' }\"\r\n    >\r\n      <div class=\"noticeBody\">\r\n        <div class=\"noticeTitle\">安全须知</div>\r\n        <div class=\"noticeContent\">\r\n          <h5>第一节  有限空间作业</h5>\r\n          <h6>(1) 作业标准</h6>\r\n          <p>1、直径小于800mm的管线，高度小于800mm的方沟，以及截面积小于0.5M²的有限空间禁止人员进入。液面深度大于50cm，流速大于0.5m/s的有限空间内禁止人员作业。</p>\r\n          <p>2、进入有害气体浓度超标及缺氧的有限空间作业，必须加强通风，符合要求后施工人员必须佩戴长管呼吸器。</p>\r\n          <p>3、当可燃气（CH4）浓度超标时，必须采取强制通风措施，可燃气体浓度降至5%LEL以下时，方可作业。</p>\r\n          <p>4、有限空间或内部井下空间作业均按照有限空间作业标准实施。</p>\r\n          <h6>(2) 作业要求</h6>\r\n          <p>1、使用气体检测仪，须在有限空间外的洁净气体中开机，并运行5 分钟进行自动标定后，方可进行检测。</p>\r\n          <p>2、禁止在存在有害气体的设施5m 半径范围内，吸烟、动用明火、使用电气焊，禁止携带易燃易爆品进入有限空间。</p>\r\n          <p>3、当有限空间内气体检测可燃气超标、存在燃烧、爆炸危险时，下井人员不得穿易产生静电的衣物，不得携带使用易产生火花的工具。并对下井作业的安全装备进行仔细检查。</p>\r\n          <p>4、作业时，井口有人值守，队内安排安全员在井上，下井作业人员佩戴长管呼吸器，腰间系绳索以备万一。</p>\r\n          <p>5、在整个施工过程中不间断地进行有毒有害气体检测工作，如发现异常情况立即通知井下作业人员撤离现场。为避免有毒有害气体对施工人员安全造成伤害，施工过程中风机排风处理不能间断。</p>\r\n          <p>6、必须遵守有限空间作业的相关管理规定。</p>\r\n          <h6>(3) 职责</h6>\r\n          <p>1、作业负责人职责：应了解整个作业过程中存在的危险危害因素；确认作业环境、作业程序、防护设施、作业人员符合要求后，授权批准作业；及时掌握作业过程中可能发生的条件变化，当有限空间作业条件不符合安全要求时，终止作业。</p>\r\n          <p>2、作业者职责：应接受有限空间作业安全生产培训；遵守有限空间作业安全操作规程，正确使用有限空间作业安全设施与个人防护用品；应与监护者进行有效的操作作业、报警、撤离等信息沟通。</p>\r\n          <p>3、监护者职责：应接受有限空间作业安全生产培训；全过程掌握作业者作业期间情况，保证在有限空间外持续监护，能够与作业者进行有效的操作作业、报警、撤离等信息沟通；在紧急情况时向作业者发出撤离警告，必要时立即呼叫应急救援服务，并在有限空间外实施紧急救援工作；防止未经授权的人员进入。</p>\r\n          <h6>(4) 作业防护设备与使用</h6>\r\n          <p>1、从事有限空间危险作业现场必须配备“四合一”气体检测仪，在有限空间外对有限空间内的主要有害气体浓度进行实时监测。检测仪器须定期检定、维护，确保灵敏、有效。</p>\r\n          <p>2、地下有限空间作业环境存在爆炸危险的，电气设备、照明用具等应满足防爆要求。</p>\r\n          <p>3、地下有限空间临时用电应符合GB/T13869 的规定。</p>\r\n          <p>4、手持照明电压应不大于24v，在积水、结露的地下有限空间作业，手持照明电压应不大于12v。</p>\r\n          <p>5、从事有限空间危险作业的人员须佩戴安全帽、全身式安全带及安全绳。</p>\r\n          <p>6、当有限空间作业时，作业人员必须佩戴长管呼吸器或正压隔绝式空气呼吸器。</p>\r\n          <p>7、进入有限空间作业前，应先打开相邻的检查井井盖或通风口,自然通风不少于30 分钟，并使用“四合一”气体检测仪，在有限空间外对设施内的主要有害气体浓度进行检测，确定人员进入所需防护用品；人员进入后必须进行不间断气体监测。</p>\r\n          <h5>第二节  占道作业</h5>\r\n          <p>1、作业人员服装颜色应当符合国家相关标准要求，具备反光或部分反光性能；安全服反光部分最小宽度不应小于5 厘米。</p>\r\n          <p>2、用于维护占道作业现场安全的保护车辆，应当喷涂符合国家相关标准的反光油漆，或粘贴规定颜色的工程级以上的反光膜并保持表面清洁；车辆顶部必须配置黄色爆闪警示灯，车辆护栏上应配置闪光箭头板，以上灯具占道作业时必须开启，保证各个方向至少100 米以外清晰可见。</p>\r\n          <p>3、占道作业交通安全设施的种类及设置要求应符合现行行业标准《道路作业交通安全标志》GA182 及地方标准的规定。</p>\r\n          <p>4、在道路上执行排水设施相关作业并可能影响道路交通安全、畅通地占用道路行为，由作业班组根据公安交通管理部门要求（参照《影响交通安全的占道施工许可工作规范》）编制占道审批材料，报公司相应业务管理人员，由业务管理人员审核后报公安交通管理部门审批，审批通过后返回作业班组，由作业班组报道路所属区交通支队备案。</p>\r\n          <p>5、公司从事占道作业的人员必须接受公司安全监督管理人员组织的安全技术培训，掌握作业程序、人工急救和交通安全防护设施、警示灯具的操作方法。公司占道作业人员每年进行不少于4 学时的占道作业安全教育和专业技术培训，并建立安全培训档案。每次组织开展占道作业，作业人数应不少于三人，其中至少一人负责现场交通疏导工作。</p>\r\n          <p>6、实施占道作业前，必须由负责该项作业的管理人员根据占道作业方案对作业人员进行书面交底，告知作业内容、安全注意事项及采取的安全措施，并由管理人员、班组长和作业人员签字确认。</p>\r\n        </div>\r\n        <div class=\"noticeBtnArea\">\r\n          <fm-button class=\"noticeBtn\" :style=\"{ 'background': hasKnow ? '#1B67D8' : '#999999' }\" round :disabled=\"!hasKnow\" @click=\"startMainWork\">{{ hasKnow ? '已了解' : '已了解' + '(' + continueTime + 's)' }}</fm-button>\r\n        </div>\r\n      </div>\r\n    </fm-popup>\r\n\r\n    <!-- 提示层 -->\r\n    <div v-show=\"ifTips\" class=\"tip-tools\">\r\n      <img :src=\"require('@/assets/img/tips.png')\" class=\"tipImg\" />\r\n      <div class=\"context\">请在地图上选择设施或者点位</div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport bus from '@/views/inspectMap/utils/Bus.js'\r\nimport axios from 'axios'\r\nimport dayjs from 'dayjs'\r\nimport MapComp from '@/views/inspectMap/index.vue'\r\nimport request from '@/utils/request'\r\nimport * as api from '../api'\r\nimport { Toast, Dialog } from 'fawkes-mobile-lib'\r\nimport * as turf from '@turf/turf'\r\nimport Uploader from '@/components/upload/Uploader.vue'\r\nimport addImgToMap from '../utils/setIcon.js'\r\n// import problemCardInfo from './problemCardInfo';\r\nimport API from '@/common/config.js'\r\nimport Vue from 'vue';\r\nimport Popup from '../../inspectMap/components/popup.vue'\r\nconst PopupItem = Vue.extend(Popup)\r\nconst mapObj = {\r\n  map: null,\r\n  mapInstance: null,\r\n}\r\nconst currentMainPoint = {\r\n  isMain: [],\r\n  isNotMain: [],\r\n}\r\nexport default {\r\n  name: 'mainten-task',\r\n  components: {\r\n    MapComp,\r\n    Uploader,\r\n    // problemCardInfo,\r\n  },\r\n  data() {\r\n    return {\r\n      maintenRangeList: [],\r\n      taskData: null,\r\n      progress: '',\r\n      hasKnow: false,\r\n      continueTime: 10,\r\n      noticeShow: false,\r\n      maintainBeforeImage: [],\r\n      maintainAfterImage: [],\r\n      currentSelectDev: null,\r\n      maintenContentsList: [],\r\n      currentSeleIsMainType: '全部',\r\n      currentSeleIsNotMainType: '全部',\r\n      maintenObj: {\r\n        isMain: [],\r\n        isNotMain: [],\r\n      },\r\n      loading: false,\r\n      finished: false,\r\n      // buttonList: ['全部', '雨水口'],\r\n      mainListStyle: {\r\n        '--top': document.body.clientHeight - 24 + 'px',\r\n        '--heigth': '24px',\r\n      },\r\n      checkboxGroup: [],\r\n      dealBefore: true,\r\n      temp: '',\r\n      mapLoad: false,\r\n      hasMain: 0,\r\n      allMain: 0,\r\n      ifStart: false,\r\n      styleVar: {\r\n        '--totalWidth': '148px',\r\n        '--barWidth': '100px',\r\n        '--colorBlue': 'blue',\r\n      },\r\n      objList: [],\r\n      taskBizType: '',\r\n      ifTips: false,\r\n      reportDataIsLoaded: false,\r\n      // 巡检任务下所有巡检管线\r\n      allTaskLines: [],\r\n      isView: true,\r\n      active: 0,\r\n      deviceName: '',\r\n      hasSignIn: false,\r\n      showPopover: false,\r\n      actions: [\r\n        {\r\n          text: '问题上报',\r\n        },\r\n        // {\r\n        //   text: '设施缺陷',\r\n        // },\r\n      ],\r\n      currentRate: 0,\r\n      // 控制关键点列表显隐\r\n      pointListShow: false,\r\n      // 全局发声函数\r\n      // 记录开始巡检的时间，用于判断是否在开始巡检的10s内\r\n      startRecordTimer: '',\r\n      recordButtonLoading: false,\r\n      navbarTitle: '日常任务',\r\n      // 上报失败的巡检轨迹点位数组\r\n      reportFailTrackPoints: [],\r\n      isShowRoute: true,\r\n      inspBusinessType: '',\r\n      recordData: [],\r\n      // 当前巡检员所处位置\r\n      currentPosition: null,\r\n      lines: [],\r\n      ifRecording: false,\r\n      endRecordShow: false,\r\n      selectEventType: false,\r\n      eventTypeList: [],\r\n      signShow: false,\r\n      attachment: '',\r\n      attachment1: '',\r\n      signForm: {\r\n        maintainImagesList: [],\r\n        remarks: '',\r\n        maintainType: '',\r\n        content: ''\r\n      },\r\n      taskDetail: {\r\n        coverage: '0/0',\r\n        reportRate: '0/0',\r\n        planEndTime: '',\r\n      },\r\n      engInfoDTO: {},\r\n      taskRestTime: 0,\r\n      reportFooterShow: false,\r\n      feature: {},\r\n      planDetail: {},\r\n      // 用于地图中显示范围和关键点\r\n      inspRangeList: [],\r\n      rangeList: [],\r\n      keyDetailList: [],\r\n      isRunList: [\r\n        {\r\n          name: '正常',\r\n          value: '1',\r\n        },\r\n        {\r\n          name: '异常',\r\n          value: '0',\r\n        },\r\n      ],\r\n      reportChose: [\r\n        {\r\n          name: '问题上报',\r\n          value: '问题上报',\r\n        },\r\n        {\r\n          name: '新增缺陷',\r\n          value: '新增缺陷',\r\n        },\r\n        {\r\n          name: '无需上报',\r\n          value: '无需上报',\r\n        },\r\n      ],\r\n      rules: {},\r\n      previewURL: '/sys-storage/download_image?f8s=',\r\n      upimgPreview: [],\r\n      headers: {},\r\n      url: {\r\n        // 本页面使用到的url\r\n        uploadFile: 'sys-storage/upload',\r\n        findFile: 'ecidi-cmp/file/cmpFileGroup/findFilesByGroupId',\r\n      },\r\n      pollingFlag: false,\r\n      pollingGapTime: 3,\r\n      trackPointList: [],\r\n      trackPointTimeList: [],\r\n      overSpeedTrackLineList: [],\r\n      trackLocation_start: '',\r\n      trackLocation_end: '',\r\n      showVisible: false,\r\n      isMask: false, //是否显示遮罩层\r\n      reportShow: false, // 问题上报面板显示\r\n      accessToken: this.$storage.get('access_token'),\r\n      header: {},\r\n      formToken: '',\r\n      // 问题上报list\r\n      problemDataList1: [],\r\n      // 设施缺陷list\r\n      problemDataList2: [],\r\n    }\r\n  },\r\n  computed: {\r\n    maintenContents() {\r\n      console.log(this.$store.state.enum['mainContents'])\r\n      return this.$store.state.enum['mainContents']\r\n    },\r\n    buttonList() {\r\n      return ['全部'].concat(JSON.parse(this.$route.query.data).maintainContent.split(','))\r\n    },\r\n    buttonAreaStyle() {\r\n      return {\r\n        '--width': this.buttonList.length * (80 + 10) + 'px',\r\n      }\r\n    },\r\n    clientY() {\r\n      return document.body.clientHeight\r\n    }\r\n  },\r\n  watch: {\r\n    progress(val) {\r\n      this.hasMain = val.split('/')[0]\r\n      this.allMain = val.split('/')[1]\r\n      this.styleVar['--barWidth'] = parseInt(148 * (this.hasMain / this.allMain)) + 'px'\r\n    }\r\n  },\r\n  mounted() {\r\n    console.log(this.$store.state)\r\n    this.taskData = JSON.parse(this.$route.query.data)\r\n    this.isView = this.$route.query.isView\r\n    this.progress = this.taskData.progress\r\n    this.navbarTitle = '养护任务'\r\n    this.getMainTaskObj()\r\n    this.getMainDevPoint()\r\n    let that = this\r\n    let elem = document.querySelector('#arrowUp')\r\n    elem.addEventListener('touchstart', (e) => {\r\n      let evt = e || window.event\r\n      let touch = evt.targetTouches[0]\r\n      let clientHeight = document.body.clientHeight\r\n      let clientY = touch.clientY\r\n      if (clientY >= clientHeight * 0.4 && clientY <= clientHeight - 24) {\r\n        that.mainListStyle['--top'] = clientY + 'px'\r\n        that.mainListStyle['--height'] = clientHeight - clientY - 24 + 'px'\r\n      }\r\n      // document.addEventListener('touchmove', e => { e.preventDefault() }, false)\r\n    })\r\n    elem.addEventListener('touchmove', (e) => {\r\n      let evt = e || window.event\r\n      let touch = evt.targetTouches[0]\r\n      let clientHeight = document.body.clientHeight\r\n      let clientY = touch.clientY\r\n      if (clientY >= clientHeight * 0.4 && clientY <= clientHeight - 24) {\r\n        that.mainListStyle['--top'] = clientY + 'px'\r\n        that.mainListStyle['--height'] = clientHeight - clientY - 24 + 'px'\r\n      }\r\n    })\r\n  },\r\n  methods: {\r\n    getGridRange() {\r\n      api.getGridRange({\r\n        pageNum: 1,\r\n        pageSize: 999\r\n      }).then(res => {\r\n        if (res.status) {\r\n          let feats = []\r\n          this.maintenRangeList = res.data.list.filter(it => it.inspGrid.id == this.taskData.gridId)\r\n          let coordList = []\r\n          this.maintenRangeList.length > 0 && this.maintenRangeList[0].detailList.forEach(it => {\r\n            coordList.push(JSON.parse(it.gridGeom).coordinates)\r\n          })\r\n          this.toMainRange(coordList)\r\n          this.maintenRangeList.length > 0 && this.maintenRangeList[0].detailList.forEach(it => {\r\n            feats.push({\r\n              type: 'Feature',\r\n              geometry: JSON.parse(it.gridGeom)\r\n            })\r\n          })\r\n          this.setSourceData('mainRangeSource', {\r\n            type: 'FeatureCollection',\r\n            features: feats\r\n          })\r\n        }\r\n      })\r\n    },\r\n    getMainRangeById(ids) {\r\n      this.maintenRangeList = []\r\n      Promise.all(ids.split(',').map(id => api.getMainRangeById({ id }))).then(reses => {\r\n        reses.forEach(res => {\r\n          if (res.status) {\r\n            this.maintenRangeList.push(...res.data.maintainRangeChildList)\r\n          }\r\n        })\r\n        let coordList = []\r\n        this.maintenRangeList.length > 0 && this.maintenRangeList.forEach(it => {\r\n          coordList.push(JSON.parse(it.geom).coordinates)\r\n        })\r\n        this.toMainRange(coordList)\r\n        let feats = []\r\n        this.maintenRangeList.length > 0 && this.maintenRangeList.forEach(it => {\r\n          feats.push({\r\n            type: 'Feature',\r\n            geometry: JSON.parse(it.geom)\r\n          })\r\n        })\r\n        this.setSourceData('mainRangeSource', {\r\n          type: 'FeatureCollection',\r\n          features: feats\r\n        })\r\n      })\r\n    },\r\n    toMainRange(coordList) {\r\n      let polygonList = coordList.map(it => turf.polygon(it))\r\n      let bbox = turf.bbox({\r\n        type:\"FeatureCollection\",\r\n        features: polygonList\r\n      });\r\n      let timer = setInterval(() => {\r\n        if (mapObj.map) {\r\n          clearInterval(timer)\r\n          mapObj.map.fitBounds(bbox, {\r\n            padding: {top: 10, bottom:25, left: 15, right: 5}\r\n          });\r\n        }\r\n      }, 500)\r\n    },\r\n    changeCheckBox(val) {\r\n      this.signForm.content = val.join(',')\r\n    },\r\n    goToDeal(obj) {\r\n      if (obj.startLongitude && obj.startLatitude) {\r\n        this.mainListStyle['--top'] = document.body.clientHeight - 24 + 'px'\r\n        this.mainListStyle['--height'] = '24px'\r\n        if (obj.deviceType == '管线') {\r\n          let point1 = turf.point([obj.startLongitude, obj.startLatitude])\r\n          let point2 = turf.point([obj.endLongitude, obj.endLatitude])\r\n          let midpoint = turf.midpoint(point1, point2)\r\n          this.flyToPoint(midpoint.geometry.coordinates)\r\n        } else {\r\n          this.flyToPoint([obj.startLongitude, obj.startLatitude])\r\n        }\r\n      } else {\r\n        Toast.warning({\r\n          message: '当前设施无地理坐标信息',\r\n          duration: 2000\r\n        })\r\n        return\r\n      }\r\n    },\r\n    filterIsMainList(it) {\r\n      this.currentSeleIsMainType = it\r\n      if (it == '全部') {\r\n        this.maintenObj.isMain = currentMainPoint.isMain\r\n      } else {\r\n        this.maintenObj.isMain = currentMainPoint.isMain.filter(\r\n          (item) => item.deviceType == it\r\n        )\r\n      }\r\n    },\r\n    filterIsNotMainList(it) {\r\n      this.currentSeleIsNotMainType = it\r\n      if (it == '全部') {\r\n        this.maintenObj.isNotMain = currentMainPoint.isNotMain\r\n      } else {\r\n        this.maintenObj.isNotMain = currentMainPoint.isNotMain.filter(\r\n          (item) => item.deviceType == it\r\n        )\r\n      }\r\n    },\r\n    onLoad() {},\r\n    addMainSourceLayer() {\r\n      mapObj.map.addSource('mainRangeSource', {\r\n        type: 'geojson',\r\n        data: {\r\n          type: 'FeatureCollection',\r\n          features: [],\r\n        },\r\n      })\r\n      mapObj.map.addSource('mainDevPointSource', {\r\n        type: 'geojson',\r\n        data: {\r\n          type: 'FeatureCollection',\r\n          features: [],\r\n        },\r\n      })\r\n      mapObj.map.addSource('mainDevLineSource', {\r\n        type: 'geojson',\r\n        data: {\r\n          type: 'FeatureCollection',\r\n          features: [],\r\n        },\r\n      })\r\n      mapObj.map.addSource('pickMainDevLineSource', {\r\n        type: 'geojson',\r\n        data: {\r\n          type: 'FeatureCollection',\r\n          features: [],\r\n        },\r\n      })\r\n      mapObj.map.addSource('pickMainDevPointSource', {\r\n        type: 'geojson',\r\n        data: {\r\n          type: 'FeatureCollection',\r\n          features: [],\r\n        },\r\n      })\r\n      // mapObj.map.addLayer({\r\n      //   id: 'mainRangeFillLayer',\r\n      //   type: 'fill',\r\n      //   source: 'mainRangeSource',\r\n      //   paint: {\r\n      //     'fill-color': '#32C5FF',\r\n      //     'fill-opacity': 0.3,\r\n      //   },\r\n      // })\r\n      mapObj.map.addLayer({\r\n        id: 'mainRangeLineLayer',\r\n        type: 'line',\r\n        source: 'mainRangeSource',\r\n        paint: {\r\n          'line-opacity': 1,\r\n          'line-width': 1.5,\r\n          'line-color': '#32C5FF',\r\n          'line-dasharray': [4, 4],\r\n        },\r\n      })\r\n      mapObj.map.addLayer(\r\n        {\r\n          id: 'mainDevPipeLayer',\r\n          type: 'line',\r\n          source: 'mainDevLineSource',\r\n          paint: {\r\n            'line-opacity': 1,\r\n            'line-width': 4,\r\n            'line-color': [\r\n              'match',\r\n              ['get', 'isMain'],\r\n              'true',\r\n              '#2dc34d',\r\n              'false',\r\n              '#ffd141',\r\n              '#ffd141'\r\n            ]\r\n          }\r\n        },\r\n        'rd_map_outfall'\r\n      )\r\n      mapObj.map.addLayer(\r\n        {\r\n          id: 'pickMainDevPipeLayer',\r\n          type: 'line',\r\n          source: 'pickMainDevLineSource',\r\n          paint: {\r\n            'line-opacity': 1,\r\n            'line-width': 6,\r\n            'line-color': [\r\n              'match',\r\n              ['get', 'isMain'],\r\n              'true',\r\n              '#2dc34d',\r\n              'false',\r\n              '#ffd141',\r\n              '#ffd141'\r\n            ]\r\n          }\r\n        },\r\n        'rd_map_outfall'\r\n      )\r\n      mapObj.map.addLayer(\r\n        {\r\n          id: 'mainDevPointLayer',\r\n          type: 'circle',\r\n          source: 'mainDevPointSource',\r\n          paint: {\r\n            'circle-opacity': 1,\r\n            'circle-radius': [\r\n              'interpolate',\r\n              ['linear'],\r\n              ['zoom'],\r\n              12.5,\r\n              5,\r\n              17,\r\n              10,\r\n            ],\r\n            'circle-color': [\r\n              'match',\r\n              ['get', 'isMain'],\r\n              'true',\r\n              '#2dc34d',\r\n              'false',\r\n              '#ffd141',\r\n              '#ffd141'\r\n            ]\r\n          }\r\n        },\r\n        'map_supply_pipe_distribute'\r\n      )\r\n      mapObj.map.addLayer(\r\n        {\r\n          id: 'pickMainDevPointLayer',\r\n          type: 'circle',\r\n          source: 'pickMainDevPointSource',\r\n          paint: {\r\n            'circle-opacity': 1,\r\n            'circle-radius': [\r\n              'interpolate',\r\n              ['linear'],\r\n              ['zoom'],\r\n              12.5,\r\n              10,\r\n              17,\r\n              15,\r\n            ],\r\n            'circle-color': [\r\n              'match',\r\n              ['get', 'isMain'],\r\n              'true',\r\n              '#2dc34d',\r\n              'false',\r\n              '#ffd141',\r\n              '#ffd141'\r\n            ]\r\n          }\r\n        },\r\n        'map_supply_pipe_distribute'\r\n      )\r\n      mapObj.map.on('mouseover', 'mainDevPipeLayer', () => {\r\n        mapObj.map.getCanvas().style.cursor = 'pointer'\r\n      })\r\n      mapObj.map.on('mouseover', 'mainDevPointLayer', () => {\r\n        mapObj.map.getCanvas().style.cursor = 'pointer'\r\n      })\r\n      mapObj.map.on('mouseout', 'mainDevPipeLayer', () => {\r\n        mapObj.map.getCanvas().style.cursor = ''\r\n      })\r\n      mapObj.map.on('mouseout', 'mainDevPointLayer', () => {\r\n        mapObj.map.getCanvas().style.cursor = ''\r\n      })\r\n      mapObj.map.on('click', 'mainDevPipeLayer', this.mainDetailInfo)\r\n      mapObj.map.on('click', 'mainDevPointLayer', this.mainDetailInfo)\r\n    },\r\n    addMainUserSourceLayer() {\r\n      mapObj.map.addSource(\"mainUser\", {\r\n        type: \"geojson\",\r\n        data: {\r\n          type: \"FeatureCollection\",\r\n          features: []\r\n        }\r\n      });\r\n      mapObj.map.addLayer({\r\n        id: \"mainUserLayer\",\r\n        type: \"symbol\",\r\n        source: \"mainUser\",\r\n        layout: {\r\n          \"icon-image\": \"userInsp\",\r\n          \"icon-size\": 0.2,\r\n          \"icon-allow-overlap\": true, //自动避让属性\r\n          \"icon-ignore-placement\": true\r\n        }\r\n      });\r\n    },\r\n    // 添加缓冲区的图层\r\n    addBufferLayer() {\r\n      mapObj.map.addSource('buffered', {\r\n        type: 'geojson',\r\n        data: {\r\n          type: 'FeatureCollection',\r\n          features: [],\r\n        },\r\n      })\r\n      mapObj.map.addLayer(\r\n        {\r\n          id: 'bufferLayer',\r\n          type: 'fill',\r\n          source: 'buffered',\r\n          paint: {\r\n            'fill-color': '#FFB6C1',\r\n            'fill-opacity': 0.5,\r\n          },\r\n        },\r\n        'rd_map_drainpipe_ys_big_direction'\r\n      )\r\n    },\r\n    // 画半径为radius的圆范围\r\n    drawBuffer(point, radius = 0.035) {\r\n      let buffered = turf.buffer(point, radius, { unit: 'kilometers' })\r\n      this.setSourceData('buffered', {\r\n        type: 'FeatureCollection',\r\n        features: [buffered],\r\n      })\r\n    },\r\n    mainDetailInfo(e) {\r\n      let feats = mapObj.map.queryRenderedFeatures(e.point, {\r\n        layers: ['mainDevPipeLayer', 'mainDevPointLayer']\r\n      })\r\n      if (!this.ifStart && feats[0].properties.isMain == 'true') {\r\n      } else if(!this.ifStart) {\r\n        Toast.warning({\r\n          message: '任务未开始，无法养护',\r\n          duration: 2000\r\n        })\r\n        return\r\n      }\r\n      // 利用feature来判断是否处于35m范围内，如果处于，可以进行签到，否则不能进行签到\r\n      // const position = this.currentPosition\r\n      // if (!position) {\r\n      //   Toast.warning({\r\n      //     message: '获取不到巡检人位置',\r\n      //     duration: 2000,\r\n      //   })\r\n      //   return\r\n      // }\r\n      // const coord = [\r\n      //   parseFloat(position.longitude),\r\n      //   parseFloat(position.latitude),\r\n      // ]\r\n      // const point = turf.point(coord)\r\n      // const engGeom = feature.geom\r\n      // const buffered = turf.buffer(engGeom, 0.035, { unit: 'kilometers' })\r\n      // const isInBuffer = turf.inside(point, buffered)\r\n      // if (!isInBuffer) {\r\n      //   Toast({\r\n      //     message: '未处于该关键点范围内',\r\n      //     duration: 2000,\r\n      //   })\r\n      //   return\r\n      // }\r\n      console.log(this.$store.state.enum['mainContents'])\r\n      this.maintenContentsList = []\r\n      this.currentSelectDev = feats[0]\r\n      if (feats[0].properties.deviceType == '检查井' && (feats[0].properties.bizType == '污水' || feats[0].properties.bizType == '雨水')) {\r\n        let arr = this.maintenContents.filter(it => it['zh-CN'] == '污水检查井')\r\n        arr[0].child.forEach(item => {\r\n          this.maintenContentsList.push({\r\n            name: item['zh-CN'],\r\n            value: item.code\r\n          })\r\n        })\r\n      } else if (feats[0].properties.deviceType == '管线' && (feats[0].properties.bizType == '污水' || feats[0].properties.bizType == '雨水')) {\r\n        let arr = this.maintenContents.filter(it => it['zh-CN'] == '排水管道')\r\n        arr[0].child.forEach(item => {\r\n          this.maintenContentsList.push({\r\n            name: item['zh-CN'],\r\n            value: item.code\r\n          })\r\n        })\r\n      } else if (feats[0].properties.deviceType == '雨水口') {\r\n        let arr = this.maintenContents.filter(it => it['zh-CN'] == '雨水口')\r\n        arr[0].child.forEach(item => {\r\n          this.maintenContentsList.push({\r\n            name: item['zh-CN'],\r\n            value: item.code\r\n          })\r\n        })\r\n      } else if (feats[0].properties.deviceType == '管线' && (feats[0].properties.bizType == '配水' || feats[0].properties.bizType == '原水' || feats[0].properties.bizType == '输水')) {\r\n        let arr = this.maintenContents.filter(it => it['zh-CN'] == '供水管道')\r\n        arr[0].child.forEach(item => {\r\n          this.maintenContentsList.push({\r\n            name: item['zh-CN'],\r\n            value: item.code\r\n          })\r\n        })\r\n      } else if (feats[0].properties.deviceType == '阀门') {\r\n        let arr = this.maintenContents.filter(it => it['zh-CN'] == '阀门')\r\n        arr[0].child.forEach(item => {\r\n          this.maintenContentsList.push({\r\n            name: item['zh-CN'],\r\n            value: item.code\r\n          })\r\n        })\r\n      } else if (feats[0].properties.deviceType == '消防栓') {\r\n        let arr = this.maintenContents.filter(it => it['zh-CN'] == '消防栓')\r\n        arr[0].child.forEach(item => {\r\n          this.maintenContentsList.push({\r\n            name: item['zh-CN'],\r\n            value: item.code\r\n          })\r\n        })\r\n      } else {\r\n        this.maintenContentsList = []\r\n      }\r\n      this.drawBuffer(feats[0].geometry)\r\n      this.signShow = true\r\n      if (feats[0].properties.isMain == 'true') {\r\n        this.hasSignIn = true\r\n        api.getMainDetailInfo({\r\n          devType: feats[0].properties.deviceType,\r\n          devId: feats[0].properties.id,\r\n          taskId: this.$route.query.taskId\r\n        }).then(res => {\r\n          if (res.status && res.data) {\r\n            this.signForm.remarks = res.data.remarks\r\n            this.signForm.maintainType = res.data.maintainType\r\n            this.signForm.content = res.data.content\r\n            this.checkboxGroup = res.data.content.split(',')\r\n            this.maintainBeforeImage = res.data.maintainImagesList.filter(it => it.stage == 0)\r\n            this.attachment = this.maintainBeforeImage[0]?.imagesToken\r\n            this.maintainAfterImage = res.data.maintainImagesList.filter(it => it.stage == 1)\r\n            this.attachment1 = this.maintainAfterImage[0]?.imagesToken\r\n          }\r\n        })\r\n      } else {\r\n        this.hasSignIn = false\r\n        this.signForm.remarks = ''\r\n        this.signForm.maintainType = ''\r\n        this.signForm.content = ''\r\n        this.checkboxGroup = []\r\n        this.maintainBeforeImage = []\r\n        this.attachment = ''\r\n        this.maintainAfterImage = []\r\n        this.attachment1 = ''\r\n      }\r\n    },\r\n    // 深拷贝\r\n    deepClone(data) {\r\n      return JSON.parse(JSON.stringify(data))\r\n    },\r\n    getMainDevPoint() {\r\n      this.loading = true\r\n      api\r\n        .getMainDevPoint({ taskId: this.$route.query.taskId })\r\n        .then((res) => {\r\n          if (res.status) {\r\n            let mainPipeFeatures = []\r\n            let mainDevFeatures = []\r\n            currentMainPoint.isMain = res.data.check\r\n            currentMainPoint.isNotMain = res.data.unCheck\r\n            this.maintenObj = this.deepClone(currentMainPoint)\r\n            currentMainPoint.isMain.forEach((it) => {\r\n              if (it.deviceType == '管线') {\r\n                mainPipeFeatures.push({\r\n                  id: it.id,\r\n                  type: 'Feature',\r\n                  geometry: {\r\n                    type: 'LineString',\r\n                    coordinates: [\r\n                      [it.startLongitude, it.startLatitude],\r\n                      [it.endLongitude, it.endLatitude],\r\n                    ],\r\n                  },\r\n                  properties: Object.assign({ isMain: 'true' }, it),\r\n                })\r\n              } else {\r\n                mainDevFeatures.push({\r\n                  id: it.id,\r\n                  type: 'Feature',\r\n                  geometry: {\r\n                    type: 'Point',\r\n                    coordinates: [it.startLongitude, it.startLatitude],\r\n                  },\r\n                  properties: Object.assign({ isMain: 'true' }, it),\r\n                })\r\n              }\r\n            })\r\n            currentMainPoint.isNotMain.forEach((it) => {\r\n              if (it.deviceType == '管线') {\r\n                mainPipeFeatures.push({\r\n                  id: it.id,\r\n                  type: 'Feature',\r\n                  geometry: {\r\n                    type: 'LineString',\r\n                    coordinates: [\r\n                      [it.startLongitude, it.startLatitude],\r\n                      [it.endLongitude, it.endLatitude],\r\n                    ],\r\n                  },\r\n                  properties: Object.assign({ isMain: 'false' }, it),\r\n                })\r\n              } else {\r\n                mainDevFeatures.push({\r\n                  id: it.id,\r\n                  type: 'Feature',\r\n                  geometry: {\r\n                    type: 'Point',\r\n                    coordinates: [it.startLongitude, it.startLatitude],\r\n                  },\r\n                  properties: Object.assign({ isMain: 'false' }, it),\r\n                })\r\n              }\r\n            })\r\n            this.setMainDevLayerFeatures(mainDevFeatures, mainPipeFeatures)\r\n          }\r\n        })\r\n        .finally(() => {\r\n          this.loading = false\r\n          this.finished = true\r\n        })\r\n    },\r\n    setMainRangeData(data) {\r\n      let that = this\r\n      let rangeData = []\r\n      data.forEach((it) => {\r\n        rangeData.push({\r\n          type: 'Feature',\r\n          geometry: JSON.parse(it.geom),\r\n        })\r\n      })\r\n      let timer = setInterval(() => {\r\n        if (that.mapLoad && mapObj.map.getSource('mainRangeSource')) {\r\n          clearInterval(timer)\r\n          that.setSourceData('mainRangeSource', {\r\n            type: 'FeatureCollection',\r\n            features: rangeData,\r\n          })\r\n        }\r\n      }, 100)\r\n    },\r\n    setMainDevLayerFeatures(devFeats, pipeFeats) {\r\n      let that = this\r\n      let timer = setInterval(() => {\r\n        if (that.mapLoad && mapObj.map.getSource('mainDevPointSource')) {\r\n          clearInterval(timer)\r\n          that.setSourceData('mainDevPointSource', {\r\n            type: 'FeatureCollection',\r\n            features: devFeats,\r\n          })\r\n        }\r\n        if (that.mapLoad && mapObj.map.getSource('mainDevLineSource')) {\r\n          clearInterval(timer)\r\n          that.setSourceData('mainDevLineSource', {\r\n            type: 'FeatureCollection',\r\n            features: pipeFeats,\r\n          })\r\n        }\r\n      }, 100)\r\n    },\r\n    setSourceData(sourceId, data) {\r\n      if (mapObj.map.getSource(sourceId)) {\r\n        mapObj.map.getSource(sourceId).setData(data)\r\n      }\r\n    },\r\n    getMainTaskObj() {\r\n      api\r\n        .getMainTask({ id: this.$route.query.taskId })\r\n        .then((res) => {\r\n          if (res.status) {\r\n            this.taskBizType = res.data.bizType\r\n            res.data.maintainPlanContent.records.forEach((it) => {\r\n              this.objList.push({\r\n                name: it.deviceType,\r\n                num: it.num || 0,\r\n                unit: it.unit || '',\r\n              })\r\n            })\r\n          }\r\n        })\r\n        .finally(() => {})\r\n    },\r\n    // 获取问题上报和设施缺陷数据\r\n    getCardListData() {\r\n      // 获取header，查询工单用\r\n      axios({\r\n        url: API.VUE_APP_WPG_URL + '/main/userCenterApi/sso/tokenByToken',\r\n        method: 'post',\r\n        params: {\r\n          token: this.accessToken,\r\n        },\r\n        headers: {\r\n          Authorization: 'Basic b3V0d29yazp3cGcyMDIw',\r\n        },\r\n      }).then((res) => {\r\n        if (res.status == 200) {\r\n          this.formToken = res.data.resultData.token\r\n          this.header = {\r\n            'Content-Type': 'application/json',\r\n            Authorization: 'Bearer ' + this.formToken,\r\n          }\r\n        }\r\n      })\r\n    },\r\n    // 问题上报(smallType: 'abnormal_inform')、设施缺陷(smallType: \"defect\")使用同一接口\r\n    async getProblemDataList(params) {\r\n      this.problemDataList1 = []\r\n      this.problemDataList2 = []\r\n\r\n      let commonParams = Object.assign(\r\n        {\r\n          sysCode: 'outwork',\r\n          token: this.accessToken,\r\n          page: {\r\n            current: 1,\r\n            size: 99999, // 查全部\r\n          },\r\n        },\r\n        params\r\n      )\r\n      // 问题上报\r\n      let params1 = {\r\n        ...commonParams,\r\n        smallType: 'abnormal_inform',\r\n      }\r\n      // 设施缺陷\r\n      let params2 = {\r\n        ...commonParams,\r\n        smallType: 'defect',\r\n      }\r\n      let problemPointFeatures = []\r\n      // 问题上报\r\n      await this.getAxiosData(params1, this.problemDataList1)\r\n      // 设施缺陷\r\n      await this.getAxiosData(params2, this.problemDataList2)\r\n      let allProblem = this.problemDataList1.concat(this.problemDataList2)\r\n      allProblem.forEach((it) => {\r\n        problemPointFeatures.push({\r\n          type: 'Feature',\r\n          geometry: {\r\n            type: 'Point',\r\n            coordinates: it.lnglat,\r\n          },\r\n          properties: {\r\n            id: it.id,\r\n            title: it.title,\r\n          },\r\n        })\r\n      })\r\n      this.$refs.mymap.addInspEventLayer(problemPointFeatures)\r\n      this.reportDataIsLoaded = true\r\n    },\r\n    getAxiosData(params, problemDataList) {\r\n      return new Promise((resolve, reject) => {\r\n        axios({\r\n          url:\r\n            API.VUE_APP_WPG_URL +\r\n            '/main/outworkapi/ticketStatisticClient/getTicketList',\r\n          method: 'post',\r\n          data: params,\r\n          headers: this.header,\r\n        }).then((res) => {\r\n          if (res.status == 200) {\r\n            res.data.resultData.records.forEach((item) => {\r\n              problemDataList.push({\r\n                id: item.id, // 工单ID\r\n                title: item.title, // 工单标题\r\n                ticketStatusName: item.ticketStatusName,\r\n                handleType: item.formValue.handleType, // 描述\r\n                createByName: item.createByName, // 创建人\r\n                createTime: item.createTime.substring(0, 10), // 创建时间\r\n                defectFrom: item.formValue.defectFrom,\r\n                faultTypes: item.formValue.faultTypes,\r\n                fileUrl: item.formValue?.handleImgs?.[0]?.fileUrl,\r\n                // 图片地址\r\n                url: item.formValue?.handleImgs?.[0]?.url,\r\n                // 发生经纬度\r\n                lnglat: [item.appealLng, item.appealLat],\r\n                device_type: item.formValue?.device_type || [],\r\n                questionDescribe: item.formValue.questionDescribe,\r\n              })\r\n            })\r\n            resolve()\r\n          }\r\n          // problemDataList.forEach((item) => {\r\n          //   // console.log('图片地址', item.url)\r\n          // })\r\n        })\r\n      })\r\n    },\r\n    // 问题上报点击标题、设施缺陷点击卡片进入详情页\r\n    toDetailPanel(cardDetail) {\r\n      window.location.href =\r\n        'http://172.20.79.70/outworkApp/#/pages/ticket/detail/index?id=' +\r\n        cardDetail.id +\r\n        '&sysCode=outwork' +\r\n        '&token=' +\r\n        this.formToken\r\n    },\r\n    // 卡片定位\r\n    flyToPoint(lnglat) {\r\n      mapObj.map.flyTo({ center: lnglat, zoom: 18.5 })\r\n    },\r\n    // 上报\r\n    reportClick() {\r\n      if (this.reportDataIsLoaded) {\r\n        this.reportShow = true\r\n        mapObj.map.setLayoutProperty(\r\n          'eventPointsLayer',\r\n          'visibility',\r\n          'visible'\r\n        )\r\n      } else {\r\n        Toast({\r\n          message: '上报数据加载中。。。',\r\n          duration: 1500,\r\n        })\r\n        return\r\n      }\r\n    },\r\n    fileChangeAfter(file) {\r\n      this.maintainAfterImage = []\r\n      file.fileList.forEach((it) => {\r\n        this.maintainAfterImage.push({\r\n          imagesToken: it.response.groupToken,\r\n          imagesName: it.url,\r\n          stage: 1\r\n        })\r\n      })\r\n      console.log(this.maintainAfterImage)\r\n    },\r\n    fileChangeBefore(file) {\r\n      this.maintainBeforeImage = []\r\n      file.fileList.forEach((it) => {\r\n        this.maintainBeforeImage.push({\r\n          imagesToken: it.response.groupToken,\r\n          imagesName: it.url,\r\n          stage: 0\r\n        })\r\n      })\r\n      console.log(this.maintainBeforeImage)\r\n    },\r\n    openPopup() {\r\n      this.showPopover = true\r\n    },\r\n    onSelect(val) {\r\n      if (this.isView) {\r\n        Toast({\r\n          message: '该养护任务已结束',\r\n          duration: '1500',\r\n        })\r\n        return\r\n      }\r\n      this.ifTips = true\r\n      setTimeout(() => {\r\n        this.ifTips = false\r\n      }, 2500)\r\n      mapObj.map.off('click', 'mainDevPipeLayer', this.mainDetailInfo)\r\n      mapObj.map.off('click', 'mainDevPointLayer', this.mainDetailInfo)\r\n      val.text == '问题上报'\r\n        ? mapObj.map.on('click', this.selectReportPoint)\r\n        : mapObj.map.on('click', this.selectFlawPoint)\r\n    },\r\n    selectReportPoint(e) {\r\n      let features = mapObj.map.queryRenderedFeatures(e.point)\r\n      console.log(features)\r\n      if (features.length > 0) {\r\n        if (features[0].layer.id == 'mainDevPointLayer' || features[0].layer.id == 'mainDevPipeLayer') {\r\n          this.addEventObjMarker(features[1], 'event')\r\n        } else {\r\n          this.addEventObjMarker(features[0], 'event')\r\n        }\r\n      }\r\n      mapObj.map.on('click', 'mainDevPipeLayer', this.mainDetailInfo)\r\n      mapObj.map.on('click', 'mainDevPointLayer', this.mainDetailInfo)\r\n      mapObj.map.off('click', this.selectReportPoint)\r\n    },\r\n    selectFlawPoint(e) {\r\n      let features = mapObj.map.queryRenderedFeatures(e.point)\r\n      console.log(features)\r\n      if (features.length > 0) {\r\n        if (\r\n          features[0].source != 'eventPoints' &&\r\n          features[0].source != 'mainUser' &&\r\n          features[0].source != 'initInspLineSource' &&\r\n          features[0].source != 'keypoints' &&\r\n          features[0].geometry.type === 'Point'\r\n        ) {\r\n          this.$refs.mymap.addEventObjMarker(features[0], 'flaw')\r\n        } else if (\r\n          features.length > 1 &&\r\n          features[1].source != 'eventPoints' &&\r\n          features[1].source != 'mainUser' &&\r\n          features[1].source != 'keypoints' &&\r\n          features[1].geometry.type === 'Point'\r\n        ) {\r\n          this.$refs.mymap.addEventObjMarker(features[1], 'flaw')\r\n        }\r\n      }\r\n      mapObj.map.on('click', 'keypointsLayer', this.$refs.mymap.signInBuffer)\r\n      mapObj.map.off('click', this.selectFlawPoint)\r\n    },\r\n    // 添加上报对象的marker\r\n    addEventObjMarker(feature, type) {\r\n      let position;\r\n      if (feature.geometry.type === 'Polygon' || feature.geometry.type === 'MultiPolygon') {\r\n        const center = turf.center(feature.geometry);\r\n        position = center.geometry.coordinates;\r\n      } else if (feature.geometry.type === 'LineString') {\r\n        const center = turf.center(feature.geometry);\r\n        position = center.geometry.coordinates;\r\n      } else if (feature.geometry.type === 'Point') {\r\n        position = feature.geometry.coordinates;\r\n      }\r\n      this.currentPoint = feature\r\n      this.currentPoint.code = feature.properties.manhole_code || feature.properties.comb_code || ''\r\n      this.currentPoint.bizType = feature.properties.manhole_type || ''\r\n      this.currentPoint.lng = feature.geometry.coordinates[0]\r\n      this.currentPoint.lat = feature.geometry.coordinates[1]\r\n      // 要素所在图层ID和属性信息\r\n      this.currentPoint.layerID = feature.layer.id\r\n      this.currentPoint.layerType = feature.layer.type\r\n      this.currentPoint.properties = feature.properties\r\n      // 底图要素name_local或设施要素road_name,id\r\n      this.currentPoint.road_name = feature.properties.road_name\r\n      this.currentPoint.id = feature.properties.id\r\n      this.currentPoint.code = feature.properties.manhole_code || feature.properties.gate_code || feature.properties.outlet_code\r\n        || feature.properties.comb_code || feature.properties.valve_code || feature.properties.pump_station_code\r\n        || feature.properties.plant_code || feature.properties.pump_code || feature.properties.fire_cock_code\r\n        || feature.properties.start_code + ',' + feature.properties.end_code || ''\r\n      // 要素对象类型（业务类型/设施类型）\r\n      switch (feature.layer.id) {\r\n        // 雨水\r\n        case \"rd_map_comb\"://comb一定是雨水口\r\n          this.currentPoint.bigType = '雨水'\r\n          this.currentPoint.smallType = '雨水口'\r\n          break\r\n        case \"rd_map_outfall\"://排放口 1-雨水； 2-污水； 3-合流； 4-其他\r\n          this.currentPoint.bigType = feature.properties.pipe_type\r\n          this.currentPoint.smallType = '排放口'\r\n          break\r\n        case \"rd_map_manhole\"://检查井  1-雨水；2-污水\r\n          this.currentPoint.bigType = feature.properties.manhole_type\r\n          this.currentPoint.smallType = '检查井'\r\n          break\r\n        case \"rd_map_gate\"://闸门 1-雨水； 2-污水； 3-合流； 4-其他\r\n          this.currentPoint.bigType = feature.properties.pipe_type\r\n          this.currentPoint.smallType = '闸门'\r\n          break\r\n        case \"rd_map_drainpipe_ys_big\":\r\n          this.currentPoint.bigType = '雨水'\r\n          this.currentPoint.smallType = '雨水管线'\r\n          break\r\n        case \"rd_map_drainpipe_ys_small\":\r\n          this.currentPoint.bigType = '雨水'\r\n          this.currentPoint.smallType = '雨水管线'\r\n          break\r\n        // 污水\r\n        case \"rd_map_drainpipe_ws_big\":\r\n          this.currentPoint.bigType = '污水'\r\n          this.currentPoint.smallType = '污水管线'\r\n          break\r\n        case \"rd_map_drainpipe_ws_small\":\r\n          this.currentPoint.bigType = '污水'\r\n          this.currentPoint.smallType = '污水管线'\r\n          break\r\n        // 给水\r\n        case \"map_supply_firehydrant\"://消火栓一定是给水\r\n          this.currentPoint.bigType = '给水'\r\n          this.currentPoint.smallType = '消火栓'\r\n          break\r\n        case \"map_supply_valve\"://阀门valve一定是给水\r\n          this.currentPoint.bigType = '给水'\r\n          this.currentPoint.smallType = '阀门'\r\n          break\r\n        case \"map_supply_pipe_distribute\"://配水管线\r\n          this.currentPoint.bigType = '给水'\r\n          this.currentPoint.smallType = '配水管线'\r\n          break\r\n        case \"map_supply_pipe_delivery\"://输水管线\r\n          this.currentPoint.bigType = 'supply'\r\n          this.currentPoint.smallType = '输水管线'\r\n          break\r\n        case \"map_supply_pipe_circulating\"://回水管线\r\n          this.currentPoint.bigType = '给水'\r\n          this.currentPoint.smallType = '回水管线'\r\n          break\r\n        case \"map_waterwork\"://供水厂\r\n          this.currentPoint.bigType = '给水'\r\n          this.currentPoint.smallType = '供水厂'\r\n          break\r\n        // 再生水\r\n        case \"map_recycle_pipe\"://再生水管线\r\n          this.currentPoint.bigType = '再生水'\r\n          this.currentPoint.smallType = 'pipeline'\r\n          break\r\n        case \"map_waterwork\"://再生水厂\r\n          this.currentPoint.bigType = '再生水'\r\n          this.currentPoint.smallType = '再生水厂'\r\n          break\r\n      }\r\n\r\n      const src = require(`@/assets/img/legend/事件上报.png`);\r\n      // 如果存在id为eventObj_one的元素，则删除此元素重新创建，保持全局只有一个此元素\r\n      let currentEle = document.getElementById(\"eventObj_one\");\r\n      if (currentEle) {\r\n        currentEle.parentNode.removeChild(currentEle);\r\n      }\r\n      let ele = document.createElement(\"div\");\r\n      ele.innerHTML = `\r\n          <img id=\"eventObj_one\" src=\"${src}\" width=\"40\" height=\"40\">\r\n        `\r\n      let marker = mapObj.mapInstance.newMarker({\r\n        element: ele\r\n      });\r\n      marker\r\n        .setLngLat(position)\r\n        .setPopup(mapObj.mapInstance.popup\r\n          .setHTML(`<div id=\"deviceDetail\"></div>`))\r\n        .addTo(mapObj.map);\r\n      let pop = new PopupItem({ propsData: { deviceCode: this.currentPoint.code, type: type, isDevice: true, fun: this.goToDetail } })\r\n      this.$nextTick(() => {\r\n        pop.$mount('#deviceDetail')\r\n      })\r\n      marker.togglePopup();\r\n\r\n    },\r\n    goToDetail(type) {\r\n      if (type == 'event') {\r\n        this.$router.push({\r\n          name: 'addProblemIndex',\r\n          query: { msg: this.currentPoint, token: this.formToken, taskId: this.$route.query.taskId },\r\n          params: { type: 'add' }\r\n        })\r\n      } else {\r\n        this.$router.push({\r\n          name: 'addFlaws',\r\n          query: { msg: this.currentPoint, token: this.formToken, taskId: this.$route.query.taskId },\r\n          params: { type: 'add' }\r\n        })\r\n      }\r\n    },\r\n    mapLoaded() {\r\n      let that = this\r\n      mapObj.mapInstance = window.xaMapBuilder\r\n      mapObj.map = window.xaMap\r\n      that.mapLoad = true\r\n      addImgToMap(mapObj.map)\r\n      this.addMainSourceLayer()\r\n      this.addBufferLayer()\r\n      this.addMainUserSourceLayer()\r\n      if (this.taskData.useChildRange == 0 || !this.taskData.rangeId) {\r\n        this.getGridRange()\r\n      } else if (this.taskData.useChildRange == 1 && this.taskData.rangeId) {\r\n        this.getMainRangeById(this.taskData.rangeId)\r\n      }\r\n      (typeof yuanchu != 'undefined') && yuanchu.locationAMap.requestSingleLocation(\r\n        ['1'],\r\n        (res) => {\r\n          that.currentPosition = JSON.parse(JSON.stringify(res))\r\n          if (!that.currentPosition) {\r\n            Toast({\r\n              message: '当前GPS信号弱',\r\n              duration: 1500,\r\n            })\r\n            return\r\n          }\r\n          const param = {\r\n            ...that.currentPosition,\r\n          }\r\n          this.setMainUserPosition(param)\r\n        },\r\n        (err) => {\r\n          console.log('err=', err)\r\n        }\r\n      )\r\n    },\r\n    addMapImg() {\r\n      let that = this\r\n      mapObj.map.loadImage(\r\n        require('@assets/img/inspection/white_arrow_right.png'),\r\n        function (error, image) {\r\n          if (error) throw error\r\n          if (!mapObj.map.hasImage('arrowIcon')) {\r\n            mapObj.map.addImage('arrowIcon', image, {})\r\n          }\r\n        }\r\n      )\r\n      mapObj.map.loadImage(\r\n        require('@assets/img/inspection/icon_starting_point.png'),\r\n        function (error, image) {\r\n          if (error) throw error\r\n          if (!mapObj.map.hasImage('start_point')) {\r\n            mapObj.map.addImage('start_point', image, {})\r\n          }\r\n        }\r\n      )\r\n      mapObj.map.loadImage(\r\n        require('@assets/img/inspection/icon_at_end.png'),\r\n        function (error, image) {\r\n          if (error) throw error\r\n          if (!mapObj.map.hasImage('end_point')) {\r\n            mapObj.map.addImage('end_point', image, {})\r\n          }\r\n        }\r\n      )\r\n    },\r\n    startMainWork() {\r\n      this.noticeShow = false\r\n      this.startRecordTimer = new Date()\r\n      this.ifStart = true\r\n    },\r\n    startGetLocation() {\r\n      let that = this\r\n        yuanchu.locationAMap.requestLocations(\r\n          ['5', '1', '10', '30', '0', true],\r\n          (res) => {\r\n            that.currentPosition = JSON.parse(JSON.stringify(res))\r\n            that.currentPosition = Object.assign(that.currentPosition, {\r\n              direction: 0\r\n            })\r\n            if (!that.currentPosition) {\r\n              Toast({\r\n                message: '当前GPS信号弱',\r\n                duration: 1500,\r\n              })\r\n              return\r\n            }\r\n            this.setMainUserPosition(that.currentPosition)\r\n          },\r\n          (err) => {\r\n            Toast({\r\n              message: 'err' + err,\r\n              duration: 2000,\r\n            })\r\n          }\r\n        )\r\n    },\r\n    getDirection() {\r\n      window.addEventListener('deviceorientationabsolute', e => {\r\n        if (e.alpha) {\r\n          // this.aplha = e.alpha\r\n          this.setRotate((e.alpha - 180) >= 0 ? (180 - e.alpha) : (180 - e.alpha))\r\n        }\r\n      })\r\n    },\r\n    // 设置养护人员位置\r\n    setMainUserPosition(position) {\r\n      // xCode，yCode为经纬度\r\n      const coord = [parseFloat(position.longitude), parseFloat(position.latitude)];\r\n      const point = turf.point(coord);\r\n      try {\r\n        const that = this;\r\n        // 定时器\r\n        let timer = setInterval(function () {\r\n          // 如果地图实例创建、巡检人员图层存在且加载完毕\r\n          if (mapObj.map.getSource(\"mainUser\")\r\n            && mapObj.map.isSourceLoaded(\"mainUser\")\r\n          ) {\r\n            // 清除定时器\r\n            clearInterval(timer);\r\n            // 巡检人员图标\r\n            that.setSourceData(\"mainUser\", {\r\n              type: \"FeatureCollection\",\r\n              features: [point]\r\n            })\r\n            that.getDirection()\r\n          }\r\n        }, 100)\r\n      } catch (e) {\r\n        console.log(e);\r\n      }\r\n    },\r\n    setRotate(bearing) {\r\n      // 调整罗盘方向\r\n      mapObj.map.setLayoutProperty(\"mainUserLayer\", \"icon-rotate\", bearing);\r\n    },\r\n    startInspRecord() {\r\n      if (this.isView) {\r\n        Toast({\r\n          message: '该巡检任务已结束',\r\n          duration: 1500,\r\n        })\r\n        return\r\n      }\r\n      let that = this\r\n      if (this.taskData.status == 0) {\r\n        this.noticeShow = true\r\n        let timer = setInterval(() => {\r\n          if (that.continueTime <= 0) {\r\n            that.hasKnow = true\r\n            clearInterval(timer)\r\n            return\r\n          }\r\n          that.continueTime--\r\n        }, 1000)\r\n        return\r\n      }\r\n      this.startGetLocation()\r\n      this.startRecordTimer = new Date()\r\n      this.ifStart = true\r\n    },\r\n    // 结束记录\r\n    endRecord() {\r\n      let diff = Math.floor((new Date() - this.startRecordTimer) / 1000)\r\n\r\n      if (diff <= 10) {\r\n        Toast({\r\n          message: `结束太快了,请${10 - diff}秒后再试`,\r\n          duration: 1000,\r\n        })\r\n        return\r\n      }\r\n      Dialog.confirm({\r\n        title: '标题',\r\n        message: '确定结束本次养护？',\r\n      })\r\n        .then(() => {\r\n          this.endRecordConfirm()\r\n        })\r\n        .catch(() => {\r\n          this.endRecordCancel()\r\n        })\r\n    },\r\n    // 结束记录取消\r\n    endRecordCancel() {\r\n      this.endRecordShow = false\r\n    },\r\n    // 结束记录确认\r\n    async endRecordConfirm() {\r\n      (typeof yuanchu != 'undefined') && yuanchu.locationAMap.stopRequestLocations()\r\n      this.ifStart = false\r\n      this.updateProgress()\r\n      this.getMainDevPoint()\r\n      Toast({\r\n        message: '结束成功',\r\n        duration: 2000\r\n      })\r\n    },\r\n    // 开始定位\r\n    startLocation() {\r\n      if (\r\n        !this.currentPosition ||\r\n        !this.currentPosition.longitude ||\r\n        !this.currentPosition.latitude\r\n      ) {\r\n        Toast({\r\n          message: '获取位置失败!',\r\n          duration: 2000,\r\n        })\r\n        return\r\n      } else {\r\n        const coord = [\r\n          parseFloat(this.currentPosition.longitude),\r\n          parseFloat(this.currentPosition.latitude),\r\n        ]\r\n        this.flyToPoint(coord)\r\n      }\r\n    },\r\n    // 确认\r\n    onConfirm() {\r\n      if (true) {\r\n        let copySignForm = this.deepClone(this.signForm)\r\n        copySignForm.maintainDate = dayjs().format('YYYY-MM-DD')\r\n        copySignForm.taskId = this.$route.query.taskId\r\n        copySignForm.maintainImagesList = [...this.maintainBeforeImage, ...this.maintainAfterImage]\r\n        if (this.currentSelectDev.properties.deviceType == '管线') {\r\n          copySignForm.pipeLength = this.currentSelectDev.properties['length']\r\n          copySignForm.pipeId = this.currentSelectDev.properties.id\r\n          api.uploadMainLineRecords(copySignForm).then((res) => {\r\n            if (res && res.status) {\r\n              Toast({\r\n                message: '养护记录上传成功',\r\n                duration: 2000,\r\n              })\r\n              this.getMainDevPoint()\r\n              this.updateProgress()\r\n            } else {\r\n              Toast({\r\n                message: '养护记录上传失败',\r\n                duration: 2000,\r\n              })\r\n            }\r\n          })\r\n        } else {\r\n          copySignForm.pointId = this.currentSelectDev.properties.id\r\n          api.uploadMainPointRecords(copySignForm).then((res) => {\r\n            if (res && res.status) {\r\n              Toast({\r\n                message: '养护记录上传成功',\r\n                duration: 2000,\r\n              })\r\n              this.getMainDevPoint()\r\n              this.updateProgress()\r\n            } else {\r\n              Toast({\r\n                message: '养护记录上传失败',\r\n                duration: 2000,\r\n              })\r\n            }\r\n          })\r\n        }\r\n        this.signShow = false\r\n        this.signForm.remarks = ''\r\n        this.signForm.maintainType = ''\r\n        this.attachment = ''\r\n        this.attachment1 = ''\r\n        this.maintainAfterImage = []\r\n        this.maintainBeforeImage = []\r\n        this.setSourceData('buffered', {\r\n          type: 'FeatureCollection',\r\n          features: [],\r\n        })\r\n        // this.refreshTask()\r\n      } else {\r\n        console.log('验证失败')\r\n      }\r\n    },\r\n    updateProgress() {\r\n      api.updateProgress({ taskId: this.$route.query.taskId }).then(res => {\r\n        if (res.status) {\r\n          this.progress = res.data\r\n        }\r\n      })\r\n    },\r\n    // 取消\r\n    onCancel() {\r\n      this.signShow = false\r\n      this.setSourceData('buffered', {\r\n        type: 'FeatureCollection',\r\n        features: [],\r\n      })\r\n      this.currentSelectDev = null\r\n      this.attachment = ''\r\n      this.maintainBeforeImage = []\r\n      this.attachment1 = ''\r\n      this.maintainAfterImage = []\r\n    }\r\n  },\r\n  beforeRouteLeave(to, from, next) {\r\n    if (to.name == 'MaintenManagement' && from.name == 'TaskDetail') {\r\n      if (this.ifStart) {\r\n        Dialog.confirm({\r\n          title: '标题',\r\n          message: '退出后会停止定位,确定退出？',\r\n        })\r\n          .then(() => {\r\n            (typeof yuanchu != 'undefined') && yuanchu.locationAMap.stopRequestLocations()\r\n            next()\r\n          })\r\n          .catch(() => {\r\n            this.endRecordCancel()\r\n          })\r\n      } else {\r\n        next()\r\n      }\r\n    } else {\r\n      next()\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"less\" scoped>\r\n/deep/.mapboxgl-popup-content {\r\n  width: auto;\r\n  min-width: 280px;\r\n  height: 50px;\r\n  padding: 24px 36px;\r\n  border-radius: 18px;\r\n  box-shadow: 10px 10px 30px rgba(0, 0, 0, 0.1);\r\n}\r\n/deep/.fm-tabs--line {\r\n  height: 100%;\r\n}\r\n/deep/.fm-tabs--line .fm-tabs__wrap {\r\n  border-radius: 30px 30px 0 0;\r\n}\r\n/deep/.fm-tab--active {\r\n  font-weight: 600;\r\n  color: #191919;\r\n}\r\n/deep/.fm-tabs__content {\r\n  height: 100%;\r\n}\r\n/deep/.fm-tab__pane {\r\n  height: 100%;\r\n}\r\n/deep/.fm-button--default {\r\n  color: #555555;\r\n  font-weight: 400;\r\n}\r\n::-webkit-scrollbar {\r\n  display: none; /* Chrome Safari */\r\n}\r\n.task-map {\r\n  width: 100%;\r\n  height: 100%;\r\n  overflow: hidden;\r\n\r\n  .tip-tools {\r\n    position: fixed;\r\n    display: flex;\r\n    top: 140px;\r\n    left: 200px;\r\n    border-radius: 16px;\r\n    padding: 24px;\r\n    background: #ffffff;\r\n    box-shadow: 0px 10px 18px 0px rgba(0, 0, 0, 0.06);\r\n    border: 2px solid rgba(23, 144, 254, 0.6);\r\n    .tipImg {\r\n      width: 32px;\r\n      height: 32px;\r\n      margin-right: 16px;\r\n    }\r\n    .context {\r\n      font-size: 24px;\r\n      font-family: MicrosoftYaHei;\r\n      color: #1b67d8;\r\n      line-height: 31px;\r\n    }\r\n  }\r\n  .arrow-up {\r\n    position: fixed;\r\n    top: var(--top);\r\n    width: 100%;\r\n    height: var(--height);\r\n    transition: 0.6s;\r\n    .fm-icon {\r\n      margin: 0 47%;\r\n    }\r\n    .content {\r\n      width: 100%;\r\n      height: 100%;\r\n      background: #ffffff;\r\n      box-shadow: 0px -6px 12px 0px rgba(104, 115, 127, 0.1);\r\n      border-radius: 30px 30px 0 0;\r\n      .contentArea {\r\n        width: 100%;\r\n        height: 100%;\r\n        background: #f5f7f9;\r\n        .buttonArea {\r\n          width: var(--width);\r\n          padding: 30px 20px;\r\n          display: flex;\r\n          .button {\r\n            min-width: 160px;\r\n            margin: 0 10px;\r\n            border: none;\r\n            box-shadow: 0px 4px 16px 0px rgba(104, 115, 127, 0.06);\r\n          }\r\n        }\r\n        .listArea {\r\n          margin: 0 4%;\r\n          background: #ffffff;\r\n          height: calc(100% - 74px);\r\n          padding: 20px 36px 0;\r\n          border-radius: 16px 16px 0 0;\r\n          overflow-y: scroll;\r\n          .list {\r\n            height: 45px;\r\n            display: flex;\r\n            padding: 40px 0;\r\n            border-bottom: 1px solid #eeeeee;\r\n            .list_num {\r\n              min-width: 60px;\r\n              margin-right: 30px;\r\n              margin-left: 10px;\r\n              height: 43px;\r\n              font-size: 36px;\r\n              font-family: Helvetica-Bold, Helvetica;\r\n              font-weight: bold;\r\n              color: #1b67d8;\r\n              line-height: 43px;\r\n            }\r\n            .list_type {\r\n              min-width: 160px;\r\n              height: 45px;\r\n              font-size: 32px;\r\n              font-family: PingFangSC-Regular, PingFang SC;\r\n              font-weight: 400;\r\n              color: #333333;\r\n              line-height: 45px;\r\n            }\r\n            .list_id {\r\n              min-width: 200px;\r\n              height: 45px;\r\n              font-size: 32px;\r\n              font-family: PingFangSC-Regular, PingFang SC;\r\n              font-weight: 400;\r\n              color: #333333;\r\n              line-height: 45px;\r\n            }\r\n            .list_deal {\r\n              height: 45px;\r\n              font-size: 32px;\r\n              font-family: PingFangSC-Regular, PingFang SC;\r\n              font-weight: 400;\r\n              color: #1b67d8;\r\n              line-height: 45px;\r\n              display: flex;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n  .noticeBody {\r\n    width: 100%;\r\n    height: 100%;\r\n    background: #FFFFFF;\r\n    .noticeTitle {\r\n      width: 18%;\r\n      padding: 36px 0;\r\n      margin: 0 41%;\r\n      height: 45px;\r\n      font-size: 32px;\r\n      font-family: PingFangSC-Semibold, PingFang SC;\r\n      font-weight: 600;\r\n      color: #1B67D8;\r\n      line-height: 45px;\r\n    }\r\n    .noticeContent {\r\n      width: 94%;\r\n      padding: 0 3%;\r\n      overflow-y: scroll;\r\n      height: calc(100% - 254px);\r\n      h5 {\r\n        text-align: center;\r\n        height: 40px;\r\n        font-size: 28px;\r\n        font-family: PingFangSC-Medium, PingFang SC;\r\n        font-weight: 600;\r\n        color: #191919;\r\n        line-height: 40px;\r\n      }\r\n      p,\r\n      h6 {\r\n        font-size: 28px;\r\n        font-family: PingFangSC-Regular, PingFang SC;\r\n        font-weight: 400;\r\n        color: #191919;\r\n        line-height: 42px;\r\n      }\r\n    }\r\n    .noticeBtnArea {\r\n      position: fixed;\r\n      bottom: 0;\r\n      width: 100%;\r\n      height: 136px;\r\n      background: #ffffff;\r\n      .noticeBtn {\r\n        width: 94%;\r\n        color: #FFFFFF;\r\n        margin: 24px 3%;\r\n      }\r\n    }\r\n  }\r\n\r\n  .alert {\r\n    top: 2.22rem;\r\n    position: fixed;\r\n    width: 100%;\r\n    z-index: 4;\r\n    background-color: #62707c;\r\n    opacity: 0.5;\r\n    font-size: 1rem;\r\n\r\n    .u-alert-content {\r\n      width: 100%;\r\n    }\r\n  }\r\n\r\n  .progress {\r\n    width: 80%;\r\n    height: 1rem;\r\n    background-color: #fff;\r\n    box-shadow: 0 0.4rem 0.6rem 0 rgba(0, 0, 0, 0.2);\r\n    border-radius: 0.1rem;\r\n    margin: 0 0.3rem;\r\n    padding: 0.1rem 0.15rem;\r\n    position: fixed;\r\n    top: 2.5rem;\r\n\r\n    &-box {\r\n      width: 100%;\r\n      margin: 0.3rem 0;\r\n      display: flex;\r\n\r\n      .pro-dot {\r\n        width: 0.3rem;\r\n        height: 0.3rem;\r\n        border-radius: 50%;\r\n        float: left;\r\n        margin: auto 0.3rem;\r\n      }\r\n\r\n      .pro-text {\r\n        line-height: 0.5rem;\r\n        display: flex;\r\n        font-size: 12px;\r\n        float: left;\r\n      }\r\n    }\r\n  }\r\n\r\n  .pro-circle {\r\n    position: fixed;\r\n    width: 1rem;\r\n    height: 1rem;\r\n    right: 0.1rem;\r\n    padding: 0.1rem;\r\n    top: 2.5rem;\r\n    // margin: 0.27rem 0rem;\r\n    background-color: #fff;\r\n    z-index: 3;\r\n    box-shadow: 0rem 0.22rem 0.61rem 0rem rgba(0, 0, 0, 0.2);\r\n    border-radius: 0.1rem;\r\n\r\n    .progress-text-view {\r\n      font-size: 0.4rem;\r\n      z-index: 4;\r\n\r\n      .progress-text-up {\r\n        color: #306cc8;\r\n      }\r\n\r\n      .progress-text-down {\r\n        border-top: 0.05rem solid #555555;\r\n      }\r\n    }\r\n  }\r\n\r\n  .point-list {\r\n    position: fixed;\r\n    width: 1.2rem;\r\n    height: 1.2rem;\r\n    left: 0.3rem;\r\n    bottom: 2rem;\r\n    background-color: #fff;\r\n    z-index: 3;\r\n    box-shadow: 0rem 0.22rem 0.61rem 0rem rgba(0, 0, 0, 0.2);\r\n    border-radius: 0.27rem;\r\n\r\n    .list-image {\r\n      margin: 0.18rem;\r\n      width: 0.82rem;\r\n      height: 0.82rem;\r\n    }\r\n  }\r\n\r\n  .footer {\r\n    width: inherit;\r\n    padding: 1.11rem 0.83rem;\r\n    color: #333333;\r\n    background-color: #ffffff;\r\n    height: 3.55rem;\r\n    z-index: 4;\r\n    position: fixed;\r\n    bottom: 0rem;\r\n\r\n    &-content {\r\n      float: left;\r\n    }\r\n\r\n    &-btn {\r\n      float: right;\r\n      width: 4.44rem;\r\n      height: 1.77rem;\r\n      line-height: 1.77rem;\r\n      border-radius: 0.88rem;\r\n    }\r\n  }\r\n\r\n  .start-record {\r\n    position: absolute;\r\n    z-index: 3;\r\n    left: 50%;\r\n    bottom: 235px;\r\n    transform: translate(-50%, 0);\r\n\r\n    img {\r\n      width: 140px;\r\n      height: 140px;\r\n    }\r\n  }\r\n\r\n  .controlCard {\r\n    width: 94%;\r\n    height: 276px;\r\n    margin: 0 3%;\r\n    background: #ffffff;\r\n    position: absolute;\r\n    top: 150px;\r\n    box-shadow: 0px 8px 20px 0px rgba(104, 115, 127, 0.2);\r\n    border-radius: 16px;\r\n    .mainContent {\r\n      width: 94%;\r\n      height: 180px;\r\n      padding: 12px 16px 12px 24px;\r\n      overflow-y: scroll;\r\n      .contentList {\r\n        display: flex;\r\n        flex-direction: column;\r\n        .obj {\r\n          display: flex;\r\n          margin: 8px 0;\r\n          .point {\r\n            width: 8px;\r\n            height: 8px;\r\n            background: #1b67d8;\r\n            border-radius: 10px;\r\n            margin: 18px;\r\n          }\r\n          .name {\r\n            width: auto;\r\n            height: 40px;\r\n            font-size: 28px;\r\n            font-family: PingFangSC-Regular, PingFang SC;\r\n            font-weight: 400;\r\n            color: #555555;\r\n            line-height: 40px;\r\n            margin-left: 18px;\r\n            margin-right: 12px;\r\n          }\r\n          .num {\r\n            width: auto;\r\n            height: 38px;\r\n            font-size: 32px;\r\n            font-family: Helvetica-Bold, Helvetica;\r\n            font-weight: bold;\r\n            color: #1b67d8;\r\n            line-height: 38px;\r\n            margin: 0 12px;\r\n          }\r\n          .unit {\r\n            width: auto;\r\n            height: 40px;\r\n            font-size: 28px;\r\n            font-family: PingFangSC-Regular, PingFang SC;\r\n            font-weight: 400;\r\n            color: #999999;\r\n            line-height: 40px;\r\n          }\r\n        }\r\n      }\r\n    }\r\n    .startBtn {\r\n      width: 100%;\r\n      height: 72px;\r\n      background: #1b67d8;\r\n      border-radius: 0px 0px 16px 16px;\r\n      .btnContent {\r\n        font-size: 28px;\r\n        padding: 20px 46% 0 46%;\r\n        color: #ffffff;\r\n      }\r\n    }\r\n\r\n    .controlContent {\r\n      margin: 60px 30px 0;\r\n      display: flex;\r\n      flex-direction: column;\r\n\r\n      .infoContent {\r\n        display: flex;\r\n        flex-direction: column;\r\n        justify-content: space-around;\r\n        margin-bottom: 24px;\r\n\r\n        .block {\r\n          text-align: center;\r\n          width: 210px;\r\n          height: 160px;\r\n          display: flex;\r\n          flex-direction: column;\r\n          align-items: center;\r\n          background: rgba(27, 103, 216, 0.05);\r\n          border-radius: 16px;\r\n          // margin: 0 20px;\r\n\r\n          .rate {\r\n            width: 100%;\r\n            height: 50%;\r\n            display: flex;\r\n            align-items: center;\r\n            margin: auto;\r\n            font-size: 48px;\r\n            font-family: Helvetica-Bold, Helvetica;\r\n            font-weight: bold;\r\n            color: #306cc8;\r\n\r\n            .centerStyle {\r\n              margin: auto;\r\n              display: flex;\r\n              align-items: center;\r\n              font-size: 38px;\r\n              font-family: Helvetica-Bold, Helvetica;\r\n              font-weight: bold;\r\n\r\n              .inspKp {\r\n                padding-bottom: 3px;\r\n                padding-right: 3px;\r\n                color: #306cc8;\r\n              }\r\n\r\n              .uninspKp {\r\n                color: #191919;\r\n                letter-spacing: 3px;\r\n              }\r\n            }\r\n          }\r\n\r\n          .name {\r\n            font-size: 14px;\r\n            font-family: PingFangSC-Regular, PingFang SC;\r\n            font-weight: 400;\r\n            color: #555555;\r\n            width: 100%;\r\n            height: 33%;\r\n          }\r\n        }\r\n      }\r\n\r\n      .bottomSide {\r\n        width: 100%;\r\n        display: flex;\r\n        margin-top: 24px;\r\n        justify-content: space-around;\r\n      }\r\n\r\n      .endControl {\r\n        display: flex;\r\n        justify-content: space-between;\r\n        align-items: center;\r\n\r\n        .leftText {\r\n          width: 27%;\r\n          display: flex;\r\n          justify-content: space-around;\r\n          align-items: center;\r\n\r\n          img {\r\n            width: 32px;\r\n            height: 32px;\r\n            margin: auto;\r\n          }\r\n\r\n          /deep/.fm-count-down {\r\n            font-size: 24px;\r\n            color: #306cc8;\r\n          }\r\n        }\r\n\r\n        .rightButton {\r\n          display: flex;\r\n\r\n          .endBtn {\r\n            font-size: 24px;\r\n            width: 120px;\r\n            height: 60px;\r\n            background: #ffffff;\r\n            color: #306cc8;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n  .controlCard_start {\r\n    width: 86%;\r\n    height: 139px;\r\n    margin: 0 3%;\r\n    background: #ffffff;\r\n    position: absolute;\r\n    display: flex;\r\n    top: 160px;\r\n    box-shadow: 0px 8px 20px 0px rgba(104, 115, 127, 0.2);\r\n    border-radius: 16px;\r\n    padding: 10px 30px;\r\n    .progressControl {\r\n      display: flex;\r\n      height: 64px;\r\n      margin: auto;\r\n      .icon {\r\n        margin: auto;\r\n      }\r\n      .title {\r\n        width: 64px;\r\n        height: 64px;\r\n        font-size: 28px;\r\n        font-family: PingFangSC-Regular, PingFang SC;\r\n        font-weight: 400;\r\n        color: #999999;\r\n        line-height: 64px;\r\n        margin: 0 12px;\r\n      }\r\n      .progressWidth {\r\n        margin: auto;\r\n        width: var(--totalWidth);\r\n        height: 44px;\r\n        border-radius: 6px;\r\n        background: rgba(27, 103, 216, 0.08);\r\n        box-shadow: inset 0px 0px 5px 0px rgba(39, 123, 214, 0.15);\r\n        margin-right: 20px;\r\n\r\n        // 第二层，计算得到的实际比率宽度\r\n        .colorWidth {\r\n          width: var(--barWidth);\r\n          height: 44px;\r\n          border-radius: 6px;\r\n          box-shadow: 0px 4px 8px 0px rgba(50, 127, 211, 0.24);\r\n          border-radius: 6px;\r\n          background: linear-gradient(\r\n            -45deg,\r\n            #1b67d8 0%,\r\n            rgba(58, 160, 238, 0.42) 100%\r\n          );\r\n\r\n          // 第三层，动画\r\n          .progressAnimate {\r\n            width: 0;\r\n            height: 44px;\r\n            border-radius: 6px;\r\n            background: linear-gradient(\r\n              270deg,\r\n              #1b67d8 0%,\r\n              rgba(58, 160, 238, 0.42) 100%\r\n            );\r\n            // background: linear-gradient(to top right, #CDDC39, #8BC34A, #FFEB3B);\r\n            animation: w 3s linear infinite;\r\n\r\n            @keyframes w {\r\n              0% {\r\n                width: 0;\r\n              }\r\n\r\n              100% {\r\n                width: var(--barWidth);\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n      .bluePercent {\r\n        height: 64px;\r\n        font-size: 32px;\r\n        font-family: PingFangSC-Semibold, PingFang SC;\r\n        font-weight: 600;\r\n        color: #1b67d8;\r\n        line-height: 64px;\r\n      }\r\n      .purPercent {\r\n        height: 64px;\r\n        font-size: 28px;\r\n        font-family: PingFangSC-Regular, PingFang SC;\r\n        font-weight: 400;\r\n        color: #999999;\r\n        line-height: 64px;\r\n      }\r\n    }\r\n    .controlBtn {\r\n      width: 119px;\r\n      height: 119px;\r\n      margin: auto;\r\n    }\r\n  }\r\n\r\n  .tool-box {\r\n    position: fixed;\r\n    width: 1.2rem;\r\n    height: auto;\r\n    right: 0.3rem;\r\n    bottom: 0.3rem;\r\n\r\n    .refresh {\r\n      width: 1.2rem;\r\n      height: 1.2rem;\r\n      margin-bottom: 0.55rem;\r\n      background-color: #fff;\r\n      z-index: 3;\r\n      box-shadow: 0rem 0.22rem 0.61rem 0rem rgba(0, 0, 0, 0.2);\r\n      border-radius: 0.27rem;\r\n\r\n      &-image {\r\n        margin: 0.18rem;\r\n        width: 0.82rem;\r\n        height: 0.82rem;\r\n      }\r\n    }\r\n\r\n    .route {\r\n      width: 1.2rem;\r\n      height: 1.2rem;\r\n      margin-bottom: 0.55rem;\r\n      background-color: #fff;\r\n      z-index: 3;\r\n      box-shadow: 0rem 0.22rem 0.61rem 0rem rgba(0, 0, 0, 0.2);\r\n      border-radius: 0.27rem;\r\n\r\n      &-image {\r\n        margin: 0.18rem;\r\n        width: 0.82rem;\r\n        height: 0.82rem;\r\n      }\r\n    }\r\n\r\n    .location {\r\n      width: 1.2rem;\r\n      height: 1.2rem;\r\n      background-color: #fff;\r\n      z-index: 3;\r\n      box-shadow: 0rem 0.22rem 0.61rem 0rem rgba(0, 0, 0, 0.2);\r\n      border-radius: 60px;\r\n\r\n      &-image {\r\n        margin: 0.18rem;\r\n        width: 0.82rem;\r\n        height: 0.82rem;\r\n      }\r\n    }\r\n  }\r\n\r\n  /deep/.fm-popup {\r\n    background: #eaf4ff;\r\n  }\r\n\r\n  .tab {\r\n    display: flex;\r\n    margin: 28px 139px;\r\n    width: auto;\r\n    .dealName {\r\n      height: 45px;\r\n      font-size: 32px;\r\n      font-family: PingFangSC-Regular, PingFang SC;\r\n      font-weight: 400;\r\n      color: #555555;\r\n      line-height: 45px;\r\n    }\r\n  }\r\n  .popup-view {\r\n    height: 540px;\r\n    width: auto;\r\n    margin: 0 32px 32px 32px;\r\n    overflow: scroll;\r\n    border-radius: 24px;\r\n    background-color: #fff;\r\n    box-shadow: 0px 4px 16px 0px rgba(104, 115, 127, 0.06);\r\n\r\n    /deep/.fm-radio--horizontal {\r\n      margin-right: 20px;\r\n    }\r\n\r\n    .title {\r\n      display: flex;\r\n      margin-top: 32px;\r\n      padding-bottom: 32px;\r\n      border-bottom: 1px #f5f5f5 solid;\r\n\r\n      img {\r\n        width: 6px;\r\n        height: 40px;\r\n      }\r\n\r\n      .deviceId {\r\n        margin-left: 32px;\r\n        font-size: 36px;\r\n        font-family: PingFangSC-Semibold, PingFang SC;\r\n        font-weight: 600;\r\n        color: #191919;\r\n        line-height: 50px;\r\n      }\r\n    }\r\n\r\n    /deep/.fm-uploader__wrapper {\r\n      margin-left: 16px;\r\n    }\r\n\r\n    .preview-cover {\r\n      position: absolute;\r\n      bottom: 0;\r\n      box-sizing: border-box;\r\n      width: 100%;\r\n      padding: 4px;\r\n      color: #fff;\r\n      font-size: 12px;\r\n      text-align: center;\r\n      background: rgba(0, 0, 0, 0.3);\r\n    }\r\n  }\r\n\r\n  .btnArea {\r\n    display: flex;\r\n\r\n    .btn {\r\n      width: 94%;\r\n      margin: 0 auto;\r\n    }\r\n\r\n    .btn1 {\r\n      width: 44%;\r\n      margin: 0 12px 0 30px;\r\n    }\r\n\r\n    .btn2 {\r\n      width: 44%;\r\n      margin: 0 30px 0 12px;\r\n    }\r\n  }\r\n\r\n  .confirm-pop {\r\n    .title {\r\n      border-left: 0.22rem solid #306cc8;\r\n      margin: 0.27rem;\r\n      padding-left: 0.55rem;\r\n    }\r\n\r\n    .content {\r\n      border-top: 0.027rem solid rgba(128, 128, 128, 0.322);\r\n      width: 11.66rem;\r\n      padding: 1.33rem;\r\n      text-align: center;\r\n      background-color: #fff;\r\n\r\n      &-view {\r\n        font-size: 0.88rem;\r\n      }\r\n\r\n      .confirm-btn {\r\n        margin-top: 2.22rem;\r\n        justify-items: center;\r\n\r\n        .popup-btn {\r\n          float: left;\r\n          width: 3.33rem;\r\n          height: 1.77rem;\r\n          border-radius: 0.27rem;\r\n\r\n          &-l {\r\n            margin-left: 0.55rem;\r\n            margin-right: 0.55rem;\r\n          }\r\n\r\n          &-r {\r\n            margin-left: 0.55rem;\r\n            margin-right: 0.55rem;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}