{"remainingRequest":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\src\\components\\select-personnel\\index.vue?vue&type=style&index=0&id=1b0d4662&scoped=true&lang=less","dependencies":[{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\src\\components\\select-personnel\\index.vue","mtime":1705912799959},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\less-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQouc2VsZWN0LXBlcnNvbm5lbC1ib3ggew0KICAvL+WbnuaYvg0KICAuZnVsbG5hbWUtdmlldyB7DQogICAgY29sb3I6ICMzMzM7DQogIH0NCg0KICAvL+e7n+S4gOeahCBjZWxsIHRpdGxlIOagt+W8jw0KICAuY2VsbC10aXRsZSB7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KDQogICAgLmxlZnQtYm94IHsNCiAgICAgIHdpZHRoOiA0OHB4Ow0KICAgICAgaGVpZ2h0OiA0OHB4Ow0KICAgICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgICAgbGluZS1oZWlnaHQ6IDQ4cHg7DQogICAgICBmb250LXNpemU6IDI4cHg7DQogICAgICBjb2xvcjogI2ZmZjsNCiAgICAgIGJhY2tncm91bmQtY29sb3I6ICMwMjdhZmY7DQogICAgICBib3JkZXItcmFkaXVzOiA1MCU7DQogICAgfQ0KDQogICAgLm5hbWUgew0KICAgICAgbWF4LXdpZHRoOiA1MDBweDsNCiAgICAgIG1hcmdpbi1sZWZ0OiAxNnB4Ow0KICAgICAgZm9udC1zaXplOiAzMnB4Ow0KICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsNCiAgICAgIHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzOw0KICAgICAgd2hpdGUtc3BhY2U6IG5vd3JhcDsNCiAgICB9DQogIH0NCg0KICAvL+WIneWni+W8ueahhg0KICAucG9wdXAxIHsNCiAgICBoZWlnaHQ6IDgwJTsNCg0KICAgIC5wb3B1cC1jZW50ZXIgew0KICAgICAgZGlzcGxheTogZmxleDsNCiAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICAgICBoZWlnaHQ6IDEwMCU7DQoNCiAgICAgIC50b3AtYm94IHsNCiAgICAgICAgZGlzcGxheTogZmxleDsNCiAgICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOw0KICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgICAgICBwYWRkaW5nOiAxMnB4IDMycHggMDsNCg0KICAgICAgICAuc2VhcmNoLWJveCB7DQogICAgICAgICAgZmxleDogMTsNCg0KICAgICAgICAgIC5mbS1zZWFyY2ggew0KICAgICAgICAgICAgcGFkZGluZy1sZWZ0OiAwOw0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgICYgPiBpIHsNCiAgICAgICAgICBmb250LXNpemU6IDQ4cHg7DQogICAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7DQogICAgICAgICAgY29sb3I6ICMwMjdhZmY7DQogICAgICAgIH0NCiAgICAgIH0NCg0KICAgICAgLnVzZXItbGlzdCB7DQogICAgICAgIGZsZXg6IDE7DQoNCiAgICAgICAgaSB7DQogICAgICAgICAgZm9udC1zaXplOiA0OHB4Ow0KICAgICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkOw0KICAgICAgICAgIGNvbG9yOiAjZmY0ZDRmOw0KICAgICAgICB9DQogICAgICB9DQoNCiAgICAgIC5uby1kYXRhIHsNCiAgICAgICAgcGFkZGluZzogMzJweDsNCiAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyOw0KICAgICAgICBmb250LXNpemU6IDMwcHg7DQogICAgICAgIGNvbG9yOiAjY2NjOw0KICAgICAgfQ0KICAgIH0NCiAgfQ0KDQogIC8v57uE57uH5py65p6E5by55qGGDQogIC5wb3B1cDIgew0KICAgIGhlaWdodDogODAlOw0KICAgIHBhZGRpbmc6IDMycHggMzJweCAwOw0KICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7DQoNCiAgICAucG9wdXAtY2VudGVyIHsNCiAgICAgIG1heC1oZWlnaHQ6IDEwMCU7DQogICAgICBvdmVyZmxvdy15OiBhdXRvOw0KICAgICAgLy/pmpDol4/mu5rliqjmnaENCiAgICAgIHNjcm9sbGJhci13aWR0aDogbm9uZTsgLy9maXJlZm94DQogICAgICAtbXMtb3ZlcmZsb3ctc3R5bGU6IG5vbmU7IC8vSUUgMTArDQoNCiAgICAgIC8v6ZqQ6JeP5rua5Yqo5p2hDQogICAgICAmOjotd2Via2l0LXNjcm9sbGJhciB7DQogICAgICAgIGRpc3BsYXk6IG5vbmU7IC8vQ2hyb21lIHwgU2FmYXJpDQogICAgICB9DQogICAgfQ0KICB9DQoNCiAgLy/kurrlkZjpgInmi6nlvLnmoYYNCiAgLnBvcHVwMyB7DQogICAgaGVpZ2h0OiA4MCU7DQoNCiAgICAucG9wdXAtY2VudGVyIHsNCiAgICAgIGRpc3BsYXk6IGZsZXg7DQogICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICAgICAgaGVpZ2h0OiAxMDAlOw0KDQogICAgICAuc2VhcmNoLWJveCB7DQogICAgICAgIHBhZGRpbmctdG9wOiAxMnB4Ow0KICAgICAgfQ0KDQogICAgICAuZm0tbGlzdCB7DQogICAgICAgIGZsZXg6IDE7DQogICAgICAgIG92ZXJmbG93LXk6IGF1dG87DQogICAgICAgIC8v6ZqQ6JeP5rua5Yqo5p2hDQogICAgICAgIHNjcm9sbGJhci13aWR0aDogbm9uZTsgLy9maXJlZm94DQogICAgICAgIC1tcy1vdmVyZmxvdy1zdHlsZTogbm9uZTsgLy9JRSAxMCsNCg0KICAgICAgICAvL+makOiXj+a7muWKqOadoQ0KICAgICAgICAmOjotd2Via2l0LXNjcm9sbGJhciB7DQogICAgICAgICAgZGlzcGxheTogbm9uZTsgLy9DaHJvbWUgfCBTYWZhcmkNCiAgICAgICAgfQ0KICAgICAgfQ0KDQogICAgICAuY29uZmlybS1ib3ggew0KICAgICAgICBkaXNwbGF5OiBmbGV4Ow0KICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47DQogICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAgICAgIHBhZGRpbmc6IDMycHg7DQoNCiAgICAgICAgJiA+IHNwYW4gew0KICAgICAgICAgIGZsZXg6IDE7DQogICAgICAgICAgbWFyZ2luLXJpZ2h0OiAzMnB4Ow0KICAgICAgICAgIGZvbnQtc2l6ZTogMzBweDsNCiAgICAgICAgICBvdmVyZmxvdzogaGlkZGVuOw0KICAgICAgICAgIHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzOw0KICAgICAgICAgIHdoaXRlLXNwYWNlOiBub3dyYXA7DQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9DQogIH0NCg0KICAvL+S6uuWRmOafpeeci+W8ueahhg0KICAucG9wdXA0IHsNCiAgICBoZWlnaHQ6IDgwJTsNCg0KICAgIC5wb3B1cC1jZW50ZXIgew0KICAgICAgaGVpZ2h0OiAxMDAlOw0KICAgICAgcGFkZGluZy10b3A6IDEycHg7DQogICAgICBib3gtc2l6aW5nOiBib3JkZXItYm94Ow0KICAgICAgb3ZlcmZsb3cteTogYXV0bzsNCg0KICAgICAgaSB7DQogICAgICAgIGZvbnQtc2l6ZTogNDhweDsNCiAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7DQogICAgICAgIGNvbG9yOiAjZmY0ZDRmOw0KICAgICAgfQ0KICAgIH0NCiAgfQ0KfQ0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AA6iBA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/select-personnel","sourcesContent":["<!--\r\n * @Description: 选人组件\r\n * @Author: ye_xf\r\n * @Date: 2022-06-06 10:33:38\r\n * @LastEditTime: 2022-06-10 09:39:15\r\n * @LastEditors: ye_xf\r\n * @Reference: \r\n-->\r\n\r\n<template>\r\n  <div class=\"select-personnel-box\">\r\n    <!-- 回显已选人员姓名：多选时仅显示第一个 -->\r\n    <fm-cell :title=\"title\" :required=\"required\" is-link @click=\"openPopup1\">\r\n      <template #default>\r\n        <div class=\"fullname-view\">\r\n          <div v-if=\"userList.length\">\r\n            <span v-if=\"!multiple\">\r\n              {{ userList[0].fullname }}\r\n            </span>\r\n            <span v-else>\r\n              {{ userList[0].fullname }}\r\n              <template v-if=\"userList.length > 1\">\r\n                +{{ userList.length }}\r\n              </template>\r\n            </span>\r\n          </div>\r\n          <span v-else>{{ placeholder }}</span>\r\n        </div>\r\n      </template>\r\n      <template #right-icon>\r\n        <i v-if=\"!userList.length\" class=\"fm-icon fm-icon-arrow\"></i>\r\n      </template>\r\n    </fm-cell>\r\n    <!-- 初始弹框 -->\r\n    <fm-popup\r\n      :visible.sync=\"popupVisible1\"\r\n      position=\"bottom\"\r\n      class=\"popup1\"\r\n      round\r\n      @click-modal=\"popup1ModalClick\"\r\n    >\r\n      <div class=\"popup-center\">\r\n        <div class=\"top-box\">\r\n          <div class=\"search-box\">\r\n            <fm-search\r\n              v-model=\"searchValue\"\r\n              placeholder=\"请输入待选人员的姓名\"\r\n              @search=\"searchUser1\"\r\n            ></fm-search>\r\n          </div>\r\n          <i class=\"fm-icon fm-icon-add-o\" @click=\"openPopup2\"></i>\r\n        </div>\r\n        <!-- 已选人员列表 -->\r\n        <div v-if=\"userList.length\" class=\"user-list\">\r\n          <fm-cell-group>\r\n            <fm-cell\r\n              v-for=\"user in userList\"\r\n              :key=\"user.name\"\r\n              clickable\r\n              @click=\"deleteSelectedUser(user)\"\r\n            >\r\n              <template #title>\r\n                <div class=\"cell-title\">\r\n                  <div class=\"left-box\">{{ user.fullname.substr(0, 1) }}</div>\r\n                  <span class=\"name\">{{ user.fullname }}</span>\r\n                </div>\r\n              </template>\r\n              <template #right-icon>\r\n                <i class=\"fm-icon fm-icon-close\"></i>\r\n              </template>\r\n            </fm-cell>\r\n          </fm-cell-group>\r\n        </div>\r\n        <div v-else class=\"no-data\">暂未选择人员</div>\r\n      </div>\r\n    </fm-popup>\r\n    <!-- 组织机构弹窗 -->\r\n    <fm-popup\r\n      :visible.sync=\"popupVisible2\"\r\n      position=\"bottom\"\r\n      class=\"popup2\"\r\n      round\r\n      @click-modal=\"popup2ModalClick\"\r\n    >\r\n      <div v-if=\"popupVisible2\" class=\"popup-center\">\r\n        <Tree :dataList=\"orgTree\" @treeClick=\"treeClick\"></Tree>\r\n      </div>\r\n    </fm-popup>\r\n    <!-- 人员选择弹框 -->\r\n    <fm-popup\r\n      :visible.sync=\"popupVisible3\"\r\n      position=\"bottom\"\r\n      class=\"popup3\"\r\n      round\r\n      @click-modal=\"popup3ModalClick\"\r\n      @closed=\"popup3Closed\"\r\n    >\r\n      <div class=\"popup-center\">\r\n        <div class=\"search-box\">\r\n          <fm-search\r\n            v-model=\"searchValue\"\r\n            placeholder=\"请输入待选人员的姓名\"\r\n            @search=\"searchUser2\"\r\n            @clear=\"clearSearch\"\r\n          ></fm-search>\r\n        </div>\r\n        <fm-list\r\n          v-model=\"listLoading\"\r\n          :finished=\"listFinished\"\r\n          :immediate-check=\"false\"\r\n          @load=\"listLoad\"\r\n        >\r\n          <!-- 单选 -->\r\n          <template v-if=\"!multiple\">\r\n            <fm-radio-group v-model=\"radioValue\">\r\n              <fm-cell-group>\r\n                <fm-cell\r\n                  v-for=\"user in targetUserList\"\r\n                  :key=\"user.userName\"\r\n                  clickable\r\n                  @click=\"radioCellClick(user)\"\r\n                >\r\n                  <template #title>\r\n                    <div class=\"cell-title\">\r\n                      <div class=\"left-box\">\r\n                        {{ user.userFullname.substr(0, 1) }}\r\n                      </div>\r\n                      <span class=\"name\">{{ user.userFullname }}</span>\r\n                    </div>\r\n                  </template>\r\n                  <template #right-icon>\r\n                    <fm-radio :name=\"user.userName\" />\r\n                  </template>\r\n                </fm-cell>\r\n              </fm-cell-group>\r\n            </fm-radio-group>\r\n          </template>\r\n          <!-- 多选 -->\r\n          <template v-else>\r\n            <fm-checkbox-group v-model=\"checkboxValue\">\r\n              <fm-cell-group>\r\n                <fm-cell\r\n                  v-for=\"user in targetUserList\"\r\n                  :key=\"user.userName\"\r\n                  clickable\r\n                  @click=\"checkboxCellClick(user)\"\r\n                >\r\n                  <template #title>\r\n                    <div class=\"cell-title\">\r\n                      <div class=\"left-box\">\r\n                        {{ user.userFullname.substr(0, 1) }}\r\n                      </div>\r\n                      <span class=\"name\">{{ user.userFullname }}</span>\r\n                    </div>\r\n                  </template>\r\n                  <template #right-icon>\r\n                    <fm-checkbox :ref=\"user.userName\" :name=\"user.userName\" />\r\n                  </template>\r\n                </fm-cell>\r\n              </fm-cell-group>\r\n            </fm-checkbox-group>\r\n          </template>\r\n        </fm-list>\r\n        <div class=\"confirm-box\">\r\n          <span v-if=\"!multiple\">\r\n            已选人员：{{ prepareUserList[0] && prepareUserList[0].fullname }}\r\n          </span>\r\n          <span v-else @click=\"openPopup4\">\r\n            已选人员：{{ prepareUserList[0] && prepareUserList[0].fullname }}\r\n            <template v-if=\"prepareUserList.length > 1\">\r\n              +{{ prepareUserList.length }}\r\n            </template>\r\n          </span>\r\n          <fm-button type=\"primary\" size=\"small\" @click=\"confirm\">\r\n            确定\r\n          </fm-button>\r\n        </div>\r\n      </div>\r\n    </fm-popup>\r\n    <!-- 人员查看弹窗 -->\r\n    <fm-popup\r\n      :visible.sync=\"popupVisible4\"\r\n      position=\"bottom\"\r\n      class=\"popup4\"\r\n      round\r\n      @click-modal=\"popup4ModalClick\"\r\n    >\r\n      <div class=\"popup-center\">\r\n        <fm-cell\r\n          v-for=\"user in prepareUserList\"\r\n          :key=\"user.name\"\r\n          clickable\r\n          @click=\"deletePrepareUser(user)\"\r\n        >\r\n          <template #title>\r\n            <div class=\"cell-title\">\r\n              <div class=\"left-box\">{{ user.fullname.substr(0, 1) }}</div>\r\n              <span class=\"name\">{{ user.fullname }}</span>\r\n            </div>\r\n          </template>\r\n          <template #right-icon>\r\n            <i class=\"fm-icon fm-icon-close\"></i>\r\n          </template>\r\n        </fm-cell>\r\n      </div>\r\n    </fm-popup>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { Toast } from 'fawkes-mobile-lib'\r\n\r\nimport Tree from './components/Tree'\r\n\r\nimport { getOrgTree, getUserByFullname } from './api'\r\n\r\nexport default {\r\n  name: 'selectPersonnel',\r\n  components: {\r\n    [Toast.name]: Toast,\r\n    Tree,\r\n  },\r\n  props: {\r\n    //已选人员的用户名数组.toString()\r\n    userName: {\r\n      type: String,\r\n      required: true,\r\n    },\r\n    //已选人员的姓名数组.toString()\r\n    userFullname: {\r\n      type: String,\r\n      required: true,\r\n    },\r\n    //fm-cell title=\"title\" 标题\r\n    title: {\r\n      type: String,\r\n      default: '选择人员',\r\n    },\r\n    //fm-cell required=\"required\" 是否显示必填标识\r\n    required: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n    //是否允许编辑\r\n    disabled: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n    //未选择人员时的提示信息\r\n    placeholder: {\r\n      type: String,\r\n      default: '',\r\n    },\r\n    //是否允许多选\r\n    multiple: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n    //组织机构树最顶级的id\r\n    portalId: {\r\n      type: String,\r\n      default: '1302785644422082562',\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      orgTree: [], //组织机构树\r\n      userList: [], //实际使用的已选人员数组\r\n      prepareUserList: [], //操作过程中未确定的人员数组\r\n      popupVisible1: false,\r\n      popupVisible2: false,\r\n      page: 1,\r\n      size: 12,\r\n      maxPage: null,\r\n      orgNo: null,\r\n      searchValue: '',\r\n      targetUserList: [], //可选择的目标人员数组\r\n      popupVisible3: false,\r\n      listLoading: false, //是否正在加载数据\r\n      listFinished: false, //数据是否已全部加载完成\r\n      radioValue: '',\r\n      checkboxValue: [],\r\n      p1ToP3: false, //是否从popup1直接打开popup3\r\n      popupVisible4: false,\r\n    }\r\n  },\r\n  methods: {\r\n    //初始化组件数据\r\n    init() {\r\n      //初始化组织机构树\r\n      const data = {\r\n        portalId: this.portalId,\r\n        isAll: false,\r\n      }\r\n\r\n      getOrgTree(data).then((res) => {\r\n        if (res.status) {\r\n          this.orgTree = res.data\r\n        }\r\n      })\r\n\r\n      //初始化 userList 和 prepareUserList\r\n      if (!this.userName && !this.userFullname) {\r\n        return\r\n      }\r\n\r\n      if (!!this.userName !== !!this.userFullname) {\r\n        Toast('userName 和 userFullname 必须同时进行赋值')\r\n        return\r\n      }\r\n\r\n      const userNameList = this.userName.split(',')\r\n      const userFullnameList = this.userFullname.split(',')\r\n\r\n      if (userNameList.length !== userFullnameList.length) {\r\n        Toast('userName 和 userFullname 所关联的人员数量不相等')\r\n      } else {\r\n        userNameList.forEach((item, index) => {\r\n          const user = {\r\n            name: userNameList[index],\r\n            fullname: userFullnameList[index],\r\n          }\r\n\r\n          this.userList.push(user)\r\n          this.prepareUserList.push(user)\r\n        })\r\n      }\r\n    },\r\n    //打开初始弹窗\r\n    openPopup1() {\r\n      this.popupVisible1 = true\r\n    },\r\n    //打开组织结构弹窗\r\n    openPopup2() {\r\n      this.popupVisible1 = false\r\n      this.popupVisible2 = true\r\n    },\r\n    //打开人员查看弹窗\r\n    openPopup4() {\r\n      this.popupVisible3 = false\r\n      this.popupVisible4 = true\r\n    },\r\n    getTargetUserList() {\r\n      const data = {\r\n        accountStatus: 1,\r\n        pageNo: this.page,\r\n        pageSize: this.size,\r\n        orgNo: this.orgNo,\r\n        searchValue: this.searchValue,\r\n      }\r\n\r\n      getUserByFullname(data)\r\n        .then((res) => {\r\n          if (!res.status) {\r\n            Toast('组织机构人员数据获取失败')\r\n            return\r\n          }\r\n\r\n          this.targetUserList = [...this.targetUserList, ...res.data.list]\r\n          this.maxPage = Math.ceil(res.data.total / this.size)\r\n\r\n          this.maxPage === 1 && (this.listFinished = true)\r\n        })\r\n        .finally(() => {\r\n          this.listLoading = false\r\n        })\r\n    },\r\n    treeClick(val) {\r\n      this.popupVisible2 = false\r\n      this.popupVisible3 = true\r\n      this.orgNo = val.content.orgNo\r\n\r\n      this.getTargetUserList()\r\n    },\r\n    //人员单选\r\n    radioCellClick(user) {\r\n      this.radioValue = user.userName\r\n\r\n      this.prepareUserList = [\r\n        {\r\n          name: user.userName,\r\n          fullname: user.userFullname,\r\n        },\r\n      ]\r\n    },\r\n    //人员多选\r\n    checkboxCellClick(user) {\r\n      this.$refs[user.userName][0].toggle() //切换对应复选框的选中状态\r\n\r\n      const result = this.prepareUserList.some((item, index) => {\r\n        if (item.name === user.userName) {\r\n          this.prepareUserList.splice(index, 1)\r\n          return true\r\n        }\r\n      })\r\n\r\n      if (!result) {\r\n        this.prepareUserList.push({\r\n          name: user.userName,\r\n          fullname: user.userFullname,\r\n        })\r\n      }\r\n    },\r\n    listLoad() {\r\n      if (!this.maxPage) {\r\n        return\r\n      }\r\n\r\n      if (this.page < this.maxPage) {\r\n        this.page += 1\r\n        this.getTargetUserList()\r\n      } else {\r\n        this.listFinished = true\r\n      }\r\n    },\r\n    popup1ModalClick() {\r\n      this.prepareUserList = [...this.userList]\r\n\r\n      if (!this.multiple) {\r\n        this.radioValue = this.userList[0] ? this.userList[0].name : ''\r\n      } else {\r\n        let list = []\r\n\r\n        this.userList.forEach((user) => {\r\n          list.push(user.name)\r\n        })\r\n\r\n        this.checkboxValue = list\r\n      }\r\n    },\r\n    popup2ModalClick() {\r\n      this.popupVisible1 = true\r\n    },\r\n    popup3ModalClick() {\r\n      if (this.p1ToP3) {\r\n        this.p1ToP3 = false\r\n        this.popupVisible1 = true\r\n      } else {\r\n        this.popupVisible2 = true\r\n      }\r\n    },\r\n    popup4ModalClick() {\r\n      this.popupVisible3 = true\r\n    },\r\n    popup3Closed() {\r\n      if (this.popupVisible4) {\r\n        return\r\n      }\r\n\r\n      this.page = 1\r\n      this.maxPage = null\r\n      this.orgNo = null\r\n      this.searchValue = ''\r\n      this.targetUserList = []\r\n\r\n      this.listFinished = false\r\n    },\r\n    //选人确定\r\n    confirm() {\r\n      //同步数据\r\n      this.userList = [...this.prepareUserList]\r\n\r\n      this.uploadProp()\r\n\r\n      this.popupVisible3 = false\r\n    },\r\n    //删除已选人员\r\n    deleteSelectedUser(user) {\r\n      if (!this.multiple) {\r\n        //单选\r\n        this.userList = []\r\n        this.prepareUserList = []\r\n        this.radioValue = ''\r\n      } else {\r\n        //多选\r\n        this.userList.some((item, index) => {\r\n          if (item.name === user.name) {\r\n            this.userList.splice(index, 1)\r\n            return true\r\n          }\r\n        })\r\n\r\n        this.prepareUserList.some((item, index) => {\r\n          if (item.name === user.name) {\r\n            this.prepareUserList.splice(index, 1)\r\n            return true\r\n          }\r\n        })\r\n\r\n        this.checkboxValue.some((item, index) => {\r\n          if (item === user.name) {\r\n            this.checkboxValue.splice(index, 1)\r\n            return true\r\n          }\r\n        })\r\n      }\r\n\r\n      this.uploadProp()\r\n    },\r\n    //初始弹框 - 搜索人员\r\n    searchUser1() {\r\n      this.p1ToP3 = true\r\n      this.popupVisible1 = false\r\n      this.popupVisible3 = true\r\n\r\n      this.getTargetUserList()\r\n    },\r\n    //人员选择弹框 - 搜索人员\r\n    searchUser2() {\r\n      this.page = 1\r\n      this.maxPage = null\r\n      this.targetUserList = []\r\n\r\n      this.listFinished = false\r\n\r\n      this.getTargetUserList()\r\n    },\r\n    //人员选择弹框 - 清空搜索\r\n    clearSearch() {\r\n      this.searchUser2()\r\n    },\r\n    deletePrepareUser(user) {\r\n      this.prepareUserList.some((item, index) => {\r\n        if (item.name === user.name) {\r\n          this.prepareUserList.splice(index, 1)\r\n          return true\r\n        }\r\n      })\r\n\r\n      this.checkboxValue.some((item, index) => {\r\n        if (item === user.name) {\r\n          this.checkboxValue.splice(index, 1)\r\n          return true\r\n        }\r\n      })\r\n    },\r\n    //更新参数\r\n    uploadProp() {\r\n      let list1 = []\r\n      let list2 = []\r\n\r\n      this.userList.forEach((user) => {\r\n        list1.push(user.name)\r\n        list2.push(user.fullname)\r\n      })\r\n\r\n      this.$emit('update:userName', list1.toString())\r\n      this.$emit('update:userFullname', list2.toString())\r\n    },\r\n  },\r\n  created() {\r\n    this.init()\r\n  },\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.select-personnel-box {\r\n  //回显\r\n  .fullname-view {\r\n    color: #333;\r\n  }\r\n\r\n  //统一的 cell title 样式\r\n  .cell-title {\r\n    display: flex;\r\n    align-items: center;\r\n\r\n    .left-box {\r\n      width: 48px;\r\n      height: 48px;\r\n      text-align: center;\r\n      line-height: 48px;\r\n      font-size: 28px;\r\n      color: #fff;\r\n      background-color: #027aff;\r\n      border-radius: 50%;\r\n    }\r\n\r\n    .name {\r\n      max-width: 500px;\r\n      margin-left: 16px;\r\n      font-size: 32px;\r\n      overflow: hidden;\r\n      text-overflow: ellipsis;\r\n      white-space: nowrap;\r\n    }\r\n  }\r\n\r\n  //初始弹框\r\n  .popup1 {\r\n    height: 80%;\r\n\r\n    .popup-center {\r\n      display: flex;\r\n      flex-direction: column;\r\n      height: 100%;\r\n\r\n      .top-box {\r\n        display: flex;\r\n        justify-content: space-between;\r\n        align-items: center;\r\n        padding: 12px 32px 0;\r\n\r\n        .search-box {\r\n          flex: 1;\r\n\r\n          .fm-search {\r\n            padding-left: 0;\r\n          }\r\n        }\r\n\r\n        & > i {\r\n          font-size: 48px;\r\n          font-weight: bold;\r\n          color: #027aff;\r\n        }\r\n      }\r\n\r\n      .user-list {\r\n        flex: 1;\r\n\r\n        i {\r\n          font-size: 48px;\r\n          font-weight: bold;\r\n          color: #ff4d4f;\r\n        }\r\n      }\r\n\r\n      .no-data {\r\n        padding: 32px;\r\n        text-align: center;\r\n        font-size: 30px;\r\n        color: #ccc;\r\n      }\r\n    }\r\n  }\r\n\r\n  //组织机构弹框\r\n  .popup2 {\r\n    height: 80%;\r\n    padding: 32px 32px 0;\r\n    box-sizing: border-box;\r\n\r\n    .popup-center {\r\n      max-height: 100%;\r\n      overflow-y: auto;\r\n      //隐藏滚动条\r\n      scrollbar-width: none; //firefox\r\n      -ms-overflow-style: none; //IE 10+\r\n\r\n      //隐藏滚动条\r\n      &::-webkit-scrollbar {\r\n        display: none; //Chrome | Safari\r\n      }\r\n    }\r\n  }\r\n\r\n  //人员选择弹框\r\n  .popup3 {\r\n    height: 80%;\r\n\r\n    .popup-center {\r\n      display: flex;\r\n      flex-direction: column;\r\n      height: 100%;\r\n\r\n      .search-box {\r\n        padding-top: 12px;\r\n      }\r\n\r\n      .fm-list {\r\n        flex: 1;\r\n        overflow-y: auto;\r\n        //隐藏滚动条\r\n        scrollbar-width: none; //firefox\r\n        -ms-overflow-style: none; //IE 10+\r\n\r\n        //隐藏滚动条\r\n        &::-webkit-scrollbar {\r\n          display: none; //Chrome | Safari\r\n        }\r\n      }\r\n\r\n      .confirm-box {\r\n        display: flex;\r\n        justify-content: space-between;\r\n        align-items: center;\r\n        padding: 32px;\r\n\r\n        & > span {\r\n          flex: 1;\r\n          margin-right: 32px;\r\n          font-size: 30px;\r\n          overflow: hidden;\r\n          text-overflow: ellipsis;\r\n          white-space: nowrap;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  //人员查看弹框\r\n  .popup4 {\r\n    height: 80%;\r\n\r\n    .popup-center {\r\n      height: 100%;\r\n      padding-top: 12px;\r\n      box-sizing: border-box;\r\n      overflow-y: auto;\r\n\r\n      i {\r\n        font-size: 48px;\r\n        font-weight: bold;\r\n        color: #ff4d4f;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>"]}]}