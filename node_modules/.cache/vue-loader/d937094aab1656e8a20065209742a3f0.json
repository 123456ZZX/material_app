{"remainingRequest":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\src\\views\\PumpStationInspection\\components\\InspectionList.vue?vue&type=script&lang=js","dependencies":[{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\src\\views\\PumpStationInspection\\components\\InspectionList.vue","mtime":1705912915816},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgeyBwYXRyb2xFZGl0IH0gZnJvbSAnLi4vYXBpJw0KZXhwb3J0IGRlZmF1bHQgew0KICBwcm9wczogew0KICAgIC8v5beh5qOA54q25oCBKDE65b6F5beh5qOA77yMMjrlt6Hmo4DkuK3vvIwzOuW3suWujOaIkCDvvIw0OuW3sue7iOatoiko5omL5py656uvKQ0KICAgIHBhdHJvbFBvaW50UmVzdWx0TGlzdDogew0KICAgICAgdHlwZTogQXJyYXksDQogICAgICBkZWZhdWx0OiAoKSA9PiBbXSwNCiAgICB9LA0KICAgIHBhdHJvbFN0YXR1czogew0KICAgICAgdHlwZTogTnVtYmVyLA0KICAgICAgZGVmYXVsdDogMCwNCiAgICB9LA0KDQogICAgZGlzYWJsZWQ6IHsNCiAgICAgIHR5cGU6IEJvb2xlYW4sDQogICAgICBkZWZhdWx0OiB0cnVlLA0KICAgIH0sDQogIH0sDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIEluc3BlY3Rpb25JdGVtVXJsOiAnL3B1bXAvaW5zcGVjdGlvbi1pdGVtJywNCiAgICAgIGluc3BlY3Rpb25Qb2ludFN0YXR1c1R5cGU6IDAsIC8vMOacquW3oe+8jDHlt7Llt6HmraPluLjvvIwy5bey5beh5byC5bi4DQogICAgICBwb3B1cFNob3c6IGZhbHNlLA0KICAgICAgTkZDSW5kZXg6IC0xLA0KICAgICAgY29sdW1uczogWyfmoIfnrb7mjZ/lnY8nLCAn5pyq6LS05qCH562+JywgJ+WFtuWugyddLA0KICAgIH0NCiAgfSwNCg0KICBhc3luYyBjcmVhdGVkKCkge30sDQoNCiAgbWV0aG9kczogew0KICAgIC8v6Lez6L2s5beh5qOA54K56aG16Z2iDQogICAgYXN5bmMgZ29Ubyh1cmwsIGluZGV4LCBpdGVtKSB7DQogICAgICBpZiAodGhpcy5kaXNhYmxlZCAmJiB0aGlzLnBhdHJvbFN0YXR1cyAhPT0gMykgcmV0dXJuDQogICAgICBpZiAoaXRlbS5uZmNDYXJkTm8gJiYgIWl0ZW0uc2lnbk1ldGhvZCkgcmV0dXJuDQoNCiAgICAgIGNvbnN0IHsgdGFza0lkIH0gPSB0aGlzLiRyb3V0ZS5xdWVyeQ0KDQogICAgICBpZiAoIWl0ZW0ucGF0cm9sSXRlbXNSZXN1bHRMaXN0KSB7DQogICAgICAgIGxldCBwYXRyb2xQb2ludFJlc3VsdExpc3QgPSB0aGlzLnBhdHJvbFBvaW50UmVzdWx0TGlzdA0KICAgICAgICBwYXRyb2xQb2ludFJlc3VsdExpc3RbaW5kZXhdLnBhdHJvbFN0YXR1cyA9ICflt7Llt6EnDQogICAgICAgIGxldCBxdWVyeSA9IHsNCiAgICAgICAgICBpZDogdGhpcy4kcm91dGUucXVlcnkudGFza0lkLA0KICAgICAgICAgIHBhdHJvbFBvaW50UmVzdWx0TGlzdCwNCiAgICAgICAgfQ0KICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBwYXRyb2xFZGl0KHF1ZXJ5KQ0KICAgICAgICB0aGlzLiRwYXJlbnQuZ2V0UGF0cm9sKCkNCg0KICAgICAgICByZXR1cm4NCiAgICAgIH0NCg0KICAgICAgdGhpcy4kcm91dGVyLnB1c2goew0KICAgICAgICBxdWVyeTogew0KICAgICAgICAgIHRhc2tJZCwNCiAgICAgICAgICBpbmRleCwNCiAgICAgICAgfSwNCiAgICAgICAgcGF0aDogdXJsLA0KICAgICAgfSkNCiAgICB9LA0KDQogICAgLy/pmpDmgqPliJfooajlsZXnpLoNCiAgICBoaWRkZW5EYW5nZXJTaG93KGl0ZW0pIHsNCiAgICAgIHRoaXMuJGVtaXQoJ2hpZGRlbkRhbmdlckNsaWNrJywgaXRlbSwgJ2l0ZW0nKQ0KICAgIH0sDQoNCiAgICAvL+W8ueWHuuWIt+WNoeeVjOmdog0KICAgIGhhbmRNb3ZlbWVudE5GQygpIHsNCiAgICAgIGNvbnNvbGUubG9nKCfmiafooYxORkMnKTsNCiAgICAgIGxldCBjb2RlID0gdW5kZWZpbmVkDQogICAgICBpZiAodHlwZW9mIHl1YW5jaHUgIT0gJ3VuZGVmaW5lZCcpIHsNCiAgICAgICAgeXVhbmNodS5uZmMubmZjU2NhbigocmVzKSA9PiB7DQogICAgICAgICAgY29kZSA9IHJlcw0KICAgICAgICB9KQ0KDQogICAgICAgIC8v5Yy56YWN5Yiw5a+55bqU55qETkZD5bm26L+b5YWl5beh5qOA6aG5DQogICAgICAgIHRoaXMucGF0cm9sUG9pbnRSZXN1bHRMaXN0Py5mb3JFYWNoKChpdGVtLCBpbmRleCkgPT4gew0KICAgICAgICAgIGlmIChpdGVtLm5mY0NhcmRObyA9PT0gY29kZSkgew0KICAgICAgICAgICAgdGhpcy5nb1RvKHRoaXMuSW5zcGVjdGlvbkl0ZW1VcmwsIGl0ZW0sIGluZGV4KQ0KICAgICAgICAgICAgdGhpcy4kdG9hc3QoJ+WMuemFjeaIkOWKnycpDQogICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHRoaXMuJHRvYXN0KCfljLnphY3lpLHotKUnKQ0KICAgICAgICAgIH0NCiAgICAgICAgfSkNCiAgICAgIH0NCiAgICB9LA0KDQogICAgLy/miYvliqhORkMt5qCH562+5o2f5Z2P44CB5pyq6LS05qCH562+44CB5YW25a6DDQogICAgc2VsZWN0Q2F1c2UoaW5kZXgpIHsNCiAgICAgIHRoaXMuTkZDSW5kZXggPSBpbmRleA0KICAgICAgdGhpcy5wb3B1cFNob3cgPSB0cnVlDQogICAgfSwNCg0KICAgIC8v5omL5YqoTkZD56Gu6K6kDQogICAgYXN5bmMgb25Db25maXJtKGUpIHsNCiAgICAgIHRyeSB7DQogICAgICAgIGxldCBwYXRyb2xQb2ludFJlc3VsdExpc3QgPSB0aGlzLnBhdHJvbFBvaW50UmVzdWx0TGlzdA0KICAgICAgICBwYXRyb2xQb2ludFJlc3VsdExpc3RbdGhpcy5ORkNJbmRleF0uc2lnbk1ldGhvZCA9IGUNCiAgICAgICAgbGV0IHF1ZXJ5ID0gew0KICAgICAgICAgIGlkOiB0aGlzLiRyb3V0ZS5xdWVyeS50YXNrSWQsDQogICAgICAgICAgcGF0cm9sUG9pbnRSZXN1bHRMaXN0LA0KICAgICAgICB9DQogICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBhdHJvbEVkaXQocXVlcnkpDQogICAgICAgIHRoaXMuJHBhcmVudC5nZXRQYXRyb2woKQ0KICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5sb2coZXJyb3IpDQogICAgICAgIHRoaXMuJHRvYXN0KCfmm7TmlrDlpLHotKUnKQ0KICAgICAgfQ0KDQogICAgICB0aGlzLnBvcHVwU2hvdyA9IGZhbHNlDQogICAgfSwNCiAgICAvL+aJi+WKqE5GQ+WPlua2iA0KICAgIG9uQ2FuY2VsKCkgew0KICAgICAgdGhpcy4kdG9hc3QoJ+WPlua2iCcpDQogICAgICB0aGlzLnBvcHVwU2hvdyA9IGZhbHNlDQogICAgfSwNCg0KICAgIC8v6I635Y+W5byC5bi45LiK5oql5bel5Y2V5pWw6YePDQogICAgZ2V0UmVwb3J0SGlkZGVuRGFuZ2VyTnVtKGluZGV4KSB7DQogICAgICBsZXQgc3VtID0gMA0KICAgICAgdGhpcy5wYXRyb2xQb2ludFJlc3VsdExpc3RbaW5kZXhdLnBhdHJvbEl0ZW1zUmVzdWx0TGlzdD8uZm9yRWFjaCgoaXRlbSkgPT4gew0KICAgICAgICBpdGVtLndvcmtPcmRlcklkID8gc3VtKysgOiBudWxsDQogICAgICB9KQ0KICAgICAgcmV0dXJuIHN1bQ0KICAgIH0sDQoNCiAgICAvL+W3oeajgOeCueWbvuagh+minOiJsg0KICAgIC8vMOacquW3oe+8jDHlt7Llt6HmraPluLjvvIwy5bey5beh5byC5bi4DQogICAgZ2V0SW5zcGVjdGlvblN0YXR1c1R5cGVDb2xvcih0eXBlKSB7DQogICAgICBzd2l0Y2ggKHR5cGUpIHsNCiAgICAgICAgY2FzZSAwOg0KICAgICAgICAgIHJldHVybiAnIzJEN0VGRicNCiAgICAgICAgY2FzZSAxOg0KICAgICAgICAgIHJldHVybiAnIzQwQkI1QScNCiAgICAgICAgY2FzZSAyOg0KICAgICAgICAgIHJldHVybiAnI0ZGMzU0NicNCiAgICAgIH0NCiAgICB9LA0KICB9LA0KfQ0K"},{"version":3,"sources":["InspectionList.vue"],"names":[],"mappings":";AA+EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"InspectionList.vue","sourceRoot":"src/views/PumpStationInspection/components","sourcesContent":["<template>\r\n  <div class=\"inspection-list\">\r\n    <div\r\n      class=\"inspection-list-item\"\r\n      v-for=\"(item, index) in patrolPointResultList\"\r\n      :key=\"item.id\"\r\n      @click=\"goTo(InspectionItemUrl, index, item)\"\r\n    >\r\n      <div\r\n        class=\"list-item-icon\"\r\n        :style=\"{\r\n          background: getInspectionStatusTypeColor(\r\n            item.patrolStatus === '未巡' ? 0 : getReportHiddenDangerNum(index) === 0 ? 1 : 2\r\n          ),\r\n        }\"\r\n      >\r\n        {{ item.patrolStatus === '未巡' ? '未巡' : '已巡' }}\r\n      </div>\r\n      <div class=\"list-item-box\">\r\n        <div class=\"item-box-title\">{{ item.patrolPointName }}</div>\r\n        <div class=\"item-box-area\">\r\n          <span>厂站：{{ item.pumpName }}</span>\r\n          <span> 区域：{{ item.areaLocation }}</span>\r\n        </div>\r\n        <div class=\"item-box-time\">\r\n          <div class=\"box-time-item\">\r\n            <img src=\"@/assets/img/pump/inspection-time.png\" class=\"box-time-img-time\" alt=\"\" />\r\n            <span class=\"box-time\" v-if=\"!item.isUnsubmitted\">\r\n              {{ item.checkTime ? item.checkTime : '未开始' }}</span\r\n            >\r\n            <span class=\"isUnsubmitted\" v-if=\"item.isUnsubmitted\">未提交</span>\r\n            <div v-if=\"item.nfcCardNo\" class=\"nfc-img\">\r\n              <img\r\n                v-if=\"!item.signMethod\"\r\n                src=\"@/assets/img/pump/inspection-nfc2.png\"\r\n                class=\"box-time-img-nfc\"\r\n                alt=\"\"\r\n                @click.stop=\"selectCause(index)\"\r\n              />\r\n              <img\r\n                v-if=\"item.signMethod === 'NFC'\"\r\n                src=\"@/assets/img/pump/inspection-nfc.png\"\r\n                class=\"box-time-img-nfc\"\r\n                alt=\"\"\r\n              />\r\n              <img\r\n                v-if=\"item.signMethod && item.signMethod !== 'NFC'\"\r\n                src=\"@/assets/img/pump/inspection-nfc1.png\"\r\n                class=\"box-time-img-nfc\"\r\n                alt=\"\"\r\n              />\r\n            </div>\r\n          </div>\r\n          <div class=\"box-time-item\" v-if=\"item.reportHiddenDangerNum > 0\">\r\n            <img\r\n              src=\"@/assets/img/pump/inspection-warning.png\"\r\n              class=\"box-time-img-warning\"\r\n              alt=\"\"\r\n              @click.stop=\"hiddenDangerShow(item)\"\r\n            />\r\n            <span style=\"color: #ff9429\">{{ getReportHiddenDangerNum(index) }}</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <fm-popup :visible.sync=\"popupShow\" position=\"bottom\" :style=\"{ height: '30%' }\">\r\n      <fm-picker\r\n        title=\"请选择未刷卡原因\"\r\n        show-toolbar\r\n        :columns=\"columns\"\r\n        @confirm=\"onConfirm\"\r\n        @cancel=\"onCancel\"\r\n      />\r\n    </fm-popup>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { patrolEdit } from '../api'\r\nexport default {\r\n  props: {\r\n    //巡检状态(1:待巡检，2:巡检中，3:已完成 ，4:已终止)(手机端)\r\n    patrolPointResultList: {\r\n      type: Array,\r\n      default: () => [],\r\n    },\r\n    patrolStatus: {\r\n      type: Number,\r\n      default: 0,\r\n    },\r\n\r\n    disabled: {\r\n      type: Boolean,\r\n      default: true,\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      InspectionItemUrl: '/pump/inspection-item',\r\n      inspectionPointStatusType: 0, //0未巡，1已巡正常，2已巡异常\r\n      popupShow: false,\r\n      NFCIndex: -1,\r\n      columns: ['标签损坏', '未贴标签', '其它'],\r\n    }\r\n  },\r\n\r\n  async created() {},\r\n\r\n  methods: {\r\n    //跳转巡检点页面\r\n    async goTo(url, index, item) {\r\n      if (this.disabled && this.patrolStatus !== 3) return\r\n      if (item.nfcCardNo && !item.signMethod) return\r\n\r\n      const { taskId } = this.$route.query\r\n\r\n      if (!item.patrolItemsResultList) {\r\n        let patrolPointResultList = this.patrolPointResultList\r\n        patrolPointResultList[index].patrolStatus = '已巡'\r\n        let query = {\r\n          id: this.$route.query.taskId,\r\n          patrolPointResultList,\r\n        }\r\n        const res = await patrolEdit(query)\r\n        this.$parent.getPatrol()\r\n\r\n        return\r\n      }\r\n\r\n      this.$router.push({\r\n        query: {\r\n          taskId,\r\n          index,\r\n        },\r\n        path: url,\r\n      })\r\n    },\r\n\r\n    //隐患列表展示\r\n    hiddenDangerShow(item) {\r\n      this.$emit('hiddenDangerClick', item, 'item')\r\n    },\r\n\r\n    //弹出刷卡界面\r\n    handMovementNFC() {\r\n      console.log('执行NFC');\r\n      let code = undefined\r\n      if (typeof yuanchu != 'undefined') {\r\n        yuanchu.nfc.nfcScan((res) => {\r\n          code = res\r\n        })\r\n\r\n        //匹配到对应的NFC并进入巡检项\r\n        this.patrolPointResultList?.forEach((item, index) => {\r\n          if (item.nfcCardNo === code) {\r\n            this.goTo(this.InspectionItemUrl, item, index)\r\n            this.$toast('匹配成功')\r\n          } else {\r\n            this.$toast('匹配失败')\r\n          }\r\n        })\r\n      }\r\n    },\r\n\r\n    //手动NFC-标签损坏、未贴标签、其它\r\n    selectCause(index) {\r\n      this.NFCIndex = index\r\n      this.popupShow = true\r\n    },\r\n\r\n    //手动NFC确认\r\n    async onConfirm(e) {\r\n      try {\r\n        let patrolPointResultList = this.patrolPointResultList\r\n        patrolPointResultList[this.NFCIndex].signMethod = e\r\n        let query = {\r\n          id: this.$route.query.taskId,\r\n          patrolPointResultList,\r\n        }\r\n        const res = await patrolEdit(query)\r\n        this.$parent.getPatrol()\r\n      } catch (error) {\r\n        console.log(error)\r\n        this.$toast('更新失败')\r\n      }\r\n\r\n      this.popupShow = false\r\n    },\r\n    //手动NFC取消\r\n    onCancel() {\r\n      this.$toast('取消')\r\n      this.popupShow = false\r\n    },\r\n\r\n    //获取异常上报工单数量\r\n    getReportHiddenDangerNum(index) {\r\n      let sum = 0\r\n      this.patrolPointResultList[index].patrolItemsResultList?.forEach((item) => {\r\n        item.workOrderId ? sum++ : null\r\n      })\r\n      return sum\r\n    },\r\n\r\n    //巡检点图标颜色\r\n    //0未巡，1已巡正常，2已巡异常\r\n    getInspectionStatusTypeColor(type) {\r\n      switch (type) {\r\n        case 0:\r\n          return '#2D7EFF'\r\n        case 1:\r\n          return '#40BB5A'\r\n        case 2:\r\n          return '#FF3546'\r\n      }\r\n    },\r\n  },\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.inspection-list {\r\n  padding: 30px;\r\n}\r\n\r\n.inspection-list-item {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 22px;\r\n\r\n  .list-item-icon {\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    flex-shrink: 0;\r\n    width: 56px;\r\n    height: 56px;\r\n    line-height: 60px;\r\n    font-size: 20px;\r\n    color: #ffffff;\r\n    background: #2d7eff;\r\n    border-radius: 50%;\r\n    margin-right: 30px;\r\n  }\r\n\r\n  .list-item-box {\r\n    width: 612px;\r\n    background: #ffffff;\r\n    box-shadow: 0px 4px 16px 0px rgba(104, 115, 127, 0.06);\r\n    border-radius: 12px;\r\n    font-size: 24px;\r\n    color: #191919;\r\n    padding: 24px 30px;\r\n\r\n    .item-box-title {\r\n      font-size: 28px;\r\n      font-weight: bold;\r\n      margin-bottom: 30px;\r\n    }\r\n\r\n    .item-box-area {\r\n      display: flex;\r\n      justify-content: space-between;\r\n      margin-bottom: 30px;\r\n\r\n      span {\r\n        flex: 1;\r\n      }\r\n    }\r\n\r\n    .item-box-time {\r\n      display: flex;\r\n      justify-content: space-between;\r\n      align-items: center;\r\n      color: #555;\r\n\r\n      .box-time-item {\r\n        display: flex;\r\n        align-items: center;\r\n\r\n        .nfc-img {\r\n          display: flex;\r\n          align-items: center;\r\n        }\r\n      }\r\n\r\n      .box-time {\r\n        margin: 0 12px;\r\n      }\r\n\r\n      .box-time-img-nfc {\r\n        width: 58px;\r\n        height: 24px;\r\n      }\r\n\r\n      .box-time-img-warning {\r\n        width: 32px;\r\n        height: 28px;\r\n        margin-right: 12px;\r\n      }\r\n    }\r\n  }\r\n\r\n  .isUnsubmitted {\r\n    color: #ff4d4f;\r\n    margin-left: 8px;\r\n  }\r\n}\r\n</style>\r\n"]}]}