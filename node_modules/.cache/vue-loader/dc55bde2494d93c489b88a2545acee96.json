{"remainingRequest":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Code\\Project\\WL\\xasw-mobile\\src\\components\\qrcode\\index.vue?vue&type=style&index=0&id=4b91aea1&lang=css","dependencies":[{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\src\\components\\qrcode\\index.vue","mtime":1705912799957},{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQoucXJjb2RlLWNvbnRhaW5lciB7DQogIHBhZGRpbmctdG9wOiAwLjJyZW07DQogIHBhZGRpbmctcmlnaHQ6IDAuMnJlbTsNCiAgcGFkZGluZy1sZWZ0OiAwLjJyZW07DQogIGJhY2tncm91bmQtY29sb3I6ICNmZmY7DQp9DQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AAoJA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/qrcode","sourcesContent":["<!--\r\n * @Author: wei_sc2\r\n * @Date: 2022-02-22 10:57:35\r\n * @LastEditTime: 2022-02-25 10:10:49\r\n * @LastEditors: xie_sm\r\n * @Description: 封装二维码组件\r\n * @FilePath: \\mobile-template\\src\\components\\qrcode\\index.vue\r\n-->\r\n<template>\r\n  <div class=\"qrcode-container\">\r\n    <canvas\r\n      :style=\"{\r\n        height: `${size}px`,\r\n        width: `${size}px`,\r\n      }\"\r\n      :height=\"size\"\r\n      :width=\"size\"\r\n      v-show=\"type === 'canvas'\"\r\n      ref=\"canvas\"\r\n    ></canvas>\r\n    <img\r\n      :src=\"imgData\"\r\n      v-if=\"type === 'img'\"\r\n      :style=\"{\r\n        height: `${size}px`,\r\n        width: `${size}px`,\r\n      }\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport QRCodeImpl from \"qr.js/lib/QRCode\";\r\nimport ErrorCorrectLevel from \"qr.js/lib/ErrorCorrectLevel\";\r\nexport default {\r\n  name: \"QRCode\",\r\n  props: {\r\n    value: String,\r\n    size: {\r\n      type: Number,\r\n      default: 160,\r\n    },\r\n    level: {\r\n      type: String,\r\n      default: \"L\",\r\n    },\r\n    bgColor: {\r\n      type: String,\r\n      default: \"#FFFFFF\",\r\n    },\r\n    fgColor: {\r\n      type: String,\r\n      default: \"#000000\",\r\n    },\r\n    type: {\r\n      type: String,\r\n      default: \"img\",\r\n    },\r\n  },\r\n  mounted() {\r\n    this.$nextTick(() => {\r\n      this.render();\r\n    });\r\n  },\r\n  data() {\r\n    return {\r\n      imgData: \"\",\r\n    };\r\n  },\r\n  watch: {\r\n    value() {\r\n      this.render();\r\n    },\r\n    size() {\r\n      this.render();\r\n    },\r\n    level() {\r\n      this.render();\r\n    },\r\n    bgColor() {\r\n      this.render();\r\n    },\r\n    fgColor() {\r\n      this.render();\r\n    },\r\n  },\r\n  methods: {\r\n    render() {\r\n      if (typeof this.value === \"undefined\") {\r\n        return;\r\n      }\r\n      const qrcode = new QRCodeImpl(-1, ErrorCorrectLevel[this.level]);\r\n      qrcode.addData(utf16to8(this.value));\r\n      qrcode.make();\r\n      const canvas = this.$refs.canvas;\r\n      const ctx = canvas.getContext(\"2d\");\r\n      const cells = qrcode.modules;\r\n      const tileW = this.size / cells.length;\r\n      const tileH = this.size / cells.length;\r\n      const scale = (window.devicePixelRatio || 1) / getBackingStorePixelRatio(ctx);\r\n      canvas.height = canvas.width = this.size * scale;\r\n      ctx.scale(scale, scale);\r\n      cells.forEach((row, rdx) => {\r\n        row.forEach((cell, cdx) => {\r\n          ctx.fillStyle = cell ? this.fgColor : this.bgColor;\r\n          const w = Math.ceil((cdx + 1) * tileW) - Math.floor(cdx * tileW);\r\n          const h = Math.ceil((rdx + 1) * tileH) - Math.floor(rdx * tileH);\r\n          ctx.fillRect(Math.round(cdx * tileW), Math.round(rdx * tileH), w, h);\r\n        });\r\n      });\r\n      if (this.type === \"img\") {\r\n        this.imgData = canvas.toDataURL(\"image/png\");\r\n      }\r\n    },\r\n  },\r\n};\r\nfunction getBackingStorePixelRatio(ctx) {\r\n  return (\r\n    ctx.webkitBackingStorePixelRatio ||\r\n    ctx.mozBackingStorePixelRatio ||\r\n    ctx.msBackingStorePixelRatio ||\r\n    ctx.oBackingStorePixelRatio ||\r\n    ctx.backingStorePixelRatio ||\r\n    1\r\n  );\r\n}\r\nfunction utf16to8(str) {\r\n  let out, i, len, c;\r\n  out = \"\";\r\n  len = str.length;\r\n  for (i = 0; i < len; i++) {\r\n    c = str.charCodeAt(i);\r\n    if (c >= 0x0001 && c <= 0x007f) {\r\n      out += str.charAt(i);\r\n    } else if (c > 0x07ff) {\r\n      out += String.fromCharCode(0xe0 | ((c >> 12) & 0x0f));\r\n      out += String.fromCharCode(0x80 | ((c >> 6) & 0x3f));\r\n      out += String.fromCharCode(0x80 | ((c >> 0) & 0x3f));\r\n    } else {\r\n      out += String.fromCharCode(0xc0 | ((c >> 6) & 0x1f));\r\n      out += String.fromCharCode(0x80 | ((c >> 0) & 0x3f));\r\n    }\r\n  }\r\n  return out;\r\n}\r\n</script>\r\n\r\n<style>\r\n.qrcode-container {\r\n  padding-top: 0.2rem;\r\n  padding-right: 0.2rem;\r\n  padding-left: 0.2rem;\r\n  background-color: #fff;\r\n}\r\n</style>\r\n"]}]}