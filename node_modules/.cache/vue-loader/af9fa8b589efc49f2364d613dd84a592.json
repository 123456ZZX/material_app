{"remainingRequest":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\src\\components\\qrcode\\index.vue?vue&type=script&lang=js","dependencies":[{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\src\\components\\qrcode\\index.vue","mtime":1705912799957},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgUVJDb2RlSW1wbCBmcm9tICJxci5qcy9saWIvUVJDb2RlIjsNCmltcG9ydCBFcnJvckNvcnJlY3RMZXZlbCBmcm9tICJxci5qcy9saWIvRXJyb3JDb3JyZWN0TGV2ZWwiOw0KZXhwb3J0IGRlZmF1bHQgew0KICBuYW1lOiAiUVJDb2RlIiwNCiAgcHJvcHM6IHsNCiAgICB2YWx1ZTogU3RyaW5nLA0KICAgIHNpemU6IHsNCiAgICAgIHR5cGU6IE51bWJlciwNCiAgICAgIGRlZmF1bHQ6IDE2MCwNCiAgICB9LA0KICAgIGxldmVsOiB7DQogICAgICB0eXBlOiBTdHJpbmcsDQogICAgICBkZWZhdWx0OiAiTCIsDQogICAgfSwNCiAgICBiZ0NvbG9yOiB7DQogICAgICB0eXBlOiBTdHJpbmcsDQogICAgICBkZWZhdWx0OiAiI0ZGRkZGRiIsDQogICAgfSwNCiAgICBmZ0NvbG9yOiB7DQogICAgICB0eXBlOiBTdHJpbmcsDQogICAgICBkZWZhdWx0OiAiIzAwMDAwMCIsDQogICAgfSwNCiAgICB0eXBlOiB7DQogICAgICB0eXBlOiBTdHJpbmcsDQogICAgICBkZWZhdWx0OiAiaW1nIiwNCiAgICB9LA0KICB9LA0KICBtb3VudGVkKCkgew0KICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsNCiAgICAgIHRoaXMucmVuZGVyKCk7DQogICAgfSk7DQogIH0sDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIGltZ0RhdGE6ICIiLA0KICAgIH07DQogIH0sDQogIHdhdGNoOiB7DQogICAgdmFsdWUoKSB7DQogICAgICB0aGlzLnJlbmRlcigpOw0KICAgIH0sDQogICAgc2l6ZSgpIHsNCiAgICAgIHRoaXMucmVuZGVyKCk7DQogICAgfSwNCiAgICBsZXZlbCgpIHsNCiAgICAgIHRoaXMucmVuZGVyKCk7DQogICAgfSwNCiAgICBiZ0NvbG9yKCkgew0KICAgICAgdGhpcy5yZW5kZXIoKTsNCiAgICB9LA0KICAgIGZnQ29sb3IoKSB7DQogICAgICB0aGlzLnJlbmRlcigpOw0KICAgIH0sDQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICByZW5kZXIoKSB7DQogICAgICBpZiAodHlwZW9mIHRoaXMudmFsdWUgPT09ICJ1bmRlZmluZWQiKSB7DQogICAgICAgIHJldHVybjsNCiAgICAgIH0NCiAgICAgIGNvbnN0IHFyY29kZSA9IG5ldyBRUkNvZGVJbXBsKC0xLCBFcnJvckNvcnJlY3RMZXZlbFt0aGlzLmxldmVsXSk7DQogICAgICBxcmNvZGUuYWRkRGF0YSh1dGYxNnRvOCh0aGlzLnZhbHVlKSk7DQogICAgICBxcmNvZGUubWFrZSgpOw0KICAgICAgY29uc3QgY2FudmFzID0gdGhpcy4kcmVmcy5jYW52YXM7DQogICAgICBjb25zdCBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgiMmQiKTsNCiAgICAgIGNvbnN0IGNlbGxzID0gcXJjb2RlLm1vZHVsZXM7DQogICAgICBjb25zdCB0aWxlVyA9IHRoaXMuc2l6ZSAvIGNlbGxzLmxlbmd0aDsNCiAgICAgIGNvbnN0IHRpbGVIID0gdGhpcy5zaXplIC8gY2VsbHMubGVuZ3RoOw0KICAgICAgY29uc3Qgc2NhbGUgPSAod2luZG93LmRldmljZVBpeGVsUmF0aW8gfHwgMSkgLyBnZXRCYWNraW5nU3RvcmVQaXhlbFJhdGlvKGN0eCk7DQogICAgICBjYW52YXMuaGVpZ2h0ID0gY2FudmFzLndpZHRoID0gdGhpcy5zaXplICogc2NhbGU7DQogICAgICBjdHguc2NhbGUoc2NhbGUsIHNjYWxlKTsNCiAgICAgIGNlbGxzLmZvckVhY2goKHJvdywgcmR4KSA9PiB7DQogICAgICAgIHJvdy5mb3JFYWNoKChjZWxsLCBjZHgpID0+IHsNCiAgICAgICAgICBjdHguZmlsbFN0eWxlID0gY2VsbCA/IHRoaXMuZmdDb2xvciA6IHRoaXMuYmdDb2xvcjsNCiAgICAgICAgICBjb25zdCB3ID0gTWF0aC5jZWlsKChjZHggKyAxKSAqIHRpbGVXKSAtIE1hdGguZmxvb3IoY2R4ICogdGlsZVcpOw0KICAgICAgICAgIGNvbnN0IGggPSBNYXRoLmNlaWwoKHJkeCArIDEpICogdGlsZUgpIC0gTWF0aC5mbG9vcihyZHggKiB0aWxlSCk7DQogICAgICAgICAgY3R4LmZpbGxSZWN0KE1hdGgucm91bmQoY2R4ICogdGlsZVcpLCBNYXRoLnJvdW5kKHJkeCAqIHRpbGVIKSwgdywgaCk7DQogICAgICAgIH0pOw0KICAgICAgfSk7DQogICAgICBpZiAodGhpcy50eXBlID09PSAiaW1nIikgew0KICAgICAgICB0aGlzLmltZ0RhdGEgPSBjYW52YXMudG9EYXRhVVJMKCJpbWFnZS9wbmciKTsNCiAgICAgIH0NCiAgICB9LA0KICB9LA0KfTsNCmZ1bmN0aW9uIGdldEJhY2tpbmdTdG9yZVBpeGVsUmF0aW8oY3R4KSB7DQogIHJldHVybiAoDQogICAgY3R4LndlYmtpdEJhY2tpbmdTdG9yZVBpeGVsUmF0aW8gfHwNCiAgICBjdHgubW96QmFja2luZ1N0b3JlUGl4ZWxSYXRpbyB8fA0KICAgIGN0eC5tc0JhY2tpbmdTdG9yZVBpeGVsUmF0aW8gfHwNCiAgICBjdHgub0JhY2tpbmdTdG9yZVBpeGVsUmF0aW8gfHwNCiAgICBjdHguYmFja2luZ1N0b3JlUGl4ZWxSYXRpbyB8fA0KICAgIDENCiAgKTsNCn0NCmZ1bmN0aW9uIHV0ZjE2dG84KHN0cikgew0KICBsZXQgb3V0LCBpLCBsZW4sIGM7DQogIG91dCA9ICIiOw0KICBsZW4gPSBzdHIubGVuZ3RoOw0KICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpKyspIHsNCiAgICBjID0gc3RyLmNoYXJDb2RlQXQoaSk7DQogICAgaWYgKGMgPj0gMHgwMDAxICYmIGMgPD0gMHgwMDdmKSB7DQogICAgICBvdXQgKz0gc3RyLmNoYXJBdChpKTsNCiAgICB9IGVsc2UgaWYgKGMgPiAweDA3ZmYpIHsNCiAgICAgIG91dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKDB4ZTAgfCAoKGMgPj4gMTIpICYgMHgwZikpOw0KICAgICAgb3V0ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoMHg4MCB8ICgoYyA+PiA2KSAmIDB4M2YpKTsNCiAgICAgIG91dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKDB4ODAgfCAoKGMgPj4gMCkgJiAweDNmKSk7DQogICAgfSBlbHNlIHsNCiAgICAgIG91dCArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKDB4YzAgfCAoKGMgPj4gNikgJiAweDFmKSk7DQogICAgICBvdXQgKz0gU3RyaW5nLmZyb21DaGFyQ29kZSgweDgwIHwgKChjID4+IDApICYgMHgzZikpOw0KICAgIH0NCiAgfQ0KICByZXR1cm4gb3V0Ow0KfQ0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AAgCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/qrcode","sourcesContent":["<!--\r\n * @Author: wei_sc2\r\n * @Date: 2022-02-22 10:57:35\r\n * @LastEditTime: 2022-02-25 10:10:49\r\n * @LastEditors: xie_sm\r\n * @Description: 封装二维码组件\r\n * @FilePath: \\mobile-template\\src\\components\\qrcode\\index.vue\r\n-->\r\n<template>\r\n  <div class=\"qrcode-container\">\r\n    <canvas\r\n      :style=\"{\r\n        height: `${size}px`,\r\n        width: `${size}px`,\r\n      }\"\r\n      :height=\"size\"\r\n      :width=\"size\"\r\n      v-show=\"type === 'canvas'\"\r\n      ref=\"canvas\"\r\n    ></canvas>\r\n    <img\r\n      :src=\"imgData\"\r\n      v-if=\"type === 'img'\"\r\n      :style=\"{\r\n        height: `${size}px`,\r\n        width: `${size}px`,\r\n      }\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport QRCodeImpl from \"qr.js/lib/QRCode\";\r\nimport ErrorCorrectLevel from \"qr.js/lib/ErrorCorrectLevel\";\r\nexport default {\r\n  name: \"QRCode\",\r\n  props: {\r\n    value: String,\r\n    size: {\r\n      type: Number,\r\n      default: 160,\r\n    },\r\n    level: {\r\n      type: String,\r\n      default: \"L\",\r\n    },\r\n    bgColor: {\r\n      type: String,\r\n      default: \"#FFFFFF\",\r\n    },\r\n    fgColor: {\r\n      type: String,\r\n      default: \"#000000\",\r\n    },\r\n    type: {\r\n      type: String,\r\n      default: \"img\",\r\n    },\r\n  },\r\n  mounted() {\r\n    this.$nextTick(() => {\r\n      this.render();\r\n    });\r\n  },\r\n  data() {\r\n    return {\r\n      imgData: \"\",\r\n    };\r\n  },\r\n  watch: {\r\n    value() {\r\n      this.render();\r\n    },\r\n    size() {\r\n      this.render();\r\n    },\r\n    level() {\r\n      this.render();\r\n    },\r\n    bgColor() {\r\n      this.render();\r\n    },\r\n    fgColor() {\r\n      this.render();\r\n    },\r\n  },\r\n  methods: {\r\n    render() {\r\n      if (typeof this.value === \"undefined\") {\r\n        return;\r\n      }\r\n      const qrcode = new QRCodeImpl(-1, ErrorCorrectLevel[this.level]);\r\n      qrcode.addData(utf16to8(this.value));\r\n      qrcode.make();\r\n      const canvas = this.$refs.canvas;\r\n      const ctx = canvas.getContext(\"2d\");\r\n      const cells = qrcode.modules;\r\n      const tileW = this.size / cells.length;\r\n      const tileH = this.size / cells.length;\r\n      const scale = (window.devicePixelRatio || 1) / getBackingStorePixelRatio(ctx);\r\n      canvas.height = canvas.width = this.size * scale;\r\n      ctx.scale(scale, scale);\r\n      cells.forEach((row, rdx) => {\r\n        row.forEach((cell, cdx) => {\r\n          ctx.fillStyle = cell ? this.fgColor : this.bgColor;\r\n          const w = Math.ceil((cdx + 1) * tileW) - Math.floor(cdx * tileW);\r\n          const h = Math.ceil((rdx + 1) * tileH) - Math.floor(rdx * tileH);\r\n          ctx.fillRect(Math.round(cdx * tileW), Math.round(rdx * tileH), w, h);\r\n        });\r\n      });\r\n      if (this.type === \"img\") {\r\n        this.imgData = canvas.toDataURL(\"image/png\");\r\n      }\r\n    },\r\n  },\r\n};\r\nfunction getBackingStorePixelRatio(ctx) {\r\n  return (\r\n    ctx.webkitBackingStorePixelRatio ||\r\n    ctx.mozBackingStorePixelRatio ||\r\n    ctx.msBackingStorePixelRatio ||\r\n    ctx.oBackingStorePixelRatio ||\r\n    ctx.backingStorePixelRatio ||\r\n    1\r\n  );\r\n}\r\nfunction utf16to8(str) {\r\n  let out, i, len, c;\r\n  out = \"\";\r\n  len = str.length;\r\n  for (i = 0; i < len; i++) {\r\n    c = str.charCodeAt(i);\r\n    if (c >= 0x0001 && c <= 0x007f) {\r\n      out += str.charAt(i);\r\n    } else if (c > 0x07ff) {\r\n      out += String.fromCharCode(0xe0 | ((c >> 12) & 0x0f));\r\n      out += String.fromCharCode(0x80 | ((c >> 6) & 0x3f));\r\n      out += String.fromCharCode(0x80 | ((c >> 0) & 0x3f));\r\n    } else {\r\n      out += String.fromCharCode(0xc0 | ((c >> 6) & 0x1f));\r\n      out += String.fromCharCode(0x80 | ((c >> 0) & 0x3f));\r\n    }\r\n  }\r\n  return out;\r\n}\r\n</script>\r\n\r\n<style>\r\n.qrcode-container {\r\n  padding-top: 0.2rem;\r\n  padding-right: 0.2rem;\r\n  padding-left: 0.2rem;\r\n  background-color: #fff;\r\n}\r\n</style>\r\n"]}]}