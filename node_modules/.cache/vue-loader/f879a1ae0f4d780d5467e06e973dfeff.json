{"remainingRequest":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\src\\views\\FlawsManagement\\index.vue?vue&type=style&index=0&id=c558fb5a&lang=scss&scoped=true","dependencies":[{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\src\\views\\FlawsManagement\\index.vue","mtime":1708928163374},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQoubWFpbiB7DQogICAgd2lkdGg6IDc1MHB4Ow0KICAgIC8vIGhlaWdodDogMTMzNHB4Ow0KICAgIGhlaWdodDogMTAwJTsNCiAgICBiYWNrZ3JvdW5kOiAjRjRGN0ZDOw0KDQogICAgLy8gLm1hcC1jb250YWluZXIgew0KICAgIC8vICAgICB3aWR0aDogNzUwcHg7DQogICAgLy8gICAgIGhlaWdodDogNjgwcHg7DQoNCiAgICAvLyAgICAgLm1hcGJveGdsLWN0cmwtYm90dG9tLWxlZnQgew0KICAgIC8vICAgICAgICAgZGlzcGxheTogbm9uZSAhaW1wb3J0YW50Ow0KICAgIC8vICAgICB9DQoNCiAgICAvLyAgICAgLm1hcGJveGdsLWN0cmwgYS5tYXBib3hnbC1jdHJsLWxvZ28gew0KICAgIC8vICAgICAgICAgZGlzcGxheTogbm9uZSAhaW1wb3J0YW50Ow0KICAgIC8vICAgICB9DQoNCiAgICAvLyAgICAgLm1hcGJveGdsLWN0cmwtYm90dG9tLWxlZnQgZGl2IHsNCiAgICAvLyAgICAgICAgIGRpc3BsYXk6IG5vbmUgIWltcG9ydGFudDsNCiAgICAvLyAgICAgfQ0KICAgIC8vIH0NCiAgICAubWFwQ29udGFpbmVyIHsNCiAgICAgICAgaGVpZ2h0OiA3NTBweDsNCiAgICAgICAgd2lkdGg6IDEwMCU7DQoNCiAgICB9DQoNCiAgICAuZmxhd3MtbGlzdC1jb250YWluZXIgew0KICAgICAgICBoZWlnaHQ6IDcwMHB4Ow0KICAgICAgICBvdmVyZmxvdzogc2Nyb2xsOw0KDQogICAgICAgIC50YWJsZUxpc3Qgew0KICAgICAgICAgICAgcGFkZGluZy1ib3R0b206IDEwcHg7DQogICAgICAgICAgICAvLyBwb3NpdGlvbjogZml4ZWQ7DQogICAgICAgICAgICBib3R0b206IDBweDsNCiAgICAgICAgICAgIHdpZHRoOiA3NTBweDsNCiAgICAgICAgICAgIGhlaWdodDogYXV0bzsNCiAgICAgICAgICAgIG92ZXJmbG93OiBzY3JvbGw7DQogICAgICAgICAgICBtYXgtaGVpZ2h0OiA1ODBweDsNCiAgICAgICAgICAgIGJhY2tncm91bmQ6ICNmNGY3ZmM7DQogICAgICAgICAgICBib3gtc2hhZG93OiAwcHggLTRweCAxMnB4IDBweCByZ2JhKDEwNCwgMTE1LCAxMjcsIDAuMSk7DQoNCiAgICAgICAgICAgIC5jb24tZGl2IHsNCiAgICAgICAgICAgICAgICBtYXJnaW4tdG9wOiAyMHB4Ow0KICAgICAgICAgICAgICAgIHdpZHRoOiA2OTBweDsNCiAgICAgICAgICAgICAgICBtYXJnaW4tbGVmdDogMzBweDsNCiAgICAgICAgICAgICAgICBoZWlnaHQ6IDI3MHB4Ow0KICAgICAgICAgICAgICAgIGJhY2tncm91bmQ6ICNmZmZmZmY7DQogICAgICAgICAgICAgICAgYm94LXNoYWRvdzogMHB4IDRweCAxNnB4IDBweCByZ2JhKDEwNCwgMTE1LCAxMjcsIDAuMDgpOw0KICAgICAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDE2cHg7DQoNCiAgICAgICAgICAgICAgICAudG9wIHsNCiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDEwMCU7DQogICAgICAgICAgICAgICAgICAgIGhlaWdodDogODBweDsNCiAgICAgICAgICAgICAgICAgICAgbGluZS1oZWlnaHQ6IDgwcHg7DQogICAgICAgICAgICAgICAgICAgIG92ZXJmbG93OiBhdXRvOw0KDQogICAgICAgICAgICAgICAgICAgIC8vIGRpc3BsYXk6IGlubGluZTsNCiAgICAgICAgICAgICAgICAgICAgLm5hbWUgew0KICAgICAgICAgICAgICAgICAgICAgICAgbWFyZ2luLWxlZnQ6IDIwcHg7DQogICAgICAgICAgICAgICAgICAgICAgICBmbG9hdDogbGVmdDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiBhdXRvOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9udC1zaXplOiAzNnB4Ow0KICAgICAgICAgICAgICAgICAgICAgICAgZm9udC1mYW1pbHk6IFBpbmdGYW5nU0MtU2VtaWJvbGQsIFBpbmdGYW5nIFNDOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDYwMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiAjMTkxOTE5Ow0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgLmltZyB7DQogICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogMzBweDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogMzlweDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZsb2F0OiByaWdodDsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1hcmdpbi1yaWdodDogMjBweDsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1hcmdpbi10b3A6IDE1cHg7DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAuc3RhdGUgew0KICAgICAgICAgICAgICAgICAgICAgICAgZmxvYXQ6IGxlZnQ7DQogICAgICAgICAgICAgICAgICAgICAgICBtYXJnaW4tbGVmdDogMjBweDsNCiAgICAgICAgICAgICAgICAgICAgICAgIG1hcmdpbi10b3A6IDIwcHg7DQogICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogYXV0bzsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmctbGVmdDogMTBweDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHBhZGRpbmctcmlnaHQ6IDEwcHg7DQogICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IDQycHg7DQogICAgICAgICAgICAgICAgICAgICAgICBsaW5lLWhlaWdodDogNDJweDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDRweDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIC5jMSB7DQogICAgICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDY0LCAxODcsIDkwLCAwLjEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9udC1zaXplOiAyNHB4Ow0KICAgICAgICAgICAgICAgICAgICAgICAgZm9udC1mYW1pbHk6IFBpbmdGYW5nU0MtUmVndWxhciwgUGluZ0ZhbmcgU0M7DQogICAgICAgICAgICAgICAgICAgICAgICBmb250LXdlaWdodDogNDAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6ICM0MGJiNWE7DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAuYzIgew0KICAgICAgICAgICAgICAgICAgICAgICAgZm9udC1zaXplOiAyNHB4Ow0KICAgICAgICAgICAgICAgICAgICAgICAgZm9udC1mYW1pbHk6IFBpbmdGYW5nU0MtUmVndWxhciwgUGluZ0ZhbmcgU0M7DQogICAgICAgICAgICAgICAgICAgICAgICBmb250LXdlaWdodDogNDAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6ICMwMjdhZmY7DQogICAgICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kOiByZ2JhKDIsIDEyMiwgMjU1LCAwLjEpOw0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgLmMzIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAxNDgsIDQxLCAwLjEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9udC1zaXplOiAyNHB4Ow0KICAgICAgICAgICAgICAgICAgICAgICAgZm9udC1mYW1pbHk6IFBpbmdGYW5nU0MtUmVndWxhciwgUGluZ0ZhbmcgU0M7DQogICAgICAgICAgICAgICAgICAgICAgICBmb250LXdlaWdodDogNDAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6ICNmZjk0Mjk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAuY29udGVudCB7DQogICAgICAgICAgICAgICAgICAgIHdoaXRlLXNwYWNlOiBub3dyYXA7DQogICAgICAgICAgICAgICAgICAgIG92ZXJmbG93OiBoaWRkZW47DQogICAgICAgICAgICAgICAgICAgIHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzOw0KICAgICAgICAgICAgICAgICAgICB3aWR0aDogOTYlOw0KICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IDYwcHg7DQogICAgICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMjhweDsNCiAgICAgICAgICAgICAgICAgICAgZm9udC1mYW1pbHk6IFBpbmdGYW5nU0MtUmVndWxhciwgUGluZ0ZhbmcgU0M7DQogICAgICAgICAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA0MDA7DQogICAgICAgICAgICAgICAgICAgIGNvbG9yOiAjNTU1NTU1Ow0KICAgICAgICAgICAgICAgICAgICBsaW5lLWhlaWdodDogNjBweDsNCiAgICAgICAgICAgICAgICAgICAgcGFkZGluZy1sZWZ0OiAyMHB4Ow0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIC51bmRlciB7DQogICAgICAgICAgICAgICAgICAgIHdpZHRoOiA5NyU7DQogICAgICAgICAgICAgICAgICAgIG1hcmdpbi1sZWZ0OiAtMTdweDsNCiAgICAgICAgICAgICAgICAgICAgZGlzcGxheTogZmxleDsNCiAgICAgICAgICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1hcm91bmQ7DQogICAgICAgICAgICAgICAgICAgIGhlaWdodDogNzBweDsNCiAgICAgICAgICAgICAgICAgICAgbGluZS1oZWlnaHQ6IDcwcHg7DQogICAgICAgICAgICAgICAgICAgIGZvbnQtc2l6ZTogMjhweDsNCiAgICAgICAgICAgICAgICAgICAgZm9udC1mYW1pbHk6IFBpbmdGYW5nU0MtUmVndWxhciwgUGluZ0ZhbmcgU0M7DQogICAgICAgICAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA0MDA7DQogICAgICAgICAgICAgICAgICAgIGNvbG9yOiAjNTU1NTU1Ow0KDQogICAgICAgICAgICAgICAgICAgIC51bmRlci1kaXYgew0KICAgICAgICAgICAgICAgICAgICAgICAgbWFyZ2luLWxlZnQ6IDMwcHg7DQogICAgICAgICAgICAgICAgICAgICAgICBmbG9hdDogbGVmdDsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC5hZGQtY29udGFpbmVyIHsNCiAgICAgICAgLmJpZ0Zvcm0tY29udGFpbmVyIHsNCiAgICAgICAgICAgIHdpZHRoOiA3NTBweDsNCiAgICAgICAgICAgIGhlaWdodDogMTIzNHB4Ow0KICAgICAgICAgICAgb3ZlcmZsb3c6IHNjcm9sbDsNCiAgICAgICAgICAgIGJhY2tncm91bmQ6ICNGRkZGRkY7DQoNCiAgICAgICAgICAgIC5zdWJ0YWJsZSB7DQogICAgICAgICAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlOw0KICAgICAgICAgICAgICAgIG1hcmdpbjogMTBweDsNCiAgICAgICAgICAgICAgICBwYWRkaW5nOiAxM3B4Ow0KICAgICAgICAgICAgICAgIC8vIGJhY2tncm91bmQtY29sb3I6IGFxdWFtYXJpbmU7DQogICAgICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogMTZweDsNCiAgICAgICAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCAjNTE5NWQwOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgIH0NCg0KICAgIH0NCg0KICAgIC5kZXRhaWwtY29udGFpbmVyIHsNCiAgICAgICAgd2lkdGg6IDc1MHB4Ow0KICAgICAgICBoZWlnaHQ6IDEyOTBweDsNCg0KICAgICAgICAuZm9ybUZyYW1lIHsNCiAgICAgICAgICAgIHdpZHRoOiA3NTBweDsNCiAgICAgICAgICAgIGhlaWdodDogMTMwMHB4Ow0KICAgICAgICAgICAgbWFyZ2luLXRvcDogLTY1cHg7DQoNCiAgICAgICAgICAgIC5vdXR3b3JrLWRldGFpbCB7DQogICAgICAgICAgICAgICAgLm91dHdvcmstZGV0YWlsLXRpdGxlYmFyIC53YmdjLWNhcmQge30NCg0KICAgICAgICAgICAgICAgIC5vdXR3b3JrLWRldGFpbC1ib3ggew0KICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IDEwMCU7DQogICAgICAgICAgICAgICAgICAgIHdpZHRoOiAxMDAlICFpbXBvcnRhbnQ7DQogICAgICAgICAgICAgICAgICAgIG92ZXJmbG93OiBhdXRvOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCn0NCg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AA83BA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/FlawsManagement","sourcesContent":["<template>\r\n    <div class=\"main\">\r\n        <fm-nav-bar title=\"缺陷管理\" left-arrow @click-left=\"$router.go(-1)\" @click-right=\"clickPlus\">\r\n            <template #right>\r\n                <i class=\"fm-icon fm-icon-plus\"></i>\r\n            </template>\r\n        </fm-nav-bar>\r\n        <div class=\"mapContainer\">\r\n            <xa-map :create=\"mapLoaded\"></xa-map>\r\n        </div>\r\n\r\n        <!-- <div v-if=\"!isAdd && !isDetail\" class=\"flaws-list-container\">\r\n            <div class=\"tableList\">\r\n                <div class=\"con-div\" v-for=\"(item, index) in tableList\" :key=\"index\">\r\n                    <div class=\"top\">\r\n                        <div class=\"name\">\r\n                            {{ item.deviceName.length > 0 ? getZHCN(item.deviceName[0]) : '' }}\r\n                            {{ item.deviceName.length > 1 ? getZHCN(item.deviceName) : '' }}\r\n                        </div>\r\n                        <div :class=\"item.state == '已完成' ? 'state c1' : item.state == '处理中' ? 'state c2' : 'state c3'\">\r\n                            {{ item.state }}</div>\r\n                        <img class=\"img\" src=\"./img/gps.png\" @click=\"toTarget(item.lnglat)\" />\r\n                    </div>\r\n                    <div @click=\"enterDetail(item.id)\">\r\n                        <div class=\"content\">\r\n                            缺陷类型 {{ getZHCN(item.flawsName) }}\r\n                        </div>\r\n                        <div class=\"content\">\r\n                            现场情况 {{ item.content }}\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div class=\"under\">\r\n                        <div class=\"under-div\"><i class=\"fm-icon fm-icon-contact\"></i>{{ item.people }}</div>\r\n                        <div class=\"under-div\"><i class=\"fm-icon fm-icon-down\"></i>\r\n                            {{ getZHCN(item.flawsFrom) }}</div>\r\n                        <div class=\"under-div\"><i class=\"fm-icon fm-icon-underway-o\"></i>{{ item.time }}</div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div> -->\r\n        <listFlaws :tableList=\"tableList\" @toTarget=\"toTarget\"></listFlaws>\r\n\r\n        <!-- <div v-show=\"isAdd && !isDetail\" class=\"add-container\">\r\n            <fm-nav-bar title=\"缺陷新增\" left-arrow @click-left=\"isAdd = false;\">\r\n            </fm-nav-bar>\r\n            <fm-form class=\"bigForm-container\" @submit=\"onSubmit\" @failed=\"onFailed\">\r\n                <fm-field readonly clickable required name=\"picker\" :value=\"commonForm.defectFrom\" label=\"缺陷来源\"\r\n                    placeholder=\"缺陷来源\" suffix-icon=\"arrow\" @click=\"choosePicker('缺陷来源')\"\r\n                    :rules=\"[{ required: true, message: '请填写缺陷来源' }]\" input-align=\"right\" />\r\n                <fm-field readonly clickable required name=\"picker\" :value=\"commonForm.bigType\" label=\"业务类型\"\r\n                    placeholder=\"业务类型\" suffix-icon=\"arrow\" @click=\"choosePicker('业务类型')\"\r\n                    :rules=\"[{ required: true, message: '请填写业务类型' }]\" input-align=\"right\" />\r\n                <fm-field readonly clickable required name=\"picker\" :value=\"commonForm.smallType\" label=\"设施类型\"\r\n                    placeholder=\"设施类型\" suffix-icon=\"arrow\" @click=\"choosePicker('设施类型')\"\r\n                    :rules=\"[{ required: true, message: '请填写设施类型' }]\" input-align=\"right\" />\r\n\r\n                <fm-popup :visible.sync=\"showPicker\" position=\"bottom\">\r\n                    <fm-picker show-toolbar :columns=\"columns\" @confirm=\"onConfirm\" @cancel=\"showPicker = false\" />\r\n                </fm-popup>\r\n\r\n                <fm-field clearable v-model=\"commonForm.smallCode\" name=\"input\" label=\"设施编号\" placeholder=\"设施编号\"\r\n                    input-align=\"right\" />\r\n                <fm-field v-model=\"commonForm.position\" name=\"input\" label=\"缺陷位置\" placeholder=\"缺陷位置\"\r\n                    input-align=\"right\" />\r\n                <div class=\"subtable\" v-for=\"(item, index) in subForms\" :key=\"item.id\">\r\n                    <img src=\"./img/link.png\" alt=\"\" style=\"position: absolute;height: 34px;z-index: 2;top: -18px\">\r\n                    <img src=\"./img/link.png\" alt=\"\"\r\n                        style=\"position: absolute;height: 34px;z-index: 2;float: right;right: 5px; top: -18px\">\r\n                    <fm-form>\r\n                        <fm-field v-model=\"item.defectType\" readonly clickable name=\"picker\" label=\"缺陷类型\"\r\n                            suffix-icon=\"arrow\" placeholder=\"缺陷类型\" @click=\"showPickerDefect = true\" input-align=\"right\">\r\n                        </fm-field>\r\n                        <fm-popup :visible.sync=\"showPickerDefect\" position=\"bottom\">\r\n                            <fm-picker show-toolbar :columns=\"defectTypeList\"\r\n                                @confirm=\"(val) => { item.defectType = val; showPickerDefect = false }\"\r\n                                @cancel=\"showPickerDefect = false\" />\r\n                        </fm-popup>\r\n\r\n                        <fm-field v-model=\"item.note\" name=\"input\" label=\"备注\" placeholder=\"备注\" input-align=\"right\">\r\n                        </fm-field>\r\n                        <uploader :wpgHeader=\"wpgHeader\" label=\"照片\" v-model=\"picUp\" ref=\"picUp\"\r\n                            @fileChange=\"(recall) => fileChange(recall, '', item.pic)\" style=\"width: 100%;\">\r\n                        </uploader>\r\n                    </fm-form>\r\n                </div>\r\n                <fm-button native-type=\"button\" type=\"default\" icon=\"plus\" size=\"large\" @click=\"addRow\"\r\n                    style=\"margin-left: 8px;width:96%\">新增缺陷\r\n                </fm-button>\r\n                <fm-field v-model=\"commonForm.describe\" name=\"input\" label=\"现场描述\" placeholder=\"现场描述\" type=\"textarea\"\r\n                    rows=\"2\" autosize maxlength=\"200\" show-word-limit input-align=\"right\" />\r\n\r\n                <uploader :wpgHeader=\"wpgHeader\" label=\"多媒体附件\" v-model=\"attachment\" ref=\"attachment\"\r\n                    @fileChange=\"(recall) => fileChange(recall, '公共')\" style=\"width: 100%;\">\r\n                </uploader>\r\n\r\n\r\n                <fm-field readonly v-model=\"upPerson\" name=\"input\" label=\"上报人\" placeholder=\"上报人\" input-align=\"right\" />\r\n                <fm-field readonly v-model=\"upTime\" name=\"input\" label=\"上报时间\" placeholder=\"上报时间\" input-align=\"right\" />\r\n                <div style=\"margin-top:10px;display:flex;justify-content: space-around;\">\r\n                    <fm-button type=\"default\" @click=\"concle\" native-type=\"button\">取消</fm-button>\r\n                    <fm-button type=\"primary\" :disabled=\"subForms.length < 1\" native-type=\"submit\">提交</fm-button>\r\n                </div>\r\n            </fm-form>\r\n        </div> -->\r\n        <!-- <div v-if=\"isDetail \" class=\"detail-container\">\r\n            <fm-nav-bar title=\"缺陷详情\" left-arrow @click-left=\"isDetail = false\"></fm-nav-bar>\r\n            <iframe id=\"form_frame\" class=\"formFrame\" name=\"form_frame\" :src=\"formURL\" />\r\n        </div> -->\r\n    </div>\r\n</template>\r\n<script>\r\nimport listFlaws from './listFlaws'\r\nimport { addIconToMap } from '@/utils/mapUtils'\r\nimport { ENUM } from '@/store/State/stateTypes'\r\nimport mapboxgl from \"mapbox-gl\";\r\nimport \"mapbox-gl/dist/mapbox-gl.css\";\r\nimport mapStyle from './mapStyle';\r\nimport { Toast } from 'fawkes-mobile-lib';\r\nimport Uploader from './upload/Uploader';\r\nimport fileUpload from '@/components/fileUpload/index.vue';\r\nimport axios from 'axios'\r\nimport popup from './popup'\r\nimport Vue from 'vue'\r\nvar myInterval\r\nconst popupItem = Vue.extend(popup)\r\nconst MapObj = {\r\n    map: null,\r\n    //   viewer: null,\r\n    //   popupItem: '', // mapbox气泡框\r\n    //   marker: '',\r\n    //   monitorPopups: [],\r\n    //   monitorPopupContent: [],\r\n    //   eventPopupArray: [],// 事件点popup集合\r\n}\r\nexport default {\r\n    name: \"flawsManagement\",\r\n    components: { Uploader, fileUpload, listFlaws },\r\n    // components: {Uploader},\r\n    data() {\r\n        return {\r\n            // 列表相关\r\n            tableData: [],\r\n            total: 0,\r\n            tableList: [],\r\n            objInfo: {},// 地图点选的信息\r\n            chosePoint: false,//点选，弹popup\r\n            // wpg接口与页面显隐\r\n            wpgHeader: {},//上传相关\r\n            accessToken: this.$storage.get('access_token'),\r\n            formToken: '',//详情页URL所需token\r\n            formURL: '',//详情页URL\r\n            icons: [\r\n                {\r\n                    name: '事件点',\r\n                    url: require('@/assets/img/map/dw.png'),\r\n                },\r\n            ],\r\n        };\r\n    },\r\n    computed: {\r\n        defectFromDic() {\r\n            console.log('this.$store.state[ENUM].defectFrom: ', this.$store.state[ENUM].defectFrom);\r\n            return this.$store.state[ENUM].defectFrom;\r\n\r\n        },\r\n        faultTypesDic() {\r\n            console.log('this.$store.state[ENUM].faultTypes: ', this.$store.state[ENUM].faultTypes);\r\n            return this.$store.state[ENUM].faultTypes;\r\n        },\r\n        // 系统字典虽叫defectType，但实际二级为 业务类型/设施类型\r\n        // 业务类型/设施类型\r\n        busDeviceTypeDic() {\r\n            console.log('this.$store.state[ENUM].defectType: ', this.$store.state[ENUM].defectType);\r\n            return this.$store.state[ENUM].defectType;\r\n\r\n        },\r\n        // getZHCN() {\r\n        //     return (val) => {\r\n        //         try {\r\n        //             let result = val\r\n        //             // 翻译二级字典 业务类型/设施类型中  二级字段---设施类型\r\n        //             if (val instanceof Array) {\r\n        //                 if (this.busDeviceTypeDic.length > 0) {\r\n        //                     this.busDeviceTypeDic.forEach(element => {\r\n        //                         if (val[0] == element.code || val[0] == element['zh-CN']) {\r\n        //                             element.child.forEach(second => {\r\n        //                                 result = val[1]\r\n        //                                 if (val[1] == second.code || val[1] == second['zh-CN']) {\r\n        //                                     result = second['zh-CN']\r\n        //                                 }\r\n        //                             })\r\n        //                         }\r\n        //                     });\r\n        //                 }\r\n        //             } else {\r\n        //                 if (this.faultTypesDic.length > 0) {\r\n        //                     this.faultTypesDic.forEach((dic) => {\r\n        //                         if (val == dic.code || val == dic['zh-CN']) {\r\n        //                             result = dic['zh-CN']\r\n        //                         }\r\n        //                     })\r\n        //                 }\r\n        //                 if (this.defectFromDic.length > 0) {\r\n        //                     this.defectFromDic.forEach((dic) => {\r\n        //                         if (val == dic.code || val == dic['zh-CN']) {\r\n        //                             result = dic['zh-CN']\r\n        //                         }\r\n        //                     })\r\n        //                 }\r\n        //                 if (this.busDeviceTypeDic.length > 0) {\r\n        //                     this.busDeviceTypeDic.forEach((dic) => {\r\n        //                         if (val == dic.code || val == dic['ch-CN']) {\r\n        //                             result = dic['zh-CN']\r\n        //                         }\r\n        //                     })\r\n        //                 }\r\n        //             }\r\n        //             return result\r\n        //         } catch (error) {\r\n        //             console.log('error: ', error);\r\n        //         }\r\n        //     }\r\n        // }\r\n    },\r\n    mounted() {\r\n        // this.initMap()\r\n        this.getwpgHeader() //  获取header，提交工单用; 同时获取 tableData\r\n    },\r\n    beforeDestroy() {\r\n\r\n    },\r\n    methods: {\r\n\r\n        // 表单接口相关---获取 tableData、提交工单\r\n        // 获取header，提交工单用; 同时获取 tableData\r\n        async getwpgHeader() {\r\n            axios({\r\n                url: process.env.VUE_APP_THIRD_REQUEST_URL + '/main/userCenterApi/sso/tokenByToken',\r\n                method: 'post',\r\n                params: {\r\n                    token: this.accessToken\r\n                },\r\n                headers: {\r\n                    'Authorization': 'Basic b3V0d29yazp3cGcyMDIw'\r\n                }\r\n            }).then(res => {\r\n                console.log('wpgHeader6666-res: ', res);\r\n                if (res.status == 200) {\r\n                    this.formToken = res.data.resultData.token\r\n                    this.wpgHeader = {\r\n                        \"Authorization\": \"Bearer \" + this.formToken\r\n                    }\r\n                    console.log(' this.wpgHeader : ', this.wpgHeader);\r\n                    this.getTableData()\r\n                }\r\n            })\r\n        },\r\n        // 列表相关\r\n        async getTableData() {\r\n            // 获取 tableData\r\n            let params = {\r\n                \"sysCode\": \"outwork\",\r\n                \"smallType\": \"defect\",\r\n                \"page\": {\r\n                    \"current\": 1,\r\n                    \"size\": 50,//-1查全部\r\n                }\r\n            }\r\n            axios({\r\n                url: process.env.VUE_APP_THIRD_REQUEST_URL + '/main/outworkapi/ticketStatisticClient/getTicketList',\r\n                method: 'post',\r\n                data: params,\r\n                headers: this.wpgHeader,\r\n            }).then(res => {\r\n                console.log('getTableData-res: ', res);\r\n                if (res.status == 200) {\r\n                    this.tableData = res.data.resultData.records\r\n                    this.getGeoJson()\r\n                    this.total = res.data.resultData.total;\r\n                    console.log('this.tableData: ', this.tableData);\r\n                    this.tableData.forEach((td) => {\r\n                        let item = {\r\n                            id: td.id,\r\n                            deviceName: td.formValue.deviceType || td.formValue.device_type || [],\r\n                            // flawsName: td.formValue.faultTypes,\r\n                            flawsName: td.formValue.detail?.defectType || td.formValue.faultTypes || '',\r\n                            state: td.ticketStatusName,\r\n                            content: td.formValue.questionDescribe,\r\n                            people: td.createByName,\r\n                            time: td.createTime.slice(0, 10),\r\n                            flawsFrom: td.formValue.defectFrom,\r\n                            lnglat: [td.formValue.deviceDetail?.longitude, td.formValue.deviceDetail?.latitude] || [td.appealLng, td.appealLat],\r\n                        }\r\n                        this.tableList.push(item)\r\n\r\n                    })\r\n                    this.$emit('tableList', this.tableList)\r\n                    console.log('this.tableList: ', this.tableList);\r\n                }\r\n            })\r\n        },\r\n        // 将事件列表添加至地图\r\n        getGeoJson() {\r\n            let features = []\r\n            let withoutPositionCount = 0\r\n            console.log('要聚合展示的tableData', this.tableData)\r\n            if (this.tableData.length == 0) {\r\n                this.removeSomeLayer()\r\n                return\r\n            }\r\n            this.tableData.forEach((item) => {\r\n                let feature = {}\r\n                let properties = {}\r\n                let geometry = {}\r\n\r\n                properties = item\r\n                properties.defectFrom = item.formValue.defectFrom\r\n                feature.properties = properties\r\n                feature.type = 'Feature'\r\n                geometry.type = 'Point'\r\n                if (item.appealLat && item.appealLng) {\r\n                    // geometry.coordinates = [item.appealLat, item.appealLon]\r\n                    geometry.coordinates = [item.appealLng, item.appealLat] // wgs84\r\n                    feature.geometry = geometry\r\n                    features.push(feature)\r\n                } else if (\r\n                    item.formValue.deviceDetail?.latitude &&\r\n                    item.formValue.deviceDetail?.longitude\r\n                ) {\r\n                    geometry.coordinates = [\r\n                        item.formValue.deviceDetail.longitude,\r\n                        item.formValue.deviceDetail.latitude,\r\n                    ]\r\n                    feature.geometry = geometry\r\n                    features.push(feature)\r\n                } else if (\r\n                    item.formValue.ticketAddress?.longitude &&\r\n                    item.formValue.ticketAddress?.latitude\r\n                ) {\r\n                    geometry.coordinates = [\r\n                        item.formValue.ticketAddress.longitude,\r\n                        item.formValue.ticketAddress.latitude,\r\n                    ]\r\n                    feature.geometry = geometry\r\n                    features.push(feature)\r\n                } else {\r\n                    // geometry.coordinates = [39.06683064435245, 115.9453947097063]\r\n                    withoutPositionCount += 1\r\n                }\r\n            })\r\n            console.log('无坐标个数', withoutPositionCount)\r\n            // 聚合数据 构造头部\r\n            let geoJson = {\r\n                type: 'FeatureCollection',\r\n                crs: { type: 'name', properties: { name: 'urn:ogc:def:crs:OGC:1.3:CRS84' } },\r\n                features: [],\r\n            }\r\n            geoJson.features = features\r\n            console.log('聚合的geoJson', geoJson)\r\n            this.renderCluster(geoJson)\r\n        },\r\n        removeSomeLayer() {\r\n            ['clusters', 'cluster-count', 'unclustered-point'].forEach((item) => {\r\n                if (MapObj.map?.getLayer(item)) {\r\n                    MapObj.map.removeLayer(item)\r\n                }\r\n            })\r\n            if (MapObj.map?.getSource('earthquakes')) {\r\n                MapObj.map.removeSource('earthquakes')\r\n            }\r\n        },\r\n        // 渲染\r\n        renderCluster(geoJsonSource) {\r\n            this.removeSomeLayer()\r\n            MapObj.map.addSource('earthquakes', {\r\n                type: 'geojson',\r\n                data: geoJsonSource,\r\n                cluster: true,\r\n                clusterMaxZoom: 14, // Max zoom to cluster points on\r\n                clusterRadius: 50, // Radius of each cluster when clustering points (defaults to 50)\r\n            })\r\n\r\n            MapObj.map.addLayer({\r\n                id: 'clusters',\r\n                type: 'circle',\r\n                source: 'earthquakes',\r\n                filter: ['has', 'point_count'],\r\n                paint: {\r\n                    'circle-color': ['step', ['get', 'point_count'], \"rgba(0, 209, 134, 0.8)\", 5, \"rgba(255, 148, 41, 0.8)\", 15, \"rgba(255, 74, 65, 0.8)\"],\r\n                    'circle-radius': ['step', ['get', 'point_count'], 20, 5, 25, 15, 30],\r\n                    // 这个是外边框的颜色 circle-stroke-color这个对应了上面circle-color\r\n                    \"circle-stroke-color\": [\r\n                        \"step\",\r\n                        [\"get\", \"point_count\"],\r\n                        \"rgba(0, 209, 134, 0.3)\",\r\n                        5,\r\n                        \"rgba(255, 148, 41, 0.3)\",\r\n                        15,\r\n                        \"rgba(255, 74, 65, 0.3)\"\r\n                    ],\r\n                    // 这个是外边框晕染的范围\r\n                    \"circle-stroke-width\": [\r\n                        \"step\",\r\n                        [\"get\", \"point_count\"],\r\n                        8, //蓝色晕染长度，当点数小于100时为5px晕染\r\n                        5, //对应上面circle-color 数字，意思为100以内\r\n                        12, //点计数在100到750之间时为黄色，6px晕染\r\n                        15, //对应上面circle-color 数字，意思为750以内\r\n                        15 //点计数大于或等于750时为7px像素的粉红色晕染\r\n                    ]\r\n                },\r\n            })\r\n\r\n            MapObj.map.addLayer({\r\n                id: 'cluster-count',\r\n                type: 'symbol',\r\n                source: 'earthquakes',\r\n                filter: ['has', 'point_count'],\r\n                layout: {\r\n                    'text-field': '{point_count_abbreviated}',\r\n                    // 'text-font': ['DIN Offc Pro Medium', 'Arial Unicode MS Bold'],\r\n                    'text-size': 12,\r\n                },\r\n            })\r\n\r\n            MapObj.map.addLayer({\r\n                id: 'unclustered-point',\r\n                source: 'earthquakes',\r\n                filter: ['!', ['has', 'point_count']],\r\n                type: 'symbol',\r\n                layout: {\r\n                    'icon-image': '事件点', // 点的图标\r\n                    visibility: 'visible',\r\n                    'icon-size': 0.7,\r\n                },\r\n            })\r\n\r\n            let defectFromDic = this.$store.state[ENUM].defectFrom\r\n            let that = this\r\n            MapObj.map.on('click', 'unclustered-point', (e) => {\r\n                // 如果当前事件点所有popup为打开状态，即事件点popup数组长度不为0，退出该次点击事件\r\n                // if (MapObj.eventPopupArray.length > 0) return\r\n                // 每次点击新的事件点就清除预案数据\r\n                // this.fileList = []\r\n                console.log('e.features: ', e.features)\r\n                // console.log('formValue: ', JSON.parse(e.features[0].properties.formValue))\r\n                MapObj.map.getCanvas().style.cursor = 'pointer'\r\n\r\n                let formValue = JSON.parse(e.features[0].properties.formValue)\r\n                console.log('formValue: ', formValue)\r\n\r\n                var coordinates = e.features[0].geometry.coordinates.slice()\r\n                while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {\r\n                    coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360\r\n                }\r\n                // Create a popup, but don't add it to the map yet.\r\n                this.popup1 = new mapboxgl.Popup({\r\n                    closeOnClick: true,\r\n                    closeButton: false,\r\n                    anchor: 'bottom',\r\n                    offset: { bottom: [0, -15] },\r\n                })\r\n                let text = formValue.detail ? formValue.detail.defectType : '其他'\r\n                console.log('text: ', text);\r\n                this.popup1\r\n                    .setLngLat(coordinates)\r\n                    .setHTML('<div id=\"vue-popup-custom\" class=\"vue-popup-custom\"><h3>'\r\n                        + text\r\n                        + '</h3></div>')\r\n                    .addTo(MapObj.map)\r\n            })\r\n\r\n            // inspect a cluster on click\r\n            MapObj.map.on('click', 'clusters', function (e) {\r\n                var features = MapObj.map.queryRenderedFeatures(e.point, { layers: ['clusters'] })\r\n                var clusterId = features[0].properties.cluster_id\r\n                MapObj.map\r\n                    .getSource('earthquakes')\r\n                    .getClusterExpansionZoom(clusterId, function (err, zoom) {\r\n                        if (err) return\r\n                        MapObj.map.easeTo({\r\n                            center: features[0].geometry.coordinates,\r\n                            zoom: zoom,\r\n                        })\r\n                    })\r\n            })\r\n            MapObj.map.setMinZoom(0)\r\n            MapObj.map.setMaxZoom(30)\r\n        },\r\n\r\n        // 地图相关\r\n        toTarget(lnglat) {\r\n            if (lnglat.length == 2) {\r\n                MapObj.map.flyTo({\r\n                    center: lnglat,\r\n                    zoom: 19,\r\n                })\r\n            } else {\r\n                console.log(\"无位置信息\")\r\n            }\r\n        },\r\n        // 开始点选\r\n        clickPlus() {\r\n            this.objInfo = {}\r\n            Toast({\r\n                message: '地图点选',\r\n                position: 'top',\r\n            });\r\n            this.chosePoint = true\r\n        },\r\n        // 点选要素回填信息\r\n        enterAdd() {\r\n            // this.isAdd = true//进入表单页\r\n            console.log(\"选点后进入表单页时的this.objInfo:\", this.objInfo)\r\n            // // 回填信息\r\n            // this.commonForm.bigType = this.objInfo.bigType || ''\r\n            // this.commonForm.smallType = this.objInfo.smallType || ''\r\n            // this.commonForm.smallCode = this.objInfo.code || ''\r\n            // this.commonForm.position = this.objInfo.road_name || [this.objInfo.lng.toFixed(3), this.objInfo.lat.toFixed(3)].toString()\r\n            // // 提交表单用的，不回填显示\r\n            // this.commonForm.lng = this.objInfo.lng\r\n            // this.commonForm.lat = this.objInfo.lat\r\n            // this.commonForm.properties = this.objInfo.properties\r\n            this.$router.push({\r\n                name: 'addFlaws',\r\n                query: { msg: this.objInfo, token: this.formToken },\r\n                params: { type: 'add' },\r\n            })\r\n        },\r\n        // initMap() {\r\n        //     mapboxgl.accessToken = \"pk.eyJ1IjoiOTM0MDk0Mjg2IiwiYSI6ImNsMnNmdmVrZDBrZGMzZG50cHJudXJkbW8ifQ.C0wKhJgrToFJgL8GH5M8rg\";\r\n        //     window.xaMap = new mapboxgl.Map({\r\n        //         container: 'mapContainer',// 容器DOM id\r\n        //         style: mapStyle,\r\n        //         center: [115.92486101369428, 39.06075549589073],\r\n        //         zoom: 13,\r\n        //         minZoom: 10,\r\n        //         pitch: 0,\r\n        //     });\r\n        //     // let needLayers=[]\r\n        //     // 加图层 http://172.20.79.65/api/swan/mapWorkshopSource/detail?id=1544640278559821826\r\n        //     axios.get(process.env.VUE_APP_BASE_URL + '/swan/mapWorkshopSource/detail?id=1548573412963749889').then(res => {\r\n        //         // axios.get('http://xasw.hdec.com/api/swan/mapWorkshopSource/detail?id=1548573412963749889').then(res => {\r\n        //         // axios.get(process.env.VUE_APP_MAP_REQUEST_URL+'/api/swan/mapWorkshopSource/detail?id=1548573412963749889').then(res => {\r\n        //         console.log('res: ', res);\r\n        //         let layers = JSON.parse(res.data.data.jsonData)\r\n        //         console.log('layers: ', layers);\r\n        //         Object.keys(layers.sources).forEach(key => {\r\n        //             window.xaMap.addSource(key, layers.sources[key])\r\n        //         })\r\n        //         // needLayers=layers.layers\r\n        //         layers.layers.forEach(layer => {\r\n        //             // console.log('77777777777777777777777', layer);\r\n        //             window.xaMap.addLayer(layer);\r\n        //             window.xaMap.setLayoutProperty(layer.id, 'visibility', 'visible')\r\n        //             // window.xaMap.on(\"click\", layer.id, this.handleMonitorClick);\r\n        //             // window.xaMap.on(\"mouseenter\", layer.id, this.handleMonitorEnter);\r\n        //             // window.xaMap.on(\"mouseout\", layer.id, this.handleMonitorLeave);\r\n        //         })\r\n        //     }).catch(e => { }).finally(() => { });\r\n        //     // 监听地图点击\r\n        //     // window.xaMap.on(\"click\", function(e)  {})\r\n        //     // window.xaMap.on(\"click\", layer.id,function(e)  {})//才能选到features???,就拿到过一次\r\n\r\n        //     window.xaMap.on(\"click\", (e) => {\r\n        //         // 若为functio(e){ this是this.window.xaMap}\r\n        //         // (e)=>{ this是this}\r\n        //         console.log(\"map-click-e\", e)\r\n        //         console.log(\"e.lngLatn\", e.lngLat)\r\n        //         var bbox = [\r\n        //             [e.point.x - 1, e.point.y - 1],\r\n        //             [e.point.x + 1, e.point.y + 1]\r\n        //         ];\r\n        //         console.log(\"bbox:\", bbox)\r\n        //         // mapbox 返回查询要素的图层属性\r\n        //         let queryfeatures = window.xaMap.queryRenderedFeatures(bbox, {\r\n        //             layers: [\"rd_map_drainpipe_ys_big\", \"rd_map_drainpipe_ys_small\", \"rd_map_drainpipe_ws_small\", \"rd_map_drainpipe_ws_big\",\r\n        //                 \"rd_map_outfall\", \"rd_map_gate\", \"rd_map_manhole\", \"rd_map_comb\",\r\n        //                 \"map_supply_firehydrant\", \"map_supply_valve\",\r\n        //                 \"map_supply_pipe_distribute\", \"map_supply_pipe_delivery\", \"map_supply_pipe_circulating\",\r\n        //                 \"map_supply_node_distribute\", \"map_supply_node_delivery\", \"map_supply_node_circulating\",\r\n        //                 \"map_recycle_pipe\", \"map_recycle_node\", \"map_waterwork\"]\r\n        //             // layers: layers\r\n        //         });\r\n        //         console.log(\"点选(微矩形)查询到的queryfeatures:\", queryfeatures)\r\n        //         // console.log(\"点选(微矩形)查询的queryfeatures:\", queryfeatures.properties)\r\n        //         // this.hightLight(queryfeatures)// 高亮表格记录，并高亮地图要素\r\n        //         this.objInfo = {}//先置空再赋值\r\n        //         // 点击位置的经纬度\r\n        //         this.objInfo.lng = e.lngLat.lng\r\n        //         this.objInfo.lat = e.lngLat.lat\r\n        //         if (queryfeatures.length > 0) {\r\n        //             // queryfeatures.forEach(f => {\r\n        //             let f = queryfeatures[0]\r\n        //             console.log('ffff: ', f);\r\n        //             // 点击要素的经纬度，有的话覆盖掉点击位置经纬度\r\n        //             this.objInfo.lng = f.properties.longitude || this.objInfo.lng\r\n        //             this.objInfo.lat = f.properties.latitude || this.objInfo.lat\r\n        //             // 要素所在图层ID和属性信息\r\n        //             this.objInfo.layerID = f.layer.id\r\n        //             this.objInfo.layerType = f.layer.type\r\n        //             this.objInfo.properties = f.properties\r\n        //             // 底图要素name_local或设施要素road_name,id\r\n        //             this.objInfo.name_local = f.properties.name_local\r\n        //             this.objInfo.road_name = f.properties.road_name\r\n        //             this.objInfo.id = f.properties.id\r\n        //             // 要素对象类型（业务类型/设施类型）\r\n        //             objInfo.bigType = ''\r\n        //             objInfo.smallType = ''\r\n        //             switch (f.layer.id) {\r\n        //                 // 雨水\r\n        //                 case \"rd_map_comb\"://comb一定是雨水口\r\n        //                     objInfo.bigType = '雨水'\r\n        //                     objInfo.smallType = '雨水口'\r\n        //                     break\r\n        //                 case \"rd_map_outfall\"://排放口 1-雨水； 2-污水； 3-合流； 4-其他\r\n        //                     objInfo.bigType = f.properties.pipe_type\r\n        //                     objInfo.smallType = '排放口'\r\n        //                     break\r\n        //                 case \"rd_map_manhole\"://检查井  1-雨水；2-污水\r\n        //                     objInfo.bigType = f.properties.manhole_type\r\n        //                     objInfo.smallType = f.properties.manhole_type == \"雨水\" ? '雨水检查井' : '污水检查井'\r\n        //                     break\r\n        //                 case \"rd_map_gate\"://闸门 1-雨水； 2-污水； 3-合流； 4-其他\r\n        //                     objInfo.bigType = f.properties.pipe_type\r\n        //                     // objInfo.smallType = '闸门'\r\n        //                     objInfo.smallType = f.properties.pipe_type == \"雨水\" ? '其他（雨）' : '其他（污）'\r\n        //                     break\r\n        //                 case \"rd_map_drainpipe_ys_big\":\r\n        //                     objInfo.bigType = '雨水'\r\n        //                     objInfo.smallType = '雨水管渠'\r\n        //                     break\r\n        //                 case \"rd_map_drainpipe_ys_small\":\r\n        //                     objInfo.bigType = '雨水'\r\n        //                     objInfo.smallType = '雨水管渠'\r\n        //                     break\r\n        //                 // 污水\r\n        //                 case \"rd_map_drainpipe_ws_big\":\r\n        //                     objInfo.bigType = '污水'\r\n        //                     objInfo.smallType = '污水管道'\r\n        //                     break\r\n        //                 case \"rd_map_drainpipe_ws_small\":\r\n        //                     objInfo.bigType = '污水'\r\n        //                     objInfo.smallType = '污水管道'\r\n        //                     break\r\n        //                 // 供水\r\n        //                 case \"map_supply_firehydrant\"://消火栓一定是供水\r\n        //                     objInfo.bigType = '供水'\r\n        //                     objInfo.smallType = '消防栓'\r\n        //                     break\r\n        //                 case \"map_supply_valve\"://阀门valve一定是供水\r\n        //                     objInfo.bigType = '供水'\r\n        //                     objInfo.smallType = '阀门'\r\n        //                     break\r\n        //                 case \"map_supply_pipe_distribute\"://配水管线\r\n        //                     objInfo.bigType = '供水'\r\n        //                     objInfo.smallType = '供水管道'\r\n        //                     break\r\n        //                 case \"map_supply_pipe_delivery\"://输水管线\r\n        //                     objInfo.bigType = 'supply'\r\n        //                     objInfo.smallType = '供水管道'\r\n        //                     break\r\n        //                 case \"map_supply_pipe_circulating\"://回水管线\r\n        //                     objInfo.bigType = '供水'\r\n        //                     objInfo.smallType = '供水管道'\r\n        //                     break\r\n        //                 // case \"map_supply_node_distribute\":\r\n        //                 //     objInfo.bigType = '供水'\r\n        //                 //     objInfo.smallType = \r\n        //                 //     break\r\n        //                 case \"map_supply_node_delivery\":\r\n        //                     objInfo.bigType = '供水'\r\n        //                     objInfo.smallType = f.properties.appurtenance == \"消防井\" ? \"消防栓\" : f.properties.appurtenance == \"排气阀\" ? \"阀门\" : '其他（供）'\r\n        //                     break\r\n        //                 // case \"map_supply_node_circulating\": \r\n        //                 //     objInfo.bigType = '供水'\r\n        //                 //     objInfo.smallType = \r\n        //                 //     break\r\n        //                 case \"map_waterwork\"://供水厂\r\n        //                     objInfo.bigType = '供水'\r\n        //                     objInfo.smallType = '其他（供）'\r\n        //                     break\r\n        //                 // 再生水\r\n        //                 case \"map_recycle_pipe\"://再生水管线\r\n        //                     objInfo.bigType = '再生水'\r\n        //                     objInfo.smallType = '再生水管道'\r\n        //                     break\r\n        //                 case \"map_waterwork\"://再生水厂\r\n        //                     objInfo.bigType = '再生水'\r\n        //                     objInfo.smallType = '其他（再）'\r\n        //                     break\r\n        //             }\r\n        //             // 设施编号\r\n        //             objInfo.code = f.properties.start_code && f.properties.end_code ? (f.properties.start_code + ',' + f.properties.end_code) : ''\r\n        //                 || f.properties.manhole_code || f.properties.gate_code || f.properties.outlet_code\r\n        //                 || f.properties.comb_code || f.properties.valve_code || f.properties.pump_station_code\r\n        //                 || f.properties.plant_code || f.properties.pump_code || f.properties.fire_cock_code\r\n        //                 || f.properties.point_code || ''\r\n        //             // })\r\n        //         }\r\n        //         console.log('this.objInfo: ', this.objInfo);\r\n        //         // popup\r\n        //         if (this.chosePoint) {\r\n        //             // let popupHtml = \"<div style='width:140px;height:30px;background-color:#08AEE9'><h3>\" + e.lngLat.lng.toFixed(3) + ',' + e.lngLat.lat.toFixed(3) + \"</h3><h3>\"+this.objInfo.smallType+' '+this.objInfo.code+\"</h3><br><fm-button  @click='clickPlus'>确定</fm-button>\" + \"</div>\"\r\n        //             let popupHtml = '<div id=\"base-add\"></div>'\r\n        //             new mapboxgl.Popup()\r\n        //                 .setLngLat([e.lngLat.lng, e.lngLat.lat])\r\n        //                 .setHTML(popupHtml)\r\n        //                 .addTo(window.xaMap);\r\n        //             new popupItem({\r\n        //                 propsData: {\r\n        //                     detailId: 99999,\r\n        //                     lng: e.lngLat.lng.toFixed(3),\r\n        //                     lat: e.lngLat.lat.toFixed(3),\r\n        //                     bigType: this.objInfo.bigType,\r\n        //                     smallType: this.objInfo.smallType,\r\n        //                     deviceCode: this.objInfo.code,\r\n        //                     fun: this.enterAdd\r\n        //                 }\r\n        //             }).$mount('#base-add')\r\n        //         }\r\n        //     })\r\n        //     // window.xaMap.on('click',e=>{})结束\r\n        // },\r\n        async mapLoaded() {\r\n            MapObj.map = window.xaMap\r\n            await addIconToMap(MapObj.map, this.icons)\r\n            MapObj.map.on(\"click\", (e) => {\r\n                // 若为functio(e){ this是this.MapObj.map}\r\n                // (e)=>{ this是this}\r\n                console.log(\"map-click-e\", e)\r\n                console.log(\"e.lngLatn\", e.lngLat)\r\n                var bbox = [\r\n                    [e.point.x - 1, e.point.y - 1],\r\n                    [e.point.x + 1, e.point.y + 1]\r\n                ];\r\n                console.log(\"bbox:\", bbox)\r\n                // mapbox 返回查询要素的图层属性\r\n                let queryfeatures = MapObj.map.queryRenderedFeatures(bbox, {\r\n                    layers: [\"rd_map_drainpipe_ys_big\", \"rd_map_drainpipe_ys_small\", \"rd_map_drainpipe_ws_small\", \"rd_map_drainpipe_ws_big\",\r\n                        \"rd_map_outfall\", \"rd_map_gate\", \"rd_map_manhole\", \"rd_map_comb\",\r\n                        \"map_supply_firehydrant\", \"map_supply_valve\",\r\n                        \"map_supply_pipe_distribute\", \"map_supply_pipe_delivery\", \"map_supply_pipe_circulating\",\r\n                        \"map_supply_node_distribute\", \"map_supply_node_delivery\", \"map_supply_node_circulating\",\r\n                        \"map_recycle_pipe\", \"map_recycle_node\", \"map_waterwork\"]\r\n                    // layers: layers\r\n                });\r\n                console.log(\"点选(微矩形)查询到的queryfeatures:\", queryfeatures)\r\n                // console.log(\"点选(微矩形)查询的queryfeatures:\", queryfeatures.properties)\r\n                // this.hightLight(queryfeatures)// 高亮表格记录，并高亮地图要素\r\n                this.objInfo = {}//先置空再赋值\r\n                // 点击位置的经纬度\r\n                this.objInfo.lng = e.lngLat.lng\r\n                this.objInfo.lat = e.lngLat.lat\r\n                if (queryfeatures.length > 0) {\r\n                    // queryfeatures.forEach(f => {\r\n                    let f = queryfeatures[0]\r\n                    console.log('ffff: ', f);\r\n                    // 点击要素的经纬度，有的话覆盖掉点击位置经纬度\r\n                    // this.objInfo.lng = f.properties.longitude || this.objInfo.lng\r\n                    // this.objInfo.lat = f.properties.latitude || this.objInfo.lat\r\n                    // 要素所在图层ID和属性信息\r\n                    this.objInfo.layerID = f.layer.id\r\n                    this.objInfo.layerType = f.layer.type\r\n                    this.objInfo.properties = f.properties\r\n                    // 底图要素name_local或设施要素road_name,id\r\n                    this.objInfo.name_local = f.properties.name_local\r\n                    this.objInfo.road_name = f.properties.road_name\r\n                    this.objInfo.id = f.properties.id\r\n                    // 要素对象类型（业务类型/设施类型）\r\n                    this.objInfo.bigType = ''\r\n                    this.objInfo.smallType = ''\r\n                    switch (f.layer.id) {\r\n                        // 雨水\r\n                        case \"rd_map_comb\"://comb一定是雨水口\r\n                            this.objInfo.bigType = '雨水'\r\n                            this.objInfo.smallType = '雨水口'\r\n                            break\r\n                        case \"rd_map_outfall\"://排放口 1-雨水； 2-污水； 3-合流； 4-其他\r\n                            this.objInfo.bigType = f.properties.pipe_type\r\n                            this.objInfo.smallType = '排放口'\r\n                            break\r\n                        case \"rd_map_manhole\"://检查井  1-雨水；2-污水\r\n                            this.objInfo.bigType = f.properties.manhole_type\r\n                            this.objInfo.smallType = f.properties.manhole_type == \"雨水\" ? '雨水检查井' : '污水检查井'\r\n                            break\r\n                        case \"rd_map_gate\"://闸门 1-雨水； 2-污水； 3-合流； 4-其他\r\n                            this.objInfo.bigType = f.properties.pipe_type\r\n                            // objInfo.smallType = '闸门'\r\n                            this.objInfo.smallType = f.properties.pipe_type == \"雨水\" ? '其他（雨）' : '其他（污）'\r\n                            break\r\n                        case \"rd_map_drainpipe_ys_big\":\r\n                            this.objInfo.bigType = '雨水'\r\n                            this.objInfo.smallType = '雨水管渠'\r\n                            break\r\n                        case \"rd_map_drainpipe_ys_small\":\r\n                            this.objInfo.bigType = '雨水'\r\n                            this.objInfo.smallType = '雨水管渠'\r\n                            break\r\n                        // 污水\r\n                        case \"rd_map_drainpipe_ws_big\":\r\n                            this.objInfo.bigType = '污水'\r\n                            this.objInfo.smallType = '污水管道'\r\n                            break\r\n                        case \"rd_map_drainpipe_ws_small\":\r\n                            this.objInfo.bigType = '污水'\r\n                            this.objInfo.smallType = '污水管道'\r\n                            break\r\n                        // 供水\r\n                        case \"map_supply_firehydrant\"://消火栓一定是供水\r\n                            this.objInfo.bigType = '供水'\r\n                            this.objInfo.smallType = '消防栓'\r\n                            break\r\n                        case \"map_supply_valve\"://阀门valve一定是供水\r\n                            this.objInfo.bigType = '供水'\r\n                            this.objInfo.smallType = '阀门'\r\n                            break\r\n                        case \"map_supply_pipe_distribute\"://配水管线\r\n                            this.objInfo.bigType = '供水'\r\n                            this.objInfo.smallType = '供水管道'\r\n                            break\r\n                        case \"map_supply_pipe_delivery\"://输水管线\r\n                            this.objInfo.bigType = 'supply'\r\n                            this.objInfo.smallType = '供水管道'\r\n                            break\r\n                        case \"map_supply_pipe_circulating\"://回水管线\r\n                            this.objInfo.bigType = '供水'\r\n                            this.objInfo.smallType = '供水管道'\r\n                            break\r\n                        // case \"map_supply_node_distribute\":\r\n                        //     objInfo.bigType = '供水'\r\n                        //     objInfo.smallType = \r\n                        //     break\r\n                        case \"map_supply_node_delivery\":\r\n                            this.objInfo.bigType = '供水'\r\n                            this.objInfo.smallType = f.properties.appurtenance == \"消防井\" ? \"消防栓\" : f.properties.appurtenance == \"排气阀\" ? \"阀门\" : '其他（供）'\r\n                            break\r\n                        // case \"map_supply_node_circulating\": \r\n                        //     objInfo.bigType = '供水'\r\n                        //     objInfo.smallType = \r\n                        //     break\r\n                        case \"map_waterwork\"://供水厂\r\n                            this.objInfo.bigType = '供水'\r\n                            this.objInfo.smallType = '其他（供）'\r\n                            break\r\n                        // 再生水\r\n                        case \"map_recycle_pipe\"://再生水管线\r\n                            this.objInfo.bigType = '再生水'\r\n                            this.objInfo.smallType = '再生水管道'\r\n                            break\r\n                        case \"map_waterwork\"://再生水厂\r\n                            this.objInfo.bigType = '再生水'\r\n                            this.objInfo.smallType = '其他（再）'\r\n                            break\r\n                    }\r\n                    // 设施编号\r\n                    this.objInfo.code = f.properties.start_code && f.properties.end_code ? (f.properties.start_code + ',' + f.properties.end_code) : ''\r\n                        || f.properties.manhole_code || f.properties.gate_code || f.properties.outlet_code\r\n                        || f.properties.comb_code || f.properties.valve_code || f.properties.pump_station_code\r\n                        || f.properties.plant_code || f.properties.pump_code || f.properties.fire_cock_code\r\n                        || f.properties.point_code || ''\r\n                    // })\r\n                }\r\n                console.log('this.objInfo: ', this.objInfo);\r\n                // popup\r\n                if (this.chosePoint) {\r\n                    // let popupHtml = \"<div style='width:140px;height:30px;background-color:#08AEE9'><h3>\" + e.lngLat.lng.toFixed(3) + ',' + e.lngLat.lat.toFixed(3) + \"</h3><h3>\"+this.objInfo.smallType+' '+this.objInfo.code+\"</h3><br><fm-button  @click='clickPlus'>确定</fm-button>\" + \"</div>\"\r\n                    let popupHtml = '<div id=\"base-add\"></div>'\r\n                    new mapboxgl.Popup()\r\n                        .setLngLat([e.lngLat.lng, e.lngLat.lat])\r\n                        .setHTML(popupHtml)\r\n                        .addTo(MapObj.map);\r\n                    new popupItem({\r\n                        propsData: {\r\n                            detailId: 99999,\r\n                            // lng: e.lngLat.lng.toFixed(3),\r\n                            // lat: e.lngLat.lat.toFixed(3),\r\n                            lng: e.lngLat.lng,\r\n                            lat: e.lngLat.lat,\r\n                            bigType: this.objInfo.bigType,\r\n                            smallType: this.objInfo.smallType,\r\n                            deviceCode: this.objInfo.code,\r\n                            fun: this.enterAdd\r\n                        }\r\n                    }).$mount('#base-add')\r\n                }\r\n            })\r\n        }\r\n    },\r\n\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.main {\r\n    width: 750px;\r\n    // height: 1334px;\r\n    height: 100%;\r\n    background: #F4F7FC;\r\n\r\n    // .map-container {\r\n    //     width: 750px;\r\n    //     height: 680px;\r\n\r\n    //     .mapboxgl-ctrl-bottom-left {\r\n    //         display: none !important;\r\n    //     }\r\n\r\n    //     .mapboxgl-ctrl a.mapboxgl-ctrl-logo {\r\n    //         display: none !important;\r\n    //     }\r\n\r\n    //     .mapboxgl-ctrl-bottom-left div {\r\n    //         display: none !important;\r\n    //     }\r\n    // }\r\n    .mapContainer {\r\n        height: 750px;\r\n        width: 100%;\r\n\r\n    }\r\n\r\n    .flaws-list-container {\r\n        height: 700px;\r\n        overflow: scroll;\r\n\r\n        .tableList {\r\n            padding-bottom: 10px;\r\n            // position: fixed;\r\n            bottom: 0px;\r\n            width: 750px;\r\n            height: auto;\r\n            overflow: scroll;\r\n            max-height: 580px;\r\n            background: #f4f7fc;\r\n            box-shadow: 0px -4px 12px 0px rgba(104, 115, 127, 0.1);\r\n\r\n            .con-div {\r\n                margin-top: 20px;\r\n                width: 690px;\r\n                margin-left: 30px;\r\n                height: 270px;\r\n                background: #ffffff;\r\n                box-shadow: 0px 4px 16px 0px rgba(104, 115, 127, 0.08);\r\n                border-radius: 16px;\r\n\r\n                .top {\r\n                    width: 100%;\r\n                    height: 80px;\r\n                    line-height: 80px;\r\n                    overflow: auto;\r\n\r\n                    // display: inline;\r\n                    .name {\r\n                        margin-left: 20px;\r\n                        float: left;\r\n                        width: auto;\r\n                        font-size: 36px;\r\n                        font-family: PingFangSC-Semibold, PingFang SC;\r\n                        font-weight: 600;\r\n                        color: #191919;\r\n                    }\r\n\r\n                    .img {\r\n                        width: 30px;\r\n                        height: 39px;\r\n                        float: right;\r\n                        margin-right: 20px;\r\n                        margin-top: 15px;\r\n                    }\r\n\r\n                    .state {\r\n                        float: left;\r\n                        margin-left: 20px;\r\n                        margin-top: 20px;\r\n                        width: auto;\r\n                        padding-left: 10px;\r\n                        padding-right: 10px;\r\n                        height: 42px;\r\n                        line-height: 42px;\r\n                        border-radius: 4px;\r\n                    }\r\n\r\n                    .c1 {\r\n                        background: rgba(64, 187, 90, 0.1);\r\n                        font-size: 24px;\r\n                        font-family: PingFangSC-Regular, PingFang SC;\r\n                        font-weight: 400;\r\n                        color: #40bb5a;\r\n                    }\r\n\r\n                    .c2 {\r\n                        font-size: 24px;\r\n                        font-family: PingFangSC-Regular, PingFang SC;\r\n                        font-weight: 400;\r\n                        color: #027aff;\r\n                        background: rgba(2, 122, 255, 0.1);\r\n                    }\r\n\r\n                    .c3 {\r\n                        background: rgba(255, 148, 41, 0.1);\r\n                        font-size: 24px;\r\n                        font-family: PingFangSC-Regular, PingFang SC;\r\n                        font-weight: 400;\r\n                        color: #ff9429;\r\n                    }\r\n                }\r\n\r\n                .content {\r\n                    white-space: nowrap;\r\n                    overflow: hidden;\r\n                    text-overflow: ellipsis;\r\n                    width: 96%;\r\n                    height: 60px;\r\n                    font-size: 28px;\r\n                    font-family: PingFangSC-Regular, PingFang SC;\r\n                    font-weight: 400;\r\n                    color: #555555;\r\n                    line-height: 60px;\r\n                    padding-left: 20px;\r\n                }\r\n\r\n                .under {\r\n                    width: 97%;\r\n                    margin-left: -17px;\r\n                    display: flex;\r\n                    justify-content: space-around;\r\n                    height: 70px;\r\n                    line-height: 70px;\r\n                    font-size: 28px;\r\n                    font-family: PingFangSC-Regular, PingFang SC;\r\n                    font-weight: 400;\r\n                    color: #555555;\r\n\r\n                    .under-div {\r\n                        margin-left: 30px;\r\n                        float: left;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    .add-container {\r\n        .bigForm-container {\r\n            width: 750px;\r\n            height: 1234px;\r\n            overflow: scroll;\r\n            background: #FFFFFF;\r\n\r\n            .subtable {\r\n                position: relative;\r\n                margin: 10px;\r\n                padding: 13px;\r\n                // background-color: aquamarine;\r\n                border-radius: 16px;\r\n                border: 1px solid #5195d0;\r\n            }\r\n\r\n        }\r\n\r\n    }\r\n\r\n    .detail-container {\r\n        width: 750px;\r\n        height: 1290px;\r\n\r\n        .formFrame {\r\n            width: 750px;\r\n            height: 1300px;\r\n            margin-top: -65px;\r\n\r\n            .outwork-detail {\r\n                .outwork-detail-titlebar .wbgc-card {}\r\n\r\n                .outwork-detail-box {\r\n                    height: 100%;\r\n                    width: 100% !important;\r\n                    overflow: auto;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n</style>"]}]}