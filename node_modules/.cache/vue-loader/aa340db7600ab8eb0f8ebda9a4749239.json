{"remainingRequest":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\src\\views\\PumpStationInspection\\components\\InspectionSubmit.vue?vue&type=script&lang=js","dependencies":[{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\src\\views\\PumpStationInspection\\components\\InspectionSubmit.vue","mtime":1705912915817},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\ty_project\\xasw-yy\\revenue\\xasw-mobile\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgSW5zcGVjdGlvblN1Ym1pdENhcmQgZnJvbSAnLi9JbnNwZWN0aW9uU3VibWl0Q2FyZC52dWUnDQppbXBvcnQgeyBwYXRyb2xFZGl0LCB1cGxvYWRUcmFja0xpc3QgfSBmcm9tICcuLi9hcGknDQpleHBvcnQgZGVmYXVsdCB7DQogIGNvbXBvbmVudHM6IHsgSW5zcGVjdGlvblN1Ym1pdENhcmQgfSwNCiAgcHJvcHM6IHsNCiAgICAvL+W3oeajgOeKtuaAgSgxOuW+heW3oeajgO+8jDI65beh5qOA5Lit77yMMzrlt7LlrozmiJAg77yMNDrlt7Lnu4jmraIpKOaJi+acuuerrykNCiAgICBQYXRyb2xEYXRhOiB7DQogICAgICB0eXBlOiBPYmplY3QsDQogICAgICBkZWZhdWx0OiAoKSA9PiB7fSwNCiAgICB9LA0KICAgIG1vZGVsVHlwZTogew0KICAgICAgdHlwZTogU3RyaW5nLA0KICAgICAgZGVmYXVsdDogJ2xpc3QnLA0KICAgIH0sDQogIH0sDQogIHdhdGNoOiB7DQogICAgUGF0cm9sRGF0YTogew0KICAgICAgaGFuZGxlcjogZnVuY3Rpb24gKCkgew0KICAgICAgICB0aGlzLmlzRmluaXNoQ29uZmlnKCkNCiAgICAgIH0sDQogICAgICBkZWVwOiB0cnVlLA0KICAgICAgaW1tZWRpYXRlOiB0cnVlLA0KICAgIH0sDQogIH0sDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIHN1Ym1pdERhdGE6IG51bGwsDQogICAgICBmaXJzdENvbmZpZzogdHJ1ZSwgLy/mmK/lkKbkuLrnrKzkuIDmrKHov5vlhaUNCiAgICAgIGZpbmlzaENvbmZpZzogZmFsc2UsIC8v5beh5qOA54K55piv5ZCm5beh5qOA5a6M5q+VDQogICAgICBzdWJtaXRTaG93OiBmYWxzZSwgLy/mj5DkuqTlvLnmoYYNCiAgICAgIGRpc2FibGVkOiB0cnVlLA0KICAgIH0NCiAgfSwNCg0KICBjcmVhdGVkKCkgew0KICAgIHRoaXMuc2V0Rmlyc3RDb25maWcoKQ0KICB9LA0KICBiZWZvcmVEZXN0cm95KCkgew0KICAgIHRoaXMuc3RvcFJlcXVlc3RMb2NhdGlvbnMoKQ0KICB9LA0KDQogIG1ldGhvZHM6IHsNCiAgICAvL+WGheWuueWPmOWMlg0KICAgIC8vbGlzdOWIl+ihqO+8jG1hcOWcsOWbvg0KICAgIG1vZGVsVHlwZUNoYW5nZSh0eXBlKSB7DQogICAgICB0aGlzLiRlbWl0KCdtb2RlbFR5cGVDaGFuZ2UnLCB0eXBlKQ0KICAgIH0sDQoNCiAgICAvL+WIpOaWreaYr+WQpuS4uuesrOS4gOasoei/m+WFpQ0KICAgIHNldEZpcnN0Q29uZmlnKCkgew0KICAgICAgbGV0IHsgZmlyc3RDb25maWcgfSA9IHRoaXMuJHJvdXRlLnF1ZXJ5DQogICAgICBpZiAoZmlyc3RDb25maWcgPT09ICdmYWxzZScpIHsNCiAgICAgICAgdGhpcy5maXJzdENvbmZpZyA9IGZhbHNlDQogICAgICAgIHRoaXMuJGVtaXQoJ2lzRGlzYWJsZWQnLCBmYWxzZSkNCiAgICAgICAgY29uc29sZS5sb2coJ2lzRGlzYWJsZWQnLCBmYWxzZSkNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHRoaXMuZmlyc3RDb25maWcgPSB0cnVlDQogICAgICB9DQogICAgfSwNCg0KICAgIC8v5beh5qOA54K55piv5ZCm5beh5qOA5a6M5q+VDQogICAgaXNGaW5pc2hDb25maWcoKSB7DQogICAgICBsZXQgY29uZmlnID0gdGhpcy5QYXRyb2xEYXRhPy5wYXRyb2xQb2ludFJlc3VsdExpc3Q/LmV2ZXJ5KChpdGVtKSA9PiB7DQogICAgICAgIHJldHVybiBpdGVtLnBhdHJvbFN0YXR1cyA9PT0gJ+W3suW3oScNCiAgICAgIH0pDQogICAgICB0aGlzLmZpbmlzaENvbmZpZyA9IGNvbmZpZw0KICAgIH0sDQoNCiAgICAvL+e7p+e7reW3oeajgA0KICAgIGdvSW5zcGVjdGlvbigpIHsNCiAgICAgIHRoaXMuZmlyc3RDb25maWcgPSBmYWxzZQ0KICAgICAgdGhpcy4kZW1pdCgnaXNEaXNhYmxlZCcsIGZhbHNlKQ0KDQogICAgICB0aGlzLnJlcXVlc3RTaW5nbGVMb2NhdGlvbih0cnVlKQ0KICAgIH0sDQoNCiAgICAvL+W8gOWni+W3oeajgA0KICAgIGFzeW5jIHN0YXJ0SW5zcGVjdGlvbih0eXBlKSB7DQogICAgICBsZXQgcXVlcnkgPSB7DQogICAgICAgIGlkOiB0aGlzLiRyb3V0ZS5xdWVyeS50YXNrSWQsDQogICAgICAgIHBhdHJvbFN0YXR1czogdHlwZSA/IHR5cGUgOiB0aGlzLlBhdHJvbERhdGEgJiYgdGhpcy5QYXRyb2xEYXRhLnBhdHJvbFN0YXR1cywNCiAgICAgICAgcGF0cm9sU3RhcnRUaW1lOiB0aGlzLiRkYXlqcygpLmZvcm1hdCgnWVlZWS1NTS1ERCBISDptbTpzcycpLA0KICAgICAgICBwYXRyb2xQb2ludFJlc3VsdExpc3Q6IHRoaXMuUGF0cm9sRGF0YSAmJiB0aGlzLlBhdHJvbERhdGEucGF0cm9sUG9pbnRSZXN1bHRMaXN0LA0KICAgICAgfQ0KDQogICAgICB0aGlzLiRlbWl0KCdpc0Rpc2FibGVkJywgZmFsc2UpDQoNCiAgICAgIHRoaXMucmVxdWVzdFNpbmdsZUxvY2F0aW9uKHRydWUpDQoNCiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBhdHJvbEVkaXQocXVlcnkpDQogICAgICB0aGlzLiRwYXJlbnQuZ2V0UGF0cm9sKCkNCiAgICAgIHRoaXMuZmlyc3RDb25maWcgPSBmYWxzZQ0KICAgICAgdGhpcy4kcm91dGVyLnB1c2goew0KICAgICAgICBwYXRoOiAnL3B1bXAvaW5zcGVjdGlvbicsDQogICAgICAgIHF1ZXJ5OiB7DQogICAgICAgICAgdGFza0lkOiB0aGlzLiRyb3V0ZS5xdWVyeS50YXNrSWQsDQogICAgICAgICAgZmlyc3RDb25maWc6ICdmYWxzZScsDQogICAgICAgIH0sDQogICAgICB9KQ0KICAgIH0sDQoNCiAgICAvL+aaguWBnOW3oeajgA0KICAgIHN0b3BJbnNwZWN0aW9uKCkgew0KICAgICAgdGhpcy4kZGlhbG9nDQogICAgICAgIC5jb25maXJtKHsNCiAgICAgICAgICB0aXRsZTogJ+aaguWBnOW3oeajgCcsDQogICAgICAgICAgbWVzc2FnZTogJ+aaguWBnOW3oeajgOWwhuaPkOS6pOacquaPkOS6pOeahOW3oeajgOeCueWSjOmakOaCo+aVsOaNru+8gScsDQogICAgICAgIH0pDQogICAgICAgIC50aGVuKGFzeW5jICgpID0+IHsNCiAgICAgICAgICBhd2FpdCB0aGlzLmlzVW5zdWJtaXR0ZWQoKQ0KDQogICAgICAgICAgdGhpcy4kcm91dGVyLnJlcGxhY2UoJy9wdW1wL2luc3BlY3Rpb25NYW5hZ2UnKQ0KICAgICAgICB9KQ0KICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7DQogICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpDQogICAgICAgIH0pDQogICAgfSwNCg0KICAgIC8v57uI5q2i5beh5qOADQogICAgYXN5bmMgdGVybWluYXRlZEluc3BlY3Rpb24oKSB7DQogICAgICB0aGlzLiRyb3V0ZXIucHVzaChgL3B1bXAvdGVybWluYXRlZC10YXNrP3Rhc2tJZD0ke3RoaXMuJHJvdXRlLnF1ZXJ5LnRhc2tJZH1gKQ0KICAgIH0sDQoNCiAgICAvL+ajgOafpeaYr+WQpuacieacquaPkOS6pOmhuSzlubbmj5DkuqQNCiAgICBhc3luYyBpc1Vuc3VibWl0dGVkKCkgew0KICAgICAgdGhpcy5zdWJtaXREYXRhID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLlBhdHJvbERhdGEpKQ0KDQogICAgICBsZXQgc3RvcmFnZUl0ZW1EYXRhTGlzdCA9IEpTT04ucGFyc2UodGhpcy4kc3RvcmFnZS5nZXQoJ3B1bXAtc3RvcmFnZUl0ZW1EYXRhTGlzdCcpKQ0KICAgICAgdGhpcy5zdWJtaXREYXRhLnBhdHJvbFBvaW50UmVzdWx0TGlzdD8uZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHsNCiAgICAgICAgc3RvcmFnZUl0ZW1EYXRhTGlzdD8uZm9yRWFjaCgoZGF0YSwgaSkgPT4gew0KICAgICAgICAgIGl0ZW0uaWQgPT09IGRhdGEuaWQNCiAgICAgICAgICAgID8gKHRoaXMuc3VibWl0RGF0YS5wYXRyb2xQb2ludFJlc3VsdExpc3RbaW5kZXhdID0gc3RvcmFnZUl0ZW1EYXRhTGlzdFtpXSkNCiAgICAgICAgICAgIDogbnVsbA0KICAgICAgICB9KQ0KICAgICAgfSkNCg0KICAgICAgdGhpcy4kc3RvcmFnZS5yZW1vdmUoJ3B1bXAtc3RvcmFnZUl0ZW1EYXRhTGlzdCcpDQogICAgICBjb25zdCByZXMgPSBhd2FpdCBwYXRyb2xFZGl0KHRoaXMuc3VibWl0RGF0YSkNCg0KICAgICAgY29uc3QgcGF0aCA9IGF3YWl0IHVwbG9hZFRyYWNrTGlzdCh0aGlzLiRzdG9yZS5zdGF0ZS5wdW1wLnB1bXBQYXRoKQ0KICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdzZXRQdW1wUGF0aCcsIFtdKQ0KICAgIH0sDQoNCiAgICAvL+W8gOWni+W3oeajgA0KICAgIHJlcXVlc3RTaW5nbGVMb2NhdGlvbihpc0ZpcnN0KSB7DQogICAgICBpZiAodHlwZW9mIHl1YW5jaHUgIT0gJ3VuZGVmaW5lZCcpIHsNCiAgICAgICAgeXVhbmNodS5sb2NhdGlvbkFNYXAucmVxdWVzdFNpbmdsZUxvY2F0aW9uKA0KICAgICAgICAgIFsnMSddLA0KICAgICAgICAgIChyZXMpID0+IHsNCiAgICAgICAgICAgIGxldCB7IGxhdGl0dWRlLCBsb25naXR1ZGUgfSA9IHJlcw0KICAgICAgICAgICAgbGV0IHBhdGgNCiAgICAgICAgICAgIGlmIChpc0ZpcnN0KSB7DQogICAgICAgICAgICAgIHBhdGggPQ0KICAgICAgICAgICAgICAgIHRoaXMuUGF0cm9sRGF0YSAmJiB0aGlzLlBhdHJvbERhdGEucGF0cm9sUG9pbnRUcmFja0xpc3QNCiAgICAgICAgICAgICAgICAgID8gdGhpcy5QYXRyb2xEYXRhLnBhdHJvbFBvaW50VHJhY2tMaXN0DQogICAgICAgICAgICAgICAgICA6IFtdDQogICAgICAgICAgICAgIGNvbnNvbGUubG9nKHBhdGgpDQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICBwYXRoID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLiRzdG9yZS5zdGF0ZS5wdW1wLnB1bXBQYXRoKSkNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcGF0aC5wdXNoKHsNCiAgICAgICAgICAgICAgbGF0OiBsYXRpdHVkZSwNCiAgICAgICAgICAgICAgbG9uOiBsb25naXR1ZGUsDQogICAgICAgICAgICB9KQ0KICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdzZXRQdW1wUGF0aCcsIHBhdGgpDQoNCiAgICAgICAgICAgIGNvbnNvbGUubG9nKHRoaXMuJHN0b3JlLnN0YXRlLnB1bXAucHVtcFBhdGgpDQogICAgICAgICAgfSwNCiAgICAgICAgICAoZXJyKSA9PiB7DQogICAgICAgICAgICBjb25zb2xlLmxvZygnZXJyPScsIGVycikNCiAgICAgICAgICB9DQogICAgICAgICkNCiAgICAgIH0NCiAgICB9LA0KDQogICAgLy/nu5PmnZ/lt6Hmo4ANCiAgICBzdG9wUmVxdWVzdExvY2F0aW9ucygpIHsNCiAgICAgIGlmICh0eXBlb2YgeXVhbmNodSAhPSAndW5kZWZpbmVkJykgew0KICAgICAgICB5dWFuY2h1LmxvY2F0aW9uQU1hcC5zdG9wUmVxdWVzdExvY2F0aW9ucygpDQogICAgICB9DQogICAgfSwNCg0KICAgIC8v5a6M5oiQ5beh5qOA5o+Q5LqkDQogICAgc3VibWl0KHR5cGUpIHsNCiAgICAgIHRoaXMuc3VibWl0RGF0YSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5QYXRyb2xEYXRhKSkNCiAgICAgIHRoaXMuc3VibWl0RGF0YS5wYXRyb2xTdGF0dXMgPSB0eXBlDQogICAgICB0aGlzLnN1Ym1pdERhdGEucGF0cm9sRW5kVGltZSA9IHRoaXMuJGRheWpzKCkuZm9ybWF0KCdZWVlZLU1NLUREIEhIOm1tOnNzJykNCiAgICAgIHRoaXMuc3VibWl0RGF0YS5zdWJtaXRUaW1lID0gdGhpcy4kZGF5anMoKS5mb3JtYXQoJ1lZWVktTU0tREQgSEg6bW06c3MnKQ0KICAgICAgdGhpcy5zdWJtaXRTaG93ID0gdHJ1ZQ0KICAgIH0sDQoNCiAgICAvL+S7u+WKoeaPkOS6pOehruiupA0KICAgIGFzeW5jIG9uQ29uZmlybSgpIHsNCiAgICAgIHRyeSB7DQogICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHBhdHJvbEVkaXQodGhpcy5zdWJtaXREYXRhKQ0KICAgICAgICB0aGlzLiRwYXJlbnQuZ2V0UGF0cm9sKCkNCiAgICAgICAgdGhpcy5maXJzdENvbmZpZyA9IGZhbHNlDQogICAgICAgIHRoaXMuJHJvdXRlci5yZXBsYWNlKCcvcHVtcC9pbnNwZWN0aW9uTWFuYWdlJykNCiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7DQogICAgICAgIGNvbnNvbGUubG9nKGVycm9yKQ0KICAgICAgfQ0KICAgIH0sDQogIH0sDQp9DQo="},{"version":3,"sources":["InspectionSubmit.vue"],"names":[],"mappings":";AAoEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"InspectionSubmit.vue","sourceRoot":"src/views/PumpStationInspection/components","sourcesContent":["<template>\r\n  <div class=\"inspection-submit\">\r\n    <div class=\"inspection-map\">\r\n      <img\r\n        v-if=\"modelType === 'list'\"\r\n        @click=\"modelTypeChange('map')\"\r\n        src=\"@/assets/img/pump/inspection-map.png\"\r\n        alt=\"\"\r\n        class=\"inspection-icon\"\r\n      />\r\n      <img\r\n        v-if=\"modelType === 'map'\"\r\n        @click=\"modelTypeChange('list')\"\r\n        src=\"@/assets/img/pump/inspection-list.png\"\r\n        alt=\"\"\r\n        class=\"inspection-icon\"\r\n      />\r\n    </div>\r\n\r\n    <fm-button\r\n      type=\"success\"\r\n      class=\"inspection-btn inspection-btn-one\"\r\n      v-if=\"PatrolData && PatrolData.patrolStatus === 1\"\r\n      @click=\"startInspection(2)\"\r\n      >开始巡检</fm-button\r\n    >\r\n    <fm-button\r\n      type=\"success\"\r\n      class=\"inspection-btn\"\r\n      v-if=\"PatrolData && PatrolData.patrolStatus === 2 && !firstConfig && finishConfig\"\r\n      @click=\"submit(3)\"\r\n      >完成巡检</fm-button\r\n    >\r\n    <fm-button\r\n      type=\"warning\"\r\n      class=\"inspection-btn\"\r\n      v-if=\"PatrolData && PatrolData.patrolStatus === 2 && !firstConfig && !finishConfig\"\r\n      @click=\"terminatedInspection(4)\"\r\n      >终止巡检</fm-button\r\n    >\r\n    <fm-button\r\n      type=\"primary\"\r\n      class=\"inspection-btn\"\r\n      v-if=\"PatrolData && PatrolData.patrolStatus === 2 && !firstConfig && !finishConfig\"\r\n      @click=\"stopInspection()\"\r\n      >暂停巡检</fm-button\r\n    >\r\n    <fm-button\r\n      type=\"primary\"\r\n      class=\"inspection-btn inspection-btn-one\"\r\n      v-if=\"PatrolData && PatrolData.patrolStatus === 2 && firstConfig\"\r\n      @click=\"goInspection()\"\r\n      >继续巡检</fm-button\r\n    >\r\n\r\n    <fm-dialog\r\n      :visible.sync=\"submitShow\"\r\n      title=\"巡检任务提交\"\r\n      @confirm=\"onConfirm\"\r\n      show-cancel-button\r\n      width=\"331\"\r\n    >\r\n      <inspection-submit-card :PatrolData=\"submitData\" />\r\n    </fm-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport InspectionSubmitCard from './InspectionSubmitCard.vue'\r\nimport { patrolEdit, uploadTrackList } from '../api'\r\nexport default {\r\n  components: { InspectionSubmitCard },\r\n  props: {\r\n    //巡检状态(1:待巡检，2:巡检中，3:已完成 ，4:已终止)(手机端)\r\n    PatrolData: {\r\n      type: Object,\r\n      default: () => {},\r\n    },\r\n    modelType: {\r\n      type: String,\r\n      default: 'list',\r\n    },\r\n  },\r\n  watch: {\r\n    PatrolData: {\r\n      handler: function () {\r\n        this.isFinishConfig()\r\n      },\r\n      deep: true,\r\n      immediate: true,\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      submitData: null,\r\n      firstConfig: true, //是否为第一次进入\r\n      finishConfig: false, //巡检点是否巡检完毕\r\n      submitShow: false, //提交弹框\r\n      disabled: true,\r\n    }\r\n  },\r\n\r\n  created() {\r\n    this.setFirstConfig()\r\n  },\r\n  beforeDestroy() {\r\n    this.stopRequestLocations()\r\n  },\r\n\r\n  methods: {\r\n    //内容变化\r\n    //list列表，map地图\r\n    modelTypeChange(type) {\r\n      this.$emit('modelTypeChange', type)\r\n    },\r\n\r\n    //判断是否为第一次进入\r\n    setFirstConfig() {\r\n      let { firstConfig } = this.$route.query\r\n      if (firstConfig === 'false') {\r\n        this.firstConfig = false\r\n        this.$emit('isDisabled', false)\r\n        console.log('isDisabled', false)\r\n      } else {\r\n        this.firstConfig = true\r\n      }\r\n    },\r\n\r\n    //巡检点是否巡检完毕\r\n    isFinishConfig() {\r\n      let config = this.PatrolData?.patrolPointResultList?.every((item) => {\r\n        return item.patrolStatus === '已巡'\r\n      })\r\n      this.finishConfig = config\r\n    },\r\n\r\n    //继续巡检\r\n    goInspection() {\r\n      this.firstConfig = false\r\n      this.$emit('isDisabled', false)\r\n\r\n      this.requestSingleLocation(true)\r\n    },\r\n\r\n    //开始巡检\r\n    async startInspection(type) {\r\n      let query = {\r\n        id: this.$route.query.taskId,\r\n        patrolStatus: type ? type : this.PatrolData && this.PatrolData.patrolStatus,\r\n        patrolStartTime: this.$dayjs().format('YYYY-MM-DD HH:mm:ss'),\r\n        patrolPointResultList: this.PatrolData && this.PatrolData.patrolPointResultList,\r\n      }\r\n\r\n      this.$emit('isDisabled', false)\r\n\r\n      this.requestSingleLocation(true)\r\n\r\n      const res = await patrolEdit(query)\r\n      this.$parent.getPatrol()\r\n      this.firstConfig = false\r\n      this.$router.push({\r\n        path: '/pump/inspection',\r\n        query: {\r\n          taskId: this.$route.query.taskId,\r\n          firstConfig: 'false',\r\n        },\r\n      })\r\n    },\r\n\r\n    //暂停巡检\r\n    stopInspection() {\r\n      this.$dialog\r\n        .confirm({\r\n          title: '暂停巡检',\r\n          message: '暂停巡检将提交未提交的巡检点和隐患数据！',\r\n        })\r\n        .then(async () => {\r\n          await this.isUnsubmitted()\r\n\r\n          this.$router.replace('/pump/inspectionManage')\r\n        })\r\n        .catch((error) => {\r\n          console.log(error)\r\n        })\r\n    },\r\n\r\n    //终止巡检\r\n    async terminatedInspection() {\r\n      this.$router.push(`/pump/terminated-task?taskId=${this.$route.query.taskId}`)\r\n    },\r\n\r\n    //检查是否有未提交项,并提交\r\n    async isUnsubmitted() {\r\n      this.submitData = JSON.parse(JSON.stringify(this.PatrolData))\r\n\r\n      let storageItemDataList = JSON.parse(this.$storage.get('pump-storageItemDataList'))\r\n      this.submitData.patrolPointResultList?.forEach((item, index) => {\r\n        storageItemDataList?.forEach((data, i) => {\r\n          item.id === data.id\r\n            ? (this.submitData.patrolPointResultList[index] = storageItemDataList[i])\r\n            : null\r\n        })\r\n      })\r\n\r\n      this.$storage.remove('pump-storageItemDataList')\r\n      const res = await patrolEdit(this.submitData)\r\n\r\n      const path = await uploadTrackList(this.$store.state.pump.pumpPath)\r\n      this.$store.commit('setPumpPath', [])\r\n    },\r\n\r\n    //开始巡检\r\n    requestSingleLocation(isFirst) {\r\n      if (typeof yuanchu != 'undefined') {\r\n        yuanchu.locationAMap.requestSingleLocation(\r\n          ['1'],\r\n          (res) => {\r\n            let { latitude, longitude } = res\r\n            let path\r\n            if (isFirst) {\r\n              path =\r\n                this.PatrolData && this.PatrolData.patrolPointTrackList\r\n                  ? this.PatrolData.patrolPointTrackList\r\n                  : []\r\n              console.log(path)\r\n            } else {\r\n              path = JSON.parse(JSON.stringify(this.$store.state.pump.pumpPath))\r\n            }\r\n\r\n            path.push({\r\n              lat: latitude,\r\n              lon: longitude,\r\n            })\r\n            this.$store.commit('setPumpPath', path)\r\n\r\n            console.log(this.$store.state.pump.pumpPath)\r\n          },\r\n          (err) => {\r\n            console.log('err=', err)\r\n          }\r\n        )\r\n      }\r\n    },\r\n\r\n    //结束巡检\r\n    stopRequestLocations() {\r\n      if (typeof yuanchu != 'undefined') {\r\n        yuanchu.locationAMap.stopRequestLocations()\r\n      }\r\n    },\r\n\r\n    //完成巡检提交\r\n    submit(type) {\r\n      this.submitData = JSON.parse(JSON.stringify(this.PatrolData))\r\n      this.submitData.patrolStatus = type\r\n      this.submitData.patrolEndTime = this.$dayjs().format('YYYY-MM-DD HH:mm:ss')\r\n      this.submitData.submitTime = this.$dayjs().format('YYYY-MM-DD HH:mm:ss')\r\n      this.submitShow = true\r\n    },\r\n\r\n    //任务提交确认\r\n    async onConfirm() {\r\n      try {\r\n        const res = await patrolEdit(this.submitData)\r\n        this.$parent.getPatrol()\r\n        this.firstConfig = false\r\n        this.$router.replace('/pump/inspectionManage')\r\n      } catch (error) {\r\n        console.log(error)\r\n      }\r\n    },\r\n  },\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.inspection-submit {\r\n  width: calc(100% - 150px);\r\n  position: fixed;\r\n  bottom: 0;\r\n  display: flex;\r\n  justify-content: space-around;\r\n  align-items: center;\r\n  height: 112px;\r\n  padding: 10px 30px 10px 120px;\r\n  background-color: #fff;\r\n\r\n  .inspection-map {\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    position: absolute;\r\n    left: 40px;\r\n    width: 40px;\r\n    height: 40px;\r\n\r\n    .inspection-icon {\r\n      width: 100%;\r\n      height: 100%;\r\n    }\r\n  }\r\n\r\n  .inspection-btn {\r\n    width: 288px;\r\n    height: 88px;\r\n    border-radius: 44px;\r\n  }\r\n\r\n  .inspection-btn-one {\r\n    width: 100%;\r\n  }\r\n}\r\n</style>\r\n"]}]}