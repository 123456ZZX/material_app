{"remainingRequest":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Code\\Project\\WL\\xasw-mobile\\src\\views\\FormCenter\\components\\DetailTable\\index.vue?vue&type=style&index=0&id=1b1107b3&scoped=true&lang=less","dependencies":[{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\src\\views\\FormCenter\\components\\DetailTable\\index.vue","mtime":1705912800020},{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\less-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Code\\Project\\WL\\xasw-mobile\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQouZGV0YWlsLXRhYmxlLWNvbnRhaW5lciB7DQogIG92ZXJmbG93OiBoaWRkZW47DQogIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMjQyLCAyNDMsIDI0NCwgMSk7DQp9DQoNCi50aXRsZS1jZWxsLXZhbHVlIHsNCiAgbWFyZ2luLXJpZ2h0OiAyMHB4Ow0KICBjb2xvcjogIzAyN2FmZjsNCn0NCg0KLnRhYmxlLWxpc3QtY29udGFpbmVyIHsNCiAgb3ZlcmZsb3c6IGhpZGRlbjsNCiAgYmFja2dyb3VuZDogI2YyZjNmNDsNCn0NCg0KLnRhYmxlLWl0ZW0gew0KICBkaXNwbGF5OiBmbGV4Ow0KICBhbGlnbi1pdGVtczogY2VudGVyOw0KICBwYWRkaW5nLWxlZnQ6IDI4cHg7DQogIG1hcmdpbi10b3A6IDI0cHg7DQp9DQovLyDlrZDooajmnIDlkI7kuIDpobnorr7nva7lupXpg6jovrnot50NCi50YWJsZS1pdGVtLWNvbnRhaW5lcjpsYXN0LWNoaWxkIHsNCiAgbWFyZ2luLWJvdHRvbTogMzJweDsNCn0NCg0KLy8gLS0tLS0gcG9wdXAgc3RhcnQgLS0tLS0NCi5wb3B1cC1jb250YWluZXIgew0KICBoZWlnaHQ6IDEwMCU7DQogIG92ZXJmbG93OiBoaWRkZW47DQogIGRpc3BsYXk6IGZsZXg7DQogIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47DQogICogew0KICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7DQogIH0NCn0NCi5hZGQtaXRlbS1jb250YWluZXIsDQoudGFibGUtY29sdW1uLWZvcm0gew0KICAvLyBoZWlnaHQ6IGNhbGMoMTAwJSAtIDkycHgpOw0KICBvdmVyZmxvdzogYXV0bzsNCiAgZmxleDogMTsNCn0NCg0KLndpdGgtYnV0dG9uLA0KLnRhYmxlLWNvbHVtbi1mb3JtIHsNCiAgaGVpZ2h0OiBjYWxjKDEwMCUgLSAxMjJweCk7DQp9DQoNCi53aXRob3V0LWJ1dHRvbiB7DQogIGhlaWdodDogY2FsYygxMDAlIC0gOTJweCk7DQogIC50YWJsZS1jb2x1bW4tZm9ybSB7DQogICAgaGVpZ2h0OiAxMDAlOw0KICB9DQp9DQoNCi51cGxvZGVyLWF0dGFjaG1lbnQtaXRlbSB7DQogIHBhZGRpbmc6IDI2cHggMzJweDsNCn0NCg0KLmZvcm0tYnV0dG9uIHsNCiAgZGlzcGxheTogZmxleDsNCiAgcGFkZGluZzogMThweCAzMHB4Ow0KICBwb3NpdGlvbjogZml4ZWQ7DQogIGxlZnQ6IDA7DQogIHJpZ2h0OiAwOw0KICBib3R0b206IGNhbGMoMCArIGVudihzYWZlLWFyZWEtaW5zZXQtYm90dG9tKSk7DQogIGJvdHRvbTogY2FsYygwICsgY29uc3RhbnQoc2FmZS1hcmVhLWluc2V0LWJvdHRvbSkpOw0KICBoZWlnaHQ6IDEyMnB4Ow0KDQogIC5zYXZlLWJ0biB7DQogICAgZmxleDogMTsNCiAgICBkaXNwbGF5OiBmbGV4Ow0KICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogIH0NCn0NCg0KLy8gLS0tLS0gcG9wdXAgZW5kIC0tLS0tDQoNCi8vIC0tLS0t5a2Q6KGo6aKE6KeI55WM6Z2iIHN0YXJ0IC0tLS0tDQouY3VzLXByZXZpZXctbGlzdC1pdGVtIHsNCiAgZGlzcGxheTogZmxleDsNCiAgZmxleC1kaXJlY3Rpb246IHJvdzsNCiAgbWFyZ2luLWJvdHRvbTogMTBweDsNCiAgLmZpbGUtaWNvbiB7DQogICAgaGVpZ2h0OiA1M3B4Ow0KICAgIHdpZHRoOiA0NHB4Ow0KICB9DQogIC5maWxlLWluZm8gew0KICAgIHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzOw0KICAgIG92ZXJmbG93OiBoaWRkZW47DQogICAgd2hpdGUtc3BhY2U6IG5vd3JhcDsNCiAgICB0ZXh0LWFsaWduOiBsZWZ0Ow0KICAgIG1hcmdpbi1sZWZ0OiAxMnB4Ow0KICB9DQp9DQoudGFibGUtdGV4dCB7DQogIHdpZHRoOiAyMCU7DQogIGZvbnQtc2l6ZTogMjhweDsNCiAgY29sb3I6ICM5OTk5OTk7DQogIHRleHQtYWxpZ246IHJpZ2h0Ow0KfQ0KLnRhYmxlLWNvbnRlbnQgew0KICB3aWR0aDogNjAlOw0KICBmb250LXNpemU6IDI4cHg7DQogIGNvbG9yOiAjMzMzMzMzOw0KICBtYXJnaW4tbGVmdDogMzJweDsNCiAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7DQogIG92ZXJmbG93OiBoaWRkZW47DQogIHdoaXRlLXNwYWNlOiBub3dyYXA7DQogIHRleHQtYWxpZ246IGxlZnQ7DQp9DQouZGVsZXRlLWJ1dHRvbiB7DQogIHdpZHRoOiAxMCU7DQogIGNvbG9yOiAjMzQ3ZGY2Ow0KICBmb250LXNpemU6IDI4cHg7DQogIGRpc3BsYXk6IGZsZXg7DQogIGp1c3RpZnktY29udGVudDogY2VudGVyOw0KfQ0KLy8gLS0tLS0g5a2Q6KGo6aKE6KeI55WM6Z2iIGVuZCAtLS0tLQ0KDQovZGVlcC8uZm0tZmllbGQtLWRpc2FibGVkIC5mbS1maWVsZF9fbGFiZWwgew0KICBjb2xvcjogIzAwMDsNCn0NCg0KLy9UT0RPIOWQjuacn+WPr+WcqGZtLWNlbGwtZ3JvdXDnu4Tku7bkuK3mt7vliqDlv4XloavlsZ7mgKcNCi8vIOS4uuW/heWhq+eahOaWh+acrOahhuiuvue9ruW/heWhqyrlj7cNCi5yZXF1aXJlZC1hc3RlcmlzayB7DQogIC9kZWVwLyAuZm0tY2VsbC1ncm91cF9fdGl0bGUgew0KICAgIGNvbG9yOiAjMDAwOw0KICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsNCiAgfQ0KICAvZGVlcC8gLmZtLWNlbGwtZ3JvdXBfX3RpdGxlOjpiZWZvcmUgew0KICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgICBsZWZ0OiAxNnB4Ow0KICAgIGNvbG9yOiAjZmY0ZDRmOw0KICAgIGZvbnQtc2l6ZTogMzJweDsNCiAgICBjb250ZW50OiAnKic7DQogIH0NCn0NCg0KL2RlZXAvIC5mbS1jZWxsX19yaWdodC1pY29uIHsNCiAgY29sb3I6ICMzMzM7DQp9DQoNCi50ZXh0YXJlYS10eXBlIC9kZWVwLyAuZm0tZmllbGRfX3ZhbHVlIHsNCiAgYm9yZGVyOiAxcHggc29saWQgI2JiYmJiYjsNCiAgb3BhY2l0eTogMC41Ow0KfQ0KDQoudGV4dGFyZWEtdHlwZSAvZGVlcC8gLmZtLWZpZWxkX19jb250cm9sIHsNCiAgcGFkZGluZy1sZWZ0OiAyMHB4Ow0KICBwYWRkaW5nLXRvcDogMjBweDsNCn0NCi50ZXh0YXJlYS10eXBlIC9kZWVwLyAuZm0tZmllbGRfX3dvcmQtbGltaXQgew0KICBtYXJnaW4tcmlnaHQ6IDIwcHg7DQogIG1hcmdpbi1ib3R0b206IDEycHg7DQp9DQoNCi8vIOWxj+iUvemZhOS7tue7hOS7tum7mOiupOeahHBhZGRpbmcNCi9kZWVwLyAuZmllbGQtYXR0YWNobWVudCB7DQogIHBhZGRpbmc6IDA7DQp9DQoNCi9kZWVwLyAuZm0tY2VsbF9fcmlnaHQtaWNvbiB7DQogIGNvbG9yOiAjMzMzOw0KfQ0KDQoucHJldmlldy1kZXRhaWwtaXRlbSB7DQogIG1hcmdpbjogMjRweCAzMHB4Ow0KfQ0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";AAwhBA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/FormCenter/components/DetailTable","sourcesContent":["<template>\r\n  <div class=\"detail-table-container\">\r\n    <fm-cell :title=\"tableName\" :required=\"required\">\r\n      <template v-if=\"readonly !== 'readonly'\"\r\n        ><span @click=\"addTableItem\" class=\"title-cell-value\">点击添加</span></template\r\n      >\r\n      <template #right-icon>\r\n        <i\r\n          :class=\"[collapsed ? 'fm-icon-arrow' : 'fm-icon-arrow-down']\"\r\n          @click=\"collapsed = !collapsed\"\r\n        />\r\n      </template>\r\n    </fm-cell>\r\n    <!-- 子表新增、编辑界面 -->\r\n    <fm-popup\r\n      :visible.sync=\"showPop\"\r\n      position=\"bottom\"\r\n      close-icon-position=\"top-left\"\r\n      class=\"popup-container\"\r\n    >\r\n      <fm-nav-bar :title=\"tableName\" left-arrow @click-left=\"cancel\" />\r\n      <div class=\"add-item-container\">\r\n        <fm-form\r\n          input-align=\"right\"\r\n          :class=\"['table-column-form', readonly != 'readonly' ? 'with-button' : 'without-button']\"\r\n        >\r\n          <div\r\n            v-for=\"(item, index) in tableColumnTemp\"\r\n            :key=\"index\"\r\n            :class=\"[item.editType == 'textarea' && item.required ? 'required-asterisk' : '']\"\r\n          >\r\n            <!-- 输入框 -->\r\n            <fm-field\r\n              v-if=\"item.editType == 'input'\"\r\n              v-model=\"item.value\"\r\n              :label=\"item.label\"\r\n              :placeholder=\"item.placeholder\"\r\n              maxlength=\"50\"\r\n              required\r\n              :readonly=\"readonly == 'readonly'\"\r\n            />\r\n            <!-- 日期选择器 -->\r\n            <div v-else-if=\"item.editType == 'datePicker'\">\r\n              <fm-field\r\n                :is-link=\"readonly != 'readonly'\"\r\n                readonly\r\n                clickable\r\n                input-align=\"right\"\r\n                name=\"datePicker\"\r\n                :value=\"\r\n                  item.value\r\n                    ? $dayjs(item.value).format(item.format || 'YYYY-MM-DD hh:mm:ss')\r\n                    : item.value\r\n                \"\r\n                :label=\"item.label\"\r\n                :placeholder=\"item.placeholder\"\r\n                @click.stop.native=\"\r\n                  item.disabled || readonly == 'readonly' ? '' : (showCalendar = true)\r\n                \"\r\n                :required=\"item.required\"\r\n              />\r\n              <!-- 选择范围默认为前后十年，可通过yearGap设置 -->\r\n              <datetime-picker\r\n                :disabled=\"item.disabled\"\r\n                :show.sync=\"showCalendar\"\r\n                v-model=\"item.value\"\r\n                type=\"date\"\r\n                :format=\"item.format\"\r\n                showFormatter\r\n                :min-date=\"\r\n                  $dayjs()\r\n                    .subtract(item.yearGap || 10, 'year')\r\n                    .dayOfYear(1)\r\n                    .toDate()\r\n                \"\r\n                :max-date=\"\r\n                  $dayjs()\r\n                    .add(item.yearGap || 10, 'year')\r\n                    .dayOfYear(365)\r\n                    .toDate()\r\n                \"\r\n              />\r\n            </div>\r\n            <!-- 步进器 -->\r\n            <fm-field\r\n              :label=\"item.label\"\r\n              :required=\"item.required\"\r\n              v-else-if=\"item.editType == 'number'\"\r\n            >\r\n              <template #input>\r\n                <fm-stepper\r\n                  @change=\"stepperChange\"\r\n                  input-width=\"50\"\r\n                  :disabled=\"item.disabled\"\r\n                  min=\"0\"\r\n                  v-model=\"item.value\"\r\n                />\r\n              </template>\r\n            </fm-field>\r\n            <!-- 字典选择组件 -->\r\n            <div v-else-if=\"item.editType == 'select'\">\r\n              <fm-field\r\n                :is-link=\"readonly != 'readonly'\"\r\n                readonly\r\n                clickable\r\n                input-align=\"right\"\r\n                name=\"picker\"\r\n                :required=\"item.required\"\r\n                :label=\"item.label\"\r\n                :placeholder=\"item.placeholder\"\r\n                :value=\"item.value | transferEnum(item.dictCode)\"\r\n                @click.stop.native=\"\r\n                  item.disabled || readonly == 'readonly' ? '' : (showPicker = true)\r\n                \"\r\n              />\r\n              <fm-popup :visible.sync=\"showPicker\" position=\"bottom\">\r\n                <fm-picker\r\n                  show-toolbar\r\n                  :columns=\"pickerType(item.dictCode)\"\r\n                  :value-key=\"lang\"\r\n                  :title=\"item.label\"\r\n                  @confirm=\"onReimburseTypeConfirm\"\r\n                  @cancel=\"showPicker = false\"\r\n                />\r\n              </fm-popup>\r\n            </div>\r\n            <!-- 附件 -->\r\n            <uploader\r\n              v-model=\"item.value\"\r\n              :deletable=\"true\"\r\n              :disabled=\"readonly == 'readonly'\"\r\n              :showUpload=\"true\"\r\n              :ref=\"`form-${item.prop}`\"\r\n              type=\"file\"\r\n              class=\"uploder-attachment-item\"\r\n              @fileChange=\"fileChange(arguments, item.prop)\"\r\n              v-else-if=\"item.editType == 'file'\"\r\n            />\r\n            <!-- 文本输入框 -->\r\n            <fm-cell-group v-else :title=\"item.label\" class=\"textarea-type\">\r\n              <fm-field\r\n                type=\"textarea\"\r\n                input-align=\"left\"\r\n                maxlength=\"50\"\r\n                :placeholder=\"item.placeholder\"\r\n                v-model=\"item.value\"\r\n                :readonly=\"readonly == 'readonly'\"\r\n                autosize\r\n                show-word-limit\r\n              >\r\n              </fm-field>\r\n            </fm-cell-group>\r\n          </div>\r\n        </fm-form>\r\n        <div class=\"form-button\" v-if=\"readonly != 'readonly'\">\r\n          <fm-button\r\n            round\r\n            block\r\n            type=\"primary\"\r\n            native-type=\"submit\"\r\n            @click=\"onSubmitTable\"\r\n            class=\"save-btn\"\r\n            >保存</fm-button\r\n          >\r\n        </div>\r\n      </div>\r\n    </fm-popup>\r\n    <!-- 子表预览界面 -->\r\n    <div class=\"preview-detail-list\" v-show=\"!collapsed\">\r\n      <fm-cell-group\r\n        inset\r\n        v-for=\"(item, index) in formDetail\"\r\n        :key=\"index\"\r\n        class=\"preview-detail-item\"\r\n      >\r\n        <div\r\n          v-for=\"(options, i) in tableColumnTemp\"\r\n          :key=\"i\"\r\n          @click=\"viewTableItem(item, index)\"\r\n          class=\"table-item-container\"\r\n        >\r\n          <div\r\n            class=\"table-item\"\r\n            v-if=\"options.editType == 'input' && options.prop != 'description'\"\r\n          >\r\n            <div class=\"table-text\">{{ options.label }}</div>\r\n            <div class=\"table-content\">{{ item[options.prop] }}</div>\r\n          </div>\r\n          <div class=\"table-item\" v-else-if=\"options.editType == 'datePicker'\">\r\n            <div class=\"table-text\">{{ options.label }}</div>\r\n            <div class=\"table-content\">{{ $dayjs(item[options.prop]).format('YYYY-MM-DD') }}</div>\r\n          </div>\r\n          <div class=\"table-item\" v-else-if=\"options.editType == 'number'\">\r\n            <div class=\"table-text\">{{ options.label }}</div>\r\n            <div class=\"table-content\">{{ item[options.prop] }}</div>\r\n          </div>\r\n          <div class=\"table-item\" v-else-if=\"options.editType == 'select'\">\r\n            <div class=\"table-text\">{{ options.label }}</div>\r\n            <div class=\"table-content\">\r\n              {{ item[options.prop] | transferEnum(options.dictCode) }}\r\n            </div>\r\n          </div>\r\n          <div class=\"table-item\" v-else-if=\"options.editType == 'file'\">\r\n            <div class=\"table-text\">{{ options.label }}</div>\r\n            <div class=\"table-content\">\r\n              <uploader\r\n                v-model=\"item[options.prop]\"\r\n                :previewLabel=\"''\"\r\n                :deletable=\"false\"\r\n                :disabled=\"true\"\r\n                :showUpload=\"false\"\r\n                :previewFullImage=\"readonly == 'readonly'\"\r\n                :ref=\"`list-${options.prop}`\"\r\n                type=\"file\"\r\n              >\r\n                <template #upload-list=\"fileList\">\r\n                  <div\r\n                    v-for=\"file in fileList\"\r\n                    :key=\"file.fileToken || file.fileId\"\r\n                    class=\"cus-preview-list-item\"\r\n                    @click=\"download($event, file, index, `list-${options.prop}`)\"\r\n                  >\r\n                    <img :src=\"file.file.name | getFileIcon\" class=\"file-icon\" />\r\n                    <div class=\"file-info\">\r\n                      <span>{{ file.file.name }}</span>\r\n                    </div>\r\n                  </div>\r\n                </template>\r\n              </uploader>\r\n            </div>\r\n          </div>\r\n          <div class=\"table-item\" v-else>\r\n            <div class=\"table-text\">{{ options.label }}</div>\r\n            <div class=\"table-content\">{{ item[options.prop] }}</div>\r\n            <div class=\"delete-button\" @click.stop=\"deleteItem(item, index)\" v-if=\"!readonly\">\r\n              删除\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </fm-cell-group>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { ENUM } from '@/store/State/stateTypes'\r\nimport {\r\n  NavBar,\r\n  Form,\r\n  Field,\r\n  // Calendar,\r\n  Button,\r\n  Stepper,\r\n  Popup,\r\n  Picker,\r\n  Checkbox,\r\n  CheckboxGroup,\r\n  Toast,\r\n  CellGroup,\r\n  Cell,\r\n  Dialog,\r\n} from 'fawkes-mobile-lib'\r\nimport Uploader from '@/components/upload/Uploader'\r\nimport DatetimePicker from '@/components/datetime-picker/DatetimePicker'\r\nimport dayOfYear from 'dayjs/plugin/dayOfYear'\r\n\r\nexport default {\r\n  name: 'DetailTable',\r\n  components: {\r\n    [NavBar.name]: NavBar,\r\n    [Form.name]: Form,\r\n    [Field.name]: Field,\r\n    // [Calendar.name]: Calendar,\r\n    [Button.name]: Button,\r\n    [Stepper.name]: Stepper,\r\n    [Popup.name]: Popup,\r\n    [Picker.name]: Picker,\r\n    [Checkbox.name]: Checkbox,\r\n    [CheckboxGroup.name]: CheckboxGroup,\r\n    [CellGroup.name]: CellGroup,\r\n    [Cell.name]: Cell,\r\n    Uploader,\r\n    [Dialog.name]: Dialog,\r\n    DatetimePicker,\r\n  },\r\n  props: {\r\n    // 子表字段列表\r\n    tableColumn: {\r\n      type: Array,\r\n      default: () => [],\r\n    },\r\n    // 子表数据\r\n    formDetail: {\r\n      type: Array,\r\n      default: () => [],\r\n    },\r\n    tableName: {\r\n      type: String,\r\n      default: '',\r\n    },\r\n    // 只读状态，可选值为 readonly|modify readonly下无任何编辑，modify可编辑列表项\r\n    readonly: {\r\n      type: String,\r\n      default: '',\r\n    },\r\n    rules: {\r\n      type: Object,\r\n      default: () => {\r\n        return {}\r\n      },\r\n    },\r\n    visible: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n    // 主表的编辑状态——add为新增，edit为编辑\r\n    tableType: {\r\n      type: String,\r\n      default: 'add',\r\n    },\r\n    // 是否可在预览页面点击附件下载\r\n    downloadable: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n    // 是否显示必填的*号\r\n    required: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      showCalendar: false, // 是否展示选择日期组件\r\n      showPicker: false, // 是否展示选择报销类型组\r\n      fileList: [],\r\n      // 子表临时数据\r\n      formDetailTemp: [],\r\n      showPop: false,\r\n      currentIndex: 0, // 子表第几项记录\r\n      currentType: 'add', // 子表当前编辑状态\r\n      show: false,\r\n      tableList: [],\r\n      tableColumnList: [],\r\n      // 子表项是否折叠，默认为true\r\n      collapsed: true,\r\n      fileMap: new Map(),\r\n    }\r\n  },\r\n  watch: {\r\n    formDetail: {\r\n      handler(val) {\r\n        this.formDetailTemp = val.map((item) => {\r\n          const obj = {}\r\n          Object.keys(item).forEach((key) => {\r\n            obj[key] = item[key]\r\n          })\r\n          // obj.deleteFlag || (obj.deleteFlag = '0')\r\n          return obj\r\n        })\r\n      },\r\n      deep: true,\r\n    },\r\n    tableType: {\r\n      // 除新增外主动展开子表\r\n      handler(newVal) {\r\n        if (newVal == 'add') {\r\n          this.collapsed = true\r\n        } else {\r\n          this.collapsed = false\r\n        }\r\n      },\r\n      immediate: true,\r\n    },\r\n  },\r\n  computed: {\r\n    // 选择器列表字段，返回一个参数为dictCode的函数\r\n    pickerType() {\r\n      return (dictCode) => this.$store.state[ENUM][this.toLine(dictCode)] || []\r\n    },\r\n    lang() {\r\n      if (this.$storage.get('i18nLocale') == 'zh') {\r\n        return 'zh-CN'\r\n      } else {\r\n        return 'en'\r\n      }\r\n    },\r\n    // 子表各字段列表，过滤掉隐藏的\r\n    tableColumnTemp() {\r\n      return this.tableColumn.filter((item) => {\r\n        return !item.hidden\r\n      })\r\n    },\r\n  },\r\n  created() {\r\n    this.$dayjs.extend(dayOfYear)\r\n  },\r\n  mounted() {},\r\n  methods: {\r\n    // 限制步进器最多只能三位小数\r\n    stepperChange(val) {\r\n      // 当有值或为数字时判断\r\n      if (val === '' || val == null || isNaN(val)) {\r\n        return false\r\n      }\r\n      let reg = /^\\d+\\.?\\d{0,3}$/\r\n      let newVal = null\r\n      if (!reg.test(val)) {\r\n        Toast('限制正数或3位小数')\r\n        val = val.toString()\r\n        newVal = val.indexOf('.') > -1 ? val.slice(0, val.indexOf('.') + 4) : val\r\n        setTimeout(() => {\r\n          this.$set(this.formData, 'budget', newVal)\r\n        }, 500)\r\n      }\r\n    },\r\n\r\n    // 确认选择差旅类型组件\r\n    onReimburseTypeConfirm(value) {\r\n      for (let i = 0; i < this.tableColumnTemp.length; i++) {\r\n        if (this.tableColumnTemp[i].editType == 'select') {\r\n          this.tableColumnTemp[i].value = value.code\r\n        }\r\n      }\r\n      this.showPicker = false\r\n    },\r\n    // checkbox(value) {\r\n    //   this.formData.notification = value.toString();\r\n    // },\r\n    toLine(name) {\r\n      return name.replace(/([A-Z])/g, '_$1').toLowerCase()\r\n    },\r\n    fileChange(args, key) {\r\n      this.fileMap.set(key, args[0].fileList)\r\n    },\r\n    // 子表保存方法\r\n    async onSubmitTable() {\r\n      let tempObj = {}\r\n      // 默认不需要校验\r\n      const validated = this.tableColumn.every((column) => {\r\n        // 必填值为空时，校验失败\r\n        if (column.required && !column.value) {\r\n          Toast({ message: `${column.placeholder}${column.label}`, customClass: 'cus-toast' })\r\n          return false\r\n        } else {\r\n          return true\r\n        }\r\n      })\r\n      if (validated) {\r\n        for (let i = 0; i < this.tableColumn.length; i++) {\r\n          let column = this.tableColumn[i]\r\n          if (column.editType == 'file') {\r\n            if (this.fileMap.get(column.prop)?.length > 0) {\r\n              const refName = `form-${column.prop}`\r\n              this.$refs[refName][0].needToGetFile = false\r\n              await this.$refs[refName][0].setG9s()\r\n              // column.value = this.$refs[refName][0].value\r\n            } else {\r\n              column.value = ''\r\n            }\r\n          }\r\n          if (column.editType == 'datePicker' && column.format) {\r\n            column.value = this.$dayjs(column.value).format(column.format)\r\n          }\r\n          tempObj[column.prop] = column.value\r\n        }\r\n\r\n        if (this.currentType == 'add') {\r\n          tempObj.deleteFlag = '0'\r\n          this.formDetailTemp.push(tempObj)\r\n        } else {\r\n          this.formDetailTemp[this.currentIndex] = tempObj\r\n          // this.$emit('update:tableIndex', this.currentIndex)\r\n        }\r\n        this.$emit('update:formDetail', this.formDetailTemp)\r\n        this.showPop = false\r\n        this.collapsed = false\r\n        this.formDetailTemp = []\r\n      }\r\n    },\r\n    // 打开弹窗\r\n    addTableItem() {\r\n      this.currentType = 'add'\r\n      this.showPop = true\r\n      for (let i = 0; i < this.tableColumnTemp.length; i++) {\r\n        this.tableColumnTemp[i].value = ''\r\n      }\r\n    },\r\n    cancel() {\r\n      this.currentIndex = 0\r\n      this.showPop = false\r\n    },\r\n    // 查看子表\r\n    viewTableItem(item, index) {\r\n      this.currentIndex = index\r\n      for (let n in this.tableColumn) {\r\n        for (let m in item) {\r\n          if (this.tableColumn[n].prop == m) {\r\n            this.tableColumn[n].value = item[m]\r\n            if (this.tableColumn[n].editType == 'file') {\r\n              const refName = `form-${this.tableColumn[n].prop}`\r\n              this.$nextTick(() => {\r\n                this.$refs[refName][0].needToGetFile = true\r\n              })\r\n            }\r\n          }\r\n        }\r\n      }\r\n      // 主表非查看状态时，点击子表项都为编辑子表状态\r\n      this.currentType = this.tableType !== 'view' ? 'edit' : 'view'\r\n      this.showPop = true\r\n      this.$emit('update:tableColumn', this.tableColumn)\r\n    },\r\n    // 明细表删除\r\n    deleteItem(item, index) {\r\n      Dialog.confirm({\r\n        title: '提示',\r\n        message: '确认是否删除?',\r\n      })\r\n        .then(() => {\r\n          this.formDetailTemp.splice(index, 1)\r\n          this.$emit('update:formDetail', this.formDetailTemp)\r\n        })\r\n        .catch(() => {})\r\n    },\r\n    // 提供预览页面下载,，需开启downloadable\r\n    download(event, file, index, refName) {\r\n      if (this.downloadable) {\r\n        event.stopPropagation()\r\n        this.$refs[refName][index].download(file)\r\n      }\r\n    },\r\n  },\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.detail-table-container {\r\n  overflow: hidden;\r\n  background-color: rgba(242, 243, 244, 1);\r\n}\r\n\r\n.title-cell-value {\r\n  margin-right: 20px;\r\n  color: #027aff;\r\n}\r\n\r\n.table-list-container {\r\n  overflow: hidden;\r\n  background: #f2f3f4;\r\n}\r\n\r\n.table-item {\r\n  display: flex;\r\n  align-items: center;\r\n  padding-left: 28px;\r\n  margin-top: 24px;\r\n}\r\n// 子表最后一项设置底部边距\r\n.table-item-container:last-child {\r\n  margin-bottom: 32px;\r\n}\r\n\r\n// ----- popup start -----\r\n.popup-container {\r\n  height: 100%;\r\n  overflow: hidden;\r\n  display: flex;\r\n  flex-direction: column;\r\n  * {\r\n    box-sizing: border-box;\r\n  }\r\n}\r\n.add-item-container,\r\n.table-column-form {\r\n  // height: calc(100% - 92px);\r\n  overflow: auto;\r\n  flex: 1;\r\n}\r\n\r\n.with-button,\r\n.table-column-form {\r\n  height: calc(100% - 122px);\r\n}\r\n\r\n.without-button {\r\n  height: calc(100% - 92px);\r\n  .table-column-form {\r\n    height: 100%;\r\n  }\r\n}\r\n\r\n.uploder-attachment-item {\r\n  padding: 26px 32px;\r\n}\r\n\r\n.form-button {\r\n  display: flex;\r\n  padding: 18px 30px;\r\n  position: fixed;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: calc(0 + env(safe-area-inset-bottom));\r\n  bottom: calc(0 + constant(safe-area-inset-bottom));\r\n  height: 122px;\r\n\r\n  .save-btn {\r\n    flex: 1;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n  }\r\n}\r\n\r\n// ----- popup end -----\r\n\r\n// -----子表预览界面 start -----\r\n.cus-preview-list-item {\r\n  display: flex;\r\n  flex-direction: row;\r\n  margin-bottom: 10px;\r\n  .file-icon {\r\n    height: 53px;\r\n    width: 44px;\r\n  }\r\n  .file-info {\r\n    text-overflow: ellipsis;\r\n    overflow: hidden;\r\n    white-space: nowrap;\r\n    text-align: left;\r\n    margin-left: 12px;\r\n  }\r\n}\r\n.table-text {\r\n  width: 20%;\r\n  font-size: 28px;\r\n  color: #999999;\r\n  text-align: right;\r\n}\r\n.table-content {\r\n  width: 60%;\r\n  font-size: 28px;\r\n  color: #333333;\r\n  margin-left: 32px;\r\n  text-overflow: ellipsis;\r\n  overflow: hidden;\r\n  white-space: nowrap;\r\n  text-align: left;\r\n}\r\n.delete-button {\r\n  width: 10%;\r\n  color: #347df6;\r\n  font-size: 28px;\r\n  display: flex;\r\n  justify-content: center;\r\n}\r\n// ----- 子表预览界面 end -----\r\n\r\n/deep/.fm-field--disabled .fm-field__label {\r\n  color: #000;\r\n}\r\n\r\n//TODO 后期可在fm-cell-group组件中添加必填属性\r\n// 为必填的文本框设置必填*号\r\n.required-asterisk {\r\n  /deep/ .fm-cell-group__title {\r\n    color: #000;\r\n    position: relative;\r\n  }\r\n  /deep/ .fm-cell-group__title::before {\r\n    position: absolute;\r\n    left: 16px;\r\n    color: #ff4d4f;\r\n    font-size: 32px;\r\n    content: '*';\r\n  }\r\n}\r\n\r\n/deep/ .fm-cell__right-icon {\r\n  color: #333;\r\n}\r\n\r\n.textarea-type /deep/ .fm-field__value {\r\n  border: 1px solid #bbbbbb;\r\n  opacity: 0.5;\r\n}\r\n\r\n.textarea-type /deep/ .fm-field__control {\r\n  padding-left: 20px;\r\n  padding-top: 20px;\r\n}\r\n.textarea-type /deep/ .fm-field__word-limit {\r\n  margin-right: 20px;\r\n  margin-bottom: 12px;\r\n}\r\n\r\n// 屏蔽附件组件默认的padding\r\n/deep/ .field-attachment {\r\n  padding: 0;\r\n}\r\n\r\n/deep/ .fm-cell__right-icon {\r\n  color: #333;\r\n}\r\n\r\n.preview-detail-item {\r\n  margin: 24px 30px;\r\n}\r\n</style>\r\n"]}]}