"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.cancelRaf = cancelRaf;
exports.doubleRaf = doubleRaf;
exports.raf = raf;
var _ = require("..");
/*
 * @Author: gao_m3
 * @Date: 2021-11-19 10:23:30
 * @LastEditors: 
 * @LastEditTime: 2021-11-19 11:08:26
 * @Descripttion: 
 */
/**
 * requestAnimationFrame polyfill
 */

var prev = Date.now();

/* istanbul ignore next */
function fallback(fn) {
  var curr = Date.now();
  var ms = Math.max(0, 16 - (curr - prev));
  var id = setTimeout(fn, ms);
  prev = curr + ms;
  return id;
}

/* istanbul ignore next */
var root = _.isServer ? global : window;

/* istanbul ignore next */
var iRaf = root.requestAnimationFrame || fallback;

/* istanbul ignore next */
var iCancel = root.cancelAnimationFrame || root.clearTimeout;
function raf(fn) {
  return iRaf.call(root, fn);
}

// double raf for animation
function doubleRaf(fn) {
  raf(function () {
    raf(fn);
  });
}
function cancelRaf(id) {
  iCancel.call(root, id);
}